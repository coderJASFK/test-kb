<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]--><meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<link rel="icon" href="/favicon.png">
<meta name="robots" content="noindex">
<meta name="description" content="Rules in Checkmk can define the default or the exception. This article describes the use of rules in detail, and how they are evaluated.">
<meta name="og:locale" content="en">
<meta name="og:site_name" content="Checkmk Docs">
<meta name="og:title" content="Rules">
<meta name="og:description" content="Rules in Checkmk can define the default or the exception. This article describes the use of rules in detail, and how they are evaluated.">
<meta name="og:image" content="https://docs.checkmk.com/assets/images/share_image.png">
<meta name="twitter:site" content="@checkmk">
<meta name="twitter:creator" content="@checkmk">
<title>Rules</title>
<link rel="stylesheet" href="../../assets/css/checkmk.css?id=4473d2acbb1ea6136428">
<link rel="stylesheet" href="../../assets/css/pygments-monokai.css">
<link rel="stylesheet" href="../../assets/css/addons.css">
<link rel="stylesheet" href="../../assets/css/SourceCodePro.css">
<link rel="search" href="./opensearch.xml" type="application/opensearchdescription+xml" title="Search docs.checkmk.com">
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-NJ3VGL8');</script>
<!-- End Google Tag Manager --><style>
#staticinfo { font-style: italic; }
</style>
</head>
<body class="article toc2 toc-right">
<!-- Cookie Consent (GDPR Compliance) -->

<!-- End Cookie Consent (GDPR Compliance) -->
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NJ3VGL8" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) --><div class="header-top">
<div class="header-top__left">
<a class="header-top__logo d-none d-xl-inline-block" href="/2.2.0/en"><img src="../../assets/images/docs_logo.png" alt="Checkmk"></a><a class="header-top__icon d-inline-block d-xl-none" href="/2.2.0/en"><img src="../../assets/images/logo_icon.svg" alt="Checkmk"></a>
</div>
<div class="header-top__center">
<input type="text" class="header-top__search" placeholder="Search the checkmk docs"><div class="header-top__search__results"></div>
</div>
<div class="header-top__right d-block">
<button class="header-top__search__toggle d-inline-block d-md-none"><img class="header-top__search__toggle__icon" src="../../assets/images/search.svg" alt="Search"></button><div class="dropdown dropdown__language">
                    <button class="btn dropdown-toggle" type="button" id="languageMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">en</button>
                    <div class="dropdown-menu  dropdown-menu-right" aria-labelledby="languageMenuButton"><a class="dropdown-item" href="../../2.2.0/de/wato_rules.html">Deutsch</a></div>
</div>
<div class="dropdown dropdown__branch">
                        <button class="btn dropdown-toggle" type="button" id="branchMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">2.2.0</button>
                        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="branchMenuButton">
<a class="dropdown-item" href="../../2.1.0/en/wato_rules.html">2.1.0</a><a class="dropdown-item" href="../../latest/en/wato_rules.html">latest (2.3.0)</a>
</div>
</div>
<a class="header-top__back d-none d-lg-inline-block" href="https://checkmk.com">to checkmk.com</a><button class="header-top__toggle d-inline-block d-lg-none"><span class="header-top__toggle__icon"></span></button>
</div>
</div>
<aside><div class="main-nav">
<div class="main-nav__content"><div id="content">
<div class="sect1">
<h2 id="_welcome_to_checkmk">
<a class="anchor" href="#_welcome_to_checkmk"></a>1. Welcome to Checkmk</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="welcome.html">Welcome to the Checkmk User Guide</a></p>
</li>
<li>
<p><a href="release_notes.html">Release notes</a></p>
</li>
<li>
<p><a href="glossar.html">Glossary</a></p>
</li>
<li>
<p><a href="search.html">Searching docs.checkmk.com</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_beginners_guide">
<a class="anchor" href="#_beginners_guide"></a>2. Beginner’s Guide</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="intro_setup.html">Setting up Checkmk</a></p>
</li>
<li>
<p><a href="intro_gui.html">The Checkmk user interface</a></p>
</li>
<li>
<p><a href="intro_setup_monitor.html">Setting up monitoring</a></p>
</li>
<li>
<p><a href="intro_tools.html">The monitoring tools</a></p>
</li>
<li>
<p><a href="intro_monitor.html">Checkmk in monitoring</a></p>
</li>
<li>
<p><a href="intro_finetune.html">Fine-tuning the monitoring</a></p>
</li>
<li>
<p><a href="intro_users.html">Working with multiple users</a></p>
</li>
<li>
<p><a href="intro_notifications.html">Switching on notifications</a></p>
</li>
<li>
<p><a href="intro_extend.html">Extending the monitoring system further</a></p>
</li>
<li>
<p><a href="intro_bestpractise.html">Best practices, tips &amp; tricks</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_installation">
<a class="anchor" href="#_installation"></a>3. Installation</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="install_packages.html">Basic information on the installation of Checkmk</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_server_and_vms">
<a class="anchor" href="#_server_and_vms"></a>3.1. Server and VMs</h3>
<div class="ulist">
<ul>
<li>
<p><a href="install_packages_debian.html">Installation on Debian and Ubuntu</a></p>
</li>
<li>
<p><a href="install_packages_redhat.html">Installation on Red Hat and derivatives</a></p>
</li>
<li>
<p><a href="install_packages_sles.html">Installation on SUSE Linux Enterprise Server</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_appliance_container_cloud">
<a class="anchor" href="#_appliance_container_cloud"></a>3.2. Appliance, container, cloud</h3>
<div class="ulist">
<ul>
<li>
<p><a href="install_appliance_cmk.html">Installation of Checkmk in the appliance</a></p>
</li>
<li>
<p><a href="introduction_docker.html">Installation as a Docker container</a></p>
</li>
<li>
<p><a href="install_azure.html">Installation from Azure Marketplace</a></p>
</li>
<li>
<p><a href="install_aws.html">Installation from AWS Marketplace</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_updates">
<a class="anchor" href="#_updates"></a>3.3. Updates</h3>
<div class="ulist">
<ul>
<li>
<p><a href="update.html">Updates and Upgrades</a></p>
</li>
<li>
<p><a href="update_major.html">Update to version <span class="new">2.2.0</span></a></p>
</li>
<li>
<p><a href="update_matrix.html">Update matrix for version <span class="new">2.2.0</span></a></p>
</li>
<li>
<p><a href="release_upgrade.html">Linux upgrade on the Checkmk server</a></p>
</li>
<li>
<p><a href="cmk_versions.html">Checkmk versions</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_administration_of_checkmk">
<a class="anchor" href="#_administration_of_checkmk"></a>4. Administration of Checkmk</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_server">
<a class="anchor" href="#_server"></a>4.1. Server</h3>
<div class="ulist">
<ul>
<li>
<p><a href="saml.html">Authentication with SAML</a></p>
</li>
<li>
<p><a href="kerberos.html">Single sign-on with Kerberos</a></p>
</li>
<li>
<p><a href="managing_docker.html">Checkmk server in a Docker container</a></p>
</li>
<li>
<p><a href="security.html">Security</a></p>
</li>
<li>
<p><a href="ports.html">Ports</a></p>
</li>
<li>
<p><a href="omd_https.html">Securing the web interface with HTTPS</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_sites">
<a class="anchor" href="#_sites"></a>4.2. Sites</h3>
<div class="ulist">
<ul>
<li>
<p><a href="omd_basics.html">Site administration with omd</a></p>
</li>
<li>
<p><a href="cmk_commandline.html">Checkmk on the command line</a></p>
</li>
<li>
<p><a href="license.html">Managing licenses</a></p>
</li>
<li>
<p><a href="distributed_monitoring.html">Distributed monitoring</a></p>
</li>
<li>
<p><a href="backup.html">Backups</a></p>
</li>
<li>
<p><a href="password_store.html">Password store</a></p>
</li>
<li>
<p><a href="analyze_configuration.html">Analyzing the Checkmk site configuration</a></p>
</li>
<li>
<p><a href="mkps.html">Checkmk extension packages (MKPs)</a></p>
</li>
<li>
<p><a href="mkp_viewables.html">MKPs for GUI extensions</a></p>
</li>
<li>
<p><a href="simulation_mode.html">Simulation mode</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_configuration">
<a class="anchor" href="#_configuration"></a>5. Configuration</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="wato.html">Configuring Checkmk</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_hosts">
<a class="anchor" href="#_hosts"></a>5.1. Hosts</h3>
<div class="ulist">
<ul>
<li>
<p><a href="hosts_setup.html">Host administration</a></p>
</li>
<li>
<p><a href="hosts_structure.html">Host structuring</a></p>
</li>
<li>
<p><a href="host_tags.html">Host tags</a></p>
</li>
<li>
<p><a href="dcd.html">Dynamic host configuration</a></p>
</li>
<li>
<p><a href="hosts_autoregister.html">Automated host creation</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_services">
<a class="anchor" href="#_services"></a>5.2. Services</h3>
<div class="ulist">
<ul>
<li>
<p><a href="wato_services.html">Understanding and configuring services</a></p>
</li>
<li>
<p><a href="clustered_services.html">Monitoring cluster services</a></p>
</li>
<li>
<p><a href="piggyback.html">The piggyback mechanism</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_rules">
<a class="anchor" href="#_rules"></a>5.3. Rules</h3>
<div class="ulist">
<ul>
<li>
<p><a href="wato_rules.html">Rules</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_supporting_configurations">
<a class="anchor" href="#_supporting_configurations"></a>5.4. Supporting configurations</h3>
<div class="ulist">
<ul>
<li>
<p><a href="timeperiods.html">Time periods</a></p>
</li>
<li>
<p><a href="labels.html">Labels</a></p>
</li>
<li>
<p><a href="regexes.html">Regular expressions in Checkmk</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_users_and_permissions">
<a class="anchor" href="#_users_and_permissions"></a>5.5. Users and permissions</h3>
<div class="ulist">
<ul>
<li>
<p><a href="wato_user.html">Users, roles and permissions</a></p>
</li>
<li>
<p><a href="ldap.html">User management with LDAP/Active Directory</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_notifications">
<a class="anchor" href="#_notifications"></a>5.6. Notifications</h3>
<div class="ulist">
<ul>
<li>
<p><a href="notifications.html">Notifications</a></p>
</li>
<li>
<p><a href="notifications_webex.html">Notifications via Cisco Webex Teams</a></p>
</li>
<li>
<p><a href="notifications_ilert.html">Notifications via ilert</a></p>
</li>
<li>
<p><a href="notifications_jira.html">Notifications via Jira</a></p>
</li>
<li>
<p><a href="notifications_mattermost.html">Notifications via Mattermost</a></p>
</li>
<li>
<p><a href="notifications_teams.html">Notifications via Microsoft Teams</a></p>
</li>
<li>
<p><a href="notifications_pagerduty.html">Notifications via PagerDuty</a></p>
</li>
<li>
<p><a href="notifications_pushover.html">Notifications via Pushover</a></p>
</li>
<li>
<p><a href="notifications_opsgenie.html">Notifications via Opsgenie</a></p>
</li>
<li>
<p><a href="notifications_servicenow.html">Notifications via ServiceNow</a></p>
</li>
<li>
<p><a href="notifications_slack.html">Notifications via Slack</a></p>
</li>
<li>
<p><a href="notifications_splunkoncall.html">Notifications via Splunk On-Call</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_events">
<a class="anchor" href="#_events"></a>5.7. Events</h3>
<div class="ulist">
<ul>
<li>
<p><a href="ec.html">The Event Console</a></p>
</li>
<li>
<p><a href="alert_handlers.html">Alert handlers</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_monitoring_systems">
<a class="anchor" href="#_monitoring_systems"></a>6. Monitoring systems</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="wato_monitoringagents.html">Monitoring agents</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_checkmk_agents_and_snmp">
<a class="anchor" href="#_checkmk_agents_and_snmp"></a>6.1. Checkmk agents and SNMP</h3>
<div class="ulist">
<ul>
<li>
<p><a href="agent_deployment.html">Automatic agent updates</a></p>
</li>
<li>
<p><a href="agent_linux.html">Monitoring Linux</a></p>
</li>
<li>
<p><a href="agent_linux_legacy.html">Monitoring Linux in legacy mode</a></p>
</li>
<li>
<p><a href="agent_windows.html">Monitoring Windows</a></p>
</li>
<li>
<p><a href="agent_freebsd.html">Monitoring FreeBSD</a></p>
</li>
<li>
<p><a href="snmp.html">Monitoring via SNMP</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_agent_extensions">
<a class="anchor" href="#_agent_extensions"></a>6.2. Agent extensions</h3>
<div class="ulist">
<ul>
<li>
<p><a href="inventory.html">The HW/SW inventory</a></p>
</li>
<li>
<p><a href="mk_filestats.html">Monitoring files</a></p>
</li>
<li>
<p><a href="monitoring_logfiles.html">Monitoring log files</a></p>
</li>
<li>
<p><a href="monitoring_oracle.html">Monitoring Oracle databases</a></p>
</li>
<li>
<p><a href="monitoring_mysql.html">Monitoring MySQL</a></p>
</li>
<li>
<p><a href="monitoring_mssql.html">Monitoring MSSQL</a></p>
</li>
<li>
<p><a href="monitoring_jobs.html">Monitoring time-based processes (Cronjobs)</a></p>
</li>
<li>
<p><a href="spool_directory.html">The spool directory</a></p>
</li>
<li>
<p><a href="localchecks.html">Local checks</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_vm_cloud_container">
<a class="anchor" href="#_vm_cloud_container"></a>6.3. VM, cloud, container</h3>
<div class="ulist">
<ul>
<li>
<p><a href="datasource_programs.html">Datasource programs</a></p>
</li>
<li>
<p><a href="monitoring_vmware.html">Monitoring VMware ESXi</a></p>
</li>
<li>
<p><a href="monitoring_aws.html">Monitoring Amazon Web Services (AWS)</a></p>
</li>
<li>
<p><a href="monitoring_azure.html">Monitoring Microsoft Azure</a></p>
</li>
<li>
<p><a href="monitoring_gcp.html">Monitoring Google Cloud Platform (GCP)</a></p>
</li>
<li>
<p><a href="monitoring_kubernetes.html">Monitoring Kubernetes</a></p>
</li>
<li>
<p><a href="monitoring_openshift.html">Monitoring OpenShift</a></p>
</li>
<li>
<p><a href="monitoring_docker.html">Monitoring Docker</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_endpoints">
<a class="anchor" href="#_endpoints"></a>6.4. Endpoints</h3>
<div class="ulist">
<ul>
<li>
<p><a href="active_checks.html">Monitoring network services (Active checks)</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_dashboards_views_metrics">
<a class="anchor" href="#_dashboards_views_metrics"></a>7. Dashboards, views, metrics</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="user_interface.html">The user interface</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_general">
<a class="anchor" href="#_general"></a>7.1. General</h3>
<div class="ulist">
<ul>
<li>
<p><a href="views.html">Host and service views</a></p>
</li>
<li>
<p><a href="dashboards.html">Dashboards</a></p>
</li>
<li>
<p><a href="graphing.html">Measured values and graphing</a></p>
</li>
<li>
<p><a href="custom_notes.html">Custom notes</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_commands_in_views">
<a class="anchor" href="#_commands_in_views"></a>7.2. Commands in views</h3>
<div class="ulist">
<ul>
<li>
<p><a href="commands.html">Commands</a></p>
</li>
<li>
<p><a href="basics_ackn.html">Acknowledging problems</a></p>
</li>
<li>
<p><a href="basics_downtimes.html">Scheduled downtimes</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_analysis_and_prognosis">
<a class="anchor" href="#_analysis_and_prognosis"></a>8. Analysis and prognosis</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_analysis">
<a class="anchor" href="#_analysis"></a>8.1. Analysis</h3>
<div class="ulist">
<ul>
<li>
<p><a href="availability.html">Availability</a></p>
</li>
<li>
<p><a href="sla.html">Extended availability (SLAs)</a></p>
</li>
<li>
<p><a href="bi.html">Business Intelligence (BI)</a></p>
</li>
<li>
<p><a href="reporting.html">Reports</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_prognosis">
<a class="anchor" href="#_prognosis"></a>8.2. Prognosis</h3>
<div class="ulist">
<ul>
<li>
<p><a href="predictive_monitoring.html">Predictive monitoring</a></p>
</li>
<li>
<p><a href="forecast_graphs.html">Forecast graphs</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_connection_of_other_applications">
<a class="anchor" href="#_connection_of_other_applications"></a>9. Connection of other applications</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="monitoring_prometheus.html">Integrating Prometheus</a></p>
</li>
<li>
<p><a href="integrating_datadog.html">Integrating Datadog</a></p>
</li>
<li>
<p><a href="nagvis.html">NagVis: status data on maps and diagrams</a></p>
</li>
<li>
<p><a href="ntop.html">Integrating ntopng in Checkmk</a></p>
</li>
<li>
<p><a href="grafana.html">Integrating Checkmk in Grafana</a></p>
</li>
<li>
<p><a href="metrics_exporter.html">Sending metrics to InfluxDB and Graphite</a></p>
</li>
<li>
<p><a href="nagstamon.html">Integrating Checkmk in Nagstamon</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_specifics_to_the_editions">
<a class="anchor" href="#_specifics_to_the_editions"></a>10. Specifics to the editions</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="cse.html">The Standard Edition</a></p>
</li>
<li>
<p><a href="cce.html">The Cloud Edition</a></p>
</li>
<li>
<p><a href="managed.html">The Managed Services Edition</a></p>
</li>
<li>
<p><a href="support_diagnostics.html">Support diagnostics</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_automation_and_development">
<a class="anchor" href="#_automation_and_development"></a>11. Automation and development</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_apis_for_automation">
<a class="anchor" href="#_apis_for_automation"></a>11.1. APIs for automation</h3>
<div class="ulist">
<ul>
<li>
<p><a href="rest_api.html">The Checkmk REST API</a></p>
</li>
<li>
<p><a href="livestatus.html">Retrieving status data via Livestatus</a></p>
</li>
<li>
<p><a href="livestatus_references.html">Livestatus command reference</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_apis_for_development">
<a class="anchor" href="#_apis_for_development"></a>11.2. APIs for development</h3>
<div class="ulist">
<ul>
<li>
<p><a href="bakery_api.html">The Bakery-API</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_development_of_check_plug_ins">
<a class="anchor" href="#_development_of_check_plug_ins"></a>11.3. Development of check plug-ins</h3>
<div class="ulist">
<ul>
<li>
<p><a href="devel_intro.html">Developing extensions for Checkmk</a></p>
</li>
<li>
<p><a href="devel_check_plugins.html">Writing agent-based check plug-ins</a></p>
</li>
<li>
<p><a href="devel_check_plugins_snmp.html">Writing SNMP-based check plug-ins</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_concepts">
<a class="anchor" href="#_concepts"></a>12. Concepts</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="monitoring_basics.html">Basic principles of monitoring with Checkmk</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_the_checkmk_micro_core_cmc">
<a class="anchor" href="#_the_checkmk_micro_core_cmc"></a>12.1. The Checkmk Micro Core (CMC)</h3>
<div class="ulist">
<ul>
<li>
<p><a href="cmc.html">The Checkmk Micro Core (CMC)</a></p>
</li>
<li>
<p><a href="cmc_differences.html">Special characteristics of the CMC</a></p>
</li>
<li>
<p><a href="cmc_migration.html">Migration to the CMC</a></p>
</li>
<li>
<p><a href="cmc_files.html">CMC files and directories</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_checkmk_appliance">
<a class="anchor" href="#_the_checkmk_appliance"></a>13. The Checkmk appliance</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="appliance_rack1_quick_start.html">Quick start guide for Checkmk racks</a></p>
</li>
<li>
<p><a href="appliance_virt1_quick_start.html">Quick start guide for Checkmk virt1</a></p>
</li>
<li>
<p><a href="appliance_install_virt1.html">Installation of the virtual appliance</a></p>
</li>
<li>
<p><a href="appliance_usage.html">Configuring and using the appliance</a></p>
</li>
<li>
<p><a href="appliance_backup.html">Backup in the appliance</a></p>
</li>
<li>
<p><a href="appliance_cluster.html">Appliance in cluster operation</a></p>
</li>
<li>
<p><a href="appliance_rack_config.html">Special features of the hardware appliance</a></p>
</li>
</ul>
</div>
</div>
</div>
</div></div>
<div class="main-nav__utils">
<div class="dropup dropdown__utils">
<button class="btn dropdown-toggle" type="button" id="aboutMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">About Checkmk</button><div class="dropdown-menu dropup" aria-labelledby="aboutMenuButton">
<a class="dropdown-item" href="https://checkmk.com/product/features" target="_blank">Features</a><a class="dropdown-item" href="https://checkmk.com/product/editions" target="_blank">Editions</a><a class="dropdown-item" href="https://checkmk.com/integrations" target="_blank">Integrations</a><a class="dropdown-item" href="https://checkmk.com/imprint" target="_blank">Imprint</a><a class="dropdown-item" href="copyright.html" target="_blank">Copyright</a>
</div>
</div>
<div class="dropup dropdown__utils">
<button class="btn dropdown-toggle" type="button" id="learnMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Learn</button><div class="dropdown-menu dropup" aria-labelledby="learnMenuButton">
<a class="dropdown-item" href="https://checkmk.com/videos">Videos</a><a class="dropdown-item" href="https://checkmk.com/webinars">Webinars</a><a class="dropdown-item" href="https://checkmk.com/trainings/classes">Trainings</a>
</div>
</div>
<a class="main-nav__utils__link" href="https://forum.checkmk.com">Forum</a>
</div>
</div></aside><main><div id="header">
<h1>Rules</h1>
<div class="details">
<span id="revdate">Last modified on 12-Jun-2023</span><a class="edit-document" href="https://github.com/Checkmk/checkmk-docs/edit/2.2.0/src/common/en/wato_rules.asciidoc">Edit this page on GitHub</a>
</div>
</div>
<div id="content">
<div id="preamble">
<div id="staticinfo">This page was exported for offline usage on 2025-01-07 22:12:14 +0000. It may not reflect the current state of the Checkmk documentation. To view a daily updated version, visit <a href="https://docs.checkmk.com/" target="_blank">docs.checkmk.com</a>.</div>
<div class="sectionbody"><div class="paragraph">
<p></p>
<div class="dropdown dropdown__related">
<button class="btn btn-primary dropdown-toggle" type="button" id="relatedMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Related Articles</button><div class="dropdown-menu dropdown-menu-right" aria-labelledby="relatedMenuButton">
<a href="wato.html">Configuring Checkmk</a>
<a href="hosts_setup.html">Host administration</a>
<a href="wato_services.html">Understanding and configuring services</a>
</div>
</div>
</div></div>
</div>
<div class="sect1">
<h2 id="heading_intro">
<span class="hidden-anchor sr-only" id="intro"></span>1. Introduction</h2>
<div class="sectionbody">
<div class="paragraph"><p>In Checkmk you configure parameters for hosts and services by using <em>rules</em>.
This feature makes Checkmk very effective in complex environments,
and also brings a number of advantages to smaller installations.
In order to clarify the principle of rule-based configuration we will compare it to the classic method.</p></div>
<div class="sect2">
<h3 id="heading_classic">
<span class="hidden-anchor sr-only" id="classic"></span>1.1. The classic approach</h3>
<div class="paragraph"><p>As an example, let’s take the configuration of the thresholds for <span class="state1">WARN</span> and <span class="state2">CRIT</span> in the monitoring of file systems.
With a data base-oriented configuration, for each file system one would enter a line into a table:</p></div>
<table class="table-responsive table-bordered table tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead><tr>
<th class="tableblock halign-left valign-top">Host</th>
<th class="tableblock halign-left valign-top">File system</th>
<th class="tableblock halign-left valign-top">Warning</th>
<th class="tableblock halign-left valign-top">Critical</th>
</tr></thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>myserver001</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/var</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">90 %</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">95 %</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>myserver001</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/sapdata</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">90 %</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">95 %</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>myserver001</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/var/log</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">90 %</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">95 %</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>myserver002</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/var</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">85 %</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">90 %</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>myserver002</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/opt</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">85 %</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">90 %</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>myserver002</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/sapdata</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">85 %</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">95 %</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>myserver002</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/var/trans</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100 %</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100 %</p></td>
</tr>
</tbody>
</table>
<div class="paragraph"><p>This is relatively straightforward — but only because the table in this example is short.
In practice there tend to be hundreds or thousands of file systems.
Tools like copy &amp; paste, and bulk operations can simplify the work,
but the basic problem remains — how can you identify and implement a standard policy?
What is the general rule?
How should thresholds for future hosts be preset?</p></div>
</div>
<div class="sect2">
<h3 id="heading_rule_based">
<span class="hidden-anchor sr-only" id="rule_based"></span>1.2. Rules-based is better!</h3>
<div class="paragraph"><p>A rules-based configuration however <strong>consists</strong> of the policy!
We will replace the logic of the above table with a set of four rules.
If we assume that <code>myserver001</code> is a test system,
and that in each case the <em>first relevant rule</em> applies to every file system,
the result will be the same thresholds as in the table above:</p></div>
<div class="olist arabic"><ol class="arabic">
<li><p>File systems with the mount point <code>/var/trans</code> have a 100/100 % threshold.</p></li>
<li><p>The <code>/sapdata</code> file system on <code>myserver002</code> has a 85/95 % threshold.</p></li>
<li><p>File systems on test systems have a 90/95 % threshold.</p></li>
<li><p>All (unspecified) file systems have a 85/90 % threshold.</p></li>
</ol></div>
<div class="paragraph"><p>Granted, for only two hosts that doesn’t achieve much,
but with only a few more hosts it can quickly make quite a big difference.
The advantages of the rules-based configuration are obvious:</p></div>
<div class="ulist"><ul>
<li><p>The policy is clearly recognizable and can be reliably implemented.</p></li>
<li><p>You can change the policy at any time without needing to handle thousands of data sets.</p></li>
<li><p><em>Exceptions</em> are always still possible, but are documented in the form of rules.</p></li>
<li><p>The incorporation of new hosts is simple and less fault-prone.</p></li>
</ul></div>
<div class="paragraph"><p>In summary, then: less work — more quality!
For this reason, with Checkmk you will find an abundance of rules for customizing hosts and services — such as thresholds, monitoring settings, responsibilities, notifications, agent configuration and many more.</p></div>
</div>
<div class="sect2">
<h3 id="heading_rule_set_types">
<span class="hidden-anchor sr-only" id="rule_set_types"></span>1.3. Types of rule sets</h3>
<div class="paragraph"><p>Within Setup Checkmk organizes rules in <em>rule sets</em>.
Every rule set has the task of defining a specific parameter for hosts or services.
Checkmk contains more than 700 rule sets!
Here are some examples:</p></div>
<div class="ulist"><ul>
<li><p><span class="guihint">Host check command</span> — defines how to determine whether hosts are <span class="hstate0">UP</span>.</p></li>
<li><p><span class="guihint">Alternative display name for services</span> — defines alternative names for services’ displays.</p></li>
<li><p><span class="guihint">JVM memory levels</span> — sets thresholds and other parameters for monitoring the memory usage of Java virtual machines (VM).</p></li>
</ul></div>
<div class="paragraph"><p>Every rule set is responsible either for hosts or for services — never for both.
If a parameter can be defined for hosts as well as services, there is a pair of applicable rules — e.g., <span class="guihint">Normal check interval for host checks</span> and <span class="guihint">Normal check interval for services checks</span>.</p></div>
<div class="paragraph"><p>A few rule sets, strictly-speaking, don’t actually define parameters, rather they create services.
An example are the rules for <a href="glossar.html#active_check">active checks</a>, which can be found at <span class="guihint">Setup &gt; Services &gt; HTTP, TCP, Email, …​</span>.
With these you can, e.g., set up an HTTP check for specific hosts.
These rules are classified as host rules — due to the fact that if such a check exists on a host it is deemed to be a property of the host.</p></div>
<div class="paragraph"><p>Further, there are rule sets that control the <a href="glossar.html#service_discovery">service discovery</a>.
With these you can, for example, via <span class="guihint">Windows service discovery</span> define for which Windows services automatic checks should be created
if they are found on a system.
These are also host rules.</p></div>
<div class="paragraph"><p>The bulk of the rule sets determine parameters for specific <a href="glossar.html#check_plugin">check plug-ins</a>.
An example is <span class="guihint">Network interfaces and switch ports</span>.
The settings in these rules are tailored very specifically to their appropriate plug-in.
Such rule sets fundamentally only find use with those services that are based on this plug-in.
In case you are uncertain which rule set is responsible for which services,
then you can best find out by navigating directly via the service to the relevant rule.
How to do this will be explained later.</p></div>
</div>
<div class="sect2">
<h3 id="heading_host_tags">
<span class="hidden-anchor sr-only" id="host_tags"></span>1.4. Host tags</h3>
<div class="paragraph"><p>One thing we have so far not mentioned:
In the above example there is a rule for all test systems.
Where is it actually defined that a host is a test system?</p></div>
<div class="paragraph"><p>In Checkmk, something like <em>test system</em> is known as a <a href="glossar.html#host_tag">host tag</a>.
You can see which tags are available via <span class="guihint">Setup &gt; Hosts &gt; Tags</span>.
Some tags are already predefined — for example, for a <span class="guihint">Test system</span> defined in the <span class="guihint">Criticality</span> group.</p></div>
<div class="paragraph"><p>Applying tags to hosts is done either explicitly in the properties of the host, or through inheritance in the folder hierarchy.
How to do this is explained in the <a href="hosts_setup.html#folder">article on hosts</a>.
How to create your own tags, and what the predefined tags are about will be explained in the <a href="host_tags.html">article on host tags</a>.</p></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="heading_determining_sets">
<span class="hidden-anchor sr-only" id="determining_sets"></span>2. Determining the correct rule sets</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="heading_host_rule_sets">
<span class="hidden-anchor sr-only" id="host_rule_sets"></span>2.1. Host rule sets</h3>
<div class="paragraph"><p>If you wish to create a new rule that defines a parameter for one or more hosts,
there are several ways to this end.
The direct way is via the corresponding group in the <span class="guihint">setup</span> menu,
in this case <span class="guihint">Setup &gt; Hosts &gt; Host monitoring rules</span>:</p></div>
<div class="imageblock"><div class="content"><img src="../images/wato_rules_host_monitoring_rules.png" alt="Setup menu with focus on the 'Host monitoring rules'."></div></div>
<div class="paragraph"><p>In the following view, all rule sets relevant for host monitoring are displayed.
The numbers following the names of these rule sets show the number of rules that have already been defined:</p></div>
<div class="imageblock"><div class="content"><img src="../images/wato_rules_host_monitoring_rules_2.png" alt="The 'Host monitoring rules' in the Setup menu."></div></div>
<div class="paragraph"><p>However, you can reach your goal somewhat faster via the <em>search field</em>.
To do this, of course, you need to know approximately what the rule set is called.
Here is the result of a search for <code>host checks</code> as an example.</p></div>
<div class="imageblock"><div class="content"><img src="../images/wato_rules_search_host_checks.png" alt="Extract of the result of a search for host checks." width="50%"></div></div>
<div class="paragraph"><p>Another way is via the menu item <span class="guihint">Hosts &gt; Effective parameters</span> in the properties of an existing host in the Setup
or via the <span class="image-inline"><img src="../images/icons/icon_rulesets.png" alt="icon rulesets"></span> icon in the list of hosts of a folder.</p></div>
<div class="imageblock"><div class="content"><img src="../images/wato_rules_setup_object_parameters.png" alt="Host list in the Setup menu, with a highlighting of the button for effective parameters."></div></div>
<div class="paragraph"><p>There you will find not only all the rule sets that affect the host,
but also the parameter currently effective for this host.
In the example of <span class="guihint">Host check command</span> no rule applies for the shown host,
and it is therefore set to the <span class="guihint">Smart PING (only with Checkmk Micro Core)</span> default value of the commercial editions.
In the Raw Edition the default value is <span class="guihint">PING (active check with ICMP echo request)</span>.</p></div>
<div class="imageblock"><div class="content"><img src="../images/wato_rules_host_rule_sets.png" alt="Display for the 'Host check command' with the default value."></div></div>
<div class="paragraph"><p>Click on <span class="guihint">Host check command</span> in order to see the complete rule set.</p></div>
<div class="paragraph"><p>If a rule already exists, instead of the <span class="guihint">Default value</span> the number of the rule defining this parameter appears.</p></div>
<div class="imageblock"><div class="content"><img src="../images/wato_rules_host_rule_sets2.png" alt="Display for the 'Host check command' with rule."></div></div>
<div class="paragraph"><p>Clicking on this takes you directly to the rule.</p></div>
</div>
<div class="sect2">
<h3 id="heading_checkparameters">
<span class="hidden-anchor sr-only" id="checkparameters"></span>2.2. Service rule sets</h3>
<div class="paragraph"><p>The path to the rule sets for services is similar.
The general access is via the <span class="guihint">Setup</span> menu,
in this case <span class="guihint">Setup &gt; Services &gt; Service monitoring rules</span>
or, more appropriately via the search field.</p></div>
<div class="imageblock"><div class="content"><img src="../images/wato_rules_service_monitoring_rules.png" alt="Setup menu with focus on the 'Service monitoring rules' and the search box."></div></div>
<div class="paragraph"><p>If you are not yet very experienced with the names of the rule sets, then the path via the service is simpler.
Similarly to the hosts, there is also a page in which all of a service’s parameters are shown
and where you have the possibility of directly accessing the applicable rule sets.
You can access this parameter page with the <span class="image-inline"><img src="../images/icons/icon_services.png" alt="icon services"></span> icon in a host’s list of services in the Setup.
The <span class="image-inline"><img src="../images/icons/icon_check_parameters.png" alt="icon check parameters"></span> icon takes you directly to the rule set that defines the <a href="wato_services.html#parameters">parameter for the check plug-in</a> for this service.</p></div>
<div class="imageblock"><div class="content"><img src="../images/wato_rules_setup_service_list.png" alt="Services list in the Setup with the icons to call the parameters."></div></div>
<div class="paragraph"><p>By the way — the <span class="image-inline"><img src="../images/icons/icon_rulesets.png" alt="icon rulesets"></span> icon for the parameter page is also found in the monitoring in every service’s action menu:</p></div>
<div class="imageblock"><div class="content"><img src="../images/wato_rules_service_context_menu.png" alt="Services list in the monitoring with opened action menu of a service."></div></div>
</div>
<div class="sect2">
<h3 id="heading_enforced_services">
<span class="hidden-anchor sr-only" id="enforced_services"></span>2.3. Enforced services</h3>
<div class="paragraph"><p>In the <span class="guihint">Setup</span> menu you will also find an entry for <span class="guihint">Enforced Services</span>.
As the name suggests, you can use these rule sets to force services to be created on your hosts.
Details can be found in the <a href="wato_services.html#enforced_services">article about services</a>.
A small number of rule sets — such as <span class="guihint">Simple checks for BIOS/Hardware errors</span> — can only be found under the enforced services.
These are services which do not result from the service discovery, but are created manually by you.</p></div>
</div>
<div class="sect2">
<h3 id="heading_rule_sets_used">
<span class="hidden-anchor sr-only" id="rule_sets_used"></span>2.4. Rule sets in use</h3>
<div class="paragraph"><p>In each of the aforementioned lists of rule sets — whether in the <span class="guihint">Host monitoring rules</span> or the <span class="guihint">Service monitoring rules</span> — you can use <span class="guihint">Related &gt; Used rulesets</span> in the menu bar, to display only the rule sets in which you have defined at least one rule.
This is often a convenient way to get started if you want to make adjustments to your existing rules.
Incidentally, some of the rules will have been generated by default when creating the Checkmk site and are a part of the sample configuration.
These are also displayed here.</p></div>
</div>
<div class="sect2">
<h3 id="heading_ineffective_rules">
<span class="hidden-anchor sr-only" id="ineffective_rules"></span>2.5. Ineffective rules</h3>
<div class="paragraph"><p>Monitoring is a complex matter.
It can happen that there are rules which do not match a single host or service — either because you have made a mistake or because the matching hosts and services have disappeared.
Such ineffective rules can be found in the aforementioned rule set listings via <span class="guihint">Related &gt; Ineffective rulesets</span> in the menu bar.</p></div>
</div>
<div class="sect2">
<h3 id="heading_obsolete_rule_sets">
<span class="hidden-anchor sr-only" id="obsolete_rule_sets"></span>2.6. Obsolete rule sets</h3>
<div class="paragraph"><p>Checkmk is under constant development.
Occasionally things are standardized and it can occur that some rule sets are replaced by others.
If you have such rule sets in use, the easiest way to find them is do a rule search.
Open it via <span class="guihint">Setup &gt; General &gt; Rule search</span>.
Then click in the menu bar on <span class="guihint">Rules &gt; Refine search</span>,
select <span class="guihint">Search for deprecated rulesets</span> as the option for <span class="guihint">Deprecated</span>
and select <span class="guihint">Search for rule sets that have rules configured</span> as the option for <span class="guihint">Used</span>.
After an additional click on <span class="guihint">Search</span> you get the desired overview.</p></div>
<div class="imageblock"><div class="content"><img src="../images/wato_rules_search_deprecated_rules.png" alt="Options to search for deprecated rule sets."></div></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="heading_create_rules">
<span class="hidden-anchor sr-only" id="create_rules"></span>3. Creating and editing rules</h2>
<div class="sectionbody">
<div class="paragraph"><p>The following image shows the <span class="guihint">Filesystems (used space and growth)</span> rule set with four rules configured:</p></div>
<div class="imageblock"><div class="content"><img src="../images/rules_filesystem.png" alt="rules filesystem"></div></div>
<div class="paragraph"><p><strong>New rules</strong> are created either with the <span class="guihint">Create rule in folder</span> button, or by cloning an existing rule with <span class="image-inline"><img src="../images/icons/icon_clone.png" alt="icon clone"></span>.
Cloning creates an identical copy of the rule that you can then edit with <span class="image-inline"><img src="../images/icons/icon_edit.png" alt="icon edit"></span>.
A new rule created using the <span class="guihint">Create rule in folder</span> button will always appear at the end of the list of rules,
whereas a cloned rule will be displayed as a copy below the original rule from which it was cloned.</p></div>
<div class="paragraph"><p>The <strong>sequence</strong> in which the rules are listed can be changed with the <span class="image-inline"><img src="../images/icons/icon_drag.png" alt="icon drag"></span> button.
The sequence is important because rules positioned higher in the list always have <strong>priority</strong> over those located lower.</p></div>
<div class="paragraph"><p>The rules are stored in the same <a href="hosts_setup.html#folder">folders</a> from which you also manage the hosts.
The rules’ authorities are restricted to the hosts in this folder or in subfolders.
In the case of conflicting rules, the rule lower in the folder structure has priority.
In this way, for example, users with rights limited to certain <a href="wato_user.html#wato_permissions">authorized</a> folders
can create rules for their hosts without affecting the rest of the system.
In a rule’s properties you can change its folder and thus ‘relocate’ it.</p></div>
<div class="sect2">
<h3 id="heading_analyse_traffic_light">
<span class="hidden-anchor sr-only" id="analyse_traffic_light"></span>3.1. The analysis mode with ‘traffic lights’</h3>
<div class="paragraph"><p>When you access a rule set for a host or service in <span class="guihint">Setup</span>, Checkmk will show you this rule set in the <strong>analysis mode</strong>.
You can get there by clicking on the <span class="image-inline"><img src="../images/icons/icon_rulesets.png" alt="icon rulesets"></span> icon in the <span class="image-inline"><img src="../images/icons/icon_menu.png" alt="icon menu"></span> action menu in the <span class="guihint">Setup</span> in the host or service list.
The following <span class="guihint">Effective parameters of</span> page shows the list of rules that apply to the host/service.
To go to the analysis mode, click on the name of a rule set for which at least one rule exists, i.e. a set which is not set to the <span class="guihint">Default value</span>:</p></div>
<div class="imageblock"><div class="content"><img src="../images/rules_filesystem_analyze.png" alt="The analysis mode with 'traffic lights'."></div></div>
<div class="paragraph"><p>This mode has two features.
Firstly, a second button for setting rules appears — <span class="guihint">Add rule for current host</span> bzw. <span class="guihint">Add rule for current host and service.</span></p></div>
<div class="paragraph"><p>With this you can create a new rule which has the appropriate current host or service already preselected.
You can create an exceptional rule very easily and directly in this way.
Secondly, a ‘traffic light’ icon appears in every line, the color of which shows
whether and/or how this rule affects the current host, or respectively, service.
The following conditions are possible:</p></div>
<table class="table-responsive table-bordered table tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 5%;">
<col style="width: 95%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image-inline"><img src="../images/icons/icon_rulenmatch.png" alt="icon rulenmatch"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This rule has no effect on the current host or service.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image-inline"><img src="../images/icons/icon_rulematch.png" alt="icon rulematch"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This rule matches and defines one or more parameters.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image-inline"><img src="../images/icons/icon_ruleimatch.png" alt="icon ruleimatch"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The rule matches. But because another rule higher in the hierarchy has priority this rule is ineffective.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image-inline"><img src="../images/icons/icon_rulepmatch.png" alt="icon rulepmatch"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This rule matches. Another rule higher in the hierarchy in fact has priority but doesn’t define all parameters, so that at least one parameter is defined by this lower rule.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph"><p>In the last condition — the rule is a <span class="image-inline"><img src="../images/icons/icon_rulepmatch.png" alt="icon rulepmatch"></span> partial match — can only occur for rule sets
in which a rule can define <strong>multiple parameters</strong> by selecting individual check boxes.
Theoretically, every parameter for another rule can also be set individually here.
More on this later.</p></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="heading_rule_characteristics">
<span class="hidden-anchor sr-only" id="rule_characteristics"></span>4. Rule characteristics</h2>
<div class="sectionbody">
<div class="paragraph"><p>Each rule consists of three blocks.
The first block contains general information about the rule, such as the rule’s name.
The second block defines what the rule is supposed to do, i.e. which actions it is to perform.
The third block contains the information on what, i.e. on which hosts or services, the rule is to be applied.</p></div>
<div class="sect2">
<h3 id="heading_rule_properties">
<span class="hidden-anchor sr-only" id="rule_properties"></span>4.1. Rule properties</h3>
<div class="paragraph"><p>Everything in the first block, <span class="guihint">Rule Properties</span>, is optional, and serves primarily for documentation:</p></div>
<div class="imageblock"><div class="content"><img src="../images/rules_props_properties.png" alt="General rule options."></div></div>
<div class="ulist"><ul>
<li><p>The <span class="guihint">Description</span> will be shown in the table of all rules in a rule set.</p></li>
<li><p>The <span class="guihint">Comment</span> field can be used for a longer description.
It only appears in a rule’s edit mode.
Via the <span class="image-inline"><img src="../images/icons/icon_insertdate.png" alt="icon insertdate"></span> icon you can insert a date stamp and your login name in the text.</p></li>
<li><p>The <span class="guihint">Documentation URL</span> is intended for a link to internal documentation that you maintain in another system (e.g., a CMDB).
It will appear as the clickable <span class="image-inline"><img src="../images/icons/icon_url.png" alt="icon url"></span> icon in the rules table.</p></li>
<li><p>With the <span class="guihint">Do not apply this rule</span> check box you can temporarily disable this rule.
It will then be flagged as <span class="image-inline"><img src="../images/icons/icon_disabled.png" alt="icon disabled"></span> in the table and is thus ineffective.</p></li>
</ul></div>
</div>
<div class="sect2">
<h3 id="heading_defined_parameters">
<span class="hidden-anchor sr-only" id="defined_parameters"></span>4.2. The defined parameters</h3>
<div class="paragraph"><p>The second section is different for each rule, but always specifies what should be done.
The following illustration shows a widely-used type of rule (<span class="guihint">DB2 Tablespaces</span>).
You can use checkboxes to determine which individual parameters the rule should define.
As described above, Checkmk determines which rule defines each individual parameter separately.
The rule from the illustration therefore only defines the one value and leaves all other settings unaffected:</p></div>
<div class="imageblock"><div class="content"><img src="../images/rules_props_value_1.png" alt="Different rule values with a setting of one value."></div></div>
<div class="paragraph"><p>You can also control the values in this and other rules on a time/calendar basis.
For example, you can set threshold values so that tablespace usage during business hours differs from that on weekends.</p></div>
<div class="paragraph"><p>First click the <span class="guihint">Enable timespecific parameters</span> button and then click <span class="guihint">Add new element</span>, you will see the time-dependent options:</p></div>
<div class="imageblock"><div class="content"><img src="../images/wato_rules_time_period.png" alt="View of rule values when time-dependent parameters are selected."></div></div>
<div class="paragraph"><p>Now select a <a href="timeperiods.html">time period</a> in the <span class="guihint">Match only during time period</span> list, and then select the parameters for which this time period should apply.</p></div>
<div class="paragraph"><p>Some of the rule sets do not set a parameter, but only decide which hosts are <em>in</em> and which are not.
An example is the rule set <span class="guihint">Hosts to be monitored</span>, whose parameter range looks like this:</p></div>
<div class="imageblock"><div class="content"><img src="../images/wato_rules_positive.png" alt="Select positive or negative match."></div></div>
<div class="paragraph"><p>By selecting one of the two available values, you decide what to do with the affected hosts.
Selecting <span class="guihint">Positive match (Add matching hosts to the set)</span> will add the affected hosts to the set of hosts to be monitored.
Selecting <span class="guihint">Negative match (Exclude matching hosts from the set)</span> removes the affected hosts from the monitoring.
The <span class="guihint">Positive match</span> or <span class="guihint">Negative match</span> refers to the content of the current rule.
It is <em>not</em> an additional filter criterion for selecting hosts.
You filter the set of affected hosts exclusively with the following <span class="guihint">Conditions</span>.</p></div>
</div>
<div class="sect2">
<h3 id="heading_conditions">
<span class="hidden-anchor sr-only" id="conditions"></span>4.3. Conditions</h3>
<div class="paragraph"><p>In the previous section, you defined how all those hosts or services that are affected by your rule are to be processed.
In the third section <span class="guihint">Conditions</span> you now define which hosts or services are to be acted on by the rule — and thus its effects.
There are different types of conditions that must all be fulfilled for the rule to take effect.
The conditions are therefore logically AND-linked:</p></div>
<div class="imageblock"><div class="content"><img src="../images/rules_props_conditions_1.png" alt="The conditions for a rule."></div></div>
<div class="sect3">
<h4 id="heading__condition_type">
<span class="hidden-anchor sr-only" id="_condition_type"></span>Condition type</h4>
<div class="paragraph"><p>Here you have the option of using normal conditions as well as <em>predefined conditions</em>.
These are managed via <span class="guihint">Setup &gt; General &gt; Predefined conditions</span>.
Here you simply give fixed names to the rule matches that you need again and again, and from then on simply refer to them in the rules.
You can even later change the content of these conditions centrally and all the rules will be automatically-adjusted to suit.
In the following example the predefined condition <span class="guihint">No VM</span> has been selected:</p></div>
<div class="imageblock"><div class="content"><img src="../images/rules_props_conditions_2.png" alt="Selecting a predefined condition for a rule."></div></div>
</div>
<div class="sect3">
<h4 id="heading__folder">
<span class="hidden-anchor sr-only" id="_folder"></span>Folder</h4>
<div class="paragraph"><p>With the <span class="guihint">Folder</span> condition you define that the rule only applies to hosts in this folder — or a subfolder.
If the setting is <span class="guihint">Main</span>, this condition is applicable to all hosts.
As described above, the folders have an effect on the rule’s sequence.
Rules in lower folders always have priority over higher ones.</p></div>
</div>
<div class="sect3">
<h4 id="heading__host_tags">
<span class="hidden-anchor sr-only" id="_host_tags"></span>Host tags</h4>
<div class="paragraph"><p><span class="guihint">Host tags</span> restrict rules to hosts according to whether they have — or do not have — specific host tags.
Here as well, AND-links are always used.
Every other host tag condition in a rule reduces the number of hosts affected by the rule.</p></div>
<div class="paragraph"><p>If you wish to make a rule applicable for two possible values for a tag, (e.g. for <span class="guihint">Criticality</span> both <span class="guihint">Productive system</span> and <span class="guihint">Business critical)</span>, you cannot do this with a single rule.
You will require a copy of the rule for each variant.
Sometimes a negation can also help here.
You can also define that a tag is <strong>not</strong> present as a condition (e.g., not <span class="guihint">Test system</span>).
The so-called <a href="host_tags.html#aux_tag">auxiliary tags</a> are another possibility.</p></div>
<div class="paragraph"><p>Because some users really use many host tags, we have designed this dialog so that not all host tag groups are displayed by default.
You have to specifically select the one needed for the rule.
It works like this:</p></div>
<div class="olist arabic"><ol class="arabic">
<li><p>In the selection box choose a host tag group.</p></li>
<li><p>Click <span class="guihint">Add tag condition</span> — an entry for this group will then be added.</p></li>
<li><p>Select <span class="guihint">is</span> or <span class="guihint">is not</span>.</p></li>
<li><p>Select the desired tag as a comparison value.</p></li>
</ol></div>
<div class="imageblock"><div class="content"><img src="../images/rules_props_hosttags.png" alt="Specifying multiple host tags in one condition."></div></div>
</div>
<div class="sect3">
<h4 id="heading__labels">
<span class="hidden-anchor sr-only" id="_labels"></span>Labels</h4>
<div class="paragraph"><p>You can also use the <a href="glossar.html#label">labels</a> for conditions in rules.
Include conditions with <span class="guihint">Add label condition</span> — choose either <span class="guihint">has</span> or <span class="guihint">has not</span> to formulate a positive or negative condition,
and then enter the label in the usual form <em>key:value</em>.
Pay attention to the exact spelling including case-sensitivity here — otherwise the condition will not work correctly.</p></div>
<div class="imageblock"><div class="content"><img src="../images/rules_props_labels.png" alt="Condition for service labels."></div></div>
<div class="paragraph"><p><strong>Note:</strong> If you have defined neither <span class="guihint">Host tags</span> nor <span class="guihint">Host labels</span>, the rule in question will always be applied to all hosts or services.
If you have created several rules, subsequent rules may no longer be evaluated, see <a href="#matching">Types of rule evaluation</a>.</p></div>
</div>
<div class="sect3">
<h4 id="heading__explicit_hosts">
<span class="hidden-anchor sr-only" id="_explicit_hosts"></span>Explicit hosts</h4>
<div class="paragraph"><p>This type of condition is intended for exception rules.
Here you can list one or more host names.
The rule will apply only to these hosts.
Note that if you check the <span class="guihint">Explicit hosts</span> box but enter <strong>no</strong> hosts, then the rule will be completely ineffective.</p></div>
<div class="paragraph"><p>Via the <span class="guihint">Negate</span> option you can define a reversed-exception.
With this you can exclude explicitly-named hosts from the rule.
This rule will then apply to all hosts <strong>except</strong> the ones mentioned here.</p></div>
<div class="imageblock"><div class="content"><img src="../images/rules_props_explicithosts_1.png" alt="Condition for explicitly named hosts."></div></div>
<div class="paragraph"><p><strong>Important</strong>: All host names entered here will be checked for <strong>exact congruence</strong>.
Checkmk is fundamentally case-sensitive in host names!</p></div>
<div class="paragraph"><p>You can change this behavior to <a href="regexes.html">regular expressions</a> by prefixing host names with a tilde (<code>~</code>).
In this case, as always in the <span class="guihint">Setup</span>:</p></div>
<div class="ulist"><ul>
<li><p>The match is applied to the <strong>beginning</strong> of the host name.</p></li>
<li><p>The match is not case-sensitive.</p></li>
</ul></div>
<div class="paragraph"><p>A point-asterisk (<code>.*</code>) in <a href="regexes.html">regular expressions</a> allows an arbitrary sequence of characters following the point.
The following example shows a condition which all hosts will match whose names <strong>contain</strong> the character sequence <code>my</code> (or <code>My</code>, <code>MY</code>, <code>mY</code> etc.):</p></div>
<div class="imageblock"><div class="content"><img src="../images/rules_props_explicithosts_2.png" alt="Condition for host selection with wildcards."></div></div>
</div>
<div class="sect3">
<h4 id="heading__explicit_services">
<span class="hidden-anchor sr-only" id="_explicit_services"></span>Explicit services</h4>
<div class="paragraph"><p>For rules that are applicable to services there is a last type of condition that defines a match on a service’s name,
or respectively — for rules that set check parameters — the <strong>check item’s</strong> name.
With what exactly the match will be made can be seen in the caption.
In our example it is the name (<span class="guihint">Instance</span>) of a Tablespace:</p></div>
<div class="imageblock"><div class="content"><img src="../images/rules_props_explicitservices.png" alt="Condition for service selection with wildcards."></div></div>
<div class="paragraph"><p>A match with <a href="regexes.html">regular expressions</a> fundamentally applies here.
The sequence <code>.*temp</code> matches all tablespaces <strong>containing</strong> <code>temp</code> because the match is always applied to the start of the name.
The dollar sign at the end of <code>transfer$</code> represents the end and thereby forces an exact match.
A tablespace with the name <code>transfer2</code> will thus <strong>not</strong> match.</p></div>
<div class="paragraph"><p>Don’t forget:
for rules concerning <span class="guihint">Explicit services</span> a match with the service name is required (e.g. <code>Tablespace transfer</code>).
For check parameter rules a match with the item applies (e.g. <code>transfer</code>).
The item is in fact the variable part of of the service name, and determines <em>to which</em> tablespace it applies.</p></div>
<div class="paragraph"><p>There are incidentally services without an item.
An example is <span class="guihint">CPU load</span>.
This exists only once for each host — so no item is required.
It follows then that rules for such check types are also without conditions.</p></div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="heading_matching">
<span class="hidden-anchor sr-only" id="matching"></span>5. Rule analysis</h2>
<div class="sectionbody">
<div class="paragraph"><p>Now we have described how rules are created.
However, simply creating rules is not enough.
As shown by the example in the <a href="#rule_based">Rules-based is better!</a> section at the start of this article, a single rule is not sufficient to achieve the desired result.
A more complex system of logically-sequenced rules is required for this.
For that reason an understanding of how multiple rules interact also becomes important.</p></div>
<div class="sect2">
<h3 id="heading_matching_type">
<span class="hidden-anchor sr-only" id="matching_type"></span>5.1. Types of rule analysis</h3>
<div class="paragraph"><p>In the introduction to the concept of rules, you saw that the first rule that applies always determines the final outcome.
This is not the whole truth.
There are a total of three different types of evaluation:</p></div>
<table class="table-responsive table-bordered table tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead><tr>
<th class="tableblock halign-left valign-top">Evaluation</th>
<th class="tableblock halign-left valign-top">Action</th>
</tr></thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">First rule<br>
(<span class="guihint">The first matching rule defines the parameter.</span>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The first matching rule defines the value.
Further rules are not evaluated.
This is the normal case for rules that define simple parameters.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">First rule per parameter<br>
(<span class="guihint">Each parameter is defined by the first matching rule where that parameter is set.</span>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Each single parameter is defined by the first rule where that parameter is defined (checkbox ticked).
This is the normal case for all rules with sub-parameters that are activated with checkboxes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">All rules<br>
(<span class="guihint">All matching rules will add to the resulting list.</span>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All matching rules will add elements to the resulting list.
This type is used, for example, when matching hosts and services to host, service and contact groups.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph"><p>The information on how the rule is evaluated is displayed for each rule set directly below the menu bar:</p></div>
<div class="imageblock"><div class="content"><img src="../images/rules_matching_strategy.png" alt="For each rule set the applicable rule evaluation is shown directly below the menu bar."></div></div>
</div>
<div class="sect2">
<h3 id="heading_rules_applied">
<span class="hidden-anchor sr-only" id="rules_applied"></span>5.2. Rule evaluation in the practice explained</h3>
<div class="paragraph"><p>Now, how will it evaluated concretely if one has created several rules that are to be applied to several hosts?
To illustrate this, let’s take a simple example:</p></div>
<div class="paragraph"><p>Let’s say you have three hosts and you want to set different periodically-repeated notifications for each of them (and also for all hosts added in the future) with the <span class="guihint">Periodic notifications during host problems</span> rule:</p></div>
<div class="olist arabic"><ol class="arabic">
<li><p>Rule A: Host-1 every 10 minutes</p></li>
<li><p>Rule B: Host-2 every 20 minutes</p></li>
<li><p>Rule C: all hosts every 30 minutes (general rule to cover both Host-3 and any hosts added in the future).</p></li>
</ol></div>
<div class="paragraph"><p>If you now activate your configuration, Checkmk runs through the chain of rules from top to bottom.
This results in the following evaluation:</p></div>
<div class="ulist"><ul>
<li><p>Rule A applies to Host-1.
The notification for Host-1 takes place every 10 minutes.
This completes the processing for Host-1.</p></li>
<li><p>Rule A does not apply to Host-2.
We continue with rule B.
This applies to Host-2 so that Host-2 is notified every 20 minutes.
This completes the processing for Host-2.</p></li>
<li><p>Rule A does not apply to Host-3, neither does Rule B.
But rule C fits and is applied: notification for Host-3 is at 30-minute intervals.
This also completes the processing for Host-3.</p></li>
</ul></div>
<div class="paragraph"><p>Please note here:
Since <a href="#matching_type">'The first matching rule defines the parameter'</a> applies to this rule set, the processing of the rule chain is always terminated after the first match.
The order of the rules is therefore decisive for the result!
This becomes apparent when the order of the rules is changed and rules B and C are swapped:</p></div>
<div class="olist arabic"><ol class="arabic">
<li><p>Rule A: Host-1 every 10 minutes</p></li>
<li><p>Rule C: all hosts every 30 minutes</p></li>
<li><p>Rule B: Host-2 every 20 minutes</p></li>
</ol></div>
<div class="paragraph"><p>If the rule chain is now run through again from top to bottom for the individual hosts, the result also changes:
Rule C now applies not only to Host-3, but also to Host-2, so that the notification for both hosts takes place every 30 minutes.
This completes the processing for both hosts.
Although Rule B would be relevant for Host-2, and was even written for this host, it will no longer be evaluated and applied.
In the <a href="#analyse_traffic_light">analysis mode</a>, the process will then look like this:</p></div>
<div class="imageblock">
<div class="content"><img src="../images/rules_analyse_mode_example.png" alt="Analysis mode for Host-2 after swapping rules B and C."></div>
<div class="title">For Host-2, the final rule with the yellow sphere also matches, but is not applied</div>
</div>
<div class="paragraph"><p>By combining the various settings explained in this article — keeping in mind the correct processing order — you can use them to build complex rule chains for entire host complexes.</p></div>
</div>
</div>
</div>
</div></main><div id="toc" class="toc2">
<div id="toctitle">On this page</div>
<ul class="sectlevel1">
<li>
<a href="#intro">1. Introduction</a><ul class="sectlevel1">
<li><a href="#classic">1.1. The classic approach</a></li>
<li><a href="#rule_based">1.2. Rules-based is better!</a></li>
<li><a href="#rule_set_types">1.3. Types of rule sets</a></li>
<li><a href="#host_tags">1.4. Host tags</a></li>
</ul>
</li>
<li>
<a href="#determining_sets">2. Determining the correct rule sets</a><ul class="sectlevel1">
<li><a href="#host_rule_sets">2.1. Host rule sets</a></li>
<li><a href="#checkparameters">2.2. Service rule sets</a></li>
<li><a href="#enforced_services">2.3. Enforced services</a></li>
<li><a href="#rule_sets_used">2.4. Rule sets in use</a></li>
<li><a href="#ineffective_rules">2.5. Ineffective rules</a></li>
<li><a href="#obsolete_rule_sets">2.6. Obsolete rule sets</a></li>
</ul>
</li>
<li>
<a href="#create_rules">3. Creating and editing rules</a><ul class="sectlevel1"><li><a href="#analyse_traffic_light">3.1. The analysis mode with ‘traffic lights’</a></li></ul>
</li>
<li>
<a href="#rule_characteristics">4. Rule characteristics</a><ul class="sectlevel1">
<li><a href="#rule_properties">4.1. Rule properties</a></li>
<li><a href="#defined_parameters">4.2. The defined parameters</a></li>
<li>
<a href="#conditions">4.3. Conditions</a><ul class="sectlevel2">
<li><a href="#_condition_type">Condition type</a></li>
<li><a href="#_folder">Folder</a></li>
<li><a href="#_host_tags">Host tags</a></li>
<li><a href="#_labels">Labels</a></li>
<li><a href="#_explicit_hosts">Explicit hosts</a></li>
<li><a href="#_explicit_services">Explicit services</a></li>
</ul>
</li>
</ul>
</li>
<li>
<a href="#matching">5. Rule analysis</a><ul class="sectlevel1">
<li><a href="#matching_type">5.1. Types of rule analysis</a></li>
<li><a href="#rules_applied">5.2. Rule evaluation in the practice explained</a></li>
</ul>
</li>
</ul>
</div>
<script src="../../assets/js/manifest.js?id=7db827d654313dce4250"></script>
<script src="../../assets/js/vendor.js?id=581a3d4a61b7156d04df"></script>
<script src="../../assets/js/app.js?id=959ccd04b1f8b7b78c5e"></script>
<script src="../../assets/js/lunr.js"></script>
<script src="../../assets/js/lunr.stemmer.support.js"></script>
<script src="../lunr.index.en.js"></script>
<script src="../../assets/js/lunr.client.js"></script>
</body>
</html>
