<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]--><meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<link rel="icon" href="/favicon.png">
<meta name="robots" content="noindex">
<meta name="description" content="The spool directory can be used by regularly running programs to store information about their state, which is then added to the agent's output.">
<meta name="og:locale" content="en">
<meta name="og:site_name" content="Checkmk Docs">
<meta name="og:title" content="The spool directory - Adding file contents to agent outputs">
<meta name="og:description" content="The spool directory can be used by regularly running programs to store information about their state, which is then added to the agent's output.">
<meta name="og:image" content="https://docs.checkmk.com/assets/images/share_image.png">
<meta name="twitter:site" content="@checkmk">
<meta name="twitter:creator" content="@checkmk">
<title>The spool directory - Adding file contents to agent outputs</title>
<link rel="stylesheet" href="../../assets/css/checkmk.css?id=4473d2acbb1ea6136428">
<link rel="stylesheet" href="../../assets/css/pygments-monokai.css">
<link rel="stylesheet" href="../../assets/css/addons.css">
<link rel="stylesheet" href="../../assets/css/SourceCodePro.css">
<link rel="search" href="./opensearch.xml" type="application/opensearchdescription+xml" title="Search docs.checkmk.com">
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-NJ3VGL8');</script>
<!-- End Google Tag Manager --><style>
#staticinfo { font-style: italic; }
</style>
</head>
<body class="article toc2 toc-right">
<!-- Cookie Consent (GDPR Compliance) -->

<!-- End Cookie Consent (GDPR Compliance) -->
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NJ3VGL8" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) --><div class="header-top">
<div class="header-top__left">
<a class="header-top__logo d-none d-xl-inline-block" href="/2.2.0/en"><img src="../../assets/images/docs_logo.png" alt="Checkmk"></a><a class="header-top__icon d-inline-block d-xl-none" href="/2.2.0/en"><img src="../../assets/images/logo_icon.svg" alt="Checkmk"></a>
</div>
<div class="header-top__center">
<input type="text" class="header-top__search" placeholder="Search the checkmk docs"><div class="header-top__search__results"></div>
</div>
<div class="header-top__right d-block">
<button class="header-top__search__toggle d-inline-block d-md-none"><img class="header-top__search__toggle__icon" src="../../assets/images/search.svg" alt="Search"></button><div class="dropdown dropdown__language">
                    <button class="btn dropdown-toggle" type="button" id="languageMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">en</button>
                    <div class="dropdown-menu  dropdown-menu-right" aria-labelledby="languageMenuButton"><a class="dropdown-item" href="../../2.2.0/de/spool_directory.html">Deutsch</a></div>
</div>
<div class="dropdown dropdown__branch">
                        <button class="btn dropdown-toggle" type="button" id="branchMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">2.2.0</button>
                        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="branchMenuButton">
<a class="dropdown-item" href="../../2.1.0/en/spool_directory.html">2.1.0</a><a class="dropdown-item" href="../../latest/en/spool_directory.html">latest (2.3.0)</a>
</div>
</div>
<a class="header-top__back d-none d-lg-inline-block" href="https://checkmk.com">to checkmk.com</a><button class="header-top__toggle d-inline-block d-lg-none"><span class="header-top__toggle__icon"></span></button>
</div>
</div>
<aside><div class="main-nav">
<div class="main-nav__content"><div id="content">
<div class="sect1">
<h2 id="_welcome_to_checkmk">
<a class="anchor" href="#_welcome_to_checkmk"></a>1. Welcome to Checkmk</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="welcome.html">Welcome to the Checkmk User Guide</a></p>
</li>
<li>
<p><a href="release_notes.html">Release notes</a></p>
</li>
<li>
<p><a href="glossar.html">Glossary</a></p>
</li>
<li>
<p><a href="search.html">Searching docs.checkmk.com</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_beginners_guide">
<a class="anchor" href="#_beginners_guide"></a>2. Beginnerâ€™s Guide</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="intro_setup.html">Setting up Checkmk</a></p>
</li>
<li>
<p><a href="intro_gui.html">The Checkmk user interface</a></p>
</li>
<li>
<p><a href="intro_setup_monitor.html">Setting up monitoring</a></p>
</li>
<li>
<p><a href="intro_tools.html">The monitoring tools</a></p>
</li>
<li>
<p><a href="intro_monitor.html">Checkmk in monitoring</a></p>
</li>
<li>
<p><a href="intro_finetune.html">Fine-tuning the monitoring</a></p>
</li>
<li>
<p><a href="intro_users.html">Working with multiple users</a></p>
</li>
<li>
<p><a href="intro_notifications.html">Switching on notifications</a></p>
</li>
<li>
<p><a href="intro_extend.html">Extending the monitoring system further</a></p>
</li>
<li>
<p><a href="intro_bestpractise.html">Best practices, tips &amp; tricks</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_installation">
<a class="anchor" href="#_installation"></a>3. Installation</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="install_packages.html">Basic information on the installation of Checkmk</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_server_and_vms">
<a class="anchor" href="#_server_and_vms"></a>3.1. Server and VMs</h3>
<div class="ulist">
<ul>
<li>
<p><a href="install_packages_debian.html">Installation on Debian and Ubuntu</a></p>
</li>
<li>
<p><a href="install_packages_redhat.html">Installation on Red Hat and derivatives</a></p>
</li>
<li>
<p><a href="install_packages_sles.html">Installation on SUSE Linux Enterprise Server</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_appliance_container_cloud">
<a class="anchor" href="#_appliance_container_cloud"></a>3.2. Appliance, container, cloud</h3>
<div class="ulist">
<ul>
<li>
<p><a href="install_appliance_cmk.html">Installation of Checkmk in the appliance</a></p>
</li>
<li>
<p><a href="introduction_docker.html">Installation as a Docker container</a></p>
</li>
<li>
<p><a href="install_azure.html">Installation from Azure Marketplace</a></p>
</li>
<li>
<p><a href="install_aws.html">Installation from AWS Marketplace</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_updates">
<a class="anchor" href="#_updates"></a>3.3. Updates</h3>
<div class="ulist">
<ul>
<li>
<p><a href="update.html">Updates and Upgrades</a></p>
</li>
<li>
<p><a href="update_major.html">Update to version <span class="new">2.2.0</span></a></p>
</li>
<li>
<p><a href="update_matrix.html">Update matrix for version <span class="new">2.2.0</span></a></p>
</li>
<li>
<p><a href="release_upgrade.html">Linux upgrade on the Checkmk server</a></p>
</li>
<li>
<p><a href="cmk_versions.html">Checkmk versions</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_administration_of_checkmk">
<a class="anchor" href="#_administration_of_checkmk"></a>4. Administration of Checkmk</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_server">
<a class="anchor" href="#_server"></a>4.1. Server</h3>
<div class="ulist">
<ul>
<li>
<p><a href="saml.html">Authentication with SAML</a></p>
</li>
<li>
<p><a href="kerberos.html">Single sign-on with Kerberos</a></p>
</li>
<li>
<p><a href="managing_docker.html">Checkmk server in a Docker container</a></p>
</li>
<li>
<p><a href="security.html">Security</a></p>
</li>
<li>
<p><a href="ports.html">Ports</a></p>
</li>
<li>
<p><a href="omd_https.html">Securing the web interface with HTTPS</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_sites">
<a class="anchor" href="#_sites"></a>4.2. Sites</h3>
<div class="ulist">
<ul>
<li>
<p><a href="omd_basics.html">Site administration with omd</a></p>
</li>
<li>
<p><a href="cmk_commandline.html">Checkmk on the command line</a></p>
</li>
<li>
<p><a href="license.html">Managing licenses</a></p>
</li>
<li>
<p><a href="distributed_monitoring.html">Distributed monitoring</a></p>
</li>
<li>
<p><a href="backup.html">Backups</a></p>
</li>
<li>
<p><a href="password_store.html">Password store</a></p>
</li>
<li>
<p><a href="analyze_configuration.html">Analyzing the Checkmk site configuration</a></p>
</li>
<li>
<p><a href="mkps.html">Checkmk extension packages (MKPs)</a></p>
</li>
<li>
<p><a href="mkp_viewables.html">MKPs for GUI extensions</a></p>
</li>
<li>
<p><a href="simulation_mode.html">Simulation mode</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_configuration">
<a class="anchor" href="#_configuration"></a>5. Configuration</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="wato.html">Configuring Checkmk</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_hosts">
<a class="anchor" href="#_hosts"></a>5.1. Hosts</h3>
<div class="ulist">
<ul>
<li>
<p><a href="hosts_setup.html">Host administration</a></p>
</li>
<li>
<p><a href="hosts_structure.html">Host structuring</a></p>
</li>
<li>
<p><a href="host_tags.html">Host tags</a></p>
</li>
<li>
<p><a href="dcd.html">Dynamic host configuration</a></p>
</li>
<li>
<p><a href="hosts_autoregister.html">Automated host creation</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_services">
<a class="anchor" href="#_services"></a>5.2. Services</h3>
<div class="ulist">
<ul>
<li>
<p><a href="wato_services.html">Understanding and configuring services</a></p>
</li>
<li>
<p><a href="clustered_services.html">Monitoring cluster services</a></p>
</li>
<li>
<p><a href="piggyback.html">The piggyback mechanism</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_rules">
<a class="anchor" href="#_rules"></a>5.3. Rules</h3>
<div class="ulist">
<ul>
<li>
<p><a href="wato_rules.html">Rules</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_supporting_configurations">
<a class="anchor" href="#_supporting_configurations"></a>5.4. Supporting configurations</h3>
<div class="ulist">
<ul>
<li>
<p><a href="timeperiods.html">Time periods</a></p>
</li>
<li>
<p><a href="labels.html">Labels</a></p>
</li>
<li>
<p><a href="regexes.html">Regular expressions in Checkmk</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_users_and_permissions">
<a class="anchor" href="#_users_and_permissions"></a>5.5. Users and permissions</h3>
<div class="ulist">
<ul>
<li>
<p><a href="wato_user.html">Users, roles and permissions</a></p>
</li>
<li>
<p><a href="ldap.html">User management with LDAP/Active Directory</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_notifications">
<a class="anchor" href="#_notifications"></a>5.6. Notifications</h3>
<div class="ulist">
<ul>
<li>
<p><a href="notifications.html">Notifications</a></p>
</li>
<li>
<p><a href="notifications_webex.html">Notifications via Cisco Webex Teams</a></p>
</li>
<li>
<p><a href="notifications_ilert.html">Notifications via ilert</a></p>
</li>
<li>
<p><a href="notifications_jira.html">Notifications via Jira</a></p>
</li>
<li>
<p><a href="notifications_mattermost.html">Notifications via Mattermost</a></p>
</li>
<li>
<p><a href="notifications_teams.html">Notifications via Microsoft Teams</a></p>
</li>
<li>
<p><a href="notifications_pagerduty.html">Notifications via PagerDuty</a></p>
</li>
<li>
<p><a href="notifications_pushover.html">Notifications via Pushover</a></p>
</li>
<li>
<p><a href="notifications_opsgenie.html">Notifications via Opsgenie</a></p>
</li>
<li>
<p><a href="notifications_servicenow.html">Notifications via ServiceNow</a></p>
</li>
<li>
<p><a href="notifications_slack.html">Notifications via Slack</a></p>
</li>
<li>
<p><a href="notifications_splunkoncall.html">Notifications via Splunk On-Call</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_events">
<a class="anchor" href="#_events"></a>5.7. Events</h3>
<div class="ulist">
<ul>
<li>
<p><a href="ec.html">The Event Console</a></p>
</li>
<li>
<p><a href="alert_handlers.html">Alert handlers</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_monitoring_systems">
<a class="anchor" href="#_monitoring_systems"></a>6. Monitoring systems</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="wato_monitoringagents.html">Monitoring agents</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_checkmk_agents_and_snmp">
<a class="anchor" href="#_checkmk_agents_and_snmp"></a>6.1. Checkmk agents and SNMP</h3>
<div class="ulist">
<ul>
<li>
<p><a href="agent_deployment.html">Automatic agent updates</a></p>
</li>
<li>
<p><a href="agent_linux.html">Monitoring Linux</a></p>
</li>
<li>
<p><a href="agent_linux_legacy.html">Monitoring Linux in legacy mode</a></p>
</li>
<li>
<p><a href="agent_windows.html">Monitoring Windows</a></p>
</li>
<li>
<p><a href="agent_freebsd.html">Monitoring FreeBSD</a></p>
</li>
<li>
<p><a href="snmp.html">Monitoring via SNMP</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_agent_extensions">
<a class="anchor" href="#_agent_extensions"></a>6.2. Agent extensions</h3>
<div class="ulist">
<ul>
<li>
<p><a href="inventory.html">The HW/SW inventory</a></p>
</li>
<li>
<p><a href="mk_filestats.html">Monitoring files</a></p>
</li>
<li>
<p><a href="monitoring_logfiles.html">Monitoring log files</a></p>
</li>
<li>
<p><a href="monitoring_oracle.html">Monitoring Oracle databases</a></p>
</li>
<li>
<p><a href="monitoring_mysql.html">Monitoring MySQL</a></p>
</li>
<li>
<p><a href="monitoring_mssql.html">Monitoring MSSQL</a></p>
</li>
<li>
<p><a href="monitoring_jobs.html">Monitoring time-based processes (Cronjobs)</a></p>
</li>
<li>
<p><a href="spool_directory.html">The spool directory</a></p>
</li>
<li>
<p><a href="localchecks.html">Local checks</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_vm_cloud_container">
<a class="anchor" href="#_vm_cloud_container"></a>6.3. VM, cloud, container</h3>
<div class="ulist">
<ul>
<li>
<p><a href="datasource_programs.html">Datasource programs</a></p>
</li>
<li>
<p><a href="monitoring_vmware.html">Monitoring VMware ESXi</a></p>
</li>
<li>
<p><a href="monitoring_aws.html">Monitoring Amazon Web Services (AWS)</a></p>
</li>
<li>
<p><a href="monitoring_azure.html">Monitoring Microsoft Azure</a></p>
</li>
<li>
<p><a href="monitoring_gcp.html">Monitoring Google Cloud Platform (GCP)</a></p>
</li>
<li>
<p><a href="monitoring_kubernetes.html">Monitoring Kubernetes</a></p>
</li>
<li>
<p><a href="monitoring_openshift.html">Monitoring OpenShift</a></p>
</li>
<li>
<p><a href="monitoring_docker.html">Monitoring Docker</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_endpoints">
<a class="anchor" href="#_endpoints"></a>6.4. Endpoints</h3>
<div class="ulist">
<ul>
<li>
<p><a href="active_checks.html">Monitoring network services (Active checks)</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_dashboards_views_metrics">
<a class="anchor" href="#_dashboards_views_metrics"></a>7. Dashboards, views, metrics</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="user_interface.html">The user interface</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_general">
<a class="anchor" href="#_general"></a>7.1. General</h3>
<div class="ulist">
<ul>
<li>
<p><a href="views.html">Host and service views</a></p>
</li>
<li>
<p><a href="dashboards.html">Dashboards</a></p>
</li>
<li>
<p><a href="graphing.html">Measured values and graphing</a></p>
</li>
<li>
<p><a href="custom_notes.html">Custom notes</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_commands_in_views">
<a class="anchor" href="#_commands_in_views"></a>7.2. Commands in views</h3>
<div class="ulist">
<ul>
<li>
<p><a href="commands.html">Commands</a></p>
</li>
<li>
<p><a href="basics_ackn.html">Acknowledging problems</a></p>
</li>
<li>
<p><a href="basics_downtimes.html">Scheduled downtimes</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_analysis_and_prognosis">
<a class="anchor" href="#_analysis_and_prognosis"></a>8. Analysis and prognosis</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_analysis">
<a class="anchor" href="#_analysis"></a>8.1. Analysis</h3>
<div class="ulist">
<ul>
<li>
<p><a href="availability.html">Availability</a></p>
</li>
<li>
<p><a href="sla.html">Extended availability (SLAs)</a></p>
</li>
<li>
<p><a href="bi.html">Business Intelligence (BI)</a></p>
</li>
<li>
<p><a href="reporting.html">Reports</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_prognosis">
<a class="anchor" href="#_prognosis"></a>8.2. Prognosis</h3>
<div class="ulist">
<ul>
<li>
<p><a href="predictive_monitoring.html">Predictive monitoring</a></p>
</li>
<li>
<p><a href="forecast_graphs.html">Forecast graphs</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_connection_of_other_applications">
<a class="anchor" href="#_connection_of_other_applications"></a>9. Connection of other applications</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="monitoring_prometheus.html">Integrating Prometheus</a></p>
</li>
<li>
<p><a href="integrating_datadog.html">Integrating Datadog</a></p>
</li>
<li>
<p><a href="nagvis.html">NagVis: status data on maps and diagrams</a></p>
</li>
<li>
<p><a href="ntop.html">Integrating ntopng in Checkmk</a></p>
</li>
<li>
<p><a href="grafana.html">Integrating Checkmk in Grafana</a></p>
</li>
<li>
<p><a href="metrics_exporter.html">Sending metrics to InfluxDB and Graphite</a></p>
</li>
<li>
<p><a href="nagstamon.html">Integrating Checkmk in Nagstamon</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_specifics_to_the_editions">
<a class="anchor" href="#_specifics_to_the_editions"></a>10. Specifics to the editions</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="cse.html">The Standard Edition</a></p>
</li>
<li>
<p><a href="cce.html">The Cloud Edition</a></p>
</li>
<li>
<p><a href="managed.html">The Managed Services Edition</a></p>
</li>
<li>
<p><a href="support_diagnostics.html">Support diagnostics</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_automation_and_development">
<a class="anchor" href="#_automation_and_development"></a>11. Automation and development</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_apis_for_automation">
<a class="anchor" href="#_apis_for_automation"></a>11.1. APIs for automation</h3>
<div class="ulist">
<ul>
<li>
<p><a href="rest_api.html">The Checkmk REST API</a></p>
</li>
<li>
<p><a href="livestatus.html">Retrieving status data via Livestatus</a></p>
</li>
<li>
<p><a href="livestatus_references.html">Livestatus command reference</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_apis_for_development">
<a class="anchor" href="#_apis_for_development"></a>11.2. APIs for development</h3>
<div class="ulist">
<ul>
<li>
<p><a href="bakery_api.html">The Bakery-API</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_development_of_check_plug_ins">
<a class="anchor" href="#_development_of_check_plug_ins"></a>11.3. Development of check plug-ins</h3>
<div class="ulist">
<ul>
<li>
<p><a href="devel_intro.html">Developing extensions for Checkmk</a></p>
</li>
<li>
<p><a href="devel_check_plugins.html">Writing agent-based check plug-ins</a></p>
</li>
<li>
<p><a href="devel_check_plugins_snmp.html">Writing SNMP-based check plug-ins</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_concepts">
<a class="anchor" href="#_concepts"></a>12. Concepts</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="monitoring_basics.html">Basic principles of monitoring with Checkmk</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_the_checkmk_micro_core_cmc">
<a class="anchor" href="#_the_checkmk_micro_core_cmc"></a>12.1. The Checkmk Micro Core (CMC)</h3>
<div class="ulist">
<ul>
<li>
<p><a href="cmc.html">The Checkmk Micro Core (CMC)</a></p>
</li>
<li>
<p><a href="cmc_differences.html">Special characteristics of the CMC</a></p>
</li>
<li>
<p><a href="cmc_migration.html">Migration to the CMC</a></p>
</li>
<li>
<p><a href="cmc_files.html">CMC files and directories</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_checkmk_appliance">
<a class="anchor" href="#_the_checkmk_appliance"></a>13. The Checkmk appliance</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="appliance_rack1_quick_start.html">Quick start guide for Checkmk racks</a></p>
</li>
<li>
<p><a href="appliance_virt1_quick_start.html">Quick start guide for Checkmk virt1</a></p>
</li>
<li>
<p><a href="appliance_install_virt1.html">Installation of the virtual appliance</a></p>
</li>
<li>
<p><a href="appliance_usage.html">Configuring and using the appliance</a></p>
</li>
<li>
<p><a href="appliance_backup.html">Backup in the appliance</a></p>
</li>
<li>
<p><a href="appliance_cluster.html">Appliance in cluster operation</a></p>
</li>
<li>
<p><a href="appliance_rack_config.html">Special features of the hardware appliance</a></p>
</li>
</ul>
</div>
</div>
</div>
</div></div>
<div class="main-nav__utils">
<div class="dropup dropdown__utils">
<button class="btn dropdown-toggle" type="button" id="aboutMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">About Checkmk</button><div class="dropdown-menu dropup" aria-labelledby="aboutMenuButton">
<a class="dropdown-item" href="https://checkmk.com/product/features" target="_blank">Features</a><a class="dropdown-item" href="https://checkmk.com/product/editions" target="_blank">Editions</a><a class="dropdown-item" href="https://checkmk.com/integrations" target="_blank">Integrations</a><a class="dropdown-item" href="https://checkmk.com/imprint" target="_blank">Imprint</a><a class="dropdown-item" href="copyright.html" target="_blank">Copyright</a>
</div>
</div>
<div class="dropup dropdown__utils">
<button class="btn dropdown-toggle" type="button" id="learnMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Learn</button><div class="dropdown-menu dropup" aria-labelledby="learnMenuButton">
<a class="dropdown-item" href="https://checkmk.com/videos">Videos</a><a class="dropdown-item" href="https://checkmk.com/webinars">Webinars</a><a class="dropdown-item" href="https://checkmk.com/trainings/classes">Trainings</a>
</div>
</div>
<a class="main-nav__utils__link" href="https://forum.checkmk.com">Forum</a>
</div>
</div></aside><main><div id="header">
<h1>The spool directory</h1>
<div class="details">
<span id="revdate">Last modified on 06-Nov-2023</span><a class="edit-document" href="https://github.com/Checkmk/checkmk-docs/edit/2.2.0/src/common/en/spool_directory.asciidoc">Edit this page on GitHub</a>
</div>
</div>
<div id="content">
<div id="preamble">
<div id="staticinfo">This page was exported for offline usage on 2025-01-07 22:12:14 +0000. It may not reflect the current state of the Checkmk documentation. To view a daily updated version, visit <a href="https://docs.checkmk.com/" target="_blank">docs.checkmk.com</a>.</div>
<div class="sectionbody"><div class="paragraph">
<p></p>
<div class="dropdown dropdown__related">
<button class="btn btn-primary dropdown-toggle" type="button" id="relatedMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Related Articles</button><div class="dropdown-menu dropdown-menu-right" aria-labelledby="relatedMenuButton">
<a href="wato_monitoringagents.html">Monitoring agents</a>
<a href="agent_linux.html">Monitoring Linux</a>
<a href="agent_windows.html">Monitoring windows</a>
</div>
</div>
</div></div>
</div>
<div class="sect1">
<h2 id="heading__introduction">
<span class="hidden-anchor sr-only" id="_introduction"></span>1. Introduction</h2>
<div class="sectionbody">
<div class="paragraph"><p>The monitoring of tasks that are processed regularly or on demand, as well as permanently running processes, can be done, for example, by analyzing log or status files.
However, this is often associated with additional effort as
it is often necessary to read large volumes of data in order to extract little information.</p></div>
<div class="paragraph"><p>To reduce this effort, Checkmk offers the option for a program to write output directly to a file in Checkmk agent format.
Stored in the so-called <em>spool directory</em>, the agent collects all of these files and integrates their content into the agent output.
The method using the spool directory is useful, for example, for</p></div>
<div class="ulist"><ul>
<li><p>the regular analysis of log files,</p></li>
<li><p>monitoring automatic backups,</p></li>
<li><p>the creation and checking of usage statistics from a database,</p></li>
<li><p>when <a href="monitoring_jobs.html">the <code>mk-job</code> plug-in</a> is not sufficient for the control of cronjobs,</p></li>
<li><p>the <a href="devel_intro.html">development of own checks</a> for testing sample output.</p></li>
</ul></div>
<div class="paragraph"><p>In Checkmk, the spool directory is supported by the agents in the following operating systems: Windows, Linux, AIX, FreeBSD, OpenWrt, and Solaris.</p></div>
<div class="paragraph"><p>To ensure that you can use this feature with no problems, there are a few points to keep in mind.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="heading_paths">
<span class="hidden-anchor sr-only" id="paths"></span>2. File directory paths</h2>
<div class="sectionbody">
<div class="paragraph"><p>The default file path to the spool directory is <code>/var/lib/check_mk_agent/spool/</code> on Linux and other Unix systems, and <code>C:\ProgramData\checkmk\agent\spool\</code> on Windows.
For Linux and Unix you can customize the parent directory path with the <span class="guihint">Agent rules &gt; Installation paths for agent files (Linux, UNIX)</span> rule and the <span class="guihint">Base directory for variable data (caches, state files)</span> option available there.</p></div>
<div class="paragraph"><p>If you are working on a host in monitoring, you can filter out the spool directory configured there from the agent output:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">user@host:~$ </span>check_mk_agent<span class="tok-w"> </span><span class="tok-p">|</span><span class="tok-w"> </span>grep<span class="tok-w"> </span>SpoolDirectory
<span class="tok-go">SpoolDirectory: /var/lib/check_mk_agent/spool</span></code></pre></div></div>
<div class="paragraph"><p>Checkmk uses a single spool directory, which by default is owned by <code>root</code>.
Multiple directories with different owners are not provided.
However, you can of course create (initially empty) files in the spool directory and make another user the owner, who can then overwrite the contents of his file.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="heading_contents">
<span class="hidden-anchor sr-only" id="contents"></span>3. File names and contents</h2>
<div class="sectionbody">
<div class="paragraph"><p>Spool files can contain text output in any of the formats processed by Checkmk.
The files are appended to each other in the order present in the spool directory.
The file extension used does not matter.</p></div>
<div class="paragraph"><p>If you want to use a numeric scheme for sorting, prefix the filename with an underscore (<code>_</code>), since filenames starting with numbers serve as <a href="#agecheck">age check</a>.
Files starting with a dot are ignored.</p></div>
<div class="paragraph"><p>To avoid confusion in the concatenated file contents, each spool file should</p></div>
<div class="ulist"><ul>
<li><p>start with a section header, i.e. a line enclosed in <code>&lt;&lt;&lt;</code> and <code>&gt;&gt;&gt;</code>â€‰â€”â€‰even if only the <a href="glossar.html#local_check">local checks</a> format is used in the file,</p></li>
<li><p>be terminated with a newline.</p></li>
</ul></div>
<div class="paragraph"><p>Thus, a local check that provides a service immediately may look like this:</p></div>
<div class="listingblock">
<div class="title">/var/lib/check_mk_agent/spool/spooldummy.txt</div>
<div class="content"><pre class="pygments highlight"><code><span></span>&lt;&lt;&lt;local&gt;&gt;&gt;
0 "Spool Test Dummy" - This static service is always OK</code></pre></div>
</div>
<div class="paragraph"><p>Similarly, you can drop outputs that require a <a href="glossar.html#check_plugin">check plug-in</a> on the Checkmk side:</p></div>
<div class="listingblock">
<div class="title">/var/lib/check_mk_agent/spool/poolplugin.txt</div>
<div class="content"><pre class="pygments highlight"><code><span></span>&lt;&lt;&lt;waterlevels&gt;&gt;&gt;
rainbarrel 376
pond 15212
pool 123732</code></pre></div>
</div>
<div class="sect2">
<h3 id="heading_piggyback">
<span class="hidden-anchor sr-only" id="piggyback"></span>3.1. Piggyback section termination</h3>
<div class="paragraph"><p>If you use <a href="glossar.html#piggyback">piggyback</a> sections in a file, terminate this file with the line <code>&lt;&lt;&lt;&lt;&gt;&gt;&gt;&gt;</code>.
This is the only way to ensure that if the readout order changes, the output following the piggyback output is reassigned to the host itself.</p></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="heading_agecheck">
<span class="hidden-anchor sr-only" id="agecheck"></span>4. Age check of files</h2>
<div class="sectionbody">
<div class="paragraph"><p>If a program can write correctly to its output file, everything is greatâ€‰â€”â€‰regardless of whether it has processed successfully or not.
But what if a program aborts before writing to a disk, or a file system error prevents new files from being written?</p></div>
<div class="paragraph"><p>For this situation you have the option to prefix the file name with an integer, for example <code>600MyCronjob</code>.
In this case the number will be interpreted as the maximum age of the file in seconds.
If the file is older, it will be ignored by the agent and the associated service in Checkmk will change to the <span class="state3">UNKNOWN</span> state because of the missing output.
In the example of a file named <code>3900_hourly_cleaner.txt</code>, the number is thus appropriately chosen for a cronjob running every hour, for which an execution time of less than five minutes is expected.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="heading_example">
<span class="hidden-anchor sr-only" id="example"></span>5. A practical example</h2>
<div class="sectionbody">
<div class="paragraph"><p>Letâ€™s assume you run a service where users log in and log out.
In the log files for the service, you will find lines of the following three types:</p></div>
<div class="listingblock">
<div class="title">/var/log/dummyapp.log</div>
<div class="content"><pre class="pygments highlight"><code><span></span>21/Oct/2022:12:42:09 User harrihirsch logged in from 12.34.56.78
21/Oct/2022:12:42:23 User zoezhang logged out after 10 min idle
21/Oct/2022:13:00:00 Current user count: 739</code></pre></div>
</div>
<div class="paragraph"><p>The process does not write the line with <code>Current user count</code> after each login/logout, but at fixed intervals.
If the number of lines in the log file is low enough to read quickly, you can program a <a href="localchecks.html">local check</a>.
This check reads the whole log file line by line each time and always sets the user count to the displayed value on occurrences of the line <code>Current user count</code>.
On occurrences of the lines <code>logged in</code> and <code>logged out</code> it increases or decreases the user count.
At the end, your check prints a line similar to the following:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-go">1 "Frobolator User Count" count=1023 Watch out! Limit nearly used up.</span></code></pre></div></div>
<div class="paragraph"><p>As your service becomes more popular, the local check runs for longer and longer, until at some point this solution, and even running it as an <a href="agent_linux.html#async_plugins">asynchronous agent plug-in</a> is no longer practical.
This is where proper use of the spool directory can dramatically increase the efficiency of check execution.
In the next few paragraphs, we will show you how to modify the program that has been providing your local check so that it makes effective use of the spool directory.</p></div>
<div class="paragraph"><p>First, the program should not terminate itself when it reaches the end of the file, but write a spool file that contains the currently determined state of the service when the log file is fully evaluated:</p></div>
<div class="listingblock">
<div class="title">/var/lib/check_mk_agent/spool/1800_frobolator.txt</div>
<div class="content"><pre class="pygments highlight"><code><span></span>&lt;&lt;&lt;local&gt;&gt;&gt;
2 "Frobolator User Count" count=1200 Maximum number of users reached!</code></pre></div>
</div>
<div class="paragraph"><p>Then let your program wait for a certain period of timeâ€‰â€”â€‰whether a few seconds or several minutes should depend on the frequency of newly added log entries.
It should then evaluate only the newly added lines and recalculate the state.
If the numbers have changed, it will rewrite the spool file.</p></div>
<div class="paragraph"><p>You program this procedure as an endless loop.
To detect a possible crash of this program, you should name the spool file accordingly, for example <code>1800_frobolator.txt</code>â€‰â€”â€‰if 30 minutes without updating the spool file indicates problems with the service or the evaluating program.</p></div>
<div class="paragraph"><p>Instead of the agentâ€™s plugin directory, now start the program as a <em>daemon</em> using your operating systemâ€™s options.
Pay attention here to automatic restart, if the program crashes or is terminated.
Many server applications also provide the option to pipe log output to another program instead of or in addition to writing normal log files.
Using this mechanism for an evaluation script that writes spool files is also a good idea.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="heading_pitfalls">
<span class="hidden-anchor sr-only" id="pitfalls"></span>6. Some fine points to consider</h2>
<div class="sectionbody">
<div class="paragraph"><p>Reading files may have other pitfalls compared to the regular starting of processes by the agent.
Consider the following points for a trouble-free operation.</p></div>
<div class="sect2">
<h3 id="heading_charset">
<span class="hidden-anchor sr-only" id="charset"></span>6.1. Character set</h3>
<div class="paragraph"><p>Checkmk expects the agent output to be exclusively <a href="https://en.wikipedia.org/wiki/UTF-8" target="_blank">UTF-8</a> encoded (without <a href="https://en.wikipedia.org/wiki/Byte_order_mark#UTF-8" target="_blank">Byte Order Mark / BOM</a>) with a simple newline (<code>0x0A</code> or <code>\n</code>) as line break.
Deviations can, in the worst case, result in agent output that cannot be read beyond the first character of an incorrectly-formatted spool file.
Specifically, this means:</p></div>
<div class="ulist"><ul>
<li><p>Especially on <em>older</em> Windows and Linux systems, make sure that spool files are <em>not</em> written in the <a href="https://en.wikipedia.org/wiki/Windows-1250" target="_blank">Windows 1250 to 1258</a> or <a href="https://en.wikipedia.org/wiki/ISO/IEC_8859" target="_blank">ISO 8859</a> encoding.
If this is unavoidable, make sure that only the intersection to UTF-8â€‰â€”â€‰de facto <a href="https://en.wikipedia.org/wiki/ASCII" target="_blank">7-bit ASCII</a>â€‰â€”â€‰is used.</p></li>
<li><p>Especially on <em>newer</em> Windows systems, make sure that spool files are <em>not</em> written in the <a href="https://en.wikipedia.org/wiki/UTF-16" target="_blank">UTF-16</a> encoding used as standard there.</p></li>
<li><p>Do not use <a href="https://en.wikipedia.org/wiki/Byte_order_mark" target="_blank">BOM</a>.
In particular, scripting languages on Windows often automatically write this character sequence, which indicates the encoding used, to output files.
In agent output, it prevents <code>&lt;&lt;&lt;</code> from appearing at the beginning of a line.</p></li>
<li><p>Use the Unix line break newline (<code>0x0A</code> or <code>\n</code>).
Again, Windows often uses the string <code>CRLF</code> (<code>0x0D 0x0A</code> or <code>\r\n</code>).</p></li>
</ul></div>
<div class="paragraph"><p>If a spool file causes undesirable behavior, examine its first lines with a <a href="https://en.wikipedia.org/wiki/Hex_editor" target="_blank">hex editor</a>:</p></div>
<div class="ulist"><ul>
<li><p><code>0xFF 0xFE</code> indicates a UTF-16 encoded file:
In this case, change your scripts to output in UTF-8.</p></li>
<li><p><code>0xEF 0xBB 0xBF</code> displays UTF-8 with BOM.
Here it is usually sufficient to write the file without BOM in the future.</p></li>
</ul></div>
</div>
<div class="sect2">
<h3 id="heading_softlinks">
<span class="hidden-anchor sr-only" id="softlinks"></span>6.2. Soft links and named pipes</h3>
<div class="paragraph"><p>In principle, files in the spool directory can also be soft links or named pipes.
It should be noted that the age check via file names does not work here because the age of the soft link or the named pipe itself is evaluated and not the age of the written data.
For named pipes, you must also ensure that the process writing to the pipe always supplies data.
If no data is supplied, the Checkmk agent will wait forever and eventually timeout.</p></div>
<div class="paragraph"><p>If you need to allow unprivileged users to write to spool files, create empty files for these users and set their ownership accordingly.
These users can then set a soft link on their own or write directly to the spool file.</p></div>
</div>
<div class="sect2">
<h3 id="heading_locking">
<span class="hidden-anchor sr-only" id="locking"></span>6.3. Locking and buffering</h3>
<div class="paragraph"><p>When writing longer programs that write multiple status lines to a spool file, it is tempting to open the output file writing when the program starts.
However, in this case the file will remain completely empty until the write buffer is first emptied and written to the destination, and it will be incomplete until the writing program has closed the file.
Similar applies, if a file is locked exclusively for the duration of a long write operation.</p></div>
<div class="paragraph"><p>For this reason, you should either write to the output file only when the entire contents to be written are available, or write to a temporary file which you then copy to the spool directoryâ€‰â€”â€‰or respectively, use <code>cat</code> to transfer the contents of a temporary file to an existing one in the spool directory.</p></div>
</div>
<div class="sect2">
<h3 id="heading_losingcontrol">
<span class="hidden-anchor sr-only" id="losingcontrol"></span>6.4. Keeping an overview</h3>
<div class="paragraph"><p>Another problem can occur when different programs try to write to files with the same name.
With many spool files, it is easy to lose track of which program actually writes to which spool file.
In particular, if an incorrectly formatted spool file results in part of the agent output becoming unusable, this is very annoying and can result in a time-consuming search.</p></div>
<div class="paragraph"><p>You can keep things tidy here by creating a file of the same nameâ€‰â€”â€‰prefixed by a dotâ€‰â€”â€‰for each spool file, which contains information about the job and a contact person, if applicable.
The contents of this hidden file are not transferred with it.</p></div>
</div>
</div>
</div>
</div></main><div id="toc" class="toc2">
<div id="toctitle">On this page</div>
<ul class="sectlevel1">
<li><a href="#_introduction">1. Introduction</a></li>
<li><a href="#paths">2. File directory paths</a></li>
<li>
<a href="#contents">3. File names and contents</a><ul class="sectlevel1"><li><a href="#piggyback">3.1. Piggyback section termination</a></li></ul>
</li>
<li><a href="#agecheck">4. Age check of files</a></li>
<li><a href="#example">5. A practical example</a></li>
<li>
<a href="#pitfalls">6. Some fine points to consider</a><ul class="sectlevel1">
<li><a href="#charset">6.1. Character set</a></li>
<li><a href="#softlinks">6.2. Soft links and named pipes</a></li>
<li><a href="#locking">6.3. Locking and buffering</a></li>
<li><a href="#losingcontrol">6.4. Keeping an overview</a></li>
</ul>
</li>
</ul>
</div>
<script src="../../assets/js/manifest.js?id=7db827d654313dce4250"></script>
<script src="../../assets/js/vendor.js?id=581a3d4a61b7156d04df"></script>
<script src="../../assets/js/app.js?id=959ccd04b1f8b7b78c5e"></script>
<script src="../../assets/js/lunr.js"></script>
<script src="../../assets/js/lunr.stemmer.support.js"></script>
<script src="../lunr.index.en.js"></script>
<script src="../../assets/js/lunr.client.js"></script>
</body>
</html>
