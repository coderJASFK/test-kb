<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]--><meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<link rel="icon" href="/favicon.png">
<meta name="robots" content="noindex">
<meta name="description" content="In this article you will learn what to consider when updating from Checkmk version 2.1.0 to 2.2.0.">
<meta name="og:locale" content="en">
<meta name="og:site_name" content="Checkmk Docs">
<meta name="og:title" content="Update to version 2.2.0">
<meta name="og:description" content="In this article you will learn what to consider when updating from Checkmk version 2.1.0 to 2.2.0.">
<meta name="og:image" content="https://docs.checkmk.com/assets/images/share_image.png">
<meta name="twitter:site" content="@checkmk">
<meta name="twitter:creator" content="@checkmk">
<title>Update to version 2.2.0</title>
<link rel="stylesheet" href="../../assets/css/checkmk.css?id=4473d2acbb1ea6136428">
<link rel="stylesheet" href="../../assets/css/pygments-monokai.css">
<link rel="stylesheet" href="../../assets/css/addons.css">
<link rel="stylesheet" href="../../assets/css/SourceCodePro.css">
<link rel="search" href="./opensearch.xml" type="application/opensearchdescription+xml" title="Search docs.checkmk.com">
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-NJ3VGL8');</script>
<!-- End Google Tag Manager --><style>
#staticinfo { font-style: italic; }
</style>
</head>
<body class="article toc2 toc-right">
<!-- Cookie Consent (GDPR Compliance) -->

<!-- End Cookie Consent (GDPR Compliance) -->
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NJ3VGL8" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) --><div class="header-top">
<div class="header-top__left">
<a class="header-top__logo d-none d-xl-inline-block" href="/2.2.0/en"><img src="../../assets/images/docs_logo.png" alt="Checkmk"></a><a class="header-top__icon d-inline-block d-xl-none" href="/2.2.0/en"><img src="../../assets/images/logo_icon.svg" alt="Checkmk"></a>
</div>
<div class="header-top__center">
<input type="text" class="header-top__search" placeholder="Search the checkmk docs"><div class="header-top__search__results"></div>
</div>
<div class="header-top__right d-block">
<button class="header-top__search__toggle d-inline-block d-md-none"><img class="header-top__search__toggle__icon" src="../../assets/images/search.svg" alt="Search"></button><div class="dropdown dropdown__language">
                    <button class="btn dropdown-toggle" type="button" id="languageMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">en</button>
                    <div class="dropdown-menu  dropdown-menu-right" aria-labelledby="languageMenuButton"><a class="dropdown-item" href="../../2.2.0/de/update_major.html">Deutsch</a></div>
</div>
<div class="dropdown dropdown__branch">
                        <button class="btn dropdown-toggle" type="button" id="branchMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">2.2.0</button>
                        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="branchMenuButton">
<a class="dropdown-item" href="../../2.1.0/en/update_major.html">2.1.0</a><a class="dropdown-item" href="../../latest/en/update_major.html">latest (2.3.0)</a>
</div>
</div>
<a class="header-top__back d-none d-lg-inline-block" href="https://checkmk.com">to checkmk.com</a><button class="header-top__toggle d-inline-block d-lg-none"><span class="header-top__toggle__icon"></span></button>
</div>
</div>
<aside><div class="main-nav">
<div class="main-nav__content"><div id="content">
<div class="sect1">
<h2 id="_welcome_to_checkmk">
<a class="anchor" href="#_welcome_to_checkmk"></a>1. Welcome to Checkmk</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="welcome.html">Welcome to the Checkmk User Guide</a></p>
</li>
<li>
<p><a href="release_notes.html">Release notes</a></p>
</li>
<li>
<p><a href="glossar.html">Glossary</a></p>
</li>
<li>
<p><a href="search.html">Searching docs.checkmk.com</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_beginners_guide">
<a class="anchor" href="#_beginners_guide"></a>2. Beginner’s Guide</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="intro_setup.html">Setting up Checkmk</a></p>
</li>
<li>
<p><a href="intro_gui.html">The Checkmk user interface</a></p>
</li>
<li>
<p><a href="intro_setup_monitor.html">Setting up monitoring</a></p>
</li>
<li>
<p><a href="intro_tools.html">The monitoring tools</a></p>
</li>
<li>
<p><a href="intro_monitor.html">Checkmk in monitoring</a></p>
</li>
<li>
<p><a href="intro_finetune.html">Fine-tuning the monitoring</a></p>
</li>
<li>
<p><a href="intro_users.html">Working with multiple users</a></p>
</li>
<li>
<p><a href="intro_notifications.html">Switching on notifications</a></p>
</li>
<li>
<p><a href="intro_extend.html">Extending the monitoring system further</a></p>
</li>
<li>
<p><a href="intro_bestpractise.html">Best practices, tips &amp; tricks</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_installation">
<a class="anchor" href="#_installation"></a>3. Installation</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="install_packages.html">Basic information on the installation of Checkmk</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_server_and_vms">
<a class="anchor" href="#_server_and_vms"></a>3.1. Server and VMs</h3>
<div class="ulist">
<ul>
<li>
<p><a href="install_packages_debian.html">Installation on Debian and Ubuntu</a></p>
</li>
<li>
<p><a href="install_packages_redhat.html">Installation on Red Hat and derivatives</a></p>
</li>
<li>
<p><a href="install_packages_sles.html">Installation on SUSE Linux Enterprise Server</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_appliance_container_cloud">
<a class="anchor" href="#_appliance_container_cloud"></a>3.2. Appliance, container, cloud</h3>
<div class="ulist">
<ul>
<li>
<p><a href="install_appliance_cmk.html">Installation of Checkmk in the appliance</a></p>
</li>
<li>
<p><a href="introduction_docker.html">Installation as a Docker container</a></p>
</li>
<li>
<p><a href="install_azure.html">Installation from Azure Marketplace</a></p>
</li>
<li>
<p><a href="install_aws.html">Installation from AWS Marketplace</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_updates">
<a class="anchor" href="#_updates"></a>3.3. Updates</h3>
<div class="ulist">
<ul>
<li>
<p><a href="update.html">Updates and Upgrades</a></p>
</li>
<li>
<p><a href="update_major.html">Update to version <span class="new">2.2.0</span></a></p>
</li>
<li>
<p><a href="update_matrix.html">Update matrix for version <span class="new">2.2.0</span></a></p>
</li>
<li>
<p><a href="release_upgrade.html">Linux upgrade on the Checkmk server</a></p>
</li>
<li>
<p><a href="cmk_versions.html">Checkmk versions</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_administration_of_checkmk">
<a class="anchor" href="#_administration_of_checkmk"></a>4. Administration of Checkmk</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_server">
<a class="anchor" href="#_server"></a>4.1. Server</h3>
<div class="ulist">
<ul>
<li>
<p><a href="saml.html">Authentication with SAML</a></p>
</li>
<li>
<p><a href="kerberos.html">Single sign-on with Kerberos</a></p>
</li>
<li>
<p><a href="managing_docker.html">Checkmk server in a Docker container</a></p>
</li>
<li>
<p><a href="security.html">Security</a></p>
</li>
<li>
<p><a href="ports.html">Ports</a></p>
</li>
<li>
<p><a href="omd_https.html">Securing the web interface with HTTPS</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_sites">
<a class="anchor" href="#_sites"></a>4.2. Sites</h3>
<div class="ulist">
<ul>
<li>
<p><a href="omd_basics.html">Site administration with omd</a></p>
</li>
<li>
<p><a href="cmk_commandline.html">Checkmk on the command line</a></p>
</li>
<li>
<p><a href="license.html">Managing licenses</a></p>
</li>
<li>
<p><a href="distributed_monitoring.html">Distributed monitoring</a></p>
</li>
<li>
<p><a href="backup.html">Backups</a></p>
</li>
<li>
<p><a href="password_store.html">Password store</a></p>
</li>
<li>
<p><a href="analyze_configuration.html">Analyzing the Checkmk site configuration</a></p>
</li>
<li>
<p><a href="mkps.html">Checkmk extension packages (MKPs)</a></p>
</li>
<li>
<p><a href="mkp_viewables.html">MKPs for GUI extensions</a></p>
</li>
<li>
<p><a href="simulation_mode.html">Simulation mode</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_configuration">
<a class="anchor" href="#_configuration"></a>5. Configuration</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="wato.html">Configuring Checkmk</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_hosts">
<a class="anchor" href="#_hosts"></a>5.1. Hosts</h3>
<div class="ulist">
<ul>
<li>
<p><a href="hosts_setup.html">Host administration</a></p>
</li>
<li>
<p><a href="hosts_structure.html">Host structuring</a></p>
</li>
<li>
<p><a href="host_tags.html">Host tags</a></p>
</li>
<li>
<p><a href="dcd.html">Dynamic host configuration</a></p>
</li>
<li>
<p><a href="hosts_autoregister.html">Automated host creation</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_services">
<a class="anchor" href="#_services"></a>5.2. Services</h3>
<div class="ulist">
<ul>
<li>
<p><a href="wato_services.html">Understanding and configuring services</a></p>
</li>
<li>
<p><a href="clustered_services.html">Monitoring cluster services</a></p>
</li>
<li>
<p><a href="piggyback.html">The piggyback mechanism</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_rules">
<a class="anchor" href="#_rules"></a>5.3. Rules</h3>
<div class="ulist">
<ul>
<li>
<p><a href="wato_rules.html">Rules</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_supporting_configurations">
<a class="anchor" href="#_supporting_configurations"></a>5.4. Supporting configurations</h3>
<div class="ulist">
<ul>
<li>
<p><a href="timeperiods.html">Time periods</a></p>
</li>
<li>
<p><a href="labels.html">Labels</a></p>
</li>
<li>
<p><a href="regexes.html">Regular expressions in Checkmk</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_users_and_permissions">
<a class="anchor" href="#_users_and_permissions"></a>5.5. Users and permissions</h3>
<div class="ulist">
<ul>
<li>
<p><a href="wato_user.html">Users, roles and permissions</a></p>
</li>
<li>
<p><a href="ldap.html">User management with LDAP/Active Directory</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_notifications">
<a class="anchor" href="#_notifications"></a>5.6. Notifications</h3>
<div class="ulist">
<ul>
<li>
<p><a href="notifications.html">Notifications</a></p>
</li>
<li>
<p><a href="notifications_webex.html">Notifications via Cisco Webex Teams</a></p>
</li>
<li>
<p><a href="notifications_ilert.html">Notifications via ilert</a></p>
</li>
<li>
<p><a href="notifications_jira.html">Notifications via Jira</a></p>
</li>
<li>
<p><a href="notifications_mattermost.html">Notifications via Mattermost</a></p>
</li>
<li>
<p><a href="notifications_teams.html">Notifications via Microsoft Teams</a></p>
</li>
<li>
<p><a href="notifications_pagerduty.html">Notifications via PagerDuty</a></p>
</li>
<li>
<p><a href="notifications_pushover.html">Notifications via Pushover</a></p>
</li>
<li>
<p><a href="notifications_opsgenie.html">Notifications via Opsgenie</a></p>
</li>
<li>
<p><a href="notifications_servicenow.html">Notifications via ServiceNow</a></p>
</li>
<li>
<p><a href="notifications_slack.html">Notifications via Slack</a></p>
</li>
<li>
<p><a href="notifications_splunkoncall.html">Notifications via Splunk On-Call</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_events">
<a class="anchor" href="#_events"></a>5.7. Events</h3>
<div class="ulist">
<ul>
<li>
<p><a href="ec.html">The Event Console</a></p>
</li>
<li>
<p><a href="alert_handlers.html">Alert handlers</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_monitoring_systems">
<a class="anchor" href="#_monitoring_systems"></a>6. Monitoring systems</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="wato_monitoringagents.html">Monitoring agents</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_checkmk_agents_and_snmp">
<a class="anchor" href="#_checkmk_agents_and_snmp"></a>6.1. Checkmk agents and SNMP</h3>
<div class="ulist">
<ul>
<li>
<p><a href="agent_deployment.html">Automatic agent updates</a></p>
</li>
<li>
<p><a href="agent_linux.html">Monitoring Linux</a></p>
</li>
<li>
<p><a href="agent_linux_legacy.html">Monitoring Linux in legacy mode</a></p>
</li>
<li>
<p><a href="agent_windows.html">Monitoring Windows</a></p>
</li>
<li>
<p><a href="agent_freebsd.html">Monitoring FreeBSD</a></p>
</li>
<li>
<p><a href="snmp.html">Monitoring via SNMP</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_agent_extensions">
<a class="anchor" href="#_agent_extensions"></a>6.2. Agent extensions</h3>
<div class="ulist">
<ul>
<li>
<p><a href="inventory.html">The HW/SW inventory</a></p>
</li>
<li>
<p><a href="mk_filestats.html">Monitoring files</a></p>
</li>
<li>
<p><a href="monitoring_logfiles.html">Monitoring log files</a></p>
</li>
<li>
<p><a href="monitoring_oracle.html">Monitoring Oracle databases</a></p>
</li>
<li>
<p><a href="monitoring_mysql.html">Monitoring MySQL</a></p>
</li>
<li>
<p><a href="monitoring_mssql.html">Monitoring MSSQL</a></p>
</li>
<li>
<p><a href="monitoring_jobs.html">Monitoring time-based processes (Cronjobs)</a></p>
</li>
<li>
<p><a href="spool_directory.html">The spool directory</a></p>
</li>
<li>
<p><a href="localchecks.html">Local checks</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_vm_cloud_container">
<a class="anchor" href="#_vm_cloud_container"></a>6.3. VM, cloud, container</h3>
<div class="ulist">
<ul>
<li>
<p><a href="datasource_programs.html">Datasource programs</a></p>
</li>
<li>
<p><a href="monitoring_vmware.html">Monitoring VMware ESXi</a></p>
</li>
<li>
<p><a href="monitoring_aws.html">Monitoring Amazon Web Services (AWS)</a></p>
</li>
<li>
<p><a href="monitoring_azure.html">Monitoring Microsoft Azure</a></p>
</li>
<li>
<p><a href="monitoring_gcp.html">Monitoring Google Cloud Platform (GCP)</a></p>
</li>
<li>
<p><a href="monitoring_kubernetes.html">Monitoring Kubernetes</a></p>
</li>
<li>
<p><a href="monitoring_openshift.html">Monitoring OpenShift</a></p>
</li>
<li>
<p><a href="monitoring_docker.html">Monitoring Docker</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_endpoints">
<a class="anchor" href="#_endpoints"></a>6.4. Endpoints</h3>
<div class="ulist">
<ul>
<li>
<p><a href="active_checks.html">Monitoring network services (Active checks)</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_dashboards_views_metrics">
<a class="anchor" href="#_dashboards_views_metrics"></a>7. Dashboards, views, metrics</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="user_interface.html">The user interface</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_general">
<a class="anchor" href="#_general"></a>7.1. General</h3>
<div class="ulist">
<ul>
<li>
<p><a href="views.html">Host and service views</a></p>
</li>
<li>
<p><a href="dashboards.html">Dashboards</a></p>
</li>
<li>
<p><a href="graphing.html">Measured values and graphing</a></p>
</li>
<li>
<p><a href="custom_notes.html">Custom notes</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_commands_in_views">
<a class="anchor" href="#_commands_in_views"></a>7.2. Commands in views</h3>
<div class="ulist">
<ul>
<li>
<p><a href="commands.html">Commands</a></p>
</li>
<li>
<p><a href="basics_ackn.html">Acknowledging problems</a></p>
</li>
<li>
<p><a href="basics_downtimes.html">Scheduled downtimes</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_analysis_and_prognosis">
<a class="anchor" href="#_analysis_and_prognosis"></a>8. Analysis and prognosis</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_analysis">
<a class="anchor" href="#_analysis"></a>8.1. Analysis</h3>
<div class="ulist">
<ul>
<li>
<p><a href="availability.html">Availability</a></p>
</li>
<li>
<p><a href="sla.html">Extended availability (SLAs)</a></p>
</li>
<li>
<p><a href="bi.html">Business Intelligence (BI)</a></p>
</li>
<li>
<p><a href="reporting.html">Reports</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_prognosis">
<a class="anchor" href="#_prognosis"></a>8.2. Prognosis</h3>
<div class="ulist">
<ul>
<li>
<p><a href="predictive_monitoring.html">Predictive monitoring</a></p>
</li>
<li>
<p><a href="forecast_graphs.html">Forecast graphs</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_connection_of_other_applications">
<a class="anchor" href="#_connection_of_other_applications"></a>9. Connection of other applications</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="monitoring_prometheus.html">Integrating Prometheus</a></p>
</li>
<li>
<p><a href="integrating_datadog.html">Integrating Datadog</a></p>
</li>
<li>
<p><a href="nagvis.html">NagVis: status data on maps and diagrams</a></p>
</li>
<li>
<p><a href="ntop.html">Integrating ntopng in Checkmk</a></p>
</li>
<li>
<p><a href="grafana.html">Integrating Checkmk in Grafana</a></p>
</li>
<li>
<p><a href="metrics_exporter.html">Sending metrics to InfluxDB and Graphite</a></p>
</li>
<li>
<p><a href="nagstamon.html">Integrating Checkmk in Nagstamon</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_specifics_to_the_editions">
<a class="anchor" href="#_specifics_to_the_editions"></a>10. Specifics to the editions</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="cse.html">The Standard Edition</a></p>
</li>
<li>
<p><a href="cce.html">The Cloud Edition</a></p>
</li>
<li>
<p><a href="managed.html">The Managed Services Edition</a></p>
</li>
<li>
<p><a href="support_diagnostics.html">Support diagnostics</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_automation_and_development">
<a class="anchor" href="#_automation_and_development"></a>11. Automation and development</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_apis_for_automation">
<a class="anchor" href="#_apis_for_automation"></a>11.1. APIs for automation</h3>
<div class="ulist">
<ul>
<li>
<p><a href="rest_api.html">The Checkmk REST API</a></p>
</li>
<li>
<p><a href="livestatus.html">Retrieving status data via Livestatus</a></p>
</li>
<li>
<p><a href="livestatus_references.html">Livestatus command reference</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_apis_for_development">
<a class="anchor" href="#_apis_for_development"></a>11.2. APIs for development</h3>
<div class="ulist">
<ul>
<li>
<p><a href="bakery_api.html">The Bakery-API</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_development_of_check_plug_ins">
<a class="anchor" href="#_development_of_check_plug_ins"></a>11.3. Development of check plug-ins</h3>
<div class="ulist">
<ul>
<li>
<p><a href="devel_intro.html">Developing extensions for Checkmk</a></p>
</li>
<li>
<p><a href="devel_check_plugins.html">Writing agent-based check plug-ins</a></p>
</li>
<li>
<p><a href="devel_check_plugins_snmp.html">Writing SNMP-based check plug-ins</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_concepts">
<a class="anchor" href="#_concepts"></a>12. Concepts</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="monitoring_basics.html">Basic principles of monitoring with Checkmk</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_the_checkmk_micro_core_cmc">
<a class="anchor" href="#_the_checkmk_micro_core_cmc"></a>12.1. The Checkmk Micro Core (CMC)</h3>
<div class="ulist">
<ul>
<li>
<p><a href="cmc.html">The Checkmk Micro Core (CMC)</a></p>
</li>
<li>
<p><a href="cmc_differences.html">Special characteristics of the CMC</a></p>
</li>
<li>
<p><a href="cmc_migration.html">Migration to the CMC</a></p>
</li>
<li>
<p><a href="cmc_files.html">CMC files and directories</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_checkmk_appliance">
<a class="anchor" href="#_the_checkmk_appliance"></a>13. The Checkmk appliance</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="appliance_rack1_quick_start.html">Quick start guide for Checkmk racks</a></p>
</li>
<li>
<p><a href="appliance_virt1_quick_start.html">Quick start guide for Checkmk virt1</a></p>
</li>
<li>
<p><a href="appliance_install_virt1.html">Installation of the virtual appliance</a></p>
</li>
<li>
<p><a href="appliance_usage.html">Configuring and using the appliance</a></p>
</li>
<li>
<p><a href="appliance_backup.html">Backup in the appliance</a></p>
</li>
<li>
<p><a href="appliance_cluster.html">Appliance in cluster operation</a></p>
</li>
<li>
<p><a href="appliance_rack_config.html">Special features of the hardware appliance</a></p>
</li>
</ul>
</div>
</div>
</div>
</div></div>
<div class="main-nav__utils">
<div class="dropup dropdown__utils">
<button class="btn dropdown-toggle" type="button" id="aboutMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">About Checkmk</button><div class="dropdown-menu dropup" aria-labelledby="aboutMenuButton">
<a class="dropdown-item" href="https://checkmk.com/product/features" target="_blank">Features</a><a class="dropdown-item" href="https://checkmk.com/product/editions" target="_blank">Editions</a><a class="dropdown-item" href="https://checkmk.com/integrations" target="_blank">Integrations</a><a class="dropdown-item" href="https://checkmk.com/imprint" target="_blank">Imprint</a><a class="dropdown-item" href="copyright.html" target="_blank">Copyright</a>
</div>
</div>
<div class="dropup dropdown__utils">
<button class="btn dropdown-toggle" type="button" id="learnMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Learn</button><div class="dropdown-menu dropup" aria-labelledby="learnMenuButton">
<a class="dropdown-item" href="https://checkmk.com/videos">Videos</a><a class="dropdown-item" href="https://checkmk.com/webinars">Webinars</a><a class="dropdown-item" href="https://checkmk.com/trainings/classes">Trainings</a>
</div>
</div>
<a class="main-nav__utils__link" href="https://forum.checkmk.com">Forum</a>
</div>
</div></aside><main><div id="header">
<h1>Update to version 2.2.0</h1>
<div class="details">
<span id="revdate">Last modified on 22-Feb-2024</span><a class="edit-document" href="https://github.com/Checkmk/checkmk-docs/edit/2.2.0/src/onprem/en/update_major.asciidoc">Edit this page on GitHub</a>
</div>
</div>
<div id="content">
<div id="preamble">
<div id="staticinfo">This page was exported for offline usage on 2025-01-07 22:12:14 +0000. It may not reflect the current state of the Checkmk documentation. To view a daily updated version, visit <a href="https://docs.checkmk.com/" target="_blank">docs.checkmk.com</a>.</div>
<div class="sectionbody"><div class="paragraph">
<p></p>
<div class="dropdown dropdown__related">
<button class="btn btn-primary dropdown-toggle" type="button" id="relatedMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Related Articles</button><div class="dropdown-menu dropdown-menu-right" aria-labelledby="relatedMenuButton">
<a href="update.html">Updates and Upgrades</a>
<a href="install_packages.html">Basic information on the installation of Checkmk</a>
</div>
</div>
</div></div>
</div>
<div class="sect1">
<h2 id="heading_intro">
<span class="hidden-anchor sr-only" id="intro"></span>1. Introduction</h2>
<div class="sectionbody">
<div class="paragraph"><p>In this article you will find the most important topics relevant to an update of your Checkmk from version <span class="new">2.1.0</span> to version <span class="new">2.2.0</span>.</p></div>
<div class="paragraph"><p>We recommend that you read through the entire article before updating so that you know exactly what to expect: before, during and after the update.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="heading_prep">
<span class="hidden-anchor sr-only" id="prep"></span>2. Preparations</h2>
<div class="sectionbody">
<div class="paragraph"><p>This chapter gives you an overview of the topics you should take into consideration before you perform the update.
Probably not every topic will be relevant for you:
For each topic, you can check the corresponding box for your own reference and immediately move on to the next topic.</p></div>
<div class="sect2">
<h3 id="heading_backup">
<span class="hidden-anchor sr-only" id="backup"></span>2.1. Backup</h3>
<div class="paragraph"><p>As with any update to production software, you should check that your backups are up to date before performing the update of Checkmk.</p></div>
<div class="paragraph"><p><strong>Does this apply to you?</strong>
Yes.</p></div>
<div class="paragraph"><p><strong>What do you have to do?</strong>
If you create your backups automatically via <span class="guihint">Setup &gt; Maintenance &gt; Backups</span>, check there that your backups are up to date and that the most recent backup jobs have completed without errors.</p></div>
<div class="paragraph"><p>For more information, see the articles on <a href="backup.html">Backups</a> and on <a href="omd_basics.html#omd_backup_restore">Backing up and restoring sites</a>.</p></div>
</div>
<div class="sect2">
<h3 id="heading_editions">
<span class="hidden-anchor sr-only" id="editions"></span>2.2. Selecting a Checkmk edition</h3>
<div class="paragraph"><p>The Checkmk edition family has grown with the brand new <span class="image-inline"><img src="../images/icons/CSE.png" alt="CSE" width="20" title="Checkmk Cloud Edition"></span> <strong>Checkmk Cloud Edition</strong>.
You can read about what this edition has to offer in the <a href="cce.html">Cloud Edition</a> article.
This means saying goodbye to the <span class="image-inline"><img src="../images/icons/CFE.png" alt="CFE" width="20" title="Checkmk Enterprise Free Edition"></span> <strong>Checkmk Enterprise Free Edition</strong>, which is no longer available in <span class="new">2.2.0</span>.</p></div>
<div class="paragraph"><p>However, the functionality of the Free Edition lives on in the Cloud Edition: the time-limited trial and the permanent use of one of the commercial editions on a small scale.
However, there is a change to the limitation for permanent use:
With the Free Edition you can monitor up to 25 hosts in one <a href="glossar.html#site">site</a>, with the Cloud Edition you are limited to monitor 750 services in one site.</p></div>
<div class="paragraph"><p><strong>Does this affect you?</strong>
If you are currently using the Free Edition in the <span class="new">2.1.0</span> version, you will need to find a new edition when updating to the <span class="new">2.2.0</span>.
A short introduction to the various Checkmk editions can be found <a href="intro_setup.html#editions">here.</a></p></div>
<div class="paragraph"><p><strong>What do you need to do?</strong>
If in your case the 25 host limit in the Free Edition was sufficient, but the 750 free services of the Cloud Edition were not, you can either purchase a subscription and upgrade to one of the commercial editions — or choose to downgrade to the free Raw Edition.
Upgrade or downgrade the edition <em>before</em> updating to version <span class="new">2.2.0</span>.
Follow the instructions in the article on <a href="update.html">Updates and Upgrades</a>, especially for a <a href="update.html#down2cee">downgrade to the Raw Edition</a>.</p></div>
<div class="paragraph"><p>If you don’t have any problems with the new limit of 750 services, simply upgrade your Free Edition to the new Cloud Edition,
as described <a href="#cfe2cce">below</a>.</p></div>
</div>
<div class="sect2">
<h3 id="heading_linux_versions">
<span class="hidden-anchor sr-only" id="linux_versions"></span>2.3. Linux distribution versions</h3>
<div class="paragraph"><p>Some obsolete distributions will no longer be supported in the Checkmk <span class="new">2.2.0</span> version.</p></div>
<div class="paragraph"><p><strong>Does this affect you?</strong>
This will affect you if your Checkmk server has one of the following — still supported in <span class="new">2.1.0</span> — Linux distributions installed:</p></div>
<div class="ulist"><ul>
<li><p>Debian 9 <em>Stretch</em></p></li>
<li><p>Ubuntu in the Long Term Support (LTS) versions 16.04 <em>Xenial</em> and 18.04 <em>Bionic</em>.</p></li>
<li><p>Ubuntu in the Short Term Support (STS) version 21.10 <em>Impish</em></p></li>
<li><p>SLES 12 SP3 and SP4</p></li>
<li><p>SLES 15 without service pack</p></li>
</ul></div>
<div class="paragraph"><p><strong>What do you need to do?</strong>
Before updating Checkmk, first perform a <a href="release_upgrade.html">Linux distribution version upgrade</a>.
Make sure that the target version of the Linux distribution is supported by Checkmk <span class="new">2.1.0</span> <strong>and</strong> <span class="new">2.2.0</span>.
To find out which Linux distribution versions are supported by Checkmk, see the <a href="update_matrix.html">update matrix for version <span class="new">2.2.0</span></a> and the <a href="https://checkmk.com/download" target="_blank">download page</a> after you have selected the Checkmk version and your Linux distribution.</p></div>
<div class="paragraph"><p>More recent Ubuntu STS versions will not receive support for the entire product lifecycle of Checkmk <span class="new">2.2.0</span>.
However, we give users of these versions the opportunity to seamlessly update to the next LTS 24.04.
Details can be found in the <a href="update_matrix.html#ossupport">OS support policy</a>.</p></div>
</div>
<div class="sect2">
<h3 id="heading_browser">
<span class="hidden-anchor sr-only" id="browser"></span>2.4. Browser support</h3>
<div class="paragraph"><p>Checkmk <span class="new">2.2.0</span> uses new JavaScript features that are not available in older browsers.
Which browsers are supported in which versions can be found in the <a href="release_notes.html#browser">Release notes</a>.</p></div>
<div class="paragraph"><p><strong>Does this affect you?</strong>
You will usually have automatic updates to the latest version enabled on desktop systems.</p></div>
<div class="paragraph"><p><strong>What do you need to do?</strong>
Check the browser version you are using and install a more recent browser if necessary.
If you are using <em>Single Board Computers</em>, <em>Smart TVs</em> or <em>Digital Signage</em> solutions to display dashboards and you have no control over the system browser, test that any required dashboards are displayed correctly before updating.
If necessary, contact the hardware manufacturer for updates.</p></div>
</div>
<div class="sect2">
<h3 id="heading_agentlinux">
<span class="hidden-anchor sr-only" id="agentlinux"></span>2.5. The Linux agent</h3>
<div class="paragraph"><p>In Checkmk <span class="new">2.2.0</span> the <a href="agent_linux.html">Linux agent</a> no longer supports Python 2.6 for plug-ins.</p></div>
<div class="paragraph"><p><strong>Does this affect you?</strong>
Only if you have very old Linux systems in use (Python 2.6 is from October 2008 and was superseded by Python 2.7 as of July 2010) <em>and</em> you use <a href="glossar.html#agent_plugin">agent plug-ins</a> written in Python on these.</p></div>
<div class="paragraph"><p><strong>What do you need to do?</strong>
Identify the affected systems and update the installed agents to the latest available patch version of <span class="new">2.1.0</span>.
If automatic agent updates are configured, <a href="#automatic_agent_updates">disable them</a> before updating the Checkmk site.
You can then manually update the individual components — agent script, plug-ins and local checks — after compatibility tests.</p></div>
</div>
<div class="sect2">
<h3 id="heading_agentwindows">
<span class="hidden-anchor sr-only" id="agentwindows"></span>2.6. The Windows agent</h3>
<div class="paragraph"><p>In Checkmk <span class="new">2.2.0</span>, the <a href="agent_windows.html">Windows agent</a> no longer supports Windows 6.0 (Vista and Server 2008 R1).
However, on affected systems, the agent from <span class="new">2.1.0</span> can still be used.</p></div>
<div class="paragraph"><p><strong>Does this affect you?</strong>
Only if you are still using these antiquated Windows systems (support ended April 11, 2017 and January 14, 2020, respectively).</p></div>
<div class="paragraph"><p><strong>What do you need to do?</strong>
Identify the affected systems and update the installed agents to the latest available patch version of <span class="new">2.1.0</span>.
If automatic agent updates are configured, <a href="#automatic_agent_updates">disable them</a> before updating the Checkmk site.</p></div>
</div>
<div class="sect2">
<h3 id="heading_bakery_plugins">
<span class="hidden-anchor sr-only" id="bakery_plugins"></span>2.7. Older Bakery plug-ins</h3>
<div class="paragraph"><p>Bakery plug-ins include functions in the <a href="glossar.html#agent_bakery">Agent Bakery’s</a> agent packages.
As announced in <a href="https://checkmk.com/werk/14648" target="_blank">Werk #14648</a>, support for legacy Bakery plug-ins will be discontinued from version <span class="new">2.2.0</span>.
These are custom plug-ins that were used in version <span class="new">1.6.0</span> and earlier, and which have not yet been migrated to the Bakery API introduced in <span class="new">2.0.0</span>.</p></div>
<div class="paragraph"><p><strong>Does this affect you?</strong>
The Agent Bakery and thus the Bakery API are only relevant for users of the commercial editions.<br></p></div>
<div class="paragraph"><p>Before the introduction of the Bakery API, the Bakery plug-ins were stored in the site directory under <code>~/local/share/check_mk/agents/bakery/</code>.
To determine whether you have any old plug-ins, you can search for the <code>bakery_info</code> string here.</p></div>
<div class="paragraph"><p>As of <span class="new">2.0.0</span>, Checkmk also displays a warning when baking agent packages with legacy Bakery plug-ins.
You can also view this afterwards under <span class="guihint">Setup &gt; Maintenance &gt; Background jobs</span> in the <span class="guihint">Agent baking</span> section.
When <a href="cmk_commandline.html#bake_agents">baking via the command line</a> with <code>cmk -A</code> the warning is displayed as command output.</p></div>
<div class="paragraph"><p><strong>What do you need to do?</strong>
Migrate old Bakery plug-ins to the Bakery API.
You can find an introduction to using the API in the <a href="bakery_api.html">Bakery API</a> article.</p></div>
</div>
<div class="sect2">
<h3 id="heading_python">
<span class="hidden-anchor sr-only" id="python"></span>2.8. Python 3.11</h3>
<div class="paragraph"><p>Checkmk <span class="new">2.2.0</span> upgrades Python from 3.10 to 3.11.
This leads to <a href="https://github.com/python/cpython/issues/66683" target="_blank">a stricter interpretation</a> of <a href="regexes.html">regular expressions.</a>
<a href="https://www.regular-expressions.info/modifiers.html" target="_blank">Modifiers</a> as 'inline flags' have been marked as <em>deprecated</em> since Python 3.6, and previously resulted in a warning when tested in the Python prompt.
In Python 3.11 they are only allowed at the beginning of a regular expression.</p></div>
<div class="paragraph"><p><strong>Does this affect you?</strong>
It will most likely affect you if you use the <code>(?i)</code> modifier to indicate that the following regular expression should be evaluated case-insensitively.
Since for performance reasons Checkmk in some places merges several regular expressions into a single one, this change may also affect regular expressions (i.e. that begin with modifiers) that when considered alone would also be valid.</p></div>
<div class="paragraph"><p><strong>What do you need to do?</strong>
Identify <em>all</em> regular expressions that use inline flags.
For this it is usually sufficient to search for the <code>(?</code> string, for example with this command:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">OMD[mysite]:~$ </span>find<span class="tok-w"> </span>etc/<span class="tok-w"> </span>-type<span class="tok-w"> </span>f<span class="tok-w"> </span>-exec<span class="tok-w"> </span>grep<span class="tok-w"> </span>-Hn<span class="tok-w"> </span><span class="tok-s1">'(?.)'</span><span class="tok-w"> </span><span class="tok-o">{}</span><span class="tok-w">  </span><span class="tok-se">\;</span></code></pre></div></div>
<div class="paragraph"><p>Modify any affected regular expressions.
Since modifiers are still valid if their scope is specified, you can equivalently <a href="https://github.com/Checkmk/checkmk-docs/blob/master/examples/update_major/fix_inline_arguments.py" target="_blank">rewrite</a> an existing regular expression:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code><span></span>(?i)somestring</code></pre></div></div>
<div class="paragraph"><p>to:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code><span></span>(?i:somestring)</code></pre></div></div>
</div>
<div class="sect2">
<h3 id="heading_pip3">
<span class="hidden-anchor sr-only" id="pip3"></span>2.9. Uninstalling Python modules</h3>
<div class="paragraph"><p>The update of Python from 3.10 to 3.11 also affects any modules installed in a site.
In many cases, post-installed modules are incompatible with Python 3.11.
In the worst case, obsolete modules overwrite the functionality of the modules supplied by Checkmk.</p></div>
<div class="paragraph"><p><strong>Does this affect you?</strong>
This will only affect you when you have explicitly-installed Python modules for special agents or agent-based check plug-ins that you have written yourself or obtained from the Exchange.
If you are unsure, carry out the check described in the following section.</p></div>
<div class="paragraph"><p><strong>What do you need to do?</strong>
First find out whether Python modules are installed in the site, and if so — identify them.
To do this, search for the directories <code>dist-info</code> and <code>egg-info</code>:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">OMD[mysite]:~$ </span>find<span class="tok-w"> </span>~/local/lib/python3/<span class="tok-w"> </span>-type<span class="tok-w"> </span>d<span class="tok-w"> </span>-name<span class="tok-w"> </span><span class="tok-s1">'*.*-info'</span>
<span class="tok-go">local/lib/python3/cryptography-41.0.5.dist-info</span>
<span class="tok-go">local/lib/python3/ecdsa-0.18.0.dist-info</span></code></pre></div></div>
<div class="paragraph"><p>Make a note of the installed modules and then uninstall them:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">OMD[mysite]:~$ </span>pip3<span class="tok-w"> </span>uninstall<span class="tok-w"> </span>cryptography<span class="tok-w"> </span>ecdsa</code></pre></div></div>
<div class="paragraph"><p>You can find out how to deal with uninstalled Python modules after the update <a href="#pip3post">below</a>.</p></div>
</div>
<div class="sect2">
<h3 id="heading_user_id">
<span class="hidden-anchor sr-only" id="user_id"></span>2.10. Incompatible user names</h3>
<div class="paragraph"><p>As of version <span class="new">2.2.0</span>, the use of certain special characters in user names is no longer allowed.
With invalid user names an update to <span class="new">2.2.0</span> is not possible, because <code>omd update</code> will abort with an error.</p></div>
<div class="paragraph"><p>User names in Checkmk may only contain letters (as defined by the <a href="https://www.unicode.org/reports/tr44/" target="_blank">Unicode database</a>), digits and the following special characters: Hyphen (<code>-</code>), underscore (<code>_</code>), period (<code>.</code>), the 'at' character (<code>@</code>) and dollar sign (<code>$</code>).
Only a single letter, digit, underscore or dollar sign is allowed as the first character.</p></div>
<div class="paragraph"><p><strong>Does this affect you?</strong>
When creating local users via <span class="guihint">Setup &gt; Users</span>, Checkmk has been rejecting invalid user names for quite some time, i.e. even before version <span class="new">1.6.0</span>.
So only user names from external connections like LDAP are affected, if at all.
As announced in <a href="https://checkmk.com/werk/14393" target="_blank">Werk #14393</a>, since version <span class="new">2.1.0</span>p20 Checkmk has issued warnings for incompatible user names — on the one hand when running <code>omd update</code> and on the other hand in the user administration, which you can call via <span class="guihint">Setup &gt; Users</span>.
The user names are displayed in the <span class="guihint">ID</span> column and in case of invalid user names there is a warning.</p></div>
<div class="paragraph"><p><strong>What do you need to do?</strong>
Update any incompatible user names found at their source.</p></div>
</div>
<div class="sect2">
<h3 id="heading_pwd_hash">
<span class="hidden-anchor sr-only" id="pwd_hash"></span>2.11. Insecure hash functions for passwords</h3>
<div class="paragraph"><p>As of version <span class="new">2.2.0</span>, the use of insecure and obsolete hash functions for passwords is no longer allowed.
This affects the hash functions <em>DES-Crypt, MD5-Crypt, Apr MD5-Crypt</em> and <em>SHA-256 Crypt</em>.
Although the latter is still considered secure for passwords, all users' password hashes should be switched to the more modern <em>bcrypt</em> hash function.</p></div>
<div class="paragraph"><p>A local user whose password has been converted using one of the aforementioned outdated hash functions will no longer be able to log in under version <span class="new">2.2.0</span>.</p></div>
<div class="paragraph"><p><strong>Does this affect you?</strong>
Since version <span class="new">2.1.0</span>p16 (see <a href="https://checkmk.com/werk/14391" target="_blank">Werk #14391</a>) Checkmk has been warning  when insecure password hashes are found in the site directory’s <code>~/etc/htpasswd</code> file.
When <code>omd update</code> is executed, a warning message is displayed with all affected (local) user names.
Users from external connections like LDAP are not affected.</p></div>
<div class="paragraph"><p>In <span class="new">2.1.0</span>, each affected user was then either prompted to choose a new password after logging in,
or the hash was automatically updated in the background during login.
However, if a user has not logged in at all since then, it is possible that an outdated password hash is still being used.
This user will not be able to log in after updating to version <span class="new">2.2.0</span>.</p></div>
<div class="paragraph"><p><strong>What do you need to do?</strong>
To restore access for an affected user, you must reset their password manually.
A new password is assigned either in the user administration via <span class="guihint">Setup &gt; Users</span>, or on the <a href="wato_user.html#change_passwd">command line</a> with the <code>cmk-passwd &lt;username&gt;</code> command.
For password changes, use only the <code>cmk-passwd</code> command and no longer <code>htpasswd</code>, which comes from the Apache installation and which would generate obsolete password hashes without additional options.</p></div>
</div>
<div class="sect2">
<h3 id="heading_zombie14">
<span class="hidden-anchor sr-only" id="zombie14"></span>2.12. Accidentally deactivated notifications</h3>
<div class="paragraph"><p>On systems that have been updated from Checkmk <span class="new">1.4.0</span> to <span class="new">1.5.0</span> at some moment in the distant past, notifications may no longer work after updating from <span class="new">2.1.0</span> to <span class="new">2.2.0</span>.</p></div>
<div class="paragraph"><p><strong>Does this affect you?</strong>
The problem only occurs on installations that were updated from Checkmk <span class="new">1.4.0</span> to <span class="new">1.5.0</span> before p8. Furthermore, it only occurs for users who have not been edited and saved in the meantime. For Checkmk installations that were updated from Checkmk <span class="new">1.4.0</span> to <span class="new">1.5.0</span>p8 or later, or were only installed with Checkmk <span class="new">1.5.0</span> or later, it does not occur at all.</p></div>
<div class="paragraph"><p><strong>What do you need to do?</strong>
Open the user settings of users who should receive messages and save them once - even if supposedly correct settings are displayed.
As this is not very practical for a large number of users, you can also make the necessary changes/checks in the configuration file <code>~/etc/check_mk/conf.d/wato/contacts.mk</code>.
Details can be found at <a href="https://checkmk.com/de/werk/6417" target="_blank">work #6417</a>.</p></div>
</div>
<div class="sect2">
<h3 id="heading_omd_update-apache-config">
<span class="hidden-anchor sr-only" id="omd_update-apache-config"></span>2.13. Site user and System Apache</h3>
<div class="paragraph"><p>Each Checkmk site provides its HTTP services (GUI, APIs) via its own site-specific Apache process.
Global access to this site-specific Apache is provided by the System Apache, which opens ports 80 and 443 for external requests, depending on the system configuration.</p></div>
<div class="paragraph"><p>To learn about the site-specific Apache, System Apache reads a reverse proxy configuration provided by the site user.
A malicious site user could now trick System Apache into executing code as the root user, because System Apache is normally started with root privileges first.</p></div>
<div class="paragraph"><p>To close this security loophole, we need to separate the System Apache configuration from the site user’s access.
To remove the privilege escalation, the <code>omd update-apache-config &lt;sitename&gt;</code> command must be run <em>once</em> for each site.</p></div>
<div class="paragraph"><p>See <a href="https://checkmk.com/werk/14281" target="_blank">Werk #14281</a> for more detailed information on this topic and additional notes, including how to execute the <code>omd update</code> command when it is used to change certain options.</p></div>
<div class="paragraph"><p><strong>Does this affect you?</strong>
Since version <span class="new">2.1.0</span>p7, when running <code>omd update</code> you are prompted to also run <code>omd update-apache-config &lt;sitename&gt;</code>.
If you have already done this when updating to <span class="new">2.1.0</span>, there is nothing further to do when updating to <span class="new">2.2.0</span>.
The previously urgent recommendation now becomes a requirement when updating to the <span class="new">2.2.0</span>.</p></div>
<div class="paragraph"><p><strong>What do you need to do?</strong>
As the root user, run the <code>omd update-apache-config &lt;sitename&gt;</code> command when prompted while running <code>omd update</code>.</p></div>
</div>
<div class="sect2">
<h3 id="heading_rest-api">
<span class="hidden-anchor sr-only" id="rest-api"></span>2.14. REST API replaces Web API</h3>
<div class="paragraph"><p>As announced in <span class="new">2.1.0</span>, the Web API (also called HTTP API) has been removed in Checkmk version <span class="new">2.2.0</span>.
The Web API is replaced by the <a href="rest_api.html">REST API</a>.</p></div>
<div class="paragraph"><p><strong>Does this affect you?</strong>
This will affect you if you have written custom scripts that still use the Web API.</p></div>
<div class="paragraph"><p><strong>What do you need to do?</strong>
Migrate all existing scripts that use the Web API to the REST API before moving to Checkmk version <span class="new">2.2.0</span>.
See the <a href="rest_api.html#rest-web-api">REST API article</a> for an overview of which REST API endpoints replace the Web API commands.</p></div>
</div>
<div class="sect2">
<h3 id="heading_kubernetes">
<span class="hidden-anchor sr-only" id="kubernetes"></span>2.15. Kubernetes monitoring</h3>
<div class="paragraph"><p>The Checkmk <span class="new">2.0.0</span> special agent and its associated check plug-ins for monitoring Kubernetes are no longer available in <span class="new">2.2.0</span>.
Instead, use the <a href="monitoring_kubernetes.html">Kubernetes monitoring</a>, rewritten from scratch and greatly improved in the <span class="new">2.1.0</span> version.</p></div>
</div>
<div class="sect2">
<h3 id="heading_nsca">
<span class="hidden-anchor sr-only" id="nsca"></span>2.16. NSCA</h3>
<div class="paragraph"><p>As announced in version <span class="new">2.1.0</span>, Checkmk <span class="new">2.2.0</span> no longer supports the Nagios Service Check Acceptor (NSCA).
NSCA is a Nagios add-on to get results from passive <a href="monitoring_basics.html#checks">checks</a> on remote hosts in a distributed Nagios configuration.
This deprecated method for setting up <a href="distributed_monitoring.html">distributed monitoring</a> offers no advantages over Checkmk’s own methods.
Details and notes on its replacement can be found in <a href="https://checkmk.com/werk/13644" target="_blank">Werk #13644</a>.</p></div>
</div>
<div class="sect2">
<h3 id="heading_local_files">
<span class="hidden-anchor sr-only" id="local_files"></span>2.17. Non-packaged local files</h3>
<div class="paragraph"><p>Local files allow you to customize and extend the functionality provided by Checkmk.
These files are located in the local part of the site’s directory structure, i.e. in <code>~/local</code>.
Local files can cause problems when updating, if they no longer match the new Checkmk version.</p></div>
<div class="paragraph"><p><strong>Does this affect you?</strong>
Since it is not possible for Checkmk to fully ensure compatibility of local customizations when updating, you should check your Checkmk site before an update to see if any local files are used on your system, and if so, which ones.</p></div>
<div class="paragraph"><p><strong>What do you need to do?</strong>
Get an overview of unpackaged local files on your Checkmk site by running the following command as the site user:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">OMD[mysite]:~$ </span>mkp<span class="tok-w"> </span>find</code></pre></div></div>
<div class="paragraph"><p>If files are listed here, you should group files that belong together in <a href="mkps.html">extension packages (MKPs)</a>.
This makes it easier to deactivate <em>en bloc</em> later, should <a href="#incompatible_mkps">incompatibilities</a> be detected after the update.</p></div>
</div>
<div class="sect2">
<h3 id="heading_apis">
<span class="hidden-anchor sr-only" id="apis"></span>2.18. Programming interfaces</h3>
<div class="paragraph"><p>In Checkmk <span class="new">2.2.0</span> some internally used programming interfaces (APIs) have been rebuilt.</p></div>
<div class="paragraph"><p><strong>Does this affect you?</strong>
The issue of APIs <em>may</em> affect you if you have extended the checks shipped with Checkmk with your own, self-written checks and/or if you use plug-ins from other sources.
Since the restructured APIs are considered <em>internal</em> and are also not available to plug-ins from the <a href="https://exchange.checkmk.com" target="_blank">Checkmk Exchange</a>,
the number of extensions affected should be small.</p></div>
<div class="paragraph"><p><strong>What do you need to do?</strong>
Check third-party extensions for functionality and make any necessary adjustments to import paths.</p></div>
<div class="paragraph"><p>Affected:</p></div>
<div class="ulist"><ul>
<li><p>Splitting of GUI imports related to datasource programs and active checks into multiple files (<a href="https://checkmk.com/werk/14716" target="_blank">Werk #14716</a>).</p></li>
<li><p>Splitting of GUI imports regarding the use of the password store (<em>password store</em>) into multiple files (<a href="https://checkmk.com/werk/14719" target="_blank">Werk #14719</a>).</p></li>
<li><p>Restructuring of the GUI code (<a href="https://checkmk.com/werk/15493" target="_blank">work #15493</a>).</p></li>
<li><p>Restructuring of the <code>ValueSpec</code> class (<a href="https://checkmk.com/werk/13094" target="_blank">work #13094</a>).</p></li>
<li><p>Changed scope of the <code>Transform</code> class (<a href="https://checkmk.com/werk/14821" target="_blank">Werk #14821</a>).</p></li>
<li><p>Finer granulation of access to rights for built-in users (<a href="https://checkmk.com/werk/14824" target="_blank">Werk #14824</a>).</p></li>
<li><p>End of support for the dashlet configuration format in Checkmk prior to version <span class="new">1.6.0</span> (<a href="https://checkmk.com/werk/14297" target="_blank">Werk #14297</a>).</p></li>
<li><p>End of support for the old plug-in API for HW/SW Inventory (<a href="https://checkmk.com/werk/14084" target="_blank">Werk #14084</a>).</p></li>
</ul></div>
</div>
<div class="sect2">
<h3 id="heading_incompatible_mkps">
<span class="hidden-anchor sr-only" id="incompatible_mkps"></span>2.19. Incompatible and obsolete MKPs</h3>
<div class="paragraph"><p>Your monitoring system can be extended quite easily and conveniently via the <a href="glossar.html#mkp">Checkmk extension packages (MKPs)</a>.
On the one hand, it can be the case that such MKPs are no longer maintained and may then no longer be compatible with new versions of Checkmk.
On the other hand, we keep adding new plug-ins and functional extensions to Checkmk, which is why MKPs sometimes simply become obsolete, and their functionality will be provided by Checkmk itself.</p></div>
<div class="paragraph"><p><strong>Does this affect you?</strong>
If you have MKPs installed, for this reason a check of these MKPs is strongly recommended — especially before a major update.
This will prevent incompatible packages from interfering with the update, or the creation of duplicate or at least very similar services following the update.</p></div>
<div class="paragraph"><p><strong>What do you need to do?</strong>
To do this, check your installed MKPs against our <a href="https://checkmk.com/integrations" target="_blank">Catalog of Check Plug-ins</a> and remove packages which are now provided natively by Checkmk.
You can also use this opportunity to remove MKPs that may have only been installed for a test run.
A listing can be found in the commercial editions via <span class="guihint">Setup &gt; Maintenance &gt; Extension packages</span>.</p></div>
<div class="paragraph"><p>On the command line, you can view installed extensions with the following command:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">OMD[mysite]:~$ </span>mkp<span class="tok-w"> </span>list
<span class="tok-go">Name        Version Title         Req. Version Until Version Files State</span>
<span class="tok-go">----------- ------- ------------- ------------ ------------- ----- -------------------------------</span>
<span class="tok-go">my_cool_mkp 1.0.2   Best MKP ever 2.0.0        2.3.9p99      6     Enabled (active on this site)</span>
<span class="tok-go">hello_world 0.2.1   Hello world!  2.1.0        2.1.99        6     Enabled (active on this site)</span></code></pre></div></div>
<div class="paragraph"><p>Then for each listed MKP you can subsequently also display the files that belong to the package:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">OMD[mysite]:~$ </span>mkp<span class="tok-w"> </span>list<span class="tok-w"> </span>my_cool_mkp
<span class="tok-go">/omd/sites/mysite/local/lib/check_mk/base/plugins/agent_based/check_mk.py</span>
<span class="tok-go">/omd/sites/mysite/local/share/check_mk/web/plugins/metrics/custom_metrics.py</span></code></pre></div></div>
<div class="paragraph"><p>Should you not be able to assign all packages via the check of the installed MKPs and the comparison with our catalog, the <a href="#dry_run">test run of the update,</a> described hereafter is recommended to identify incompatibilities in the process and then before the update remove these from your production monitoring.</p></div>
<div class="sect3">
<h4 id="heading_mkp_backport">
<span class="hidden-anchor sr-only" id="mkp_backport"></span>MKP management for different Checkmk versions</h4>
<div class="paragraph"><p>To facilitate updates, Checkmk <span class="new">2.1.0</span>p22 introduced the ability to maintain MKPs in different versions.
When updating, the package for Checkmk <span class="new">2.1.0</span> is then automatically deactivated and the one for Checkmk <span class="new">2.2.0</span> automatically activated.
When operating a distributed monitoring with a <a href="glossar.html#distributed_setup">centralized configuration</a>, you can use this feature to <a href="#dist_setup">distribute</a> packages in versions that can differ between the remote sites and the central site.
This works even if the remote sites have a higher version than the central site, as is the case when updating in a distributed monitoring during a transitional period.</p></div>
<div class="paragraph"><p>Note that you can only use this feature if you use at least <span class="new">2.1.0</span>p22 as the initial version!
If these requirements are met, you can add additional packages for <span class="new">2.2.0</span> on the central site.</p></div>
<div class="paragraph"><p>When installing an MKP written for Checkmk <span class="new">2.2.0</span>, you will get a warning message when using Checkmk <span class="new">2.1.0</span>p22 and higher:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">OMD[mysite]:~$ </span>mkp<span class="tok-w"> </span>install<span class="tok-w"> </span>/tmp/hello_world-0.2.2.mkp
<span class="tok-go">The package requires Check_MK version 2.2.0, but you have 2.1.0p22 installed.</span></code></pre></div></div>
<div class="paragraph"><p>This package is identified in the list of packages as being <span class="guihint">Enabled (inactive on this site)</span>:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">OMD[mysite]:~$ </span>mkp<span class="tok-w"> </span>list
<span class="tok-go">Name        Version Title        Req. Version Until Version Files State</span>
<span class="tok-go">----------- ------- ------------ ------------ ------------- ----- -------------------------------</span>
<span class="tok-go">hello_world 0.2.2   Hello world! 2.2.0        2.2.99        6     Enabled (inactive on this site)</span>
<span class="tok-go">hello_world 0.2.1   Hello world! 2.1.0        2.1.99        6     Enabled (active on this site)</span></code></pre></div></div>
<div class="paragraph"><p>Details on the revised package management function can be found in the <a href="mkps.html">article on extension package (MKPs) management</a>.</p></div>
</div>
</div>
<div class="sect2">
<h3 id="heading_incompatible">
<span class="hidden-anchor sr-only" id="incompatible"></span>2.20. Incompatible changes</h3>
<div class="paragraph"><p>As in every Checkmk version, there are alterations to the software in the current version <span class="new">2.2.0</span> that <em>may</em> have repercussions on your Checkmk installation.
A so-called <em>incompatible change</em> requires that you make manual modifications in order to allow existing functions to continue to run as usual and/or to be able to use new functions.</p></div>
<div class="paragraph"><p><strong>Does this affect you?</strong>
In general, there will be incompatible changes that will also affect your Checkmk installation, it is however impossible to make a general statement.
In this article we have collected those issues that apply to all or most Checkmk installations.
In any case there may be additional changes that are relevant to you, for example in checks that you use in your installation.</p></div>
<div class="paragraph"><p><strong>What do you need to do?</strong>
Once you have performed the <a href="#update">update</a>, the Checkmk interface will show you the number and content of any incompatible changes, and prompt you to review and take note of them.
So you will definitely be confronted with this issue — but only after you have performed the update.</p></div>
<div class="paragraph"><p>It is therefore a good idea to get an overview of the incompatible changes <strong>before</strong> the update:
Open the list of <a href="https://checkmk.com/werks?search=&amp;cmk_version[]=2.2&amp;compatible=0" target="_blank">Werks</a>.
(The software development of Checkmk is organized in so-called Werks).
In the description of a Werk, you will find instructions on what, if anything, needs to be done to make the change compatible.</p></div>
<div class="paragraph"><p>The frustrating news:
A version’s Werks list is very, very long — even if it contains only the incompatible changes.
The comforting news:
You will be able to see from the number of changes how much effort we put into improving Checkmk for you.</p></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="heading_update">
<span class="hidden-anchor sr-only" id="update"></span>3. Update</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="heading_dry_run">
<span class="hidden-anchor sr-only" id="dry_run"></span>3.1. Best practices when updating</h3>
<div class="paragraph"><p>In this section we describe the best practices that we follow even when updating large Checkmk environments.
These are certainly not mandatory in every environment, but they can make the process of updating easier for you.</p></div>
<div class="sect3">
<h4 id="heading_update_patch">
<span class="hidden-anchor sr-only" id="update_patch"></span>Update the Checkmk version</h4>
<div class="paragraph"><p>Before updating to version <span class="new">2.2.0</span>, the Checkmk site must have version <span class="new">2.1.0</span> installed.</p></div>
<div class="paragraph"><p>We have previously advised against omitting an intermediate major version when performing a major update, as there are simply too many changes in between that will hinder a smooth update and almost certainly cause problems.
With version <span class="new">2.1.0</span>, this recommendation was turned into a requirement — and a lock was introduced that prevents, for example, a direct update from version <span class="new">2.0.0</span> to <span class="new">2.2.0</span>.</p></div>
<div class="paragraph"><p>The update to <span class="new">2.2.0</span> currently requires at least <span class="new">2.1.0</span>p23.
However, in the future, a specific <span class="new">2.2.0</span> patch version may require a higher <span class="new">2.1.0</span> patch version for the update.
In general, we recommend updating Checkmk to the latest <span class="new">2.1.0</span> patch version first, and only then updating to <span class="new">2.2.0</span>.</p></div>
</div>
<div class="sect3">
<h4 id="heading__perform_a_test_run_of_the_update">
<span class="hidden-anchor sr-only" id="_perform_a_test_run_of_the_update"></span>Perform a test run of the update</h4>
<div class="paragraph"><p>In large environments, where obviously even restoring a current backup of your Checkmk environment could take quite some time, it is recommended to perform a test with a cloned site before updating the production environment.
For this purpose, you can, for example, restore the last regular backup of your site under a different name.</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">root@linux# </span>omd<span class="tok-w"> </span>restore<span class="tok-w"> </span>newsite<span class="tok-w"> </span>/path/to/backup</code></pre></div></div>
<div class="paragraph"><p><strong>Alternatively</strong> you can also copy your site using <code>omd cp</code>.
For this, however, the site must be stopped for a short time:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">root@linux# </span>omd<span class="tok-w"> </span>stop<span class="tok-w"> </span>mysite
<span class="tok-gp">root@linux# </span>omd<span class="tok-w"> </span>cp<span class="tok-w"> </span>mysite<span class="tok-w"> </span>newsite</code></pre></div></div>
<div class="paragraph"><p>Then, perform the update first on this new cloned site, for example to check the above mentioned local changes in the new environment.</p></div>
</div>
<div class="sect3">
<h4 id="heading_automatic_agent_updates">
<span class="hidden-anchor sr-only" id="automatic_agent_updates"></span>Temporarily disable agent updates</h4>
<div class="paragraph"><p><span class="image-inline"><img src="../images/CEE.svg" alt="CEE" class="icon-left"></span>
If you are using the automatic agent updates in the commercial editions, you should consider disabling them temporarily before updating Checkmk so as to be able to later switch to the new agents at the hosts in a controlled manner.
To do this, first select <span class="guihint">Setup &gt; Agents &gt; Windows, Linux, Solaris, AIX</span> and on the following page select the menu item <span class="guihint">Agents &gt; Automatic updates.</span>
By clicking on the <span class="image-inline"><img src="../images/icons/icon_edit.png" alt="Icon to edit a list entry."></span> button in front of the <span class="guihint">Master switch</span> you can disable the agent update completely:</p></div>
<div class="imageblock"><div class="content"><img src="../images/update_major_automatic_agent_updates.png" alt=" Disabling agent update using the master switch."></div></div>
<div class="paragraph"><p>Following a successful update of Checkmk, you can reactivate the agent update in the same way.</p></div>
<div class="paragraph"><p>At this point, we recommend that you initially only reactivate the automatic agent update for individual hosts or host groups.
By doing so, the new agent will not be rolled out to all of your servers right away and you can familiarize yourself with the newly delivered data on a few systems.
Also, due to the significant increase in the number of check plug-ins supplied, you might find a whole new set of services that you can then set up properly on the test systems you choose.
You may also need new thresholds for new services.
If you tackle this on a small scale first, you will be able to minimize unnecessary false positives.</p></div>
<div class="paragraph"><p>To do this, you can simply enter a few hosts or host groups in the appropriate fields on the above page and then re-enable the <span class="guihint">Master switch</span>.</p></div>
<div class="imageblock"><div class="content"><img src="../images/update_major_activate_update_on_selected_hosts.png" alt="Options when updating agents to activate on specific hosts."></div></div>
<div class="paragraph"><p><strong>Important:</strong> Remember to remove these restrictions on explicit hosts and host groups again once you are satisfied with the results.</p></div>
</div>
<div class="sect3">
<h4 id="heading_notifications">
<span class="hidden-anchor sr-only" id="notifications"></span>Temporarily disable notifications</h4>
<div class="paragraph"><p>You should also consider turning off <a href="glossar.html#notification">notifications</a> in the pre-update site — for similar reasons to the ones we explained in the previous section on automatic agent updates.
This way you avoid your colleagues from the monitoring team receiving <em>unnecessary</em> notifications.</p></div>
<div class="paragraph"><p>You can turn off notifications centrally with the main <span class="guihint">Notifications</span> switch in the <a href="user_interface.html#master_control">Master control</a> snap-in.</p></div>
<div class="paragraph"><p>It may will happen that after the update one or another service is <span class="state2">CRIT</span> which had not been the case previously.
Take care of new problems after the update first.
You can also view any 'unhandled' problems, e.g. in the <a href="user_interface.html#overview">Overview</a> snap-in.</p></div>
<div class="paragraph"><p><strong>Important:</strong> Don’t forget to turn on the notifications again, e.g. when the number of unhandled problems after the update has leveled off to the level before the update.</p></div>
</div>
</div>
<div class="sect2">
<h3 id="heading_update_distributed_monitoring">
<span class="hidden-anchor sr-only" id="update_distributed_monitoring"></span>3.2. Updates in distributed monitoring</h3>
<div class="paragraph"><p>There are two different procedures for performing an update of all sites included in a <a href="distributed_monitoring.html">distributed monitoring</a>:</p></div>
<div class="ulist"><ul>
<li><p>Stop all sites, perform the update of all sites in a bulk action, and then restart all sites.</p></li>
<li><p>Under strict conditions, a <em>mixed operation</em> is possible for a certain period of time, in which the remote sites are updated first, following which version equivalency is restored with the update of the central site.</p></li>
</ul></div>
<div class="paragraph"><p>In particular, if you want to update while the system is running, you should read the notes in the general article on <a href="update.html#updatedistributed">Updates and Upgrades</a>.</p></div>
<div class="sect3">
<h4 id="heading_dist_setup">
<span class="hidden-anchor sr-only" id="dist_setup"></span>MKPs in a distributed setup</h4>
<div class="paragraph"><p>If you are running a distributed monitoring with a <a href="glossar.html#distributed_setup">central configuration</a> from which <a href="glossar.html#mkp">Checkmk extension packages (MKPs)</a> are also distributed to the remote sites, you have the option to keep packages for the remote sites in versions for <span class="new">2.1.0</span> and <span class="new">2.2.0</span> on the Checkmk <span class="new">2.1.0</span> central site.
The MKPs matching the remote sites will then be distributed automatically.</p></div>
<div class="paragraph"><p>To use this feature, you must first update the central site to patch version <span class="new">2.1.0</span>p22.
Once this has been done, you can start adding additional <a href="#mkp_backport">packages for <span class="new">2.2.0</span> on the central site</a>.
Now, when you upgrade remote sites to <span class="new">2.2.0</span>, they will automatically receive and activate the package matching the new version.</p></div>
</div>
</div>
<div class="sect2">
<h3 id="heading__performing_the_update">
<span class="hidden-anchor sr-only" id="_performing_the_update"></span>3.3. Performing the update</h3>
<div class="paragraph"><p>Nothing fundamental has changed with the actual update of the software in Checkmk <span class="new">2.2.0</span>,
i.e. you install the new version, perform the update of the Checkmk site, rectify any possible conflicts and check and confirm the incompatible changes.</p></div>
<div class="paragraph"><p>Perform the update procedure as described in the article on <a href="update.html#detailed">Updates and Upgrades</a>.</p></div>
</div>
<div class="sect2">
<h3 id="heading_cfe2cce">
<span class="hidden-anchor sr-only" id="cfe2cce"></span>3.4. Upgrading to the Cloud Edition</h3>
<div class="paragraph"><p>If you already have the Free Edition in the <span class="new">2.1.0</span> version, it is an obvious option to upgrade to the Cloud Edition when you update to the <span class="new">2.2.0</span> version,
because you can try this <a href="#editions">Checkmk edition</a> in the <span class="new">2.2.0</span> for a limited time or use it permanently on a small scale.</p></div>
<div class="paragraph"><p><strong>Note:</strong> The <em>direct crossgrade</em> described here is only supported for the change from <span class="new">2.1.0</span> Free Edition to <span class="new">2.2.0</span> Cloud Edition.
In all other cases, first update Checkmk and then upgrade the edition.
For distributed environments, again pay attention to the order described <a href="update.html#editiondistributed">here</a>.</p></div>
<div class="olist arabic"><ol class="arabic">
<li><p>Download the Cloud Edition from the <a href="https://checkmk.com/download" target="_blank">download page</a>.
You do not need any credentials for the download.</p></li>
<li>
<p>Update to version <span class="new">2.2.0</span> as described in the article on <a href="update.html#detailed">Updates and Upgrades</a>.<br>
In doing so, perform an <em>upgrade</em> to another Checkmk edition at the same time as the <em>update</em> to version <span class="new">2.2.0</span>,
because in this particular case there is no common version of the <span class="new">2.1.0</span> Free Edition and the <span class="new">2.2.0</span> Cloud Edition.
For this reason, you must confirm an additional query when the <code>omd update</code> is executed:</p>
<div class="imageblock"><div class="content"><img src="../images/update_major_omd_update_upgrade_confirmation.png" alt="Query when upgrading to the Cloud Edition." width="40%"></div></div>
<div class="paragraph"><p>The last lines of the output from <code>omd update</code> tell you that the Cloud Edition will start its life in the license state "Trial",
during which you can test the Cloud Edition for 30 days without any restrictions:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-go">You are now starting your trial of Checkmk Cloud Edition.</span>
<span class="tok-go">If you are intending to use Checkmk to monitor more than 750 services after 30 days, you must purchase a license.</span>
<span class="tok-go">In case you already have a license, please enter your license credentials on the product's licensing page (Setup &gt; Maintenance &gt; Licensing &gt; Edit settings).</span>
<span class="tok-go">Finished update.</span></code></pre></div></div>
</li>
<li>
<p>After upgrading to the Cloud Edition, restart your site.
The login dialog will show the countdown for the remaining time in the license state "Trial":</p>
<div class="imageblock"><div class="content"><img src="../images/update_major_login_cce_trial.png" alt="Checkmk login dialog for the Cloud Edition in license state 'Trial'." width="60%"></div></div>
</li>
</ol></div>
<div class="paragraph"><p>Entering a license key after 30 days at the latest is only necessary if you want to use the Cloud Edition without restrictions.
If you stay below the limit of 750 services in a single site, the Cloud Edition will switch to the license state "Free" after 30 days.</p></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="heading_follow-up">
<span class="hidden-anchor sr-only" id="follow-up"></span>4. Follow-ups</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="heading_gui">
<span class="hidden-anchor sr-only" id="gui"></span>4.1. Changes to the user interface</h3>
<div class="paragraph"><p>The Checkmk user interface (GUI), which was completely redesigned with version <span class="new">2.0.0</span>, has not been changed fundamentally in version <span class="new">2.2.0</span>.
The general procedures, which you are already familiar with from versions <span class="new">2.0.0</span> and <span class="new">2.1.0</span>, can also be used as they are in <span class="new">2.2.0</span>.
However, menus, menu items, icons, and other details have been modified to make new features available — and to improve existing ones.</p></div>
<div class="paragraph"><p>We will present these changes in this User Guide’s articles — and in the <a href="intro_setup.html">Beginner’s Guide</a> you will find a detailed introduction,
including the most important elements of the <a href="intro_gui.html">user interface</a>.</p></div>
<div class="sect3">
<h4 id="heading_favorites">
<span class="hidden-anchor sr-only" id="favorites"></span>The 'Favorites' have been removed</h4>
<div class="paragraph"><p>The little known, little used and in the User Guide also not described option to mark hosts and services as <em>favorites</em> was removed with <a href="https://checkmk.com/werk/14727" target="_blank">Werk #14727</a>.
Favorites could be set until <span class="new">2.1.0</span> via the <span class="guihint">Commands &gt; Favorites</span> menu item, i.e. in the same menu in which the commands for acknowledging problems or creating scheduled downtimes can be found.</p></div>
<div class="paragraph"><p>As a substitute for quick access to important hosts and services, the <a href="user_interface.html#bookmarks">Bookmarks</a> can be set, e.g. in views, after you have filtered the hosts or services shown.
For a description of how to do this, see the <a href="intro_tools.html#views">Beginner’s Guide</a>.</p></div>
</div>
</div>
<div class="sect2">
<h3 id="heading_service_discovery">
<span class="hidden-anchor sr-only" id="service_discovery"></span>4.2. Updating services</h3>
<div class="paragraph"><p>As with every major version, Checkmk <span class="new">2.2.0</span> introduces a whole new set of check plug-ins.
If you do not use the <a href="wato_services.html#discovery_check">'discovery check'</a>, i.e. the automatic update of the service configuration via the periodic service discovery, you will have to search for services on quite a number of hosts.</p></div>
<div class="paragraph"><p>If your hosts are organized accordingly (e.g. in folders), you can generally use the <span class="guihint">Bulk discovery</span> function for this.
This function can be found under <span class="guihint">Setup &gt; Hosts &gt; Hosts</span> and then in the <span class="guihint">Hosts &gt; Run bulk service discovery</span> menu.</p></div>
<div class="sect3">
<h4 id="heading_service_descriptions">
<span class="hidden-anchor sr-only" id="service_descriptions"></span>Service descriptions</h4>
<div class="paragraph"><p>Each update of Checkmk will involve changing service descriptions to improve the consistency of naming within the monitoring and documentation of Checkmk.
Since changing service descriptions means that rules sometimes need to be modified and historical monitoring data is lost, Checkmk initially leaves the old descriptions in place for updates.
For services where the loss of old monitoring data is acceptable and the effort for adapting rules is manageable, you should switch to new service descriptions as soon as possible.</p></div>
<div class="paragraph"><p>To do this, go to <span class="guihint">Setup &gt; General &gt; Global settings &gt; Execution of checks</span> and go through the list <span class="guihint">Use new service descriptions</span> and identify the services where the checkboxes are not yet active and activate them.
After applying the changes, the new service descriptions will be active and a few minutes will pass before you see the defined states of the affected services in the monitoring again.</p></div>
</div>
</div>
<div class="sect2">
<h3 id="heading_new_ports">
<span class="hidden-anchor sr-only" id="new_ports"></span>4.3. Ports</h3>
<div class="paragraph"><p>Since Checkmk <span class="new">2.1.0</span>, hosts need access to the following ports on the Checkmk server to perform <a href="wato_monitoringagents.html#agents">TLS registration</a>: port 443 (80 respectively) for REST API requests and port 8000 for the Agent Receiver.
If security policies speak against making these ports available, you can perform a <a href="agent_linux.html#proxyregister">registration by proxy</a> directly on the Checkmk server when using <a href="glossar.html#pull_mode">pull mode</a>.</p></div>
<div class="paragraph"><p>To use the Cloud Edition’s <a href="glossar.html#push_mode">push mode</a> introduced in Checkmk <span class="new">2.2.0</span>, port 8000 of the Checkmk server must be accessible from the monitored host.</p></div>
</div>
<div class="sect2">
<h3 id="heading_certificate_lifetime">
<span class="hidden-anchor sr-only" id="certificate_lifetime"></span>4.4. Agent Controller certificate lifetime</h3>
<div class="paragraph"><p>Checkmk <span class="new">2.1.0</span> used certificates with de facto unlimited validity to establish the TLS connection.
In Checkmk <span class="new">2.2.0</span>, the certificate lifetime is customizable and set to a default value of five years (see <a href="https://checkmk.com/werk/14964" target="_blank">Werk #14964</a>).
In addition, a custom <em>Certificate Authority</em> can also be used.
Certificates created before the update to version <span class="new">2.2.0</span> are automatically replaced by newly generated certificates once the maximum runtime has expired.</p></div>
<div class="paragraph"><p>Therefore, update Checkmk <span class="new">2.1.0</span> agents that use the Agent Controller with encryption to the <span class="new">2.2.0</span> agent in a timely manner.</p></div>
<div class="paragraph"><p>In the few cases where updating the agent is not possible — for example, because the operating system version is no longer supported by the <span class="new">2.2.0</span> agent — you must manually <a href="agent_windows.html#registration">re-register</a> affected hosts after the certificate expires.
The same applies if hosts running the <span class="new">2.2.0</span> agent are inactive for a longer period of time.</p></div>
</div>
<div class="sect2">
<h3 id="heading_remove_old_mkps">
<span class="hidden-anchor sr-only" id="remove_old_mkps"></span>4.5. Removing obsolete MKPs</h3>
<div class="paragraph"><p><strong>Does this affect you?</strong>
This will affect you if you have made use of the feature to keep <a href="#mkp_backport">MKPs in differing versions</a>.</p></div>
<div class="paragraph"><p><strong>What do you need to do?</strong>
During the update, incompatible packages will be automatically set to the <span class="guihint">Disabled</span> state, but not completely deleted.
Packages compatible with the new Checkmk version will be automatically enabled, and you will see the <span class="guihint">Enabled (active on this site)</span> state.</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">OMD[mysite]:~$ </span>mkp<span class="tok-w"> </span>list
<span class="tok-go">Name        Version Title        Req. Version Until Version Files State</span>
<span class="tok-go">----------- ------- ------------ ------------ ------------- ----- -----------------------------</span>
<span class="tok-go">hello_world 0.2.1   Hello world! 2.1.0        2.1.99        6     Enabled (active on this site)</span>
<span class="tok-go">hello_world 0.2.0   Hello world! 2.0.0        2.0.99        6     Disabled</span></code></pre></div></div>
<div class="paragraph"><p>Once the functionality of the new packages has been verified and the old ones are no longer needed for reference, you can search for obsolete packages:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">OMD[mysite]:~$ </span>mkp<span class="tok-w"> </span>list<span class="tok-w"> </span><span class="tok-p">|</span><span class="tok-w"> </span>grep<span class="tok-w"> </span>Disabled</code></pre></div></div>
<div class="paragraph"><p>Then uninstall them with <code>mkp remove</code>.</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">OMD[mysite]:~$ </span>mkp<span class="tok-w"> </span>remove<span class="tok-w"> </span>hello_world<span class="tok-w"> </span><span class="tok-m">0</span>.2.0</code></pre></div></div>
</div>
<div class="sect2">
<h3 id="heading_pip3post">
<span class="hidden-anchor sr-only" id="pip3post"></span>4.6. Installing Python modules</h3>
<div class="paragraph"><p><strong>Does this affect you?</strong>
This will only apply to you if you have explicitly installed Python modules for special agents or agent-based check plug-ins that you have written yourself or obtained from the Exchange and have <a href="#pip3">removed</a> these in the course of preparing for the update.</p></div>
<div class="paragraph"><p><strong>What do you need to do?</strong>
First find out whether the previously uninstalled modules have already been delivered with the new Checkmk version, for example:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">OMD[mysite]:~$ </span>pip3<span class="tok-w"> </span>list<span class="tok-w"> </span><span class="tok-p">|</span><span class="tok-w"> </span>grep<span class="tok-w"> </span><span class="tok-s1">'^cryptography'</span></code></pre></div></div>
<div class="paragraph"><p>If the module has already been found, mark it as not required in your notes.
Install the latest version of any modules that are not included:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">OMD[mysite]:~$ </span>pip3<span class="tok-w"> </span>install<span class="tok-w"> </span>ecdsa</code></pre></div></div>
<div class="paragraph"><p>Then test the check plug-ins or special agents that rely on Python modules installed in the site.</p></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="heading_outlook">
<span class="hidden-anchor sr-only" id="outlook"></span>5. The outlook</h2>
<div class="sectionbody">
<div class="paragraph"><p>This chapter covers topics not directly related to the current Checkmk version <span class="new">2.2.0</span>, but to one of its subsequent versions.</p></div>
<div class="sect2">
<h3 id="heading_mod_auth_mellon">
<span class="hidden-anchor sr-only" id="mod_auth_mellon"></span>5.1. Checkmk without the mod_auth_mellon Apache module</h3>
<div class="paragraph"><p><a href="https://github.com/Uninett/mod_auth_mellon" target="_blank">mod_auth_mellon</a> is a software module for Apache that provides services for authentication via the Secure Assertion Markup Language (SAML).
Up until Checkmk version <span class="new">2.1.0</span>, logging into Checkmk via SAML was only possible with the help of mod_auth_mellon.
As of version <span class="new">2.2.0</span>, SAML authentication is built into the Checkmk commercial editions and the configuration is done through the Checkmk user interface, as described in the article on <a href="saml.html#saml_cee">SAML</a>.
SAML authentication via mod_auth_mellon is also still supported in version <span class="new">2.2.0</span>.</p></div>
<div class="paragraph"><p>However, this will change starting with version <span class="new">2.3.0</span> — mod_auth_mellon will then no longer be shipped with the Checkmk software.
If you would like to continue using this approach to SAML authentication from version <span class="new">2.3.0</span> onwards, you will need to install mod_auth_mellon manually.
That said, from version <span class="new">2.3.0</span>, we will no longer provide support for this method.</p></div>
</div>
<div class="sect2">
<h3 id="heading_mk_file_config">
<span class="hidden-anchor sr-only" id="mk_file_config"></span>5.2. No configuration of check plug-in default values with mk files</h3>
<div class="paragraph"><p>In version <span class="new">2.3.0</span> it will no longer be possible to override the default values in check plug-ins or other global variables using mk files.</p></div>
<div class="paragraph"><p>This deprecated method for configuring plug-ins has long been undocumented — and in any case no longer works for all of those plug-ins that have been switched to the <a href="https://docs.checkmk.com/2.1.0/en/update_major.html#check-api">Check API</a> that was introduced with version <span class="new">2.0.0</span>.
Therefore, from version <span class="new">2.3.0</span> configuring check plug-in defaults with mk files is no longer supported.</p></div>
<div class="paragraph"><p>For details and notes on the changeover, see <a href="https://checkmk.com/werk/15250" target="_blank">Werk #15250</a>.</p></div>
</div>
<div class="sect2">
<h3 id="heading_prometheus">
<span class="hidden-anchor sr-only" id="prometheus"></span>5.3. Prometheus checks data sources and settings</h3>
<div class="paragraph"><p>The <a href="monitoring_prometheus.html">Prometheus special agent</a> provides <code>kube-state-metrics</code> as a data source, but its checks are no longer actively supported.
These have since been replaced by improved counterparts in the Kubernetes agent (see <a href="https://checkmk.com/werk/14572" target="_blank">Werk #14572</a>).
In addition, in the <span class="guihint">Prometheus</span> and <span class="guihint">Alertmanager</span> rules, the specification of IP address/host name, port and file path prefix is replaced by a single input field <span class="guihint">Custom URL</span> (see <a href="https://checkmk.com/werk/14573" target="_blank">Werk #14573</a>).</p></div>
<div class="paragraph"><p>In both cases, the old method still works in version <span class="new">2.2.0</span>.
However, to use it in version <span class="new">2.3.0</span>, the configuration must be changed to the new procedure.</p></div>
</div>
</div>
</div>
</div></main><div id="toc" class="toc2">
<div id="toctitle">On this page</div>
<ul class="sectlevel1">
<li><a href="#intro">1. Introduction</a></li>
<li>
<a href="#prep">2. Preparations</a><ul class="sectlevel1">
<li><a href="#backup">2.1. Backup</a></li>
<li><a href="#editions">2.2. Selecting a Checkmk edition</a></li>
<li><a href="#linux_versions">2.3. Linux distribution versions</a></li>
<li><a href="#browser">2.4. Browser support</a></li>
<li><a href="#agentlinux">2.5. The Linux agent</a></li>
<li><a href="#agentwindows">2.6. The Windows agent</a></li>
<li><a href="#bakery_plugins">2.7. Older Bakery plug-ins</a></li>
<li><a href="#python">2.8. Python 3.11</a></li>
<li><a href="#pip3">2.9. Uninstalling Python modules</a></li>
<li><a href="#user_id">2.10. Incompatible user names</a></li>
<li><a href="#pwd_hash">2.11. Insecure hash functions for passwords</a></li>
<li><a href="#zombie14">2.12. Accidentally deactivated notifications</a></li>
<li><a href="#omd_update-apache-config">2.13. Site user and System Apache</a></li>
<li><a href="#rest-api">2.14. REST API replaces Web API</a></li>
<li><a href="#kubernetes">2.15. Kubernetes monitoring</a></li>
<li><a href="#nsca">2.16. NSCA</a></li>
<li><a href="#local_files">2.17. Non-packaged local files</a></li>
<li><a href="#apis">2.18. Programming interfaces</a></li>
<li>
<a href="#incompatible_mkps">2.19. Incompatible and obsolete MKPs</a><ul class="sectlevel2"><li><a href="#mkp_backport">MKP management for different Checkmk versions</a></li></ul>
</li>
<li><a href="#incompatible">2.20. Incompatible changes</a></li>
</ul>
</li>
<li>
<a href="#update">3. Update</a><ul class="sectlevel1">
<li>
<a href="#dry_run">3.1. Best practices when updating</a><ul class="sectlevel2">
<li><a href="#update_patch">Update the Checkmk version</a></li>
<li><a href="#_perform_a_test_run_of_the_update">Perform a test run of the update</a></li>
<li><a href="#automatic_agent_updates">Temporarily disable agent updates</a></li>
<li><a href="#notifications">Temporarily disable notifications</a></li>
</ul>
</li>
<li>
<a href="#update_distributed_monitoring">3.2. Updates in distributed monitoring</a><ul class="sectlevel2"><li><a href="#dist_setup">MKPs in a distributed setup</a></li></ul>
</li>
<li><a href="#_performing_the_update">3.3. Performing the update</a></li>
<li><a href="#cfe2cce">3.4. Upgrading to the Cloud Edition</a></li>
</ul>
</li>
<li>
<a href="#follow-up">4. Follow-ups</a><ul class="sectlevel1">
<li>
<a href="#gui">4.1. Changes to the user interface</a><ul class="sectlevel2"><li><a href="#favorites">The 'Favorites' have been removed</a></li></ul>
</li>
<li>
<a href="#service_discovery">4.2. Updating services</a><ul class="sectlevel2"><li><a href="#service_descriptions">Service descriptions</a></li></ul>
</li>
<li><a href="#new_ports">4.3. Ports</a></li>
<li><a href="#certificate_lifetime">4.4. Agent Controller certificate lifetime</a></li>
<li><a href="#remove_old_mkps">4.5. Removing obsolete MKPs</a></li>
<li><a href="#pip3post">4.6. Installing Python modules</a></li>
</ul>
</li>
<li>
<a href="#outlook">5. The outlook</a><ul class="sectlevel1">
<li><a href="#mod_auth_mellon">5.1. Checkmk without the mod_auth_mellon Apache module</a></li>
<li><a href="#mk_file_config">5.2. No configuration of check plug-in default values with mk files</a></li>
<li><a href="#prometheus">5.3. Prometheus checks data sources and settings</a></li>
</ul>
</li>
</ul>
</div>
<script src="../../assets/js/manifest.js?id=7db827d654313dce4250"></script>
<script src="../../assets/js/vendor.js?id=581a3d4a61b7156d04df"></script>
<script src="../../assets/js/app.js?id=959ccd04b1f8b7b78c5e"></script>
<script src="../../assets/js/lunr.js"></script>
<script src="../../assets/js/lunr.stemmer.support.js"></script>
<script src="../lunr.index.en.js"></script>
<script src="../../assets/js/lunr.client.js"></script>
</body>
</html>
