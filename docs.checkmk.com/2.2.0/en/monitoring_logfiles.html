<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]--><meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<link rel="icon" href="/favicon.png">
<meta name="robots" content="noindex">
<meta name="description" content="In Checkmk you can monitor log files using the agent plugin Logwatch.">
<meta name="og:locale" content="en">
<meta name="og:site_name" content="Checkmk Docs">
<meta name="og:title" content="Monitoring log files">
<meta name="og:description" content="In Checkmk you can monitor log files using the agent plugin Logwatch.">
<meta name="og:image" content="https://docs.checkmk.com/assets/images/share_image.png">
<meta name="twitter:site" content="@checkmk">
<meta name="twitter:creator" content="@checkmk">
<title>Monitoring log files</title>
<link rel="stylesheet" href="../../assets/css/checkmk.css?id=4473d2acbb1ea6136428">
<link rel="stylesheet" href="../../assets/css/pygments-monokai.css">
<link rel="stylesheet" href="../../assets/css/addons.css">
<link rel="stylesheet" href="../../assets/css/SourceCodePro.css">
<link rel="search" href="./opensearch.xml" type="application/opensearchdescription+xml" title="Search docs.checkmk.com">
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-NJ3VGL8');</script>
<!-- End Google Tag Manager --><style>
#staticinfo { font-style: italic; }
</style>
</head>
<body class="article toc2 toc-right">
<!-- Cookie Consent (GDPR Compliance) -->

<!-- End Cookie Consent (GDPR Compliance) -->
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NJ3VGL8" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) --><div class="header-top">
<div class="header-top__left">
<a class="header-top__logo d-none d-xl-inline-block" href="/2.2.0/en"><img src="../../assets/images/docs_logo.png" alt="Checkmk"></a><a class="header-top__icon d-inline-block d-xl-none" href="/2.2.0/en"><img src="../../assets/images/logo_icon.svg" alt="Checkmk"></a>
</div>
<div class="header-top__center">
<input type="text" class="header-top__search" placeholder="Search the checkmk docs"><div class="header-top__search__results"></div>
</div>
<div class="header-top__right d-block">
<button class="header-top__search__toggle d-inline-block d-md-none"><img class="header-top__search__toggle__icon" src="../../assets/images/search.svg" alt="Search"></button><div class="dropdown dropdown__language">
                    <button class="btn dropdown-toggle" type="button" id="languageMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">en</button>
                    <div class="dropdown-menu  dropdown-menu-right" aria-labelledby="languageMenuButton"><a class="dropdown-item" href="../../2.2.0/de/monitoring_logfiles.html">Deutsch</a></div>
</div>
<div class="dropdown dropdown__branch">
                        <button class="btn dropdown-toggle" type="button" id="branchMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">2.2.0</button>
                        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="branchMenuButton">
<a class="dropdown-item" href="../../2.1.0/en/monitoring_logfiles.html">2.1.0</a><a class="dropdown-item" href="../../latest/en/monitoring_logfiles.html">latest (2.3.0)</a>
</div>
</div>
<a class="header-top__back d-none d-lg-inline-block" href="https://checkmk.com">to checkmk.com</a><button class="header-top__toggle d-inline-block d-lg-none"><span class="header-top__toggle__icon"></span></button>
</div>
</div>
<aside><div class="main-nav">
<div class="main-nav__content"><div id="content">
<div class="sect1">
<h2 id="_welcome_to_checkmk">
<a class="anchor" href="#_welcome_to_checkmk"></a>1. Welcome to Checkmk</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="welcome.html">Welcome to the Checkmk User Guide</a></p>
</li>
<li>
<p><a href="release_notes.html">Release notes</a></p>
</li>
<li>
<p><a href="glossar.html">Glossary</a></p>
</li>
<li>
<p><a href="search.html">Searching docs.checkmk.com</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_beginners_guide">
<a class="anchor" href="#_beginners_guide"></a>2. Beginnerâ€™s Guide</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="intro_setup.html">Setting up Checkmk</a></p>
</li>
<li>
<p><a href="intro_gui.html">The Checkmk user interface</a></p>
</li>
<li>
<p><a href="intro_setup_monitor.html">Setting up monitoring</a></p>
</li>
<li>
<p><a href="intro_tools.html">The monitoring tools</a></p>
</li>
<li>
<p><a href="intro_monitor.html">Checkmk in monitoring</a></p>
</li>
<li>
<p><a href="intro_finetune.html">Fine-tuning the monitoring</a></p>
</li>
<li>
<p><a href="intro_users.html">Working with multiple users</a></p>
</li>
<li>
<p><a href="intro_notifications.html">Switching on notifications</a></p>
</li>
<li>
<p><a href="intro_extend.html">Extending the monitoring system further</a></p>
</li>
<li>
<p><a href="intro_bestpractise.html">Best practices, tips &amp; tricks</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_installation">
<a class="anchor" href="#_installation"></a>3. Installation</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="install_packages.html">Basic information on the installation of Checkmk</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_server_and_vms">
<a class="anchor" href="#_server_and_vms"></a>3.1. Server and VMs</h3>
<div class="ulist">
<ul>
<li>
<p><a href="install_packages_debian.html">Installation on Debian and Ubuntu</a></p>
</li>
<li>
<p><a href="install_packages_redhat.html">Installation on Red Hat and derivatives</a></p>
</li>
<li>
<p><a href="install_packages_sles.html">Installation on SUSE Linux Enterprise Server</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_appliance_container_cloud">
<a class="anchor" href="#_appliance_container_cloud"></a>3.2. Appliance, container, cloud</h3>
<div class="ulist">
<ul>
<li>
<p><a href="install_appliance_cmk.html">Installation of Checkmk in the appliance</a></p>
</li>
<li>
<p><a href="introduction_docker.html">Installation as a Docker container</a></p>
</li>
<li>
<p><a href="install_azure.html">Installation from Azure Marketplace</a></p>
</li>
<li>
<p><a href="install_aws.html">Installation from AWS Marketplace</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_updates">
<a class="anchor" href="#_updates"></a>3.3. Updates</h3>
<div class="ulist">
<ul>
<li>
<p><a href="update.html">Updates and Upgrades</a></p>
</li>
<li>
<p><a href="update_major.html">Update to version <span class="new">2.2.0</span></a></p>
</li>
<li>
<p><a href="update_matrix.html">Update matrix for version <span class="new">2.2.0</span></a></p>
</li>
<li>
<p><a href="release_upgrade.html">Linux upgrade on the Checkmk server</a></p>
</li>
<li>
<p><a href="cmk_versions.html">Checkmk versions</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_administration_of_checkmk">
<a class="anchor" href="#_administration_of_checkmk"></a>4. Administration of Checkmk</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_server">
<a class="anchor" href="#_server"></a>4.1. Server</h3>
<div class="ulist">
<ul>
<li>
<p><a href="saml.html">Authentication with SAML</a></p>
</li>
<li>
<p><a href="kerberos.html">Single sign-on with Kerberos</a></p>
</li>
<li>
<p><a href="managing_docker.html">Checkmk server in a Docker container</a></p>
</li>
<li>
<p><a href="security.html">Security</a></p>
</li>
<li>
<p><a href="ports.html">Ports</a></p>
</li>
<li>
<p><a href="omd_https.html">Securing the web interface with HTTPS</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_sites">
<a class="anchor" href="#_sites"></a>4.2. Sites</h3>
<div class="ulist">
<ul>
<li>
<p><a href="omd_basics.html">Site administration with omd</a></p>
</li>
<li>
<p><a href="cmk_commandline.html">Checkmk on the command line</a></p>
</li>
<li>
<p><a href="license.html">Managing licenses</a></p>
</li>
<li>
<p><a href="distributed_monitoring.html">Distributed monitoring</a></p>
</li>
<li>
<p><a href="backup.html">Backups</a></p>
</li>
<li>
<p><a href="password_store.html">Password store</a></p>
</li>
<li>
<p><a href="analyze_configuration.html">Analyzing the Checkmk site configuration</a></p>
</li>
<li>
<p><a href="mkps.html">Checkmk extension packages (MKPs)</a></p>
</li>
<li>
<p><a href="mkp_viewables.html">MKPs for GUI extensions</a></p>
</li>
<li>
<p><a href="simulation_mode.html">Simulation mode</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_configuration">
<a class="anchor" href="#_configuration"></a>5. Configuration</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="wato.html">Configuring Checkmk</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_hosts">
<a class="anchor" href="#_hosts"></a>5.1. Hosts</h3>
<div class="ulist">
<ul>
<li>
<p><a href="hosts_setup.html">Host administration</a></p>
</li>
<li>
<p><a href="hosts_structure.html">Host structuring</a></p>
</li>
<li>
<p><a href="host_tags.html">Host tags</a></p>
</li>
<li>
<p><a href="dcd.html">Dynamic host configuration</a></p>
</li>
<li>
<p><a href="hosts_autoregister.html">Automated host creation</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_services">
<a class="anchor" href="#_services"></a>5.2. Services</h3>
<div class="ulist">
<ul>
<li>
<p><a href="wato_services.html">Understanding and configuring services</a></p>
</li>
<li>
<p><a href="clustered_services.html">Monitoring cluster services</a></p>
</li>
<li>
<p><a href="piggyback.html">The piggyback mechanism</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_rules">
<a class="anchor" href="#_rules"></a>5.3. Rules</h3>
<div class="ulist">
<ul>
<li>
<p><a href="wato_rules.html">Rules</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_supporting_configurations">
<a class="anchor" href="#_supporting_configurations"></a>5.4. Supporting configurations</h3>
<div class="ulist">
<ul>
<li>
<p><a href="timeperiods.html">Time periods</a></p>
</li>
<li>
<p><a href="labels.html">Labels</a></p>
</li>
<li>
<p><a href="regexes.html">Regular expressions in Checkmk</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_users_and_permissions">
<a class="anchor" href="#_users_and_permissions"></a>5.5. Users and permissions</h3>
<div class="ulist">
<ul>
<li>
<p><a href="wato_user.html">Users, roles and permissions</a></p>
</li>
<li>
<p><a href="ldap.html">User management with LDAP/Active Directory</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_notifications">
<a class="anchor" href="#_notifications"></a>5.6. Notifications</h3>
<div class="ulist">
<ul>
<li>
<p><a href="notifications.html">Notifications</a></p>
</li>
<li>
<p><a href="notifications_webex.html">Notifications via Cisco Webex Teams</a></p>
</li>
<li>
<p><a href="notifications_ilert.html">Notifications via ilert</a></p>
</li>
<li>
<p><a href="notifications_jira.html">Notifications via Jira</a></p>
</li>
<li>
<p><a href="notifications_mattermost.html">Notifications via Mattermost</a></p>
</li>
<li>
<p><a href="notifications_teams.html">Notifications via Microsoft Teams</a></p>
</li>
<li>
<p><a href="notifications_pagerduty.html">Notifications via PagerDuty</a></p>
</li>
<li>
<p><a href="notifications_pushover.html">Notifications via Pushover</a></p>
</li>
<li>
<p><a href="notifications_opsgenie.html">Notifications via Opsgenie</a></p>
</li>
<li>
<p><a href="notifications_servicenow.html">Notifications via ServiceNow</a></p>
</li>
<li>
<p><a href="notifications_slack.html">Notifications via Slack</a></p>
</li>
<li>
<p><a href="notifications_splunkoncall.html">Notifications via Splunk On-Call</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_events">
<a class="anchor" href="#_events"></a>5.7. Events</h3>
<div class="ulist">
<ul>
<li>
<p><a href="ec.html">The Event Console</a></p>
</li>
<li>
<p><a href="alert_handlers.html">Alert handlers</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_monitoring_systems">
<a class="anchor" href="#_monitoring_systems"></a>6. Monitoring systems</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="wato_monitoringagents.html">Monitoring agents</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_checkmk_agents_and_snmp">
<a class="anchor" href="#_checkmk_agents_and_snmp"></a>6.1. Checkmk agents and SNMP</h3>
<div class="ulist">
<ul>
<li>
<p><a href="agent_deployment.html">Automatic agent updates</a></p>
</li>
<li>
<p><a href="agent_linux.html">Monitoring Linux</a></p>
</li>
<li>
<p><a href="agent_linux_legacy.html">Monitoring Linux in legacy mode</a></p>
</li>
<li>
<p><a href="agent_windows.html">Monitoring Windows</a></p>
</li>
<li>
<p><a href="agent_freebsd.html">Monitoring FreeBSD</a></p>
</li>
<li>
<p><a href="snmp.html">Monitoring via SNMP</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_agent_extensions">
<a class="anchor" href="#_agent_extensions"></a>6.2. Agent extensions</h3>
<div class="ulist">
<ul>
<li>
<p><a href="inventory.html">The HW/SW inventory</a></p>
</li>
<li>
<p><a href="mk_filestats.html">Monitoring files</a></p>
</li>
<li>
<p><a href="monitoring_logfiles.html">Monitoring log files</a></p>
</li>
<li>
<p><a href="monitoring_oracle.html">Monitoring Oracle databases</a></p>
</li>
<li>
<p><a href="monitoring_mysql.html">Monitoring MySQL</a></p>
</li>
<li>
<p><a href="monitoring_mssql.html">Monitoring MSSQL</a></p>
</li>
<li>
<p><a href="monitoring_jobs.html">Monitoring time-based processes (Cronjobs)</a></p>
</li>
<li>
<p><a href="spool_directory.html">The spool directory</a></p>
</li>
<li>
<p><a href="localchecks.html">Local checks</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_vm_cloud_container">
<a class="anchor" href="#_vm_cloud_container"></a>6.3. VM, cloud, container</h3>
<div class="ulist">
<ul>
<li>
<p><a href="datasource_programs.html">Datasource programs</a></p>
</li>
<li>
<p><a href="monitoring_vmware.html">Monitoring VMware ESXi</a></p>
</li>
<li>
<p><a href="monitoring_aws.html">Monitoring Amazon Web Services (AWS)</a></p>
</li>
<li>
<p><a href="monitoring_azure.html">Monitoring Microsoft Azure</a></p>
</li>
<li>
<p><a href="monitoring_gcp.html">Monitoring Google Cloud Platform (GCP)</a></p>
</li>
<li>
<p><a href="monitoring_kubernetes.html">Monitoring Kubernetes</a></p>
</li>
<li>
<p><a href="monitoring_openshift.html">Monitoring OpenShift</a></p>
</li>
<li>
<p><a href="monitoring_docker.html">Monitoring Docker</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_endpoints">
<a class="anchor" href="#_endpoints"></a>6.4. Endpoints</h3>
<div class="ulist">
<ul>
<li>
<p><a href="active_checks.html">Monitoring network services (Active checks)</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_dashboards_views_metrics">
<a class="anchor" href="#_dashboards_views_metrics"></a>7. Dashboards, views, metrics</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="user_interface.html">The user interface</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_general">
<a class="anchor" href="#_general"></a>7.1. General</h3>
<div class="ulist">
<ul>
<li>
<p><a href="views.html">Host and service views</a></p>
</li>
<li>
<p><a href="dashboards.html">Dashboards</a></p>
</li>
<li>
<p><a href="graphing.html">Measured values and graphing</a></p>
</li>
<li>
<p><a href="custom_notes.html">Custom notes</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_commands_in_views">
<a class="anchor" href="#_commands_in_views"></a>7.2. Commands in views</h3>
<div class="ulist">
<ul>
<li>
<p><a href="commands.html">Commands</a></p>
</li>
<li>
<p><a href="basics_ackn.html">Acknowledging problems</a></p>
</li>
<li>
<p><a href="basics_downtimes.html">Scheduled downtimes</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_analysis_and_prognosis">
<a class="anchor" href="#_analysis_and_prognosis"></a>8. Analysis and prognosis</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_analysis">
<a class="anchor" href="#_analysis"></a>8.1. Analysis</h3>
<div class="ulist">
<ul>
<li>
<p><a href="availability.html">Availability</a></p>
</li>
<li>
<p><a href="sla.html">Extended availability (SLAs)</a></p>
</li>
<li>
<p><a href="bi.html">Business Intelligence (BI)</a></p>
</li>
<li>
<p><a href="reporting.html">Reports</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_prognosis">
<a class="anchor" href="#_prognosis"></a>8.2. Prognosis</h3>
<div class="ulist">
<ul>
<li>
<p><a href="predictive_monitoring.html">Predictive monitoring</a></p>
</li>
<li>
<p><a href="forecast_graphs.html">Forecast graphs</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_connection_of_other_applications">
<a class="anchor" href="#_connection_of_other_applications"></a>9. Connection of other applications</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="monitoring_prometheus.html">Integrating Prometheus</a></p>
</li>
<li>
<p><a href="integrating_datadog.html">Integrating Datadog</a></p>
</li>
<li>
<p><a href="nagvis.html">NagVis: status data on maps and diagrams</a></p>
</li>
<li>
<p><a href="ntop.html">Integrating ntopng in Checkmk</a></p>
</li>
<li>
<p><a href="grafana.html">Integrating Checkmk in Grafana</a></p>
</li>
<li>
<p><a href="metrics_exporter.html">Sending metrics to InfluxDB and Graphite</a></p>
</li>
<li>
<p><a href="nagstamon.html">Integrating Checkmk in Nagstamon</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_specifics_to_the_editions">
<a class="anchor" href="#_specifics_to_the_editions"></a>10. Specifics to the editions</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="cse.html">The Standard Edition</a></p>
</li>
<li>
<p><a href="cce.html">The Cloud Edition</a></p>
</li>
<li>
<p><a href="managed.html">The Managed Services Edition</a></p>
</li>
<li>
<p><a href="support_diagnostics.html">Support diagnostics</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_automation_and_development">
<a class="anchor" href="#_automation_and_development"></a>11. Automation and development</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_apis_for_automation">
<a class="anchor" href="#_apis_for_automation"></a>11.1. APIs for automation</h3>
<div class="ulist">
<ul>
<li>
<p><a href="rest_api.html">The Checkmk REST API</a></p>
</li>
<li>
<p><a href="livestatus.html">Retrieving status data via Livestatus</a></p>
</li>
<li>
<p><a href="livestatus_references.html">Livestatus command reference</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_apis_for_development">
<a class="anchor" href="#_apis_for_development"></a>11.2. APIs for development</h3>
<div class="ulist">
<ul>
<li>
<p><a href="bakery_api.html">The Bakery-API</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_development_of_check_plug_ins">
<a class="anchor" href="#_development_of_check_plug_ins"></a>11.3. Development of check plug-ins</h3>
<div class="ulist">
<ul>
<li>
<p><a href="devel_intro.html">Developing extensions for Checkmk</a></p>
</li>
<li>
<p><a href="devel_check_plugins.html">Writing agent-based check plug-ins</a></p>
</li>
<li>
<p><a href="devel_check_plugins_snmp.html">Writing SNMP-based check plug-ins</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_concepts">
<a class="anchor" href="#_concepts"></a>12. Concepts</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="monitoring_basics.html">Basic principles of monitoring with Checkmk</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_the_checkmk_micro_core_cmc">
<a class="anchor" href="#_the_checkmk_micro_core_cmc"></a>12.1. The Checkmk Micro Core (CMC)</h3>
<div class="ulist">
<ul>
<li>
<p><a href="cmc.html">The Checkmk Micro Core (CMC)</a></p>
</li>
<li>
<p><a href="cmc_differences.html">Special characteristics of the CMC</a></p>
</li>
<li>
<p><a href="cmc_migration.html">Migration to the CMC</a></p>
</li>
<li>
<p><a href="cmc_files.html">CMC files and directories</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_checkmk_appliance">
<a class="anchor" href="#_the_checkmk_appliance"></a>13. The Checkmk appliance</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="appliance_rack1_quick_start.html">Quick start guide for Checkmk racks</a></p>
</li>
<li>
<p><a href="appliance_virt1_quick_start.html">Quick start guide for Checkmk virt1</a></p>
</li>
<li>
<p><a href="appliance_install_virt1.html">Installation of the virtual appliance</a></p>
</li>
<li>
<p><a href="appliance_usage.html">Configuring and using the appliance</a></p>
</li>
<li>
<p><a href="appliance_backup.html">Backup in the appliance</a></p>
</li>
<li>
<p><a href="appliance_cluster.html">Appliance in cluster operation</a></p>
</li>
<li>
<p><a href="appliance_rack_config.html">Special features of the hardware appliance</a></p>
</li>
</ul>
</div>
</div>
</div>
</div></div>
<div class="main-nav__utils">
<div class="dropup dropdown__utils">
<button class="btn dropdown-toggle" type="button" id="aboutMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">About Checkmk</button><div class="dropdown-menu dropup" aria-labelledby="aboutMenuButton">
<a class="dropdown-item" href="https://checkmk.com/product/features" target="_blank">Features</a><a class="dropdown-item" href="https://checkmk.com/product/editions" target="_blank">Editions</a><a class="dropdown-item" href="https://checkmk.com/integrations" target="_blank">Integrations</a><a class="dropdown-item" href="https://checkmk.com/imprint" target="_blank">Imprint</a><a class="dropdown-item" href="copyright.html" target="_blank">Copyright</a>
</div>
</div>
<div class="dropup dropdown__utils">
<button class="btn dropdown-toggle" type="button" id="learnMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Learn</button><div class="dropdown-menu dropup" aria-labelledby="learnMenuButton">
<a class="dropdown-item" href="https://checkmk.com/videos">Videos</a><a class="dropdown-item" href="https://checkmk.com/webinars">Webinars</a><a class="dropdown-item" href="https://checkmk.com/trainings/classes">Trainings</a>
</div>
</div>
<a class="main-nav__utils__link" href="https://forum.checkmk.com">Forum</a>
</div>
</div></aside><main><div id="header">
<h1>Monitoring log files</h1>
<div class="details">
<span id="revdate">draft</span><a class="edit-document" href="https://github.com/Checkmk/checkmk-docs/edit/2.2.0/src/common/en/monitoring_logfiles.asciidoc">Edit this page on GitHub</a>
</div>
</div>
<div id="content">
<div id="preamble">
<div id="staticinfo">This page was exported for offline usage on 2025-01-07 22:12:14 +0000. It may not reflect the current state of the Checkmk documentation. To view a daily updated version, visit <a href="https://docs.checkmk.com/" target="_blank">docs.checkmk.com</a>.</div>
<div class="sectionbody">
<div class="paragraph">
<p></p>
<div class="dropdown dropdown__related">
<button class="btn btn-primary dropdown-toggle" type="button" id="relatedMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Related Articles</button><div class="dropdown-menu dropdown-menu-right" aria-labelledby="relatedMenuButton">
<a href="mk_filestats.html">Monitoring files</a>
<a href="ec.html">The Event Console</a>
</div>
</div>
</div>
<div class="admonitionblock tip"><table><tr>
<td class="icon"><img src="../images/icons/tip.png" alt="Tip"></td>
<td class="content"><div class="paragraph"><p>This article is currently under construction and is being expanded on a regular basis.
Additionally, this is a machine translation based on the German version of the article.</p></div></td>
</tr></table></div>
</div>
</div>
<div class="sect1">
<h2 id="heading_basics">
<span class="hidden-anchor sr-only" id="basics"></span>1. Essentials for monitoring log files</h2>
<div class="sectionbody">
<div class="paragraph"><p>The history of log file monitoring is a history full of misunderstandings.
The misunderstandings already begin when we look at what log entries are and what, on the other hand, services display in Checkmk.
Lines or entries in log files are "by nature" event based. Checkmk, on the other hand, displays states.
Read more about the difference between events and states in the article <a href="monitoring_basics.html#states_events">Basic principles of monitoring with Checkmk - States and events</a>.</p></div>
<div class="paragraph"><p>In Checkmk we circumvent this problem by defining when a service that maps one or more log files assumes a critical state.
As a rule, we define "become critical when the log file contains messages that are</p></div>
<div class="ulist"><ul>
<li><p>new,</p></li>
<li><p>not acknowledged and</p></li>
<li><p>critical".</p></li>
</ul></div>
<div class="paragraph"><p>You should also use moderation when using Logwatch.
Logwatch is suitable for metered use and not for processing gigabytes or terabytes of log files.
There are certainly more suitable tools for this.
We strongly recommend using Logwatch only on an ad hoc basis and not across the board.
As you will see later in the article, it is easy to carry out an important part of the prefiltering on the monitored host.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="heading_prereqisites">
<span class="hidden-anchor sr-only" id="prereqisites"></span>2. Prerequisites</h2>
<div class="sectionbody">
<div class="paragraph"><p>Logwatch is a Python program and therefore requires a Python environment on the host.
Python will already be installed in most Linux distributions and Solaris has also included Python 3.x for some time.
If you want to monitor log files on a Windows host, there are different ways to achieve this.</p></div>
<div class="paragraph"><p><span class="image-inline"><img src="../images/CEE.svg" alt="CEE" class="icon-left"></span>
Users of our commercial editions can configure Logwatch conveniently via the GUI and have the plugin inserted into the agent package with the agent bakery.
As soon as Checkmk notices that you are configuring an agent plugin based on Python for a Windows host, the agent is also given a virtual Python environment (venv).</p></div>
<div class="paragraph"><p>If you are using one of our commercial editions but not the agent bakery, you can consult the following section for your Windows hosts.</p></div>
<div class="sect2">
<h3 id="heading_python_windows">
<span class="hidden-anchor sr-only" id="python_windows"></span>2.1. Python for Windows in Checkmk Raw</h3>
<div class="sect3">
<h4 id="heading_install_python_venv">
<span class="hidden-anchor sr-only" id="install_python_venv"></span>Install Checkmk Python (venv)</h4>
<div class="paragraph"><p>The installation package of the Windows agent from Checkmk Raw does not contain a Python environment.
However, a corresponding cabinet file is already available on your Checkmk server.
You can find this file called <code>python-3.cab</code> in the directory <code>~share/check_mk/agents/windows</code> or in Checkmk via <span class="guihint">Setup &gt; Agents &gt; Windows &gt; Windows Agent</span>.
Copy this file to your Windows host in the directory <code>C:\Program Files (x86)\checkmk\service\install</code>.
There is already a file with this name and a file size of 0 bytes.
You must overwrite this file with the version from the Checkmk server.
Then restart the Checkmk agent service.
In Windows PowerShell with administrator rights, you can do this with the following command:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-go">net stop checkmkservice; net start checkmkservice</span></code></pre></div></div>
<div class="paragraph"><p>When the Windows service is restarted, the virtual Python environment is installed automatically.</p></div>
</div>
<div class="sect3">
<h4 id="heading_install_full_python">
<span class="hidden-anchor sr-only" id="install_full_python"></span>Install Python completely</h4>
<div class="paragraph"><p>Alternatively, you can also download and install a current Python package from <a href="https://www.python.org/">python.org</a>.
Make sure to activate the following options during installation:</p></div>
<div class="ulist"><ul>
<li><p><span class="guihint">Install Python 3.x for all users</span>. This will also automatically activate the <span class="guihint">Precompile standard library</span> option, which is a good thing.</p></li>
<li><p><span class="guihint">Add Python to environment variables</span></p></li>
</ul></div>
<div class="paragraph"><p>If you want to start testing immediately after installing Python, it is essential to restart the <span class="guihint">CheckmkService</span> either via the Windows Task Manager or with the commands specified above.
Otherwise the service will not know about the new environment variables.</p></div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="heading_monitor_logfiles">
<span class="hidden-anchor sr-only" id="monitor_logfiles"></span>3. Monitor log files</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="heading_installation">
<span class="hidden-anchor sr-only" id="installation"></span>3.1. Installation on the host</h3>
<div class="paragraph"><p>Start by installing the agent plugin.
To do this, copy the file <code>~/share/check_mk/agents/plugins/mk_logwatch.py</code> from your Checkmk server to the host in the directory <code>/usr/lib/check_mk_agent/plugins/</code> (Linux) or <code>C:\ProgramData\checkmk\agent\plugins</code> (Windows).
Make sure that the file is executable on the host.
Further information on this step can be found in the section "Manual installation" in the articles <a href="agent_linux.html#manualplugins">Monitor Linux</a> and <a href="agent_windows.html#manual_installation_of_plugins">Monitor Windows</a>.</p></div>
<div class="paragraph"><p><span class="image-inline"><img src="../images/CEE.svg" alt="CEE" class="icon-left"></span>
Users of our commercial editions can select <span class="guihint">Text logfiles (Linux, Solaris, Windows)</span> during <a href="#configuration">Configuration of the rule</a> <span class="guihint">Deploy the Logwatch plugin and its configuration</span> to automatically deploy the agent plugin with the agent.</p></div>
</div>
<div class="sect2">
<h3 id="heading_configuration">
<span class="hidden-anchor sr-only" id="configuration"></span>3.2. Configuration of Logwatch</h3>
<div class="paragraph"><p>In line with the initial considerations, Logwatch does not monitor anything without configuration.
Therefore, after installing the agent plugin, it is essential to create a configuration file for the monitored host.</p></div>
<div class="sect3">
<h4 id="heading_configuration_bakery">
<span class="hidden-anchor sr-only" id="configuration_bakery"></span>Configuration via the Agent Bakery</h4>
<div class="paragraph"><p><span class="image-inline"><img src="../images/CEE.svg" alt="CEE" class="icon-left"></span>
In the commercial editions, first call up the rule for the agent plugin <span class="guihint">Setup &gt; Agents &gt; Windows, Linux, Solaris, AIX &gt; Agent rules &gt; Text logfiles (Linux, Solaris, Windows)</span>.
The default setting <span class="guihint">Deploy the Logwatch plugin and its configuration</span> should normally be left as it is.
However, if you want or need to transfer the configuration file <code>logwatch.cfg</code> to the host in a different way, the option <span class="guihint">Deploy the Logwatch plugin without configuration</span> is still available here.</p></div>
<div class="paragraph"><p>Continue with the option <span class="guihint">Retention period</span>.
The default setting here is one minute, which also corresponds to the preset check interval in Checkmk.
The value should always be at least equal to the check interval.
This option is primarily responsible for ensuring that no log messages are lost due to a service detection or the manual execution of <code>cmk -d myhost</code>.
Further details can be found in the inline help for the option and in the <a href="https://checkmk.com/werk/14451" target="_blank">Werk #14451</a> with which this option was introduced.</p></div>
<div class="paragraph"><p>Now comes the section of the rule where things finally get going - <span class="guihint">Configure a logfile section</span>.
And we start directly with the biggest stumbling block of recent years.
In the <span class="guihint">Patterns for logfiles to monitor</span> field, you have to name the log files that you want to monitor.
You can do this individually and explicitly or with so-called glob patterns (glob for short).
We are using the Python module <code>glob</code> here, for which there is a <a href="https://docs.python.org/3/library/glob.html">detailed documentation</a> on docs.python.org.
However, we would like to provide you with a few helpful examples right here.</p></div>
<div class="paragraph"><p>For example, if you enter <code>/var/log/my.log</code> here, Logwatch will monitor just this one log file.
If you enter <code>/var/log/*log</code> here instead, Logwatch will monitor all files that end with the character string <code>log</code> and are located <strong>directly</strong> in the directory <code>/var/log</code>.
If you want to monitor log files in all direct subdirectories of <code>/var/</code>, you can do this with the following glob, for example: <code>/var/*/*log</code>.
We explicitly <strong>do not</strong> offer the glob <code>**</code> for recursively searching a directory structure here, because we would end up with far too large a hit list far too quickly and leave the actual purpose of Logwatch behind us.</p></div>
<div class="paragraph"><p>The following table gives you a few more helpful examples of how you can use globs to actually monitor the files that require monitoring without having to specify them all individually:</p></div>
<table class="table-responsive table-bordered table tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Glob Pattern</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Explanation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Example</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/var/log/*</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All files in <code>/var/log</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/var/log/mylog</code> <code>/var/log/my.log</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/var/log/*/*</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All files in all direct subdirectories of /var/log/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/var/log/foo/mylog</code> <code>/var/log/bar/mylog</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/var/log/mylog?.log</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All files in <code>/var/log</code> where the name begins with <code>mylog</code>, followed by a singe character and ending in <code>.log</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/var/log/mylog1.log</code> <code>/var/log/mylog9.log</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/var/log/mylog[123].log</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All files in <code>/var/log</code> where the name begins with <code>mylog</code>, followed by either a <code>1</code>, <code>2</code> or <code>3</code> and ending in <code>.log</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/var/log/mylog1.log</code> <code>/var/log/mylog3.log</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph"><p>So when it comes to which files are "matched" in the <strong>first</strong> step, we use <strong>no</strong> regular expressions and this may be enough for you to reach all the files you want.</p></div>
<div class="paragraph"><p>However, if you now need to filter further, you can use the option <span class="guihint">Regular expression for logfile filtering</span> to apply regular expressions to the hits from step 1 in a second step.</p></div>
<div class="paragraph"><p>If you collected all files <code>/var/log/<strong></strong></code> and its direct subdirectories in the first step with <code>/var/log/</code> and <code>/var/log/*/*</code>, you could use the regular expression <code>error.log$|err$</code> to reduce the hit list to all files that end with <code>err.log</code> or <code>err</code>.
Caution: The dot is now an arbitrary character again.
This could, for example, leave the files <code>/var/log/apache2/error.log</code>, <code>/var/log/mail.err</code> and <code>/var/log/cups/error_log</code>.</p></div>
<div class="paragraph"><p>As you can see, we have already provided you with two good and powerful tools for selecting the monitored files, so that Logwatch can also check the other parameters and contents very quickly in the next step using a manageable file list.
You can deepen your knowledge of the latter in the article <a href="regexes.html">regular expressions in Checkmk</a>.</p></div>
<div class="paragraph"><p>With the option <span class="guihint">Restrict the length of the lines</span> you can instruct Logwatch to cut off excessively long lines after the specified number of characters.</p></div>
<div class="paragraph"><p>The following option <span class="guihint">Watch the total size of the log file</span> is useful for recognizing a defective log rotation.
If you set 100 MiB here, you will receive a warning each time a particular log file has grown by the set size again.</p></div>
<div class="paragraph"><p>The maximum number of lines that Logwatch checks per run and file can be restricted with <span class="guihint">Restrict number of processed messages per cycle</span> and with <span class="guihint">Restrict runtime of logfile parsing</span> you can ensure that Logwatch does not spend too long on a single file that may have been flooded with thousands and thousands of new entries since the last check.</p></div>
<div class="paragraph"><p>If you activate one of the latter two options, you must also specify what should happen if the specified limit is exceeded.
With our default setting, the associated service becomes critical and you receive a message that lines have been skipped or that the maximum runtime has been exceeded.</p></div>
<div class="paragraph"><p><span class="guihint">Handling of context messages</span> is an option with which the amount of transferred data <strong>can</strong> become very large very quickly.
So think carefully about whether only the log message that you think should generate a <span class="state2">CRIT</span> or <span class="state1">WARN</span> is important to you, or whether <strong>all</strong> lines that have been added since the last run of Logwatch should be transferred to the Checkmk server.
For small log files that only grow by a few lines every minute, the setting <span class="guihint">Do transfer context</span> is certainly unproblematic.
However, if 50 log files are monitored on a host, which suddenly contain 100,000 new lines with a length of 500 characters, we are already in the gigabyte range.
In such an event, it may be enough to see that a large number of new messages have been added since the last check in order to initiate a check directly on the host concerned.</p></div>
<div class="paragraph"><p>If you do need the context - i.e. the lines before and after the log message that is important to you - you can limit this to a certain amount of lines before and after with the options <span class="guihint">Limit the amount of context data sent to the monitoring server</span>.</p></div>
<div class="paragraph"><p>With <span class="guihint">Limit the amount of data sent to the monitoring server</span> you can limit the size of the transferred data in general.</p></div>
<div class="paragraph"><p><span class="guihint">Process new logfiles from the beginning</span> is switched off by default.
This sometimes leads to astonishment, because Logwatch does not "recognize" problems that are in log files and passes them on to the Checkmk server.
In our opinion, nothing is older than yesterdayâ€™s newspaper and so are the log messages that were already in a log file <strong>before the first run</strong> of Logwatch.
During this very first run, Logwatch does nothing more than note how many lines are already contained in the respective log.
Only during the second run are the files checked for their content - i.e. the newly added lines.</p></div>
<div class="paragraph"><p>Logwatch relies on actually being able to read the log files.
Under the hood, Logwatch goes to great lengths to recognize the coding of each log file.
However, character encoding that are too exotic can lead to problems.
If you can influence the character encoding of the monitored log files, UTF-8 is a very good choice.
If this is not possible and Logwatch does not manage to find out the encoding, you can make an explicit specification with <span class="guihint">Codec that should be used to decode the matching files</span>.</p></div>
<div class="paragraph"><p>With <span class="guihint">Duplicated messages management</span> you can save a bit of bandwidth again and the subsequent output in Checkmk will also be more readable if you activate this option.
If you activate <span class="guihint">Filter out consecutive duplicated messages in the agent output</span>, Logwatch counts how often a line was repeated and writes this accordingly in the output instead of repeating the lines.</p></div>
<div class="paragraph"><p>Finally, the lines in the log files that are of interest to you are now described using a regular expression and assigned a status.
If you want every line containing the word <code>panic</code> to lead to a <span class="state2">CRIT</span> in Checkmk, it is sufficient to enter <code>panic</code> in the <span class="guihint">Pattern(Regex)</span> field after clicking on <span class="guihint">Add message pattern</span> below <span class="guihint">Regular expressions for message classification</span>.
The functions of the other options offered are already described in great detail in the inline help at this point and are not duplicated here.</p></div>
<div class="paragraph"><p>Just this much: The status <span class="guihint">OK</span> may seem confusing at first glance.
It is used to first transfer lines from a log file to the Checkmk server in order to then carry out the final classification.
And this brings us to an important point that shows how flexible Logwatch can be when used correctly.</p></div>
<div class="paragraph"><p>All the options explained in this section become entries in the configuration file already mentioned, which is stored on the respective host.
If you now want to make changes to the classification of certain messages, you may first have to edit the rule, then bake the agent and install it.</p></div>
<div class="paragraph"><p>Alternatively, you can first transfer all interesting messages to the Checkmk server (for example with the status <span class="state0">OK</span>) and then (re-)classify them with the rule <span class="guihint">Logfile patterns</span> on the Checkmk server.
In this way, you can save yourself the trouble of baking and rolling out the new agent and only have to quickly activate the changes once after adjusting the above-mentioned rule accordingly.
You can find out exactly how to do this below in the chapter <a href="#logfile_patterns">Reclassify with logfile patterns</a>.</p></div>
</div>
<div class="sect3">
<h4 id="heading__manual_configuration">
<span class="hidden-anchor sr-only" id="_manual_configuration"></span>Manual configuration</h4>
<div class="paragraph"><p><span class="image-inline"><img src="../images/CRE.svg" alt="CRE" class="icon-left"></span>
In the <span class="image-inline"><img src="../images/icons/CRE.png" alt="CRE" width="20" title="Checkmk Raw Edition"></span> <strong>Checkmk Raw Edition</strong> you configure the agent plugin as usual via a text file.
As a rule, Logwatch searches for a file called <code>logwatch.cfg</code> in the directories <code>/etc/check_mk</code> (Linux) or <code>c:\ProgramData\checkmk\agent\config\</code> (Windows).
An (almost) minimal configuration could look like this:</p></div>
<div class="listingblock">
<div class="title">/etc/check_mk/logwatch.cfg</div>
<div class="content"><pre class="pygments highlight"><code><span></span>"/var/log/my.log" overflow=C nocontext=True
 C a critical message
 W something that should only trigger a warning</code></pre></div>
</div>
<div class="paragraph"><p>First, always enter a glob pattern here, followed by all the options to be applied.
This is followed - with an indentation of one space - by a letter representing the desired status or function and finally a regular expression that is compared with each line of the log file.
With the above configuration, all new lines that have been added to the file <code>/var/log/my.log</code> since the last run of Logwatch would be checked for the two patterns "a critical message" and "something that should only trigger a warning".</p></div>
<div class="paragraph"><p>You can find a very extensive example configuration as an instance user in the file <code>~/share/check_mk/agents/cfg_examples/logwatch.cfg</code>.</p></div>
<div class="paragraph"><p>As all the options that you can specify in such a configuration file have already been explained in the section <a href="#configuration_bakery">Configuration via agent bakery</a>, only a list and reference follows here.
Please refer to the above section for an explanation.</p></div>
<table class="table-responsive table-bordered table tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">option in <code>logwatch.cfg</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">counterpart</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">example</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">remark</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">regex</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Regular expression for logfile filtering</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>regex='error.log$|err$'</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">encoding</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Codec that should be used to decode the matching files</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>encodig=utf-8</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">maxlines</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Restrict number of processed messages per cycle</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>maxlines=500</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">maxtime</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Restrict runtime of logfile parsing</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>maxtime=23</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">overflow</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">In case of an overflow</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>overflow=W</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">maxlinesize</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Restrict the length of the lines</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>maxlinesize=123</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">maxoutputsize</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Limit the amount of data sent to the monitoring server</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>maxoutputsize=10485760</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Size given in byte</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">skipconsecutiveduplicated</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Duplicated messages management</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>skipconsecutiveduplicated=True</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">nocontext</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Handling of context messages</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>nocontext=True</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">maxcontextlines</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Limit the amount of context data sent to the monitoring server</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>maxcontextlines=55,66</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="heading_logfile_grouping">
<span class="hidden-anchor sr-only" id="logfile_grouping"></span>4. Grouping of log files</h2>
<div class="sectionbody">
<div class="paragraph"><p>The check belonging to the agent plug-in called <code>logwatch</code> normally creates a separate service for each log file.
By defining groupings using the <span class="guihint">Logfile Grouping</span> rule, you can switch to the <code>logwatch_groups</code> check.</p></div>
<div class="paragraph"><p>Further information will follow soon. Until then, please consult the inline help of the rule <span class="guihint">Logfile Grouping.</span></p></div>
</div>
</div>
<div class="sect1">
<h2 id="heading_logfile_patterns">
<span class="hidden-anchor sr-only" id="logfile_patterns"></span>5. Reclassify with logfile patterns</h2>
<div class="sectionbody"><div class="paragraph"><p>This section will follow soon. Until then, please consult the inline help of the rule <span class="guihint">Logfile patterns.</span></p></div></div>
</div>
<div class="sect1">
<h2 id="heading__forwarding_to_the_event_console">
<span class="hidden-anchor sr-only" id="_forwarding_to_the_event_console"></span>6. Forwarding to the Event Console</h2>
<div class="sectionbody"><div class="paragraph"><p>In addition to the direct processing of log messages in Checkmk and a possible reclassification with the rule <span class="guihint">Logfile patterns</span>, there is also the option of forwarding log lines obtained by Logwatch to the Event Console.
This is done using the rule <span class="guihint">Logwatch Event Console Forwarding</span> and is described in the article <a href="ec.html#logwatch">The Event Console</a>.</p></div></div>
</div>
<div class="sect1">
<h2 id="heading__logwatch_in_monitoring">
<span class="hidden-anchor sr-only" id="_logwatch_in_monitoring"></span>7. Logwatch in monitoring</h2>
<div class="sectionbody">
<div class="paragraph"><p>In monitoring, the display differs depending on the check plug-in used.</p></div>
<div class="paragraph"><p>If you use either <code>logwatch</code> or <code>logwatch_groups</code>, you will find - after the necessary service detection - one service per log file or per grouping of log files (see <a href="#logfile_grouping">Grouping of log files</a>) that begins with <code>Log</code>.
This is followed by the full path of the file or the group name.</p></div>
<div class="paragraph"><p>If you forward your log messages to the Event Console, you will see one service per forwarding, depending on the setting of the rule <span class="guihint">Logwatch Event Console Forwarding</span>, which informs you about the number of forwarded log messages.
In the case of bundled forwarding by the <code>logwatch_ec</code> plugin, this service is called <span class="guihint">Log Forwarding</span>.
If you use the <span class="guihint">Seperate check</span> option and thus the <code>logwatch_ec_single</code> plugin, the service name also starts with <code>Log</code> followed by the path of the log file.
This service also informs you of the number of messages forwarded and if a log file cannot be read.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="heading_files">
<span class="hidden-anchor sr-only" id="files"></span>8. Files and directories</h2>
<div class="sectionbody">
<div class="paragraph"><p>All paths for the Checkmk server are specified relative to the instance directory (e.g. <code>/omd/sites/mysite</code>).</p></div>
<table class="table-responsive table-bordered table tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 15%;">
<col style="width: 39%;">
<col style="width: 46%;">
</colgroup>
<thead><tr>
<th class="tableblock halign-left valign-top">location</th>
<th class="tableblock halign-left valign-top">path</th>
<th class="tableblock halign-left valign-top">meaning</th>
</tr></thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Checkmk server</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>~/share/check_mk/agents/cfg_examples/logwatch.cfg</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">example configuration file</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Checkmk server</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>~/share/check_mk/agents/plugins/mk_logwatch.py</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Python 3 agent plugin including explanations</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Checkmk server</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>~/share/check_mk/agents/plugins/mk_logwatch_2.py</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Python 2 agent plugin including explanations</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Linux host</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/etc/check_mk/logwatch.cfg</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configuration file - created by the agent bakery or manually</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Linux host</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/var/lib/check_mk_agent/logwatch.state.*</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">State files of mk_logwatch</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Linux host</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/var/lib/check_mk_agent/logwatch-batches/*</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Location of the individual batches that mk_logwatch creates per query</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Windows host</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>c:\ProgramData\checkmk\agent\config\logwatch.cfg</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configuration file - created by the agent bakery or manually</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Windows host</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>c:\ProgramData\checkmk\agent\state</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Storage location for the state files of mk_logwatch</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Windows host</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>c:\ProgramData\checkmk\agent\state\logwatch-batches</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Storage location of the individual batches that mk_logwatch creates per query</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div></main><div id="toc" class="toc2">
<div id="toctitle">On this page</div>
<ul class="sectlevel1">
<li><a href="#basics">1. Essentials for monitoring log files</a></li>
<li>
<a href="#prereqisites">2. Prerequisites</a><ul class="sectlevel1"><li>
<a href="#python_windows">2.1. Python for Windows in Checkmk Raw</a><ul class="sectlevel2">
<li><a href="#install_python_venv">Install Checkmk Python (venv)</a></li>
<li><a href="#install_full_python">Install Python completely</a></li>
</ul>
</li></ul>
</li>
<li>
<a href="#monitor_logfiles">3. Monitor log files</a><ul class="sectlevel1">
<li><a href="#installation">3.1. Installation on the host</a></li>
<li>
<a href="#configuration">3.2. Configuration of Logwatch</a><ul class="sectlevel2">
<li><a href="#configuration_bakery">Configuration via the Agent Bakery</a></li>
<li><a href="#_manual_configuration">Manual configuration</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#logfile_grouping">4. Grouping of log files</a></li>
<li><a href="#logfile_patterns">5. Reclassify with logfile patterns</a></li>
<li><a href="#_forwarding_to_the_event_console">6. Forwarding to the Event Console</a></li>
<li><a href="#_logwatch_in_monitoring">7. Logwatch in monitoring</a></li>
<li><a href="#files">8. Files and directories</a></li>
</ul>
</div>
<script src="../../assets/js/manifest.js?id=7db827d654313dce4250"></script>
<script src="../../assets/js/vendor.js?id=581a3d4a61b7156d04df"></script>
<script src="../../assets/js/app.js?id=959ccd04b1f8b7b78c5e"></script>
<script src="../../assets/js/lunr.js"></script>
<script src="../../assets/js/lunr.stemmer.support.js"></script>
<script src="../lunr.index.en.js"></script>
<script src="../../assets/js/lunr.client.js"></script>
</body>
</html>
