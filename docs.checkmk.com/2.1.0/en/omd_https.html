<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]--><meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<link rel="icon" href="/favicon.png">
<meta name="robots" content="noindex">
<meta name="description" content="For security reasons, web interfaces should only be operated over HTTPS. Learn how to enable encryption for a Checkmk site.">
<meta name="og:locale" content="en">
<meta name="og:site_name" content="Checkmk Docs">
<meta name="og:title" content="Securing the web interface with HTTPS">
<meta name="og:description" content="For security reasons, web interfaces should only be operated over HTTPS. Learn how to enable encryption for a Checkmk site.">
<meta name="og:image" content="https://docs.checkmk.com/assets/images/share_image.png">
<meta name="twitter:site" content="@checkmk">
<meta name="twitter:creator" content="@checkmk">
<title>Securing the web interface with HTTPS</title>
<link rel="stylesheet" href="../../assets/css/checkmk.css?id=4473d2acbb1ea6136428">
<link rel="stylesheet" href="../../assets/css/pygments-monokai.css">
<link rel="stylesheet" href="../../assets/css/addons.css">
<link rel="stylesheet" href="../../assets/css/SourceCodePro.css">
<link rel="search" href="./opensearch.xml" type="application/opensearchdescription+xml" title="Search docs.checkmk.com">
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-NJ3VGL8');</script>
<!-- End Google Tag Manager --><style>
#staticinfo { font-style: italic; }
</style>
</head>
<body class="article toc2 toc-right">
<!-- Cookie Consent (GDPR Compliance) -->

<!-- End Cookie Consent (GDPR Compliance) -->
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NJ3VGL8" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) --><div class="header-top">
<div class="header-top__left">
<a class="header-top__logo d-none d-xl-inline-block" href="/2.1.0/en"><img src="../../assets/images/docs_logo.png" alt="Checkmk"></a><a class="header-top__icon d-inline-block d-xl-none" href="/2.1.0/en"><img src="../../assets/images/logo_icon.svg" alt="Checkmk"></a>
</div>
<div class="header-top__center">
<input type="text" class="header-top__search" placeholder="Search the checkmk docs"><div class="header-top__search__results"></div>
</div>
<div class="header-top__right d-block">
<button class="header-top__search__toggle d-inline-block d-md-none"><img class="header-top__search__toggle__icon" src="../../assets/images/search.svg" alt="Search"></button><div class="dropdown dropdown__language">
                    <button class="btn dropdown-toggle" type="button" id="languageMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">en</button>
                    <div class="dropdown-menu  dropdown-menu-right" aria-labelledby="languageMenuButton"><a class="dropdown-item" href="../../2.1.0/de/omd_https.html">Deutsch</a></div>
</div>
<div class="dropdown dropdown__branch">
                        <button class="btn dropdown-toggle" type="button" id="branchMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">2.1.0</button>
                        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="branchMenuButton">
<a class="dropdown-item" href="../../2.2.0/en/omd_https.html">2.2.0</a><a class="dropdown-item" href="../../latest/en/omd_https.html">latest (2.3.0)</a>
</div>
</div>
<a class="header-top__back d-none d-lg-inline-block" href="https://checkmk.com">to checkmk.com</a><button class="header-top__toggle d-inline-block d-lg-none"><span class="header-top__toggle__icon"></span></button>
</div>
</div>
<aside><div class="main-nav">
<div class="main-nav__content"><div id="content">
<div class="sect1">
<h2 id="_welcome_to_checkmk">
<a class="anchor" href="#_welcome_to_checkmk"></a>1. Welcome to Checkmk</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="welcome.html">Welcome to the Checkmk User Guide</a></p>
</li>
<li>
<p><a href="glossar.html">Glossary</a></p>
</li>
<li>
<p><a href="search.html">Searching docs.checkmk.com</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_beginners_guide">
<a class="anchor" href="#_beginners_guide"></a>2. Beginner’s Guide</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="intro_setup.html">Setting up Checkmk</a></p>
</li>
<li>
<p><a href="intro_gui.html">The Checkmk user interface</a></p>
</li>
<li>
<p><a href="intro_setup_monitor.html">Setting up monitoring</a></p>
</li>
<li>
<p><a href="intro_tools.html">The monitoring tools</a></p>
</li>
<li>
<p><a href="intro_monitor.html">Checkmk in monitoring</a></p>
</li>
<li>
<p><a href="intro_finetune.html">Fine-tuning the monitoring</a></p>
</li>
<li>
<p><a href="intro_users.html">Working with multiple users</a></p>
</li>
<li>
<p><a href="intro_notifications.html">Switching on notifications</a></p>
</li>
<li>
<p><a href="intro_extend.html">Extending the monitoring system further</a></p>
</li>
<li>
<p><a href="intro_bestpractise.html">Best practices, tips &amp; tricks</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_installation">
<a class="anchor" href="#_installation"></a>3. Installation</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="install_packages.html">Basic information on the installation of Checkmk</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_server_and_vms">
<a class="anchor" href="#_server_and_vms"></a>3.1. Server and VMs</h3>
<div class="ulist">
<ul>
<li>
<p><a href="install_packages_debian.html">Installation on Debian and Ubuntu</a></p>
</li>
<li>
<p><a href="install_packages_redhat.html">Installation on Red Hat and CentOS</a></p>
</li>
<li>
<p><a href="install_packages_sles.html">Installation on SUSE Linux Enterprise Server</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_appliance_container_cloud">
<a class="anchor" href="#_appliance_container_cloud"></a>3.2. Appliance, container, cloud</h3>
<div class="ulist">
<ul>
<li>
<p><a href="install_appliance_cmk.html">Installation of Checkmk in the appliance</a></p>
</li>
<li>
<p><a href="introduction_docker.html">Installation as a Docker container</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_updates">
<a class="anchor" href="#_updates"></a>3.3. Updates</h3>
<div class="ulist">
<ul>
<li>
<p><a href="update.html">Updates and upgrades</a></p>
</li>
<li>
<p><a href="update_major.html">Update to version <span class="new">2.1.0</span></a></p>
</li>
<li>
<p><a href="update_matrix.html">Update matrix for version <span class="new">2.1.0</span></a></p>
</li>
<li>
<p><a href="release_upgrade.html">Linux upgrade on the Checkmk server</a></p>
</li>
<li>
<p><a href="cmk_versions.html">Checkmk versions</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_administration_of_checkmk">
<a class="anchor" href="#_administration_of_checkmk"></a>4. Administration of Checkmk</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_server">
<a class="anchor" href="#_server"></a>4.1. Server</h3>
<div class="ulist">
<ul>
<li>
<p><a href="saml.html">Authentication with SAML</a></p>
</li>
<li>
<p><a href="kerberos.html">Single sign-on with Kerberos</a></p>
</li>
<li>
<p><a href="managing_docker.html">Checkmk server in a Docker container</a></p>
</li>
<li>
<p><a href="security.html">Security</a></p>
</li>
<li>
<p><a href="ports.html">Ports</a></p>
</li>
<li>
<p><a href="omd_https.html">Securing the web interface with HTTPS</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_sites">
<a class="anchor" href="#_sites"></a>4.2. Sites</h3>
<div class="ulist">
<ul>
<li>
<p><a href="omd_basics.html">Site administration with omd</a></p>
</li>
<li>
<p><a href="cmk_commandline.html">Checkmk on the command line</a></p>
</li>
<li>
<p><a href="license.html">Managing licenses</a></p>
</li>
<li>
<p><a href="distributed_monitoring.html">Distributed monitoring</a></p>
</li>
<li>
<p><a href="backup.html">Backups</a></p>
</li>
<li>
<p><a href="analyze_configuration.html">Analyzing the Checkmk site configuration</a></p>
</li>
<li>
<p><a href="mkps.html">Checkmk extension packages (MKPs)</a></p>
</li>
<li>
<p><a href="simulation_mode.html">Simulation mode</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_configuration">
<a class="anchor" href="#_configuration"></a>5. Configuration</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="wato.html">Configuring Checkmk</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_hosts">
<a class="anchor" href="#_hosts"></a>5.1. Hosts</h3>
<div class="ulist">
<ul>
<li>
<p><a href="hosts_setup.html">Host administration</a></p>
</li>
<li>
<p><a href="hosts_structure.html">Host structuring</a></p>
</li>
<li>
<p><a href="host_tags.html">Host tags</a></p>
</li>
<li>
<p><a href="dcd.html">Dynamic host configuration</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_services">
<a class="anchor" href="#_services"></a>5.2. Services</h3>
<div class="ulist">
<ul>
<li>
<p><a href="wato_services.html">Understanding and configuring services</a></p>
</li>
<li>
<p><a href="clustered_services.html">Monitoring cluster services</a></p>
</li>
<li>
<p><a href="piggyback.html">The piggyback mechanism</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_rules">
<a class="anchor" href="#_rules"></a>5.3. Rules</h3>
<div class="ulist">
<ul>
<li>
<p><a href="wato_rules.html">Host and service parameters</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_supporting_configurations">
<a class="anchor" href="#_supporting_configurations"></a>5.4. Supporting configurations</h3>
<div class="ulist">
<ul>
<li>
<p><a href="timeperiods.html">Time periods</a></p>
</li>
<li>
<p><a href="labels.html">Labels</a></p>
</li>
<li>
<p><a href="regexes.html">Regular expressions in Checkmk</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_users_and_permissions">
<a class="anchor" href="#_users_and_permissions"></a>5.5. Users and permissions</h3>
<div class="ulist">
<ul>
<li>
<p><a href="wato_user.html">Users, roles and permissions</a></p>
</li>
<li>
<p><a href="ldap.html">User management with LDAP/Active Directory</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_notifications">
<a class="anchor" href="#_notifications"></a>5.6. Notifications</h3>
<div class="ulist">
<ul>
<li>
<p><a href="notifications.html">Introduction to notifications</a></p>
</li>
<li>
<p><a href="notifications_jira.html">Notifications via Jira</a></p>
</li>
<li>
<p><a href="notifications_mattermost.html">Notifications via Mattermost</a></p>
</li>
<li>
<p><a href="notifications_pagerduty.html">Notifications via PagerDuty</a></p>
</li>
<li>
<p><a href="notifications_pushover.html">Notifications via Pushover</a></p>
</li>
<li>
<p><a href="notifications_opsgenie.html">Notifications via Opsgenie</a></p>
</li>
<li>
<p><a href="notifications_servicenow.html">Notifications via ServiceNow</a></p>
</li>
<li>
<p><a href="notifications_slack.html">Notifications via Slack</a></p>
</li>
<li>
<p><a href="notifications_splunkoncall.html">Notifications via Splunk On-Call</a></p>
</li>
<li>
<p><a href="notifications_webex.html">Notifications via Cisco Webex Teams</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_events">
<a class="anchor" href="#_events"></a>5.7. Events</h3>
<div class="ulist">
<ul>
<li>
<p><a href="ec.html">The Event Console</a></p>
</li>
<li>
<p><a href="alert_handlers.html">Alert handlers</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_monitoring_systems">
<a class="anchor" href="#_monitoring_systems"></a>6. Monitoring systems</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="wato_monitoringagents.html">Monitoring agents</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_checkmk_agents_and_snmp">
<a class="anchor" href="#_checkmk_agents_and_snmp"></a>6.1. Checkmk agents and SNMP</h3>
<div class="ulist">
<ul>
<li>
<p><a href="agent_deployment.html">Automatic agent updates</a></p>
</li>
<li>
<p><a href="agent_linux.html">Monitoring Linux</a></p>
</li>
<li>
<p><a href="agent_linux_legacy.html">Monitoring Linux in legacy mode</a></p>
</li>
<li>
<p><a href="agent_windows.html">Monitoring Windows</a></p>
</li>
<li>
<p><a href="agent_freebsd.html">Monitoring FreeBSD</a></p>
</li>
<li>
<p><a href="snmp.html">Monitoring via SNMP</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_agent_extensions">
<a class="anchor" href="#_agent_extensions"></a>6.2. Agent extensions</h3>
<div class="ulist">
<ul>
<li>
<p><a href="inventory.html">The HW/SW inventory</a></p>
</li>
<li>
<p><a href="mk_filestats.html">Monitoring files</a></p>
</li>
<li>
<p><a href="monitoring_oracle.html">Monitoring Oracle databases</a></p>
</li>
<li>
<p><a href="monitoring_mysql.html">Monitoring MySQL</a></p>
</li>
<li>
<p><a href="monitoring_mssql.html">Monitoring MSSQL</a></p>
</li>
<li>
<p><a href="monitoring_jobs.html">Monitoring time-based processes (Cronjobs)</a></p>
</li>
<li>
<p><a href="spool_directory.html">The spool directory</a></p>
</li>
<li>
<p><a href="localchecks.html">Local checks</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_vm_cloud_container">
<a class="anchor" href="#_vm_cloud_container"></a>6.3. VM, cloud, container</h3>
<div class="ulist">
<ul>
<li>
<p><a href="datasource_programs.html">Datasource programs</a></p>
</li>
<li>
<p><a href="monitoring_vmware.html">Monitoring VMWare ESXi</a></p>
</li>
<li>
<p><a href="monitoring_aws.html">Monitoring Amazon Web Services (AWS)</a></p>
</li>
<li>
<p><a href="monitoring_azure.html">Monitoring Microsoft Azure</a></p>
</li>
<li>
<p><a href="monitoring_kubernetes.html">Monitoring Kubernetes</a></p>
</li>
<li>
<p><a href="monitoring_docker.html">Monitoring Docker</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_endpoints">
<a class="anchor" href="#_endpoints"></a>6.4. Endpoints</h3>
<div class="ulist">
<ul>
<li>
<p><a href="active_checks.html">Monitoring network services (Active checks)</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_dashboards_views_metrics">
<a class="anchor" href="#_dashboards_views_metrics"></a>7. Dashboards, views, metrics</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="user_interface.html">The user interface</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_general">
<a class="anchor" href="#_general"></a>7.1. General</h3>
<div class="ulist">
<ul>
<li>
<p><a href="views.html">Host and service views</a></p>
</li>
<li>
<p><a href="dashboards.html">Dashboards</a></p>
</li>
<li>
<p><a href="graphing.html">Performance data and graphing</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_commands_in_views">
<a class="anchor" href="#_commands_in_views"></a>7.2. Commands in views</h3>
<div class="ulist">
<ul>
<li>
<p><a href="commands.html">Commands</a></p>
</li>
<li>
<p><a href="basics_ackn.html">Acknowledging problems</a></p>
</li>
<li>
<p><a href="basics_downtimes.html">Scheduled downtimes</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_analysis_and_prognosis">
<a class="anchor" href="#_analysis_and_prognosis"></a>8. Analysis and prognosis</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_analysis">
<a class="anchor" href="#_analysis"></a>8.1. Analysis</h3>
<div class="ulist">
<ul>
<li>
<p><a href="availability.html">Availability</a></p>
</li>
<li>
<p><a href="sla.html">Extended availability (SLAs)</a></p>
</li>
<li>
<p><a href="bi.html">Business Intelligence (BI)</a></p>
</li>
<li>
<p><a href="reporting.html">Reports</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_prognosis">
<a class="anchor" href="#_prognosis"></a>8.2. Prognosis</h3>
<div class="ulist">
<ul>
<li>
<p><a href="predictive_monitoring.html">Predictive monitoring</a></p>
</li>
<li>
<p><a href="forecast_graphs.html">Forecast graphs</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_connection_of_other_applications">
<a class="anchor" href="#_connection_of_other_applications"></a>9. Connection of other applications</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="monitoring_prometheus.html">Integrating Prometheus</a></p>
</li>
<li>
<p><a href="integrating_datadog.html">Integrating Datadog</a></p>
</li>
<li>
<p><a href="nagvis.html">NagVis: status data on maps and diagrams</a></p>
</li>
<li>
<p><a href="ntop.html">Integrating ntopng in Checkmk</a></p>
</li>
<li>
<p><a href="grafana.html">Integrating Checkmk in Grafana</a></p>
</li>
<li>
<p><a href="metrics_exporter.html">Sending metrics to InfluxDB and Graphite</a></p>
</li>
<li>
<p><a href="nagstamon.html">Integrating Checkmk in Nagstamon</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_specifics_to_the_editions">
<a class="anchor" href="#_specifics_to_the_editions"></a>10. Specifics to the editions</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="support_diagnostics.html">Support diagnostics</a></p>
</li>
<li>
<p><a href="managed.html">The Managed Services Edition</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_automation_and_development">
<a class="anchor" href="#_automation_and_development"></a>11. Automation and development</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_apis_for_automation">
<a class="anchor" href="#_apis_for_automation"></a>11.1. APIs for automation</h3>
<div class="ulist">
<ul>
<li>
<p><a href="rest_api.html">Configuration via the Checkmk REST-API</a></p>
</li>
<li>
<p><a href="livestatus.html">Retrieving status data via Livestatus</a></p>
</li>
<li>
<p><a href="livestatus_references.html">Livestatus command reference</a></p>
</li>
<li>
<p><a href="web_api.html">Configuration via HTTP-API</a></p>
</li>
<li>
<p><a href="web_api_references.html">Command reference for the HTTP-API</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_apis_for_development">
<a class="anchor" href="#_apis_for_development"></a>11.2. APIs for development</h3>
<div class="ulist">
<ul>
<li>
<p><a href="bakery_api.html">The Bakery-API</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_development_of_check_plug_ins">
<a class="anchor" href="#_development_of_check_plug_ins"></a>11.3. Development of check plug-ins</h3>
<div class="ulist">
<ul>
<li>
<p><a href="devel_check_plugins.html">Writing your own check plug-ins</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_concepts">
<a class="anchor" href="#_concepts"></a>12. Concepts</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="monitoring_basics.html">Basic principles of monitoring with Checkmk</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_the_checkmk_micro_core_cmc">
<a class="anchor" href="#_the_checkmk_micro_core_cmc"></a>12.1. The Checkmk Micro Core (CMC)</h3>
<div class="ulist">
<ul>
<li>
<p><a href="cmc.html">The Checkmk Micro Core (CMC)</a></p>
</li>
<li>
<p><a href="cmc_differences.html">Special characteristics of the CMC</a></p>
</li>
<li>
<p><a href="cmc_migration.html">Migration to the CMC</a></p>
</li>
<li>
<p><a href="cmc_files.html">CMC files and directories</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_checkmk_appliance">
<a class="anchor" href="#_the_checkmk_appliance"></a>13. The Checkmk appliance</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="appliance_rack1_quick_start.html">Quick start guide for Checkmk racks</a></p>
</li>
<li>
<p><a href="appliance_virt1_quick_start.html">Quick start guide for Checkmk virt1</a></p>
</li>
<li>
<p><a href="appliance_install_virt1.html">Installation of the virtual appliance</a></p>
</li>
<li>
<p><a href="appliance_usage.html">Configuring and using the appliance</a></p>
</li>
<li>
<p><a href="appliance_backup.html">Backup in the appliance</a></p>
</li>
<li>
<p><a href="appliance_cluster.html">Appliance in cluster operation</a></p>
</li>
<li>
<p><a href="appliance_rack_config.html">Special features of the hardware appliance</a></p>
</li>
</ul>
</div>
</div>
</div>
</div></div>
<div class="main-nav__utils">
<div class="dropup dropdown__utils">
<button class="btn dropdown-toggle" type="button" id="aboutMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">About Checkmk</button><div class="dropdown-menu dropup" aria-labelledby="aboutMenuButton">
<a class="dropdown-item" href="https://checkmk.com/product/features" target="_blank">Features</a><a class="dropdown-item" href="https://checkmk.com/product/editions" target="_blank">Editions</a><a class="dropdown-item" href="https://checkmk.com/integrations" target="_blank">Integrations</a><a class="dropdown-item" href="https://checkmk.com/imprint" target="_blank">Imprint</a><a class="dropdown-item" href="copyright.html" target="_blank">Copyright</a>
</div>
</div>
<div class="dropup dropdown__utils">
<button class="btn dropdown-toggle" type="button" id="learnMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Learn</button><div class="dropdown-menu dropup" aria-labelledby="learnMenuButton">
<a class="dropdown-item" href="https://checkmk.com/videos">Videos</a><a class="dropdown-item" href="https://checkmk.com/webinars">Webinars</a><a class="dropdown-item" href="https://checkmk.com/trainings/classes">Trainings</a>
</div>
</div>
<a class="main-nav__utils__link" href="https://forum.checkmk.com">Forum</a>
</div>
</div></aside><main><div id="header">
<h1>Securing the web interface with HTTPS</h1>
<div class="details">
<span id="revdate">Last modified on 28-Oct-2022</span><a class="edit-document" href="https://github.com/Checkmk/checkmk-docs/edit/2.1.0/en/omd_https.asciidoc">Edit this page on GitHub</a>
</div>
</div>
<div id="content">
<div id="preamble">
<div id="staticinfo">This page was exported for offline usage on 2025-01-07 22:12:14 +0000. It may not reflect the current state of the Checkmk documentation. To view a daily updated version, visit <a href="https://docs.checkmk.com/" target="_blank">docs.checkmk.com</a>.</div>
<div class="sectionbody"><div class="paragraph">
<p></p>
<div class="dropdown dropdown__related">
<button class="btn btn-primary dropdown-toggle" type="button" id="relatedMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Related Articles</button><div class="dropdown-menu dropdown-menu-right" aria-labelledby="relatedMenuButton">
<a href="kerberos.html">Single sign-on with Kerberos</a>
<a href="ldap.html">User management with LDAP/Active Directory</a>
</div>
</div>
</div></div>
</div>
<div class="sect1">
<h2 id="heading__introduction">
<span class="hidden-anchor sr-only" id="_introduction"></span>1. Introduction</h2>
<div class="sectionbody">
<div class="paragraph"><p>If you want to operate the Checkmk web interface via HTTPS, you will need to provide the following on your monitoring server — regardless of your sites:</p></div>
<div class="ulist"><ul>
<li><p>The Apache module <code>mod_ssl</code> is installed and activated.</p></li>
<li><p>The Apache modules <code>mod_rewrite</code> and <code>mod_headers</code> are present and also activated.</p></li>
<li><p>You have a valid server certificate.</p></li>
<li><p>The server is accessible via HTTPS.</p></li>
</ul></div>
<div class="paragraph"><p>This article explains everything that is required to achieve such a configuration.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="heading__activating_the_apache_modules">
<span class="hidden-anchor sr-only" id="_activating_the_apache_modules"></span>2. Activating the Apache modules</h2>
<div class="sectionbody">
<div class="paragraph"><p>HTTPS access of the Checkmk interface requires the Apache module <code>mod_ssl</code>.
We also assume in the further course of the setup that a connection coming in on the unencrypted port 80 should be forwarded to the SSL encrypted port 443.
This requires the <code>mod_rewrite</code> module.
Finally, <code>mod_headers</code> is needed so that the externally accessible Apache configured as a <a href="https://httpd.apache.org/docs/2.4/howto/reverse_proxy.html" target="_blank">Reverse Proxy</a> forwards the request headers to the <a href="ports.html#loopback">site Apache</a>.</p></div>
<div class="paragraph"><p>You can display the currently installed Apache modules with the <code>apachectl</code> command (old CentOS and RHEL versions may need <code>httpd</code> instead).
Use <code>grep</code> to check immediately whether all three required modules are present:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">root@linux# </span><strong>apachectl<span class="tok-w"> </span>-M<span class="tok-w"> </span><span class="tok-p">|</span><span class="tok-w"> </span>grep<span class="tok-w"> </span>-E<span class="tok-w"> </span><span class="tok-s1">'headers|rewrite|ssl'</span></strong>
<span class="tok-go"> headers_module (shared)</span>
<span class="tok-go"> rewrite_module (shared)</span></code></pre></div></div>
<div class="paragraph"><p>The activation of missing modules can be achieved on most distributions with the <code>a2enmod</code> script.
This script creates soft links in the <code>/etc/apache2/mods-enabled</code> folder.
The file with the extension <code>.load</code> contains instructions for loading the module, and the <code>.conf</code> file contains the module’s actual configuration:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">root@linux# </span><strong>a2enmod<span class="tok-w"> </span>ssl</strong>
<span class="tok-go">Enabling module ssl.</span>
<span class="tok-go">To activate the new configuration, you need to run:</span>
<span class="tok-go">  systemctl restart apache2</span></code></pre></div></div>
<div class="paragraph"><p>For older versions of RHEL and distributions based on it, <code>mod_ssl</code> is a dedicated package that needs to be installed separately:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">root@linux# </span><strong>yum<span class="tok-w"> </span>install<span class="tok-w"> </span>-y<span class="tok-w"> </span>httpd<span class="tok-w"> </span>mod_ssl</strong></code></pre></div></div>
<div class="paragraph"><p>If the <code>a2enmod</code> command is not available, you are working with a distribution that keeps the Apache configuration in a single configuration file instead of splitting it into directories and many individual files.
In such a case, the commented-out line <code>LoadModule ssl_module […​]</code> in the <code>/etc/httpd/conf/httpd.conf</code> configuration file must be stripped of <code>#</code>.
Proceed in the same way for the other two modules.</p></div>
<div class="paragraph"><p>Whether the Apache web server can be restarted now or later depends on whether simple, self-signed certificates were automatically generated when Apache was installed.</p></div>
<div class="paragraph"><p>You can find this out by first searching for the configuration file that contains the file paths to the certificate and keys, and then checking whether these files exist (for RHEL, specify <code>/etc/httpd</code> as the starting directory for the search):</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">root@linux# </span><strong>find<span class="tok-w"> </span>/etc/apache2/<span class="tok-w"> </span>-type<span class="tok-w"> </span>f<span class="tok-w"> </span>-exec<span class="tok-w"> </span>grep<span class="tok-w"> </span>-Hn<span class="tok-w"> </span><span class="tok-s1">'^\s*SSLCertificate.*File'</span><span class="tok-w"> </span><span class="tok-o">{}</span><span class="tok-w"> </span><span class="tok-se">\;</span></strong>
<span class="tok-go">/etc/apache2/sites-available/default-ssl.conf:32: SSLCertificateFile	/etc/ssl/certs/ssl-cert-snakeoil.pem</span>
<span class="tok-go">/etc/apache2/sites-available/default-ssl.conf:33: SSLCertificateKeyFile /etc/ssl/private/ssl-cert-snakeoil.key</span></code></pre></div></div>
<div class="paragraph"><p>Check whether the files specified in the configuration file are present.
If no automatically created certificate exists, wait until you have received or created a certificate yourself before restarting the Apache web server — otherwise the restart will fail.</p></div>
<div class="paragraph"><p>If the certificate and key exist, restart the Apache web server, in the case of <code>systemd</code>, which is now used by default, using the following command:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">root@linux# </span><strong>systemctl<span class="tok-w"> </span>restart<span class="tok-w"> </span>apache2</strong></code></pre></div></div>
<div class="paragraph"><p>Again, some distributions do not use <code>apache2</code> as the name for the service, instead the somewhat more generic <code>httpd</code>.
In this case, edit the command.</p></div>
<div class="paragraph"><p><strong>Note:</strong> In the Checkmk appliance, enable <a href="appliance_usage.html#ssl">HTTPS via the web interface!</a></p></div>
</div>
</div>
<div class="sect1">
<h2 id="heading__receiving_certificates">
<span class="hidden-anchor sr-only" id="_receiving_certificates"></span>3. Receiving certificates</h2>
<div class="sectionbody">
<div class="paragraph"><p>Essentially, the following methods for obtaining a server certificate are available:</p></div>
<div class="ulist"><ul>
<li><p>You use an external service provider for <a href="#oldschoolcsr">certificate issuance using CSR</a> (<em>Certificate Signing Request</em>), whose root certificate is trusted by browser and operating system manufacturers.
With this procedure, certificates can be validated not only at the domain level, but also at organization level (Organization Validation) and higher (Extended Validation), as is mandatory in some classes of business for regulatory reasons.
More Information on these options can be found in <a href="https://en.wikipedia.org/wiki/Public_key_certificate#Validation_levels" target="_blank">Validation levels</a>.</p></li>
<li><p>You are using <a href="#letsencrypt">free certificates from <em>Let’s Encrypt</em>.</a>
This method only allows validation at the domain level.
To be able to request certificates, the server to be secured must be accessible from outside or you must be able to create (automated) entries in the public DNS of the domain used.</p></li>
<li><p>You become your <a href="#becomeca">own <em>Certificate Authority</em> (CA)</a> and generate your own certificates.
Your own CA’s root certificate must be present on all machines that communicate with servers that use certificates signed with the CA key.
High security standards should be maintained when dealing with one’s own CA, since this CA can be used to issue certificates for any domain.</p></li>
</ul></div>
<div class="sect2">
<h3 id="heading_oldschoolcsr">
<span class="hidden-anchor sr-only" id="oldschoolcsr"></span>3.1. Using external CAs</h3>
<div class="paragraph"><p>For a long time, having certificates signed by a commercial certificate authority was the only way to obtain certificates accepted by all browsers and operating systems.
This procedure is still common today, especially when long validity periods are desired.</p></div>
<div class="paragraph"><p>The procedure is that you first generate the private server key and then create a <em>Certificate Signing Request</em> (CSR) for it, which you transfer to the selected provider.
The provider then verifies the ownership of the domain, confirms the CSR with its key and sends you the resulting server certificate.</p></div>
<div class="paragraph"><p>Regardless of the examples below, be sure to follow your Certificate Authority’s guidelines and modify the commands accordingly.</p></div>
<div class="sect3">
<h4 id="heading_createcsr">
<span class="hidden-anchor sr-only" id="createcsr"></span>Generating key and CSR</h4>
<div class="paragraph"><p>First, you generate the private server key.
You can perform this step directly on the server where the Checkmk site to be secured is located.</p></div>
<div class="paragraph"><p>The <code>/etc/certs</code> folder used is the default for many distributions.
However, you can use any folder that the Apache process has read access to.
Naming the key after the primary domain name for which it is used (here <code>checkmk.mydomain.com</code>) provides a better overview in this context.
Especially if additional server names are added later, for which own keys/certificates are used, this naming scheme facilitates the assignment.</p></div>
<div class="paragraph"><p>The private key is later used to encrypt the data traffic and should be handled with appropriate care (for example, with regard to access rights).
In order to be able to restart the Apache server automatically, most administrators do not assign a passphrase.</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">root@linux# </span><strong>openssl<span class="tok-w"> </span>genrsa<span class="tok-w"> </span>-out<span class="tok-w"> </span>/etc/certs/checkmk.mydomain.com.key<span class="tok-w"> </span><span class="tok-m">2048</span></strong>
<span class="tok-go">Generating RSA private key, 2048 bit long modulus (2 primes)</span>
<span class="tok-go">.....++
...............................................................++</span>
<span class="tok-go">e is 65537 (0x010001)</span></code></pre></div></div>
<div class="paragraph"><p>In the next step, you create the Certificate Signing Request (CSR) — a digital request for the creation of an identity certificate (here: a public key certificate):</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">root@linux# </span><strong>openssl<span class="tok-w"> </span>req<span class="tok-w"> </span>-new<span class="tok-w"> </span>-key<span class="tok-w"> </span>checkmk.mydomain.com.key<span class="tok-w"> </span>-out<span class="tok-w"> </span>checkmk.mydomain.com.csr</strong>
<span class="tok-go">You are about to be asked to enter information that will be incorporated</span>
<span class="tok-go">into your certificate request.</span>
<span class="tok-go">What you are about to enter is what is called a Distinguished Name or a DN.</span>
<span class="tok-go">There are quite a few fields but you can leave some blank</span>
<span class="tok-go">For some fields there will be a default value,</span>
<span class="tok-go">If you enter '.', the field will be left blank.</span>
<span class="tok-go">---</span>
<span class="tok-go">Country Name (2 letter code) [AU]: <strong>DE</strong></span>
<span class="tok-go">State or Province Name (full name) [Some-State]: <strong>Bavaria</strong></span>
<span class="tok-go">Locality Name (eg, city) []: <strong>Munich</strong></span>
<span class="tok-go">Organization Name (eg, company) [Internet Widgits Pty Ltd]: <strong>Yoyodyne Inc.</strong></span>
<span class="tok-go">Organizational Unit Name (eg, section) []:</span>
<span class="tok-go">Common Name (e.g. server FQDN or YOUR name) []: <strong>checkmk.mydomain.com</strong></span>
<span class="tok-go">Email Address []: <strong><a href="mailto:webmaster@mydomain.com">webmaster@mydomain.com</a></strong></span>

<span class="tok-go">Please enter the following 'extra' attributes</span>
<span class="tok-go">to be sent with your certificate request</span>
<span class="tok-go">A challenge password []:</span>
<span class="tok-go">An optional company name []:</span></code></pre></div></div>
<div class="paragraph"><p>Be sure to enter the company details correctly and enter the server name as the <code>Common Name</code>.
The <code>Email Address</code> should be in the same domain and belong to an existing mailbox that is actively read.</p></div>
</div>
<div class="sect3">
<h4 id="heading__creating_an_extension_file">
<span class="hidden-anchor sr-only" id="_creating_an_extension_file"></span>Creating an extension file</h4>
<div class="paragraph"><p>Modern browsers require certificates that use the extension for <em>alternate host names</em>, even if the certificates are issued for only a single host name.
This requires an extension file, which some providers create and integrate automatically.
If this is not the case or if you are not sure, create such a file.
If a certificate should be valid for multiple host names, following <code>[alt_names]</code> add additional lines, <code>DNS.2 =</code> and so on as required:</p></div>
<div class="listingblock">
<div class="title">/tmp/checkmk.mydomain.com.ext</div>
<div class="content"><pre class="pygments highlight"><code><span></span>authorityKeyIdentifier=keyid,issuer
basicConstraints=CA:FALSE
keyUsage = digitalSignature, nonRepudiation, keyEncipherment, dataEncipherment
subjectAltName = @alt_names

[alt_names]
DNS.1 = checkmk.mydomain.com</code></pre></div>
</div>
</div>
<div class="sect3">
<h4 id="heading__submitting_documentation">
<span class="hidden-anchor sr-only" id="_submitting_documentation"></span>Submitting documentation</h4>
<div class="paragraph"><p>Depending on the level of validation sought, it may be necessary to compile further documents such as commercial register excerpts or bank data.
Since the requested documents, the ways of submission and the ways of confirmation differ from provider to provider, no generally applicable guidance can be given here.
For example, Extended Validation can also mean that a code is sent by registered mail to the managing director or an authorized signatory, who must then enter the code via a web interface.</p></div>
<div class="paragraph"><p>In the simplest case of a validation at the domain level only, the CSR file and, if applicable, the EXT file are uploaded via a web interface.
You are then given the option of selecting an e-mail address: from those stored for the Admin-C (owner of the domain) or for Tech-C (technically responsible person for the domain), or a generic e-mail address such as <code>webmaster@domain.com</code>.
A confirmation link will then be sent to this address.</p></div>
</div>
<div class="sect3">
<h4 id="heading__receiving_the_certificate">
<span class="hidden-anchor sr-only" id="_receiving_the_certificate"></span>Receiving the certificate</h4>
<div class="paragraph"><p>The validation process itself usually takes a maximum of a few minutes for domain-level validation, or can sometimes take several days for an extended validation.
Once this process has been completed, you will receive the certificate belonging to your key by e-mail or download.
In addition to the certificate, you will also receive a download link to the <em>Certificate Chain File</em>.
Be sure to save this file as well.</p></div>
</div>
</div>
<div class="sect2">
<h3 id="heading_letsencrypt">
<span class="hidden-anchor sr-only" id="letsencrypt"></span>3.2. Let’s Encrypt</h3>
<div class="paragraph"><p>If a server can be accessed remotely or if you have access to the name server, you can have certificates generated automatically via the non-profit service provider <a href="https://letsencrypt.org/#" target="_blank">Let’s Encrypt</a>, which belongs to the Electronic Frontier Foundation (EFF).
There are no costs involved.
Certificates validated via DNS require a few minutes of attention every 90 days, certificates validated via server directory can be regenerated automatically for years.</p></div>
<div class="paragraph"><p>For Let’s Encrypt certificates, the EFF provides <em>Certbot</em>, a Python program available in a variety of package formats.
The Certbot creates the key, sends the CSR, checks the ownership of the server or domain, and finally downloads the certificate.
Certbot communicates with the EFF servers via the <a href="https://en.wikipedia.org/wiki/Automatic_Certificate_Management_Environment#" target="_blank">Automatic Certificate Management Environment (ACME)</a> protocol.</p></div>
<div class="sect3">
<h4 id="heading__installation_of_the_certbot_script">
<span class="hidden-anchor sr-only" id="_installation_of_the_certbot_script"></span>Installation of the Certbot script</h4>
<div class="paragraph"><p>There are three ways of installing Certbot.
Which one you choose should mainly depend on the age of the distribution you are using and your organization’s policy on installing packages from third-party sources:</p></div>
<div class="ulist"><ul>
<li><p>If your Linux distribution’s package management provides Certbot version 1.10 or higher, this Certbot version can be used.</p></li>
<li><p>Certbot may be installed via the Python package installation tool <code>pip3</code> from the <a href="https://pypi.org/project/certbot/#" target="_blank">Python Package Index</a>.
The <code>pip3 install certbot</code> command also installs all of the required dependencies.</p></li>
<li><p>The EFF prefers installation from a snap image on their <a href="https://certbot.eff.org/instructions#" target="_blank">Certbot documentation page</a>.
The known advantages and disadvantages of the snap package format apply.</p></li>
</ul></div>
</div>
<div class="sect3">
<h4 id="heading__fully_automated_configuration">
<span class="hidden-anchor sr-only" id="_fully_automated_configuration"></span>Fully automated configuration</h4>
<div class="paragraph"><p>If the Checkmk server is accessible from the Internet and you have not made any changes to the system-wide Apache web server configuration since installing Checkmk, you can use Certbot’s 'Apache automatism'.
With this you can generate keys, request certificates, automatically adjust the Apache configuration and finally set up a cronjob to periodically renew the certificates that are valid for a maximum of 90 days, before they expire.</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">root@linux# </span><strong>certbot<span class="tok-w"> </span>--apache</strong></code></pre></div></div>
<div class="paragraph"><p>The script will now interactively ask for some information regarding contact details (e-mail contact for additional information such as necessary certificate recalls) and installation paths.
Once the script has finished, you will have a functioning SSL configuration.
Modification of the configuration file for <code>mod_ssl</code> is not required, this has already been done by the Certbot.</p></div>
</div>
<div class="sect3">
<h4 id="heading__semi_automated_configuration">
<span class="hidden-anchor sr-only" id="_semi_automated_configuration"></span>Semi-automated configuration</h4>
<div class="paragraph"><p>If you are requesting certificates, as described in the previous section, but want to customize the Apache configuration yourself, use the command:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">root@linux# </span><strong>certbot<span class="tok-w"> </span>certonly<span class="tok-w"> </span>--apache</strong></code></pre></div></div>
<div class="paragraph"><p>You can then complete the configuration <a href="#configsample">as described below</a> in the configuration file for <code>mod_ssl</code>.</p></div>
</div>
<div class="sect3">
<h4 id="heading__more_options">
<span class="hidden-anchor sr-only" id="_more_options"></span>More options</h4>
<div class="paragraph"><p>For example, if the Checkmk server is only accessible from the intranet or via VPN, but the DNS server is public, you can validate via a <em>DNS Challenge</em>.
Here the ownership of a domain is not checked for being able to put files onto the web server, but for being able to add entries in the DNS.
This does not involve entries that resolve a host name to an IP address, but so-called TXT entries, which can contain any character strings.
TXT entries are also used, for example, to specify which servers are allowed to send e-mails for a domain.</p></div>
<div class="paragraph"><p>DNS challenges can be performed manually, which is usually only practical for individual test systems with 90-day validity.
If your DNS provider has an API supported by Let’s Encrypt, an automatic renewal can also be performed.
For this, read the <a href="https://letsencrypt.org/de/docs/challenge-types/" target="_blank">Overview of Challenge Types</a> at Let’s Encrypt.</p></div>
</div>
</div>
<div class="sect2">
<h3 id="heading_becomeca">
<span class="hidden-anchor sr-only" id="becomeca"></span>3.3. Using internal CAs</h3>
<div class="paragraph"><p>You can put yourself in the role of a Certificate Authority (CA) and issue certificates for any domains (your domains, foreign domains and fantasy domains).
The route via your own CA is particularly useful for test environments or isolated Checkmk servers with a manageable number of users.
This is also the only way to obtain certificates if you internally use one of the five reserved top-level domains (TLD) <code>.example</code>, <code>.invalid</code>, <code>.local</code>, <code>.localhost</code> or <code>.test</code>.
There are no registrars for these domains, consequently no ownership can be verified.</p></div>
<div class="paragraph"><p>This chapter explains how to issue certificates with such an internal CA.
The prerequisites are assumed to be that you already have the private CA root or CA intermediate key and should now use it to issue certificates to secure a Checkmk server.</p></div>
<div class="paragraph"><p>The creation of the CA keys, the CA certificate and the associated configuration file are not included in this tutorial.</p></div>
<div class="sect3">
<h4 id="heading__generating_key_and_csr">
<span class="hidden-anchor sr-only" id="_generating_key_and_csr"></span>Generating key and CSR</h4>
<div class="paragraph"><p>To create the server key, Certificate Signing Request (CSR), and extension file, proceed as described in the section on <a href="#createcsr">Certificate issuance via a commercial CA</a>.
The procedure and the required files are identical.</p></div>
</div>
<div class="sect3">
<h4 id="heading_signyourself">
<span class="hidden-anchor sr-only" id="signyourself"></span>Signing the CSR</h4>
<div class="paragraph"><p>To sign certificates yourself, you need at least a private key (here <code>intermediate.key.pem</code>) and the corresponding intermediate certificate <code>intermediate.pem</code>.
If you also have a configuration file, the path to it must be specified with the <code>--config</code> parameter.</p></div>
<div class="paragraph"><p>The signature based on the CSR file <code>checkmk.mydomain.com.csr</code>, extension file <code>checkmk.mydomain.com.ext</code> and the output file <code>checkmk.mydomain.com.crt</code> is then performed with the following command:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">user@host:~$ </span>openssl<span class="tok-w"> </span>x509<span class="tok-w"> </span>-CAcreateserial<span class="tok-w"> </span>-req<span class="tok-w"> </span><span class="tok-se">\</span>
<span class="tok-w">    </span>-in<span class="tok-w"> </span>checkmk.mydomain.com.csr<span class="tok-w"> </span><span class="tok-se">\</span>
<span class="tok-w">    </span>-CA<span class="tok-w"> </span>intermediate.pem<span class="tok-w"> </span>-CAkey<span class="tok-w"> </span>intermediate.key.pem<span class="tok-w"> </span><span class="tok-se">\</span>
<span class="tok-w">    </span>-out<span class="tok-w"> </span>checkmk.mydomain.com.crt<span class="tok-w"> </span>-days<span class="tok-w"> </span><span class="tok-m">365</span><span class="tok-w"> </span><span class="tok-se">\</span>
<span class="tok-w">    </span>-sha256<span class="tok-w"> </span>-extfile<span class="tok-w"> </span>checkmk.mydomain.com.ext</code></pre></div></div>
<div class="paragraph"><p>In addition to the server certificate <code>checkmk.mydomain.com.crt</code> created here, you also have to pass on your CA certificate <code>intermediate.pem</code>.
If you are not a root CA, you must also forward the root certificate (referred to as a <code>ca_certificate_internal.pem</code> in the rest of the text).</p></div>
</div>
<div class="sect3">
<h4 id="heading__importing_the_certificate">
<span class="hidden-anchor sr-only" id="_importing_the_certificate"></span>Importing the certificate</h4>
<div class="paragraph"><p>The options for importing a CA certificate as trusted vary from browser to browser.
It is usually sufficient to add the certificate <code>ca_certificate_intern.pem</code> under <span class="guihint">Settings &gt; Privacy</span> and <span class="guihint">Security &gt; Certificates &gt; Import</span>.</p></div>
<div class="paragraph"><p>So that certificate management is not a stumbling block when agents are automatically updated in the <span class="image-inline"><img src="../images/CEE.svg" alt="CEE" width="20" title="Checkmk Enterprise Editions"></span> <strong>Checkmk Enterprise Editions</strong>, in the <a href="glossar.html#agent_bakery">Agent Bakery</a> we have provided the option of passing an <a href="agent_deployment.html#certificates_for_https">own CA certificate</a> that is only used for agent updates.
The system certificates are not touched in this case, and agent updates are still possible.</p></div>
<div class="paragraph"><p>As an alternative to distribution via agent updates, you can integrate the root certificate in the host’s local CA database.
To do this, copy the <code>ca_certificate_intern.pem</code> file to <code>/usr/local/share/ca-certificates/</code>, then regenerate the cache:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">root@linux# </span><strong>update-ca-certificates</strong></code></pre></div></div>
<div class="paragraph"><p>Under Windows it is possible to manage the system certificates via the MMC 'Certificates' snap-in.
This is necessary, for example, if you want to use a Microsoft browser to access a Checkmk secured with its own CA.
You can read the exact procedure in the article on the <a href="https://learn.microsoft.com/en-us/troubleshoot/windows-server/windows-security/import-third-party-ca-to-enterprise-ntauth-store#method-1---import-a-certificate-by-using-the-pki-health-tool" target="_blank">Microsoft Knowledge Base PKI</a>.
Alternatively, you can distribute certificates via <a href="https://learn.microsoft.com/en-us/mem/intune/protect/certificates-configure" target="_blank">Intune</a>.</p></div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="heading_configsample">
<span class="hidden-anchor sr-only" id="configsample"></span>4. Configuring HTTPS connection for a site</h2>
<div class="sectionbody">
<div class="paragraph"><p>First, you must specify the correct file paths to the key, certificate, and intermediate certificate in the SSL configuration file. Note that these are configurations for the <code>apache2</code> web server and are not specific to Checkmk. Therefore, the configuration file used on Debian-based systems is usually the default <code>/etc/apache2/sites-enabled/default-ssl.conf</code>, however the file path may be different on older distributions.</p></div>
<div class="paragraph"><p>In the example below, the <code>SSLCertificateKeyFile</code> denotes the private key generated at the initial configuration of this server.
<code>SSLCertificateChainFile</code> contains the intermediate certificate or, if applicable, a concatenation of dependent intermediate certificates.
This is only omitted for an internal CA where the CA key is used directly for signing.</p></div>
<div class="paragraph"><p>Many commercial vendors use rather generic filenames, so if you adopt these the configuration will look similar to the following:</p></div>
<div class="listingblock">
<div class="title">/etc/apache2/sites-enabled/default-ssl.conf</div>
<div class="content"><pre class="pygments highlight"><code data-lang="apache"><span></span><span class="tok-nb">SSLEngine</span><span class="tok-w"> </span><span class="tok-k">on</span>
<span class="tok-nb">SSLCertificateKeyFile</span><span class="tok-w"> </span><span class="tok-sx">/etc/certs/checkmk.mydomain.com.key</span>
<span class="tok-nb">SSLCertificateChainFile</span><span class="tok-w"> </span><span class="tok-sx">/etc/certs/ca_bundle.crt</span>
<span class="tok-nb">SSLCertificateFile</span><span class="tok-w"> </span><span class="tok-sx">/etc/certs/certificate.crt</span></code></pre></div>
</div>
<div class="paragraph"><p>If you have used Let’s Encrypt to generate certificates but want to update the configuration manually, identify the file paths stored under <code>/etc/letsencrypt/live</code> and enter them:</p></div>
<div class="listingblock">
<div class="title">/etc/apache2/sites-enabled/default-ssl.conf</div>
<div class="content"><pre class="pygments highlight"><code data-lang="apache"><span></span><span class="tok-nb">SSLEngine</span><span class="tok-w"> </span><span class="tok-k">on</span>
<span class="tok-nb">SSLCertificateKeyFile</span><span class="tok-w"> </span><span class="tok-sx">/etc/letsencrypt/live/checkmk.mydomain.com/privkey.pem</span>
<span class="tok-nb">SSLCertificateChainFile</span><span class="tok-w"> </span><span class="tok-sx">/etc/letsencrypt/live/checkmk.mydomain.com/chain.pem</span>
<span class="tok-nb">SSLCertificateFile</span><span class="tok-w"> </span><span class="tok-sx">/etc/letsencrypt/live/checkmk.mydomain.com/cert.pem</span></code></pre></div>
</div>
<div class="sect2">
<h3 id="heading_httpsredirect">
<span class="hidden-anchor sr-only" id="httpsredirect"></span>4.1. Adding HTTPS forwarding</h3>
<div class="paragraph"><p>Apache works with virtual hosts to serve content for many host names under a single IP address.
If the term 'site' is used in the Apache context, such a virtual host is meant, not a Checkmk site.
On a dedicated Checkmk server, usually only one virtual host with a server name is used under which all Checkmk sites can then be reached.
The <code>VirtualHost</code> configuration is located in one of the following files, depending on the distribution being used:</p></div>
<table class="table-responsive table-bordered table tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Debian, Ubuntu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/etc/apache2/sites-enabled/000-default</code>(<code>.conf</code>)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RHEL, CentOS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/etc/httpd/conf.d/ssl.conf</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SLES</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/etc/apache2/httpd.conf</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph"><p>The following example assumes that you use a single configuration file for unencrypted connections on port 80 and encrypted connections on 443.
In this case, add the following lines to the <code>VirtualHost</code> section:</p></div>
<div class="listingblock">
<div class="title">/etc/apache2/sites-enabled/000-default</div>
<div class="content"><pre class="pygments highlight"><code data-lang="apache"><span></span><span class="tok-nb">RewriteEngine</span><span class="tok-w"> </span><span class="tok-k">On</span>
<span class="tok-c"># Never forward request for .well-known (important when using Let's Encrypt)</span>
<span class="tok-nb">RewriteCond</span><span class="tok-w"> </span>%{REQUEST_URI}<span class="tok-w"> </span>!^/.well-known
<span class="tok-c"># Next 2 lines: Force redirection if incoming request is not on 443</span>
<span class="tok-nb">RewriteCond</span><span class="tok-w"> </span>%{SERVER_PORT}<span class="tok-w"> </span>!^443$
<span class="tok-nb">RewriteRule</span><span class="tok-w"> </span>(.*)<span class="tok-w"> </span>https://%{HTTP_HOST}$1<span class="tok-w"> </span>[L]
<span class="tok-c"># This section passes the system Apaches connection mode to the</span>
<span class="tok-c"># instance Apache. Make sure mod_headers is enabled, otherwise it</span>
<span class="tok-c"># will be ignored and "Analyze configuration" will issue "WARN".</span>
<span class="tok-nt">&lt;IfModule</span><span class="tok-w"> </span><span class="tok-s">headers_module</span><span class="tok-nt">&gt;</span>
<span class="tok-w">    </span><span class="tok-nb">RequestHeader</span><span class="tok-w"> </span>set<span class="tok-w"> </span>X-Forwarded-Proto<span class="tok-w"> </span>expr=%{REQUEST_SCHEME}
<span class="tok-w">    </span><span class="tok-nb">RequestHeader</span><span class="tok-w"> </span>set<span class="tok-w"> </span>X-Forwarded-SSL<span class="tok-w"> </span>expr=%{HTTPS}
<span class="tok-nt">&lt;/IfModule&gt;</span></code></pre></div>
</div>
<div class="paragraph"><p>The two <code>RequestHeader set X-Forwarded…​</code> lines here ensure that the <a href="ports.html#loopback">Site Apache on port 5000</a> is notified that a call was made over SSL, confirming that security rules were followed.</p></div>
<div class="paragraph"><p>Following the configuration change, the web server must be restarted:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">root@linux# </span><strong>systemctl<span class="tok-w"> </span>restart<span class="tok-w"> </span>apache2</strong></code></pre></div></div>
<div class="paragraph"><p>Again, some distributions do not use <code>apache2</code> as the service name, instead the more generic <code>httpd</code>.
In such a case, simply edit the command.</p></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="heading__additional_options">
<span class="hidden-anchor sr-only" id="_additional_options"></span>5. Additional options</h2>
<div class="sectionbody"><div class="sect2">
<h3 id="heading__setting_up_hsts">
<span class="hidden-anchor sr-only" id="_setting_up_hsts"></span>5.1. Setting up HSTS</h3>
<div class="paragraph"><p>Making the Checkmk server accessible only via HTTPS is the first and most important step for securing connections to the monitoring.
You can, however, further increase the security with additional, optional settings.
For example, the web server can tell the browser that in future it may only be accessed via HTTPS and that an unsecured connection via HTTP will always be rejected.</p></div>
<div class="paragraph"><p>This technique is called 'HTTP Strict Transport Security' (HSTS) and is defined for a certain period of time in seconds.
Once this period has expired, the browser checks again whether the limitation via HSTS is still valid.</p></div>
<div class="sect3">
<h4 id="heading_hsts_specifics">
<span class="hidden-anchor sr-only" id="hsts_specifics"></span>HSTS features</h4>
<div class="paragraph"><p>Setting up HSTS not only has the advantage of ensuring that only secure connections can be used, its use also brings with it certain conditions of which one must be aware <em>before</em> making the switch:</p></div>
<div class="ulist"><ul>
<li><p>Once the entry to the HSTS has been created by the user’s browser, it can only be removed — at least before the specified time expires — with appropriately detailed knowledge of the browser in question. Note that this does not apply to many users.</p></li>
<li><p>The connection will be rejected, if, among other things the certificate has expired or has been replaced by a self-signed one.
Such pages cannot be bypassed even with an exception for temporary trust of a certificate.</p></li>
<li><p>Conversely, HSTS is only taken into account if the certificate is <strong>trusted</strong> when the connection is first established.
Otherwise, the browser does not create an entry for HSTS, so the additional protection mechanism is not used.</p></li>
</ul></div>
</div>
<div class="sect3">
<h4 id="heading__apache_web_server_configuration">
<span class="hidden-anchor sr-only" id="_apache_web_server_configuration"></span>Apache web server configuration</h4>
<div class="paragraph"><p>To set the option, add the following entry to the HTTPS configuration.
Under Debian/Ubuntu, by default this is the file <code>default-ssl.conf</code>:</p></div>
<div class="listingblock">
<div class="title">/etc/apache2/sites-enabled/default-ssl.conf</div>
<div class="content"><pre class="pygments highlight"><code data-lang="apache"><span></span><span class="tok-nb">Header</span><span class="tok-w"> </span>always<span class="tok-w"> </span>set<span class="tok-w"> </span>Strict-Transport-Security<span class="tok-w"> </span><span class="tok-s2">"max-age=43200"</span></code></pre></div>
</div>
<div class="paragraph"><p><strong>Important</strong>: First set a short time period — e.g., 600 seconds — to test the setting, otherwise the connection may be permanently rejected in the case of an error!
More on this at the <a href="#hsts_specifics">Special functions</a> below.</p></div>
<div class="paragraph"><p>To see if the new setting works, you can use the <code>curl</code> program to retrieve the server.
Here only the first 4 lines of output are shown in this example:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">root@linux# </span><strong>curl<span class="tok-w"> </span>-I<span class="tok-w"> </span><span class="tok-se">\h</span>ttps://mycmkserver/mysite/check_mk/login.py</strong>
<span class="tok-go">HTTP/1.1 200 OK</span>
<span class="tok-go"><strong>Date</strong>: Tue, 01 Jun 2021 09:30:20 GMT</span>
<span class="tok-go"><strong>Server</strong>: Apache</span>
<span class="tok-go"><strong>Strict-Transport-Security</strong>: max-age=3600</span></code></pre></div></div>
</div>
</div></div>
</div>
</div></main><div id="toc" class="toc2">
<div id="toctitle">On this page</div>
<ul class="sectlevel1">
<li><a href="#_introduction">1. Introduction</a></li>
<li><a href="#_activating_the_apache_modules">2. Activating the Apache modules</a></li>
<li>
<a href="#_receiving_certificates">3. Receiving certificates</a><ul class="sectlevel1">
<li>
<a href="#oldschoolcsr">3.1. Using external CAs</a><ul class="sectlevel2">
<li><a href="#createcsr">Generating key and CSR</a></li>
<li><a href="#_creating_an_extension_file">Creating an extension file</a></li>
<li><a href="#_submitting_documentation">Submitting documentation</a></li>
<li><a href="#_receiving_the_certificate">Receiving the certificate</a></li>
</ul>
</li>
<li>
<a href="#letsencrypt">3.2. Let’s Encrypt</a><ul class="sectlevel2">
<li><a href="#_installation_of_the_certbot_script">Installation of the Certbot script</a></li>
<li><a href="#_fully_automated_configuration">Fully automated configuration</a></li>
<li><a href="#_semi_automated_configuration">Semi-automated configuration</a></li>
<li><a href="#_more_options">More options</a></li>
</ul>
</li>
<li>
<a href="#becomeca">3.3. Using internal CAs</a><ul class="sectlevel2">
<li><a href="#_generating_key_and_csr">Generating key and CSR</a></li>
<li><a href="#signyourself">Signing the CSR</a></li>
<li><a href="#_importing_the_certificate">Importing the certificate</a></li>
</ul>
</li>
</ul>
</li>
<li>
<a href="#configsample">4. Configuring HTTPS connection for a site</a><ul class="sectlevel1"><li><a href="#httpsredirect">4.1. Adding HTTPS forwarding</a></li></ul>
</li>
<li>
<a href="#_additional_options">5. Additional options</a><ul class="sectlevel1"><li>
<a href="#_setting_up_hsts">5.1. Setting up HSTS</a><ul class="sectlevel2">
<li><a href="#hsts_specifics">HSTS features</a></li>
<li><a href="#_apache_web_server_configuration">Apache web server configuration</a></li>
</ul>
</li></ul>
</li>
</ul>
</div>
<script src="../../assets/js/manifest.js?id=7db827d654313dce4250"></script>
<script src="../../assets/js/vendor.js?id=581a3d4a61b7156d04df"></script>
<script src="../../assets/js/app.js?id=959ccd04b1f8b7b78c5e"></script>
<script src="../../assets/js/lunr.js"></script>
<script src="../../assets/js/lunr.stemmer.support.js"></script>
<script src="../lunr.index.en.js"></script>
<script src="../../assets/js/lunr.client.js"></script>
</body>
</html>
