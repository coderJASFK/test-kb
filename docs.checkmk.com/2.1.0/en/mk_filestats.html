<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]--><meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<link rel="icon" href="/favicon.png">
<meta name="robots" content="noindex">
<meta name="description" content="In Checkmk you can use mk_filestats and fileinfo to monitor files for age, size and count, both on Linux and Windows.">
<meta name="og:locale" content="en">
<meta name="og:site_name" content="Checkmk Docs">
<meta name="og:title" content="Monitoring files">
<meta name="og:description" content="In Checkmk you can use mk_filestats and fileinfo to monitor files for age, size and count, both on Linux and Windows.">
<meta name="og:image" content="https://docs.checkmk.com/assets/images/share_image.png">
<meta name="twitter:site" content="@checkmk">
<meta name="twitter:creator" content="@checkmk">
<title>Monitoring files</title>
<link rel="stylesheet" href="../../assets/css/checkmk.css?id=4473d2acbb1ea6136428">
<link rel="stylesheet" href="../../assets/css/pygments-monokai.css">
<link rel="stylesheet" href="../../assets/css/addons.css">
<link rel="stylesheet" href="../../assets/css/SourceCodePro.css">
<link rel="search" href="./opensearch.xml" type="application/opensearchdescription+xml" title="Search docs.checkmk.com">
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-NJ3VGL8');</script>
<!-- End Google Tag Manager --><style>
#staticinfo { font-style: italic; }
</style>
</head>
<body class="article toc2 toc-right">
<!-- Cookie Consent (GDPR Compliance) -->

<!-- End Cookie Consent (GDPR Compliance) -->
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NJ3VGL8" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) --><div class="header-top">
<div class="header-top__left">
<a class="header-top__logo d-none d-xl-inline-block" href="/2.1.0/en"><img src="../../assets/images/docs_logo.png" alt="Checkmk"></a><a class="header-top__icon d-inline-block d-xl-none" href="/2.1.0/en"><img src="../../assets/images/logo_icon.svg" alt="Checkmk"></a>
</div>
<div class="header-top__center">
<input type="text" class="header-top__search" placeholder="Search the checkmk docs"><div class="header-top__search__results"></div>
</div>
<div class="header-top__right d-block">
<button class="header-top__search__toggle d-inline-block d-md-none"><img class="header-top__search__toggle__icon" src="../../assets/images/search.svg" alt="Search"></button><div class="dropdown dropdown__language">
                    <button class="btn dropdown-toggle" type="button" id="languageMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">en</button>
                    <div class="dropdown-menu  dropdown-menu-right" aria-labelledby="languageMenuButton"><a class="dropdown-item" href="../../2.1.0/de/mk_filestats.html">Deutsch</a></div>
</div>
<div class="dropdown dropdown__branch">
                        <button class="btn dropdown-toggle" type="button" id="branchMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">2.1.0</button>
                        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="branchMenuButton">
<a class="dropdown-item" href="../../2.2.0/en/mk_filestats.html">2.2.0</a><a class="dropdown-item" href="../../latest/en/mk_filestats.html">latest (2.3.0)</a>
</div>
</div>
<a class="header-top__back d-none d-lg-inline-block" href="https://checkmk.com">to checkmk.com</a><button class="header-top__toggle d-inline-block d-lg-none"><span class="header-top__toggle__icon"></span></button>
</div>
</div>
<aside><div class="main-nav">
<div class="main-nav__content"><div id="content">
<div class="sect1">
<h2 id="_welcome_to_checkmk">
<a class="anchor" href="#_welcome_to_checkmk"></a>1. Welcome to Checkmk</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="welcome.html">Welcome to the Checkmk User Guide</a></p>
</li>
<li>
<p><a href="glossar.html">Glossary</a></p>
</li>
<li>
<p><a href="search.html">Searching docs.checkmk.com</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_beginners_guide">
<a class="anchor" href="#_beginners_guide"></a>2. Beginner’s Guide</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="intro_setup.html">Setting up Checkmk</a></p>
</li>
<li>
<p><a href="intro_gui.html">The Checkmk user interface</a></p>
</li>
<li>
<p><a href="intro_setup_monitor.html">Setting up monitoring</a></p>
</li>
<li>
<p><a href="intro_tools.html">The monitoring tools</a></p>
</li>
<li>
<p><a href="intro_monitor.html">Checkmk in monitoring</a></p>
</li>
<li>
<p><a href="intro_finetune.html">Fine-tuning the monitoring</a></p>
</li>
<li>
<p><a href="intro_users.html">Working with multiple users</a></p>
</li>
<li>
<p><a href="intro_notifications.html">Switching on notifications</a></p>
</li>
<li>
<p><a href="intro_extend.html">Extending the monitoring system further</a></p>
</li>
<li>
<p><a href="intro_bestpractise.html">Best practices, tips &amp; tricks</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_installation">
<a class="anchor" href="#_installation"></a>3. Installation</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="install_packages.html">Basic information on the installation of Checkmk</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_server_and_vms">
<a class="anchor" href="#_server_and_vms"></a>3.1. Server and VMs</h3>
<div class="ulist">
<ul>
<li>
<p><a href="install_packages_debian.html">Installation on Debian and Ubuntu</a></p>
</li>
<li>
<p><a href="install_packages_redhat.html">Installation on Red Hat and CentOS</a></p>
</li>
<li>
<p><a href="install_packages_sles.html">Installation on SUSE Linux Enterprise Server</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_appliance_container_cloud">
<a class="anchor" href="#_appliance_container_cloud"></a>3.2. Appliance, container, cloud</h3>
<div class="ulist">
<ul>
<li>
<p><a href="install_appliance_cmk.html">Installation of Checkmk in the appliance</a></p>
</li>
<li>
<p><a href="introduction_docker.html">Installation as a Docker container</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_updates">
<a class="anchor" href="#_updates"></a>3.3. Updates</h3>
<div class="ulist">
<ul>
<li>
<p><a href="update.html">Updates and upgrades</a></p>
</li>
<li>
<p><a href="update_major.html">Update to version <span class="new">2.1.0</span></a></p>
</li>
<li>
<p><a href="update_matrix.html">Update matrix for version <span class="new">2.1.0</span></a></p>
</li>
<li>
<p><a href="release_upgrade.html">Linux upgrade on the Checkmk server</a></p>
</li>
<li>
<p><a href="cmk_versions.html">Checkmk versions</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_administration_of_checkmk">
<a class="anchor" href="#_administration_of_checkmk"></a>4. Administration of Checkmk</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_server">
<a class="anchor" href="#_server"></a>4.1. Server</h3>
<div class="ulist">
<ul>
<li>
<p><a href="saml.html">Authentication with SAML</a></p>
</li>
<li>
<p><a href="kerberos.html">Single sign-on with Kerberos</a></p>
</li>
<li>
<p><a href="managing_docker.html">Checkmk server in a Docker container</a></p>
</li>
<li>
<p><a href="security.html">Security</a></p>
</li>
<li>
<p><a href="ports.html">Ports</a></p>
</li>
<li>
<p><a href="omd_https.html">Securing the web interface with HTTPS</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_sites">
<a class="anchor" href="#_sites"></a>4.2. Sites</h3>
<div class="ulist">
<ul>
<li>
<p><a href="omd_basics.html">Site administration with omd</a></p>
</li>
<li>
<p><a href="cmk_commandline.html">Checkmk on the command line</a></p>
</li>
<li>
<p><a href="license.html">Managing licenses</a></p>
</li>
<li>
<p><a href="distributed_monitoring.html">Distributed monitoring</a></p>
</li>
<li>
<p><a href="backup.html">Backups</a></p>
</li>
<li>
<p><a href="analyze_configuration.html">Analyzing the Checkmk site configuration</a></p>
</li>
<li>
<p><a href="mkps.html">Checkmk extension packages (MKPs)</a></p>
</li>
<li>
<p><a href="simulation_mode.html">Simulation mode</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_configuration">
<a class="anchor" href="#_configuration"></a>5. Configuration</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="wato.html">Configuring Checkmk</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_hosts">
<a class="anchor" href="#_hosts"></a>5.1. Hosts</h3>
<div class="ulist">
<ul>
<li>
<p><a href="hosts_setup.html">Host administration</a></p>
</li>
<li>
<p><a href="hosts_structure.html">Host structuring</a></p>
</li>
<li>
<p><a href="host_tags.html">Host tags</a></p>
</li>
<li>
<p><a href="dcd.html">Dynamic host configuration</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_services">
<a class="anchor" href="#_services"></a>5.2. Services</h3>
<div class="ulist">
<ul>
<li>
<p><a href="wato_services.html">Understanding and configuring services</a></p>
</li>
<li>
<p><a href="clustered_services.html">Monitoring cluster services</a></p>
</li>
<li>
<p><a href="piggyback.html">The piggyback mechanism</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_rules">
<a class="anchor" href="#_rules"></a>5.3. Rules</h3>
<div class="ulist">
<ul>
<li>
<p><a href="wato_rules.html">Host and service parameters</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_supporting_configurations">
<a class="anchor" href="#_supporting_configurations"></a>5.4. Supporting configurations</h3>
<div class="ulist">
<ul>
<li>
<p><a href="timeperiods.html">Time periods</a></p>
</li>
<li>
<p><a href="labels.html">Labels</a></p>
</li>
<li>
<p><a href="regexes.html">Regular expressions in Checkmk</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_users_and_permissions">
<a class="anchor" href="#_users_and_permissions"></a>5.5. Users and permissions</h3>
<div class="ulist">
<ul>
<li>
<p><a href="wato_user.html">Users, roles and permissions</a></p>
</li>
<li>
<p><a href="ldap.html">User management with LDAP/Active Directory</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_notifications">
<a class="anchor" href="#_notifications"></a>5.6. Notifications</h3>
<div class="ulist">
<ul>
<li>
<p><a href="notifications.html">Introduction to notifications</a></p>
</li>
<li>
<p><a href="notifications_jira.html">Notifications via Jira</a></p>
</li>
<li>
<p><a href="notifications_mattermost.html">Notifications via Mattermost</a></p>
</li>
<li>
<p><a href="notifications_pagerduty.html">Notifications via PagerDuty</a></p>
</li>
<li>
<p><a href="notifications_pushover.html">Notifications via Pushover</a></p>
</li>
<li>
<p><a href="notifications_opsgenie.html">Notifications via Opsgenie</a></p>
</li>
<li>
<p><a href="notifications_servicenow.html">Notifications via ServiceNow</a></p>
</li>
<li>
<p><a href="notifications_slack.html">Notifications via Slack</a></p>
</li>
<li>
<p><a href="notifications_splunkoncall.html">Notifications via Splunk On-Call</a></p>
</li>
<li>
<p><a href="notifications_webex.html">Notifications via Cisco Webex Teams</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_events">
<a class="anchor" href="#_events"></a>5.7. Events</h3>
<div class="ulist">
<ul>
<li>
<p><a href="ec.html">The Event Console</a></p>
</li>
<li>
<p><a href="alert_handlers.html">Alert handlers</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_monitoring_systems">
<a class="anchor" href="#_monitoring_systems"></a>6. Monitoring systems</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="wato_monitoringagents.html">Monitoring agents</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_checkmk_agents_and_snmp">
<a class="anchor" href="#_checkmk_agents_and_snmp"></a>6.1. Checkmk agents and SNMP</h3>
<div class="ulist">
<ul>
<li>
<p><a href="agent_deployment.html">Automatic agent updates</a></p>
</li>
<li>
<p><a href="agent_linux.html">Monitoring Linux</a></p>
</li>
<li>
<p><a href="agent_linux_legacy.html">Monitoring Linux in legacy mode</a></p>
</li>
<li>
<p><a href="agent_windows.html">Monitoring Windows</a></p>
</li>
<li>
<p><a href="agent_freebsd.html">Monitoring FreeBSD</a></p>
</li>
<li>
<p><a href="snmp.html">Monitoring via SNMP</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_agent_extensions">
<a class="anchor" href="#_agent_extensions"></a>6.2. Agent extensions</h3>
<div class="ulist">
<ul>
<li>
<p><a href="inventory.html">The HW/SW inventory</a></p>
</li>
<li>
<p><a href="mk_filestats.html">Monitoring files</a></p>
</li>
<li>
<p><a href="monitoring_oracle.html">Monitoring Oracle databases</a></p>
</li>
<li>
<p><a href="monitoring_mysql.html">Monitoring MySQL</a></p>
</li>
<li>
<p><a href="monitoring_mssql.html">Monitoring MSSQL</a></p>
</li>
<li>
<p><a href="monitoring_jobs.html">Monitoring time-based processes (Cronjobs)</a></p>
</li>
<li>
<p><a href="spool_directory.html">The spool directory</a></p>
</li>
<li>
<p><a href="localchecks.html">Local checks</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_vm_cloud_container">
<a class="anchor" href="#_vm_cloud_container"></a>6.3. VM, cloud, container</h3>
<div class="ulist">
<ul>
<li>
<p><a href="datasource_programs.html">Datasource programs</a></p>
</li>
<li>
<p><a href="monitoring_vmware.html">Monitoring VMWare ESXi</a></p>
</li>
<li>
<p><a href="monitoring_aws.html">Monitoring Amazon Web Services (AWS)</a></p>
</li>
<li>
<p><a href="monitoring_azure.html">Monitoring Microsoft Azure</a></p>
</li>
<li>
<p><a href="monitoring_kubernetes.html">Monitoring Kubernetes</a></p>
</li>
<li>
<p><a href="monitoring_docker.html">Monitoring Docker</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_endpoints">
<a class="anchor" href="#_endpoints"></a>6.4. Endpoints</h3>
<div class="ulist">
<ul>
<li>
<p><a href="active_checks.html">Monitoring network services (Active checks)</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_dashboards_views_metrics">
<a class="anchor" href="#_dashboards_views_metrics"></a>7. Dashboards, views, metrics</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="user_interface.html">The user interface</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_general">
<a class="anchor" href="#_general"></a>7.1. General</h3>
<div class="ulist">
<ul>
<li>
<p><a href="views.html">Host and service views</a></p>
</li>
<li>
<p><a href="dashboards.html">Dashboards</a></p>
</li>
<li>
<p><a href="graphing.html">Performance data and graphing</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_commands_in_views">
<a class="anchor" href="#_commands_in_views"></a>7.2. Commands in views</h3>
<div class="ulist">
<ul>
<li>
<p><a href="commands.html">Commands</a></p>
</li>
<li>
<p><a href="basics_ackn.html">Acknowledging problems</a></p>
</li>
<li>
<p><a href="basics_downtimes.html">Scheduled downtimes</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_analysis_and_prognosis">
<a class="anchor" href="#_analysis_and_prognosis"></a>8. Analysis and prognosis</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_analysis">
<a class="anchor" href="#_analysis"></a>8.1. Analysis</h3>
<div class="ulist">
<ul>
<li>
<p><a href="availability.html">Availability</a></p>
</li>
<li>
<p><a href="sla.html">Extended availability (SLAs)</a></p>
</li>
<li>
<p><a href="bi.html">Business Intelligence (BI)</a></p>
</li>
<li>
<p><a href="reporting.html">Reports</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_prognosis">
<a class="anchor" href="#_prognosis"></a>8.2. Prognosis</h3>
<div class="ulist">
<ul>
<li>
<p><a href="predictive_monitoring.html">Predictive monitoring</a></p>
</li>
<li>
<p><a href="forecast_graphs.html">Forecast graphs</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_connection_of_other_applications">
<a class="anchor" href="#_connection_of_other_applications"></a>9. Connection of other applications</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="monitoring_prometheus.html">Integrating Prometheus</a></p>
</li>
<li>
<p><a href="integrating_datadog.html">Integrating Datadog</a></p>
</li>
<li>
<p><a href="nagvis.html">NagVis: status data on maps and diagrams</a></p>
</li>
<li>
<p><a href="ntop.html">Integrating ntopng in Checkmk</a></p>
</li>
<li>
<p><a href="grafana.html">Integrating Checkmk in Grafana</a></p>
</li>
<li>
<p><a href="metrics_exporter.html">Sending metrics to InfluxDB and Graphite</a></p>
</li>
<li>
<p><a href="nagstamon.html">Integrating Checkmk in Nagstamon</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_specifics_to_the_editions">
<a class="anchor" href="#_specifics_to_the_editions"></a>10. Specifics to the editions</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="support_diagnostics.html">Support diagnostics</a></p>
</li>
<li>
<p><a href="managed.html">The Managed Services Edition</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_automation_and_development">
<a class="anchor" href="#_automation_and_development"></a>11. Automation and development</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_apis_for_automation">
<a class="anchor" href="#_apis_for_automation"></a>11.1. APIs for automation</h3>
<div class="ulist">
<ul>
<li>
<p><a href="rest_api.html">Configuration via the Checkmk REST-API</a></p>
</li>
<li>
<p><a href="livestatus.html">Retrieving status data via Livestatus</a></p>
</li>
<li>
<p><a href="livestatus_references.html">Livestatus command reference</a></p>
</li>
<li>
<p><a href="web_api.html">Configuration via HTTP-API</a></p>
</li>
<li>
<p><a href="web_api_references.html">Command reference for the HTTP-API</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_apis_for_development">
<a class="anchor" href="#_apis_for_development"></a>11.2. APIs for development</h3>
<div class="ulist">
<ul>
<li>
<p><a href="bakery_api.html">The Bakery-API</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_development_of_check_plug_ins">
<a class="anchor" href="#_development_of_check_plug_ins"></a>11.3. Development of check plug-ins</h3>
<div class="ulist">
<ul>
<li>
<p><a href="devel_check_plugins.html">Writing your own check plug-ins</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_concepts">
<a class="anchor" href="#_concepts"></a>12. Concepts</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="monitoring_basics.html">Basic principles of monitoring with Checkmk</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_the_checkmk_micro_core_cmc">
<a class="anchor" href="#_the_checkmk_micro_core_cmc"></a>12.1. The Checkmk Micro Core (CMC)</h3>
<div class="ulist">
<ul>
<li>
<p><a href="cmc.html">The Checkmk Micro Core (CMC)</a></p>
</li>
<li>
<p><a href="cmc_differences.html">Special characteristics of the CMC</a></p>
</li>
<li>
<p><a href="cmc_migration.html">Migration to the CMC</a></p>
</li>
<li>
<p><a href="cmc_files.html">CMC files and directories</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_checkmk_appliance">
<a class="anchor" href="#_the_checkmk_appliance"></a>13. The Checkmk appliance</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="appliance_rack1_quick_start.html">Quick start guide for Checkmk racks</a></p>
</li>
<li>
<p><a href="appliance_virt1_quick_start.html">Quick start guide for Checkmk virt1</a></p>
</li>
<li>
<p><a href="appliance_install_virt1.html">Installation of the virtual appliance</a></p>
</li>
<li>
<p><a href="appliance_usage.html">Configuring and using the appliance</a></p>
</li>
<li>
<p><a href="appliance_backup.html">Backup in the appliance</a></p>
</li>
<li>
<p><a href="appliance_cluster.html">Appliance in cluster operation</a></p>
</li>
<li>
<p><a href="appliance_rack_config.html">Special features of the hardware appliance</a></p>
</li>
</ul>
</div>
</div>
</div>
</div></div>
<div class="main-nav__utils">
<div class="dropup dropdown__utils">
<button class="btn dropdown-toggle" type="button" id="aboutMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">About Checkmk</button><div class="dropdown-menu dropup" aria-labelledby="aboutMenuButton">
<a class="dropdown-item" href="https://checkmk.com/product/features" target="_blank">Features</a><a class="dropdown-item" href="https://checkmk.com/product/editions" target="_blank">Editions</a><a class="dropdown-item" href="https://checkmk.com/integrations" target="_blank">Integrations</a><a class="dropdown-item" href="https://checkmk.com/imprint" target="_blank">Imprint</a><a class="dropdown-item" href="copyright.html" target="_blank">Copyright</a>
</div>
</div>
<div class="dropup dropdown__utils">
<button class="btn dropdown-toggle" type="button" id="learnMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Learn</button><div class="dropdown-menu dropup" aria-labelledby="learnMenuButton">
<a class="dropdown-item" href="https://checkmk.com/videos">Videos</a><a class="dropdown-item" href="https://checkmk.com/webinars">Webinars</a><a class="dropdown-item" href="https://checkmk.com/trainings/classes">Trainings</a>
</div>
</div>
<a class="main-nav__utils__link" href="https://forum.checkmk.com">Forum</a>
</div>
</div></aside><main><div id="header">
<h1>Monitoring files</h1>
<div class="details">
<span id="revdate">Last modified on 01-Dec-2021</span><a class="edit-document" href="https://github.com/Checkmk/checkmk-docs/edit/2.1.0/en/mk_filestats.asciidoc">Edit this page on GitHub</a>
</div>
</div>
<div id="content">
<div id="preamble">
<div id="staticinfo">This page was exported for offline usage on 2025-01-07 22:12:14 +0000. It may not reflect the current state of the Checkmk documentation. To view a daily updated version, visit <a href="https://docs.checkmk.com/" target="_blank">docs.checkmk.com</a>.</div>
<div class="sectionbody"><div class="paragraph">
<p></p>
<div class="dropdown dropdown__related">
<button class="btn btn-primary dropdown-toggle" type="button" id="relatedMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Related Articles</button><div class="dropdown-menu dropdown-menu-right" aria-labelledby="relatedMenuButton">
<a href="wato.html">Configuring Checkmk</a>
<a href="wato_services.html">Understanding and configuring services</a>
</div>
</div>
</div></div>
</div>
<div class="sect1">
<h2 id="heading_basics">
<span class="hidden-anchor sr-only" id="basics"></span>1. The basics of file monitoring</h2>
<div class="sectionbody">
<div class="paragraph"><p>With Checkmk you can monitor files for number, size and age, individually or in groups.
This function can be used in many different ways, such as monitoring the success of backup strategies for example:
Are any of the backups older than X days? Is one of the backups suspiciously large or small?
You can also check company-wide file servers to see if users are misusing them as private storage for movies, or keep an eye on classic swap files or volatile files like containers.</p></div>
<div class="paragraph"><p>The basic procedure is in accordance with the Checkmk standard:
A plug-in/configuration is installed in the agent which brings the desired information on files or file groups into the monitoring.
There, corresponding rule sets are used to determine which properties lead to which statuses.</p></div>
<div class="paragraph"><p>The actual filtering, i.e. determining which data actually ends up in the monitoring, takes place in the agent.
You can use globbing patterns to recursively include files from entire directories, for example, or only certain file types or even individual files.
Using globbing patterns such as <code>/myfiles/*.*</code>, you may end up with enormously large file lists, even though you may only be interested in particularly old or large files.
Due to this fact, there are currently two agent and associated monitoring rule sets:
The older <em>fileinfo</em> is already built into the agent and filters only by globbing pattern/path, the newer <em>mk_filestats</em> must be installed separately as a plug-in and filters by other properties.</p></div>
<div class="paragraph"><p>There are other differences between mk_filestats and fileinfo, which we will explain below.
The most important difference, however, is that mk_filestats can only monitor Linux hosts, while fileinfo can also monitor Windows hosts.
For Linux hosts, you should usually use the more up-to-date mk_filestats.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="heading_differences">
<span class="hidden-anchor sr-only" id="differences"></span>2. The differences between mk_filestats and fileinfo</h2>
<div class="sectionbody">
<div class="paragraph"><p>If you want to see the rule sets for the two variants side by side for the sake of clarity, simply type <code>size age</code> in the <span class="guihint">Setup</span> menu.
The rules for individual files and groups are named (largely) identically, but the mk_filestats rules are explicitly identified as such.
Both variants of service rules are additionally available as <a href="wato_services.html#enforced_services">enforced services.</a></p></div>
<div class="imageblock">
<div class="content"><img src="../images/filestats_setup_menu.png" alt="Setup menu with mk_filestats and fileinfo entries."></div>
<div class="title">fileinfo rules are not explicitly marked as such</div>
</div>
<div class="paragraph"><p>Differences between the two variants exist at the agent and service levels.
To begin with, here are the basic theoretical differences.
You will find specific details later in the instructions for the mk_filestats agent plug-in as well as for the agent’s fileinfo.</p></div>
<div class="paragraph"><p>In the case of the agent, mk_filestats is distinguished by two options that fileinfo lacks:
Firstly, mk_filestats offers the additional filtering options already mentioned, namely by file size, number and name, the latter in the form <a href="regexes.html">regular expressions</a>.
For example, with a <code>/myfiles/*</code> globbing pattern, you could bring only those files into monitoring that are larger than 1 KB and contain <code>backup</code> somewhere in the filename.
On the other hand, with mk_filestats, file groups are also specified directly in the plug-in configuration, simply by creating multiple filters, each of which then ends up as its own <a href="wato_monitoringagents.html#diagnostics">section</a> in the agent output and which can later be addressed by rules via the section names.</p></div>
<div class="paragraph"><p>For <strong>service monitoring rules</strong>, the approaches used by mk_filestats and fileinfo differ more in their details.
Both can restrict evaluations to specific <a href="timeperiods.html">time periods</a>, but only fileinfo allows explicit specification of time windows per day directly in the rule.
Also exclusively, fileinfo can configure so-called <span class="guihint">conjunctions</span> for file groups.
This associates a set of conditions for each status, so for example:
"The status goes to <span class="state2">CRIT</span> as soon as the oldest file in the group is exactly 5 hours old <strong>and</strong> the smallest file is exactly 8 megabytes."
In turn, for file groups, mk_filestats provides the option to define outliers:
Suppose a file group is supposed to go to <span class="state2">CRIT</span> as soon as the group size exceeds 2 gigabytes.
However, if the group should <strong>not</strong> go to <span class="state2">CRIT</span> when a certain single file alone exceeds 1 gigabyte (such as a temporary file), you can define this as a special case, overriding the group rule on a case-by-case basis.</p></div>
<div class="paragraph"><p>An overview of the differences:</p></div>
<table class="table-responsive table-bordered table tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 40%;">
</colgroup>
<thead><tr>
<th class="tableblock halign-left valign-top">Feature</th>
<th class="tableblock halign-left valign-top">mk_filestats</th>
<th class="tableblock halign-left valign-top">fileinfo</th>
</tr></thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Supported operating systems</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Linux</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Linux and Windows</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Agent</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Agent plug-in</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Included in agent</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Filter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Filters directly in the agent for globbing patterns and properties</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Filters in the agent only for globbing patterns</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">File lists</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Delivers lean file lists</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Delivers sometimes verbose file lists</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">File grouping</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Groups directly in the agent</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Groups via a separate monitoring rule set</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Display files</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Show files in service details optionally</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always show files in service details</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">File evaluation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Can consider outliers in files</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Can consider relationships between files</p></td>
</tr>
</tbody>
</table>
<div class="paragraph"><p>In the following chapters you will see the two functions individually in practical examples — the differences and features described should then become clearer.
mk_filestats itself also provides detailed information via the call <code>filestats.py --help</code>.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="heading_mk_filestats">
<span class="hidden-anchor sr-only" id="mk_filestats"></span>3. Monitoring files with mk_filestats (Linux)</h2>
<div class="sectionbody">
<div class="paragraph"><p>The following example shows the procedure for groups of files.
For individual files the procedure is identical, there are simply fewer options.
Suppose you want to monitor a <strong>group</strong> of a certain number of backup files (<code>mybackup_01.zip</code> etc.) and these files should not fall below a minimum size, then you can proceed as follows:</p></div>
<div class="sect2">
<h3 id="heading_mk_filestats_agent_rule">
<span class="hidden-anchor sr-only" id="mk_filestats_agent_rule"></span>3.1. Configuring the rule for the agent plug-in</h3>
<div class="sect3">
<h4 id="heading__configuration_via_the_agent_bakery">
<span class="hidden-anchor sr-only" id="_configuration_via_the_agent_bakery"></span>Configuration via the Agent Bakery</h4>
<div class="paragraph"><p><span class="image-inline"><img src="../images/CEE.svg" alt="CEE" class="icon-left"></span> In the <span class="image-inline"><img src="../images/CEE.svg" alt="CEE" width="20" title="Checkmk Enterprise Editions"></span> <strong>Checkmk Enterprise Editions</strong>, first call the rule for the agent plug-in <span class="guihint">Setup &gt; Agents &gt; Windows, Linux, Solaris, AIX &gt; Agent rules &gt; Count, size and age of files - mk_filestats (Linux)</span>.
Under <span class="guihint">Section name</span> you assign an arbitrary name, which appears later in the agent output as an independent section.</p></div>
<div class="paragraph"><p>Under <span class="guihint">Globbing pattern for input files</span> you then specify which files are to be monitored.
You can use globbing patterns, i.e. ultimately file path specifications with placeholders.
At this point, we want to use an absolute path specification that includes all files in the specified folder.</p></div>
<div class="paragraph"><p>Further filtering is done by the next two options: <span class="guihint">Filter files by matching regular expression</span> includes files according to a specified template, in this example files with <code>my</code> somewhere in their names, and
<span class="guihint">Filter files by not matching regular expression</span> which then excludes files, here those ending in <code>tmp</code>.</p></div>
<div class="imageblock">
<div class="content"><img src="../images/filestats_agent_rule.png" alt="Form to configure the agent plug-in mk_filestats."></div>
<div class="title">Pay attention to the distinction between globs and regular expressions.</div>
</div>
<div class="paragraph"><p>This completes the configuration and you can distribute the plug-in including its configuration via the <a href="agent_linux.html#install_plugins_using_bakery">Agent Bakery</a>.</p></div>
</div>
<div class="sect3">
<h4 id="heading__manual_configuration">
<span class="hidden-anchor sr-only" id="_manual_configuration"></span>Manual configuration</h4>
<div class="paragraph"><p><span class="image-inline"><img src="../images/CRE.svg" alt="CRE" class="icon-left"></span> In the <span class="image-inline"><img src="../images/CRE.svg" alt="CRE" width="20" title="Checkmk Raw Edition"></span> <strong>Checkmk Raw Edition</strong> you configure the plug-in as usual using a text file:
as the site user you can find an sample configuration in the <code>share/check_mk/agents/cfg_examples/filestats.cfg</code> file.
A configuration according to the above specifications then looks like this:</p></div>
<div class="listingblock">
<div class="title">/etc/check_mk/filestats.cfg</div>
<div class="content"><pre class="pygments highlight"><code><span></span>[myfiles]
input_patterns: /media/evo/myfiles/
filter_regex: .*my.*
filter_regex_inverse: tmp$</code></pre></div>
</div>
<div class="paragraph"><p>This completes the configuration and you can install the agent plug-in <a href="agent_linux.html#manualplugins">manually</a>.</p></div>
</div>
<div class="sect3">
<h4 id="heading__data_in_the_agent_output">
<span class="hidden-anchor sr-only" id="_data_in_the_agent_output"></span>Data in the agent output</h4>
<div class="paragraph"><p>You will then find the result from your configuration in the form of raw data in the agent output:</p></div>
<div class="listingblock">
<div class="title">mysite-myhost-agent.txt</div>
<div class="content"><pre class="pygments highlight"><code><span></span>&lt;&lt;&lt;filestats:sep(0)&gt;&gt;&gt;
[[[file_stats myfiles]]]
{'type': 'file', 'path': '/media/evo/myfiles/mybackup_01.zip', 'stat_status': 'ok', 'size': 13146562, 'age': 339080, 'mtime': 1633966263}
{'type': 'file', 'path': '/media/evo/myfiles/mybackup_02.zip', 'stat_status': 'ok', 'size': 13145766, 'age': 325141, 'mtime': 1633980202}
{'type': 'file', 'path': '/media/evo/myfiles/mybackup_03.zip', 'stat_status': 'ok', 'size': 13151050, 'age': 325352, 'mtime': 1633979991}
...</code></pre></div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="heading_mk_filestats_service_rule">
<span class="hidden-anchor sr-only" id="mk_filestats_service_rule"></span>3.2. Service rule configuration</h3>
<div class="paragraph"><p>The monitoring now has access to the file data via the agent.
For evaluation, call the rule <span class="guihint">Setup &gt; Services &gt; Service monitoring rules &gt; Size, age and count of file groups (mk_filestats)</span>.
In our example, we want to be warned as soon as a specified number of files is exceeded or not reached.
This is done by the options <span class="guihint">Minimal file count</span> and <span class="guihint">Maximal file count</span>, which are used to set upper and lower limits. All other minimum-maximum options work analogously.</p></div>
<div class="imageblock">
<div class="content"><img src="../images/filestats_service_rule_group_value_1.png" alt="Form with upper and lower limits for file monitoring."></div>
<div class="title">Part 1/3: <span class="state0">OK</span> are here exclusively 7 or 8 files</div>
</div>
<div class="paragraph"><p>But which file then generates, for example, a <span class="state2">CRIT</span> status?
The option <span class="guihint">Show files in service details</span> helps here:
If this is enabled, you will see all affected files listed in the service details view.</p></div>
<div class="imageblock" id="showfiles">
<div class="content"><img src="../images/filestats_service_rule_group_value_2.png" alt="Specifying to show individual files in service details."></div>
<div class="title">Part 2/3: This option provides transparency — but can also produce very long lists</div>
</div>
<div class="paragraph"><p>Now it could be that the correct number of files is present, but there are also outliers with respect to their sizes, for example.
For such exceptions you can use the option <span class="guihint">Additional rules for outliers</span>:
This specifies, for example, that for files below 5 megabytes the status <span class="state1">WARN</span> is set, below 1 megabyte the service goes to <span class="state2">CRIT</span>.
This can be useful for being notified of possibly defective backups for instance.</p></div>
<div class="imageblock">
<div class="content"><img src="../images/filestats_service_rule_group_value_3.png" alt="Specifying outliers in the monitored files."></div>
<div class="title">Part 3/3: files must be at least 5 MB, otherwise a warning will be issued</div>
</div>
<div class="paragraph"><p>In the <span class="guihint">Conditions</span> box, you can now specify that the rule should apply exclusively to the <code>myfiles</code> file group configured in the agent plug-in:
To do this, enter the name you assigned in the agent plug-in under <span class="guihint">Section name</span> as <span class="guihint">File Group Name</span>.</p></div>
<div class="imageblock">
<div class="content"><img src="../images/filestats_service_rule_group_condition.png" alt="Filter on files in the myfiles group."></div>
<div class="title">
<span class="guihint">File Group Name</span> corresponds to <span class="guihint">Section Name</span> in the plug-in rule</div>
</div>
<div class="paragraph"><p>This also completes the service rule.
You could also optionally limit the evaluation to a single <a href="timeperiods.html">time period</a>.
Once completed add the new service to the affected hosts and activate the changes as usual.</p></div>
</div>
<div class="sect2">
<h3 id="heading_mk_filestats_monitoring">
<span class="hidden-anchor sr-only" id="mk_filestats_monitoring"></span>3.3. mk_filestats in monitoring</h3>
<div class="paragraph"><p>You can then see the evaluation from the monitoring in lists and, of course, in the details.
In addition to the parameters for the service, you will now also be able to see the files that are responsible for the <span class="state1">WARN</span> or <span class="state2">CRIT</span> status.</p></div>
<div class="imageblock">
<div class="content"><img src="../images/filestats_service_monitoring.png" alt="Service details in monitoring for the WARN status."></div>
<div class="title">The files responsible for the status are revealed by mk_filestats in the monitoring</div>
</div>
<div class="paragraph"><p>However, caution is advised with the <a href="#showfiles">Show files in service details</a> option:
If many files have been responsible for a status change, they will all be listed, which can lead to long lists and associated performance and view issues.</p></div>
<div class="imageblock">
<div class="content"><img src="../images/filestats_many_files.png" alt="Service details in monitoring for CRIT status."></div>
<div class="title">Imprecise regular expressions can produce huge lists</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="heading_fileinfo">
<span class="hidden-anchor sr-only" id="fileinfo"></span>4. Monitoring files with fileinfo (Linux, Windows)</h2>
<div class="sectionbody">
<div class="paragraph"><p>Monitoring files with fileinfo is basically the same as with mk_filestats, so the procedure here is a bit shortened, but is once again for file groups.</p></div>
<div class="sect2">
<h3 id="heading_fileinfo_agent_rule">
<span class="hidden-anchor sr-only" id="fileinfo_agent_rule"></span>4.1. Configuring the rule for the agent</h3>
<div class="sect3">
<h4 id="heading__agent_bakery_configuration">
<span class="hidden-anchor sr-only" id="_agent_bakery_configuration"></span>Agent Bakery configuration</h4>
<div class="paragraph"><p><span class="image-inline"><img src="../images/CEE.svg" alt="CEE" class="icon-left"></span> The configuration of the agent in the <span class="image-inline"><img src="../images/CEE.svg" alt="CEE" width="20" title="Checkmk Enterprise Editions"></span> <strong>Checkmk Enterprise Editions</strong> under <span class="guihint">Setup &gt; Agents &gt; Windows, Linux, Solaris, AIX &gt; Agent rules &gt; Count, size and age of files (Linux, Windows)</span> is much simpler:
Here you only define the file path in the form of a globbing template.
This also raises the problem of transferring extremely long file lists, which can noticeably slow down monitoring. In addition, a separate service is created by default for each file found, which can only be avoided by forming groups.</p></div>
<div class="imageblock">
<div class="content"><img src="../images/filestats_fileinfo_agent_rule.png" alt="Rule for fileinfo with filtering on the Windows path."></div>
<div class="title">Monitoring all files under this path</div>
</div>
<div class="paragraph"><p><strong>Additional date:</strong> There is an additional, slightly-hidden filter option:
In the globbing pattern, you can use the <code>$DATE</code> variable to include only files whose names contain the current date.
The format of this variable is the same as that for the Linux program <code>date</code>.</p></div>
<div class="imageblock">
<div class="content"><img src="../images/filestats_fileinfo_date_rule.png" alt="Rule for fileinfo with filtering by date variable."></div>
<div class="title">Under Linux, files with timestamps in their names can only be addressed explicitly</div>
</div>
<div class="paragraph"><p>A specification like <code>/backups/mybackup_*_$DATE:%Y%m%d$</code> would — as of today, 10/22/2021 — consequently find files such as <code>mybackup_01_20211022</code> and <code>mybackup_foobar_20211022</code>:</p></div>
<div class="imageblock">
<div class="content"><img src="../images/filestats_fileinfo_date_monitoring.png" alt="File in the monitoring, filtered by the date in the file name."></div>
<div class="title">For backup files, timestamps and a daily check are useful</div>
</div>
<div class="paragraph"><p>More information can be found directly on the rule’s page as well as in the related inline help.</p></div>
<div class="paragraph"><p>This completes the configuration and you can deploy the plug-in including its configuration via the <a href="agent_deployment.html">Agent Bakery</a>.</p></div>
</div>
<div class="sect3">
<h4 id="heading__manual_configuration_2">
<span class="hidden-anchor sr-only" id="_manual_configuration_2"></span>Manual configuration</h4>
<div class="paragraph"><p><span class="image-inline"><img src="../images/CRE.svg" alt="CRE" class="icon-left"></span> In the <span class="image-inline"><img src="../images/CRE.svg" alt="CRE" width="20" title="Checkmk Raw Edition"></span> <strong>Checkmk Raw Edition</strong> with fileinfo you must also configure using files, which vary according to the operating system:</p></div>
<div class="paragraph"><p><strong>Linux:</strong> the configuration file is <code>fileinfo.cfg</code>:</p></div>
<div class="listingblock">
<div class="title">/etc/check_mk/fileinfo.cfg</div>
<div class="content"><pre class="pygments highlight"><code><span></span>C:\myfiles\*
/myfiles/*
/media/evo/test_$DATE:%Y%m%d$</code></pre></div>
</div>
<div class="paragraph"><p><strong>Windows:</strong> the configuration file is <code>check_mk.user.yml</code>:</p></div>
<div class="listingblock">
<div class="title">C:\ProgramData\checkmk\agent\check_mk.user.yml</div>
<div class="content"><pre class="pygments highlight"><code><span></span>fileinfo:
  enabled: yes
  path:
  - 'c:\myfiles\*.*'
  - "c:\\myfiles\\*.*"
  - /media/evo/test_$DATE:%Y%m%d$</code></pre></div>
</div>
<div class="paragraph"><p>Note the different Windows file path notations here — in double quotes, the backslashes must be escaped.</p></div>
<div class="paragraph"><p>This completes the configuration and you can manually install the plug-in on <a href="agent_linux.html#manualplugins">Linux</a> or on <a href="agent_windows.html#manual_installation_of_plugins">Windows</a>.</p></div>
</div>
<div class="sect3">
<h4 id="heading__data_in_the_agent_output_2">
<span class="hidden-anchor sr-only" id="_data_in_the_agent_output_2"></span>Data in the agent output</h4>
<div class="paragraph"><p>You will then find the result from your configuration in the form of raw data in the agent output, starting with the section heading <span class="guihint">fileinfo:</span></p></div>
<div class="listingblock">
<div class="title">mysite-myhost-agent.txt</div>
<div class="content"><pre class="pygments highlight"><code><span></span> &lt;&lt;fileinfo:sep(124)&gt;&gt;&gt;
1634131485
C:\myfiles\myfile|12|1632490780
C:\myfiles\myfile2|12|1632490780
C:\myfiles\myfile3|12|1632490780
...</code></pre></div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="heading_fileinfo_service_rule">
<span class="hidden-anchor sr-only" id="fileinfo_service_rule"></span>4.2. Service rule configuration</h3>
<div class="paragraph"><p>In the second step, the service rule <span class="guihint">Setup &gt; Services &gt; Service monitoring rules &gt; Size, age and count of file groups</span> is configured again.
The minimum-maximum options correspond to those of mk_filestats, but the options for displaying the affected file names in the service details and for outliers are not present here.
There are two additional options for this:
First, you can directly enter a time period via <span class="guihint">Add time range</span> — outside this time period the service will always have an <span class="state0">OK</span> status.</p></div>
<div class="paragraph"><p>On the other hand, the powerful <span class="guihint">Level conjunctions</span> feature is available:
This allows you to set series of conditions for each of the four states <span class="state0">OK</span>, <span class="state1">WARN</span>, <span class="state2">CRIT</span>, and <span class="state3">UNKNOWN</span>.
For example, you could specify that the service goes to <span class="state2">CRIT</span> if…​</p></div>
<div class="ulist"><ul>
<li><p>there are exactly 7 files</p></li>
<li><p>the smallest file is less than 10 megabytes,</p></li>
<li><p>the oldest file is less than 5 days old</p></li>
</ul></div>
<div class="imageblock">
<div class="content"><img src="../images/filestats_fileinfo_service_rule.png" alt="Specifying conditions for files monitored with fileinfo."></div>
<div class="title">
<span class="guihint">Level conjunctions</span> also allow the definition of explicit exceptions</div>
</div>
<div class="paragraph"><p>And again, you can restrict this rule to the desired <code>myfiles</code> group with <span class="guihint">File Group Name</span> in the <span class="guihint">Conditions</span> box.</p></div>
<div class="imageblock">
<div class="content"><img src="../images/filestats_fileinfo_grouping_pattern.png" alt="Filtering of files in the group myfiles."></div>
<div class="title">Input fields do not always behave identically — the inline help always provides further details</div>
</div>
<div class="paragraph"><p><strong>Additional date:</strong> Again the use of the <code>$DATE</code> variable is possible. As an alternative you can also use <code>$YESTERDAY</code> for filtering, which simply subtracts one day from <code>$DATE</code>.
As always, you can get more info on this in the inline help.</p></div>
</div>
<div class="sect2">
<h3 id="heading_fileinfo_monitoring">
<span class="hidden-anchor sr-only" id="fileinfo_monitoring"></span>4.3. fileinfo in monitoring</h3>
<div class="paragraph"><p>In monitoring, the view of a fileinfo group is not very different from an mk_filestats group.
However, fileinfo always lists all affected files explicitly, regardless of whether they are responsible for a status change or not.
Here in the example you can see the two files <code>yourfile</code> with 0 megabytes which has no effect on the status, and <code>yourfile_2.exe</code> with its almost 11 megabytes which thus triggers the <span class="state2">CRIT</span> status:</p></div>
<div class="imageblock">
<div class="content"><img src="../images/filestats_fileinfo_service_monitoring.png" alt="A fileinfo group in monitoring."></div>
<div class="title">
<code>yourfile</code> is displayed by fileinfo, although it is not responsible for the status change</div>
</div>
<div class="paragraph"><p>All files delivered to the monitoring by fileinfo and which are not assigned to a group remain as individual services:</p></div>
<div class="imageblock">
<div class="content"><img src="../images/filestats_fileinfo__service_monitoring_singlefiles.png" alt="Single files as separate services in monitoring."></div>
<div class="title">With fileinfo, imprecise globbing patterns can produce huge lists</div>
</div>
<div class="paragraph"><p>This very list shows why it is so important to be precise about filters in fileinfo:
For example, if <code>C:\</code> were specified here without any restrictions, there would subsequently be several hundred thousand individual services in the monitoring.</p></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="heading_troubleshooting">
<span class="hidden-anchor sr-only" id="troubleshooting"></span>5. Troubleshooting</h2>
<div class="sectionbody"><div class="sect2">
<h3 id="heading__no_files_or_too_many_files_in_the_monitoring">
<span class="hidden-anchor sr-only" id="_no_files_or_too_many_files_in_the_monitoring"></span>5.1. No files or too many files in the monitoring</h3>
<div class="paragraph"><p>No matter whether you work with mk_filestats or fileinfo, missing files or even too many entries in the monitoring are often due to incorrect filters.
There are two main causes of this — a conflict between a globbing pattern and a regular expression, or an incorrect configuration.
For example, the asterisk behaves differently in the two variants:
In globbing, <code>*</code> stands as a placeholder for any number of arbitrary characters, and in a regular expression, it stands for one or more occurrences of the character preceding it. In order to match any characters in any quantity via regex, you would have to work with <code>.*</code> accordingly.</p></div>
</div></div>
</div>
<div class="sect1">
<h2 id="heading_files">
<span class="hidden-anchor sr-only" id="files"></span>6. Files and directories</h2>
<div class="sectionbody">
<div class="paragraph"><p>As always, all file paths for the Checkmk server are relative to the site directory (e.g. <code>/omd/sites/mysite</code>).</p></div>
<div class="sect2">
<h3 id="heading__mk_filestats">
<span class="hidden-anchor sr-only" id="_mk_filestats"></span>6.1. mk_filestats</h3>
<table class="table-responsive table-bordered table tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 15%;">
<col style="width: 39%;">
<col style="width: 46%;">
</colgroup>
<thead><tr>
<th class="tableblock halign-left valign-top">Location</th>
<th class="tableblock halign-left valign-top">File path</th>
<th class="tableblock halign-left valign-top">Content</th>
</tr></thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Checkmk-Server</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>share/check_mk/agents/cfg_examples/filestats.cfg</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sample configuration file</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Checkmk-Server</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>share/check_mk/agents/plugins/mk_filestats.py</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Python 3 agent plug-in including explanations</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Checkmk-Server</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>share/check_mk/agents/plugins/mk_filestats_2.py</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Python-2 agent plug-in including explanations</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Linux host</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/etc/check_mk/filestats.cfg</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configuration file - created by the agent bakery or manually</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="heading__fileinfo">
<span class="hidden-anchor sr-only" id="_fileinfo"></span>6.2. fileinfo</h3>
<table class="table-responsive table-bordered table tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 15%;">
<col style="width: 39%;">
<col style="width: 46%;">
</colgroup>
<thead><tr>
<th class="tableblock halign-left valign-top">Location</th>
<th class="tableblock halign-left valign-top">File path</th>
<th class="tableblock halign-left valign-top">Content</th>
</tr></thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Checkmk server</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>share/check_mk/agents/cfg_examples/fileinfo.cfg</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sample configuration file</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Linux host</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/etc/check_mk/fileinfo.cfg</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configuration file - created by the agent bakery or manually</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Windows host</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>C:\ProgramData\checkmk\agent\bakery\check_mk.bakery.yml</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configuration file - created by the agent bakery</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Windows host</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>C:\ProgramData\checkmk\agent\check_mk.user.yml</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configuration file - created manually</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div></main><div id="toc" class="toc2">
<div id="toctitle">On this page</div>
<ul class="sectlevel1">
<li><a href="#basics">1. The basics of file monitoring</a></li>
<li><a href="#differences">2. The differences between mk_filestats and fileinfo</a></li>
<li>
<a href="#mk_filestats">3. Monitoring files with mk_filestats (Linux)</a><ul class="sectlevel1">
<li>
<a href="#mk_filestats_agent_rule">3.1. Configuring the rule for the agent plug-in</a><ul class="sectlevel2">
<li><a href="#_configuration_via_the_agent_bakery">Configuration via the Agent Bakery</a></li>
<li><a href="#_manual_configuration">Manual configuration</a></li>
<li><a href="#_data_in_the_agent_output">Data in the agent output</a></li>
</ul>
</li>
<li><a href="#mk_filestats_service_rule">3.2. Service rule configuration</a></li>
<li><a href="#mk_filestats_monitoring">3.3. mk_filestats in monitoring</a></li>
</ul>
</li>
<li>
<a href="#fileinfo">4. Monitoring files with fileinfo (Linux, Windows)</a><ul class="sectlevel1">
<li>
<a href="#fileinfo_agent_rule">4.1. Configuring the rule for the agent</a><ul class="sectlevel2">
<li><a href="#_agent_bakery_configuration">Agent Bakery configuration</a></li>
<li><a href="#_manual_configuration_2">Manual configuration</a></li>
<li><a href="#_data_in_the_agent_output_2">Data in the agent output</a></li>
</ul>
</li>
<li><a href="#fileinfo_service_rule">4.2. Service rule configuration</a></li>
<li><a href="#fileinfo_monitoring">4.3. fileinfo in monitoring</a></li>
</ul>
</li>
<li>
<a href="#troubleshooting">5. Troubleshooting</a><ul class="sectlevel1"><li><a href="#_no_files_or_too_many_files_in_the_monitoring">5.1. No files or too many files in the monitoring</a></li></ul>
</li>
<li>
<a href="#files">6. Files and directories</a><ul class="sectlevel1">
<li><a href="#_mk_filestats">6.1. mk_filestats</a></li>
<li><a href="#_fileinfo">6.2. fileinfo</a></li>
</ul>
</li>
</ul>
</div>
<script src="../../assets/js/manifest.js?id=7db827d654313dce4250"></script>
<script src="../../assets/js/vendor.js?id=581a3d4a61b7156d04df"></script>
<script src="../../assets/js/app.js?id=959ccd04b1f8b7b78c5e"></script>
<script src="../../assets/js/lunr.js"></script>
<script src="../../assets/js/lunr.stemmer.support.js"></script>
<script src="../lunr.index.en.js"></script>
<script src="../../assets/js/lunr.client.js"></script>
</body>
</html>
