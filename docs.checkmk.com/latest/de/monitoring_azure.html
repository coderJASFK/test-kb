<!DOCTYPE html>
<html lang="de">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]--><meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<link rel="icon" href="/favicon.png">
<meta name="description" content="Die Integration von Microsoft Azure in Checkmk ermöglicht die nahtlose Überwachung von Cloud und On-Premises in einer Oberfläche und wird hier im Detail beschrieben.">
<meta name="og:locale" content="de">
<meta name="og:site_name" content="Checkmk Docs">
<meta name="og:title" content="Microsoft Azure überwachen">
<meta name="og:description" content="Die Integration von Microsoft Azure in Checkmk ermöglicht die nahtlose Überwachung von Cloud und On-Premises in einer Oberfläche und wird hier im Detail beschrieben.">
<meta name="og:image" content="https://docs.checkmk.com/assets/images/share_image.png">
<meta name="twitter:site" content="@checkmk">
<meta name="twitter:creator" content="@checkmk">
<title>Microsoft Azure überwachen</title>
<link rel="stylesheet" href="../../assets/css/checkmk.css?id=4473d2acbb1ea6136428">
<link rel="stylesheet" href="../../assets/css/pygments-monokai.css">
<link rel="stylesheet" href="../../assets/css/addons.css">
<link rel="stylesheet" href="../../assets/css/SourceCodePro.css">
<link rel="search" href="./opensearch.xml" type="application/opensearchdescription+xml" title="Suche auf docs.checkmk.com">
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-NJ3VGL8');</script>
<!-- End Google Tag Manager --><style>
#staticinfo { font-style: italic; }
</style>
</head>
<body class="article toc2 toc-right">
<!-- Cookie Consent (GDPR Compliance) -->

<!-- End Cookie Consent (GDPR Compliance) -->
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NJ3VGL8" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) --><div class="header-top">
<div class="header-top__left">
<a class="header-top__logo d-none d-xl-inline-block" href="/latest/de"><img src="../../assets/images/docs_logo.png" alt="Checkmk"></a><a class="header-top__icon d-inline-block d-xl-none" href="/latest/de"><img src="../../assets/images/logo_icon.svg" alt="Checkmk"></a>
</div>
<div class="header-top__center">
<input type="text" class="header-top__search" placeholder="Search the checkmk docs"><div class="header-top__search__results"></div>
</div>
<div class="header-top__right d-block">
<button class="header-top__search__toggle d-inline-block d-md-none"><img class="header-top__search__toggle__icon" src="../../assets/images/search.svg" alt="Search"></button><div class="dropdown dropdown__language">
                    <button class="btn dropdown-toggle" type="button" id="languageMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">de</button>
                    <div class="dropdown-menu  dropdown-menu-right" aria-labelledby="languageMenuButton"><a class="dropdown-item" href="../../latest/en/monitoring_azure.html">English</a></div>
</div>
<div class="dropdown dropdown__branch">
                        <button class="btn dropdown-toggle" type="button" id="branchMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">latest (2.3.0)</button>
                        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="branchMenuButton">
<a class="dropdown-item" href="../../2.1.0/de/monitoring_azure.html">2.1.0</a><a class="dropdown-item" href="../../2.2.0/de/monitoring_azure.html">2.2.0</a>
</div>
</div>
<a class="header-top__back d-none d-lg-inline-block" href="https://checkmk.com">to checkmk.com</a><button class="header-top__toggle d-inline-block d-lg-none"><span class="header-top__toggle__icon"></span></button>
</div>
</div>
<aside><div class="main-nav">
<div class="main-nav__content"><div id="content">
<div class="sect1">
<h2 id="_willkommen_bei_checkmk">
<a class="anchor" href="#_willkommen_bei_checkmk"></a>1. Willkommen bei Checkmk</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="welcome.html">Willkommen im Checkmk Handbuch</a></p>
</li>
<li>
<p><a href="release_notes.html">Release notes</a></p>
</li>
<li>
<p><a href="glossar.html">Glossar</a></p>
</li>
<li>
<p><a href="search.html">Suchen in docs.checkmk.com</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_leitfaden_für_einsteiger">
<a class="anchor" href="#_leitfaden_f%C3%BCr_einsteiger"></a>2. Leitfaden für Einsteiger</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="intro_setup.html">Checkmk aufsetzen</a></p>
</li>
<li>
<p><a href="intro_gui.html">Die Checkmk-Oberfläche</a></p>
</li>
<li>
<p><a href="intro_setup_monitor.html">Das Monitoring einrichten</a></p>
</li>
<li>
<p><a href="intro_tools.html">Die Monitoring-Werkzeuge</a></p>
</li>
<li>
<p><a href="intro_monitor.html">Checkmk im Monitoring</a></p>
</li>
<li>
<p><a href="intro_finetune.html">Das Monitoring feinjustieren</a></p>
</li>
<li>
<p><a href="intro_users.html">Mit mehreren Benutzern arbeiten</a></p>
</li>
<li>
<p><a href="intro_notifications.html">Benachrichtigungen einschalten</a></p>
</li>
<li>
<p><a href="intro_extend.html">Das Monitoring weiter ausbauen</a></p>
</li>
<li>
<p><a href="intro_bestpractise.html">Best Practices, Tipps &amp; Tricks</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_installation">
<a class="anchor" href="#_installation"></a>3. Installation</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="install_packages.html">Grundsätzliches zur Installation von Checkmk</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_server_und_vms">
<a class="anchor" href="#_server_und_vms"></a>3.1. Server und VMs</h3>
<div class="ulist">
<ul>
<li>
<p><a href="install_packages_debian.html">Installation unter Debian und Ubuntu</a></p>
</li>
<li>
<p><a href="install_packages_redhat.html">Installation unter Red Hat und Derivaten</a></p>
</li>
<li>
<p><a href="install_packages_sles.html">Installation unter SUSE Linux Enterprise Server</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_appliance_container_cloud">
<a class="anchor" href="#_appliance_container_cloud"></a>3.2. Appliance, Container, Cloud</h3>
<div class="ulist">
<ul>
<li>
<p><a href="install_appliance_cmk.html">Installation von Checkmk in der Appliance</a></p>
</li>
<li>
<p><a href="introduction_docker.html">Installation als Docker-Container</a></p>
</li>
<li>
<p><a href="install_azure.html">Installation aus dem Azure Marketplace</a></p>
</li>
<li>
<p><a href="install_aws.html">Installation aus dem AWS Marketplace</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_updates">
<a class="anchor" href="#_updates"></a>3.3. Updates</h3>
<div class="ulist">
<ul>
<li>
<p><a href="update.html">Updates und Upgrades</a></p>
</li>
<li>
<p><a href="update_major.html">Update auf Version <span class="new">2.3.0</span></a></p>
</li>
<li>
<p><a href="update_matrix.html">Update-Matrix für Version <span class="new">2.3.0</span></a></p>
</li>
<li>
<p><a href="release_upgrade.html">Linux-Upgrade auf dem Checkmk-Server</a></p>
</li>
<li>
<p><a href="cmk_versions.html">Checkmk-Versionen</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_administration_von_checkmk">
<a class="anchor" href="#_administration_von_checkmk"></a>4. Administration von Checkmk</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_server">
<a class="anchor" href="#_server"></a>4.1. Server</h3>
<div class="ulist">
<ul>
<li>
<p><a href="saml.html">Anmeldung mit SAML</a></p>
</li>
<li>
<p><a href="kerberos.html">Single Sign-On mit Kerberos</a></p>
</li>
<li>
<p><a href="managing_docker.html">Checkmk-Server im Docker-Container</a></p>
</li>
<li>
<p><a href="security.html">Sicherheit (Security)</a></p>
</li>
<li>
<p><a href="ports.html">Ports</a></p>
</li>
<li>
<p><a href="omd_https.html">Weboberfläche mit HTTPS absichern</a></p>
</li>
<li>
<p><a href="support_diagnostics.html">Support Diagnostics</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_instanzen">
<a class="anchor" href="#_instanzen"></a>4.2. Instanzen</h3>
<div class="ulist">
<ul>
<li>
<p><a href="omd_basics.html">Instanzen (Sites) mit omd verwalten</a></p>
</li>
<li>
<p><a href="cmk_commandline.html">Checkmk auf der Kommandozeile</a></p>
</li>
<li>
<p><a href="license.html">Lizenzen verwalten</a></p>
</li>
<li>
<p><a href="distributed_monitoring.html">Verteiltes Monitoring</a></p>
</li>
<li>
<p><a href="backup.html">Backups</a></p>
</li>
<li>
<p><a href="password_store.html">Passwortspeicher (Password store)</a></p>
</li>
<li>
<p><a href="analyze_configuration.html">Konfiguration der Checkmk Instanz analysieren</a></p>
</li>
<li>
<p><a href="mkps.html">Checkmk-Erweiterungspakete (MKPs)</a></p>
</li>
<li>
<p><a href="mkp_viewables.html">MKPs für GUI-Erweiterungen</a></p>
</li>
<li>
<p><a href="simulation_mode.html">Der Simulationsmodus</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_konfiguration">
<a class="anchor" href="#_konfiguration"></a>5. Konfiguration</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="wato.html">Die Konfiguration von Checkmk</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_hosts">
<a class="anchor" href="#_hosts"></a>5.1. Hosts</h3>
<div class="ulist">
<ul>
<li>
<p><a href="hosts_setup.html">Verwaltung der Hosts</a></p>
</li>
<li>
<p><a href="hosts_structure.html">Strukturierung der Hosts</a></p>
</li>
<li>
<p><a href="host_tags.html">Host-Merkmale</a></p>
</li>
<li>
<p><a href="dcd.html">Dynamische Host-Konfiguration</a></p>
</li>
<li>
<p><a href="hosts_autoregister.html">Automatisch Hosts erstellen</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_services">
<a class="anchor" href="#_services"></a>5.2. Services</h3>
<div class="ulist">
<ul>
<li>
<p><a href="wato_services.html">Services verstehen und konfigurieren</a></p>
</li>
<li>
<p><a href="clustered_services.html">Cluster-Services überwachen</a></p>
</li>
<li>
<p><a href="piggyback.html">Der Piggyback-Mechanismus</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_regeln">
<a class="anchor" href="#_regeln"></a>5.3. Regeln</h3>
<div class="ulist">
<ul>
<li>
<p><a href="wato_rules.html">Regeln</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_unterstützende_konfigurationen">
<a class="anchor" href="#_unterst%C3%BCtzende_konfigurationen"></a>5.4. Unterstützende Konfigurationen</h3>
<div class="ulist">
<ul>
<li>
<p><a href="timeperiods.html">Zeitperioden (Time Periods)</a></p>
</li>
<li>
<p><a href="labels.html">Labels</a></p>
</li>
<li>
<p><a href="regexes.html">Reguläre Ausdrücke in Checkmk</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_benutzer_und_berechtigungen">
<a class="anchor" href="#_benutzer_und_berechtigungen"></a>5.5. Benutzer und Berechtigungen</h3>
<div class="ulist">
<ul>
<li>
<p><a href="wato_user.html">Benutzer, Zuständigkeiten, Berechtigungen</a></p>
</li>
<li>
<p><a href="ldap.html">Benutzerverwaltung mit LDAP/Active Directory</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_benachrichtigungen">
<a class="anchor" href="#_benachrichtigungen"></a>5.6. Benachrichtigungen</h3>
<div class="ulist">
<ul>
<li>
<p><a href="notifications.html">Benachrichtigungen</a></p>
</li>
<li>
<p><a href="notifications_webex.html">Benachrichtigungen per Cisco Webex Teams</a></p>
</li>
<li>
<p><a href="notifications_ilert.html">Benachrichtigungen per ilert</a></p>
</li>
<li>
<p><a href="notifications_jira.html">Benachrichtigungen per Jira</a></p>
</li>
<li>
<p><a href="notifications_mattermost.html">Benachrichtigungen per Mattermost</a></p>
</li>
<li>
<p><a href="notifications_teams.html">Benachrichtigungen per Microsoft Teams</a></p>
</li>
<li>
<p><a href="notifications_pagerduty.html">Benachrichtigungen per PagerDuty</a></p>
</li>
<li>
<p><a href="notifications_pushover.html">Benachrichtigungen per Pushover</a></p>
</li>
<li>
<p><a href="notifications_opsgenie.html">Benachrichtigungen per Opsgenie</a></p>
</li>
<li>
<p><a href="notifications_servicenow.html">Benachrichtigungen per ServiceNow</a></p>
</li>
<li>
<p><a href="notifications_signl4.html">Benachrichtigungen per SIGNL4</a></p>
</li>
<li>
<p><a href="notifications_slack.html">Benachrichtigungen per Slack</a></p>
</li>
<li>
<p><a href="notifications_splunkoncall.html">Benachrichtigungen per Splunk On-Call</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_events">
<a class="anchor" href="#_events"></a>5.7. Events</h3>
<div class="ulist">
<ul>
<li>
<p><a href="ec.html">Die Event Console</a></p>
</li>
<li>
<p><a href="alert_handlers.html">Alert Handler</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_überwachung_von_systemen">
<a class="anchor" href="#_%C3%BCberwachung_von_systemen"></a>6. Überwachung von Systemen</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="wato_monitoringagents.html">Monitoring-Agenten</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_checkmk_agenten_und_snmp">
<a class="anchor" href="#_checkmk_agenten_und_snmp"></a>6.1. Checkmk-Agenten und SNMP</h3>
<div class="ulist">
<ul>
<li>
<p><a href="agent_deployment.html">Automatische Agenten-Updates</a></p>
</li>
<li>
<p><a href="agent_linux.html">Linux überwachen</a></p>
</li>
<li>
<p><a href="agent_linux_legacy.html">Linux überwachen im Legacy-Modus</a></p>
</li>
<li>
<p><a href="agent_windows.html">Windows überwachen</a></p>
</li>
<li>
<p><a href="agent_freebsd.html">FreeBSD überwachen</a></p>
</li>
<li>
<p><a href="snmp.html">Überwachen via SNMP</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_agentenerweiterungen">
<a class="anchor" href="#_agentenerweiterungen"></a>6.2. Agentenerweiterungen</h3>
<div class="ulist">
<ul>
<li>
<p><a href="inventory.html">Die HW/SW-Inventur</a></p>
</li>
<li>
<p><a href="mk_filestats.html">Dateien überwachen</a></p>
</li>
<li>
<p><a href="monitoring_logfiles.html">Log-Dateien überwachen</a></p>
</li>
<li>
<p><a href="monitoring_oracle.html">Oracle-Datenbanken überwachen</a></p>
</li>
<li>
<p><a href="monitoring_mysql.html">MySQL überwachen</a></p>
</li>
<li>
<p><a href="monitoring_mssql.html">MSSQL überwachen</a></p>
</li>
<li>
<p><a href="monitoring_mssql_legacy.html">MSSQL mit dem Legacy-Plugin überwachen</a></p>
</li>
<li>
<p><a href="monitoring_jobs.html">Zeitbasierte Prozesse (Cronjobs) überwachen</a></p>
</li>
<li>
<p><a href="spool_directory.html">Das Spool-Verzeichnis</a></p>
</li>
<li>
<p><a href="localchecks.html">Lokale Checks</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_vm_cloud_container">
<a class="anchor" href="#_vm_cloud_container"></a>6.3. VM, Cloud, Container</h3>
<div class="ulist">
<ul>
<li>
<p><a href="datasource_programs.html">Datenquellenprogramme</a></p>
</li>
<li>
<p><a href="monitoring_vmware.html">VMware ESXi überwachen</a></p>
</li>
<li>
<p><a href="monitoring_aws.html">Amazon Web Services (AWS) überwachen</a></p>
</li>
<li>
<p><a href="monitoring_azure.html">Microsoft Azure überwachen</a></p>
</li>
<li>
<p><a href="monitoring_gcp.html">Google Cloud Platform (GCP) überwachen</a></p>
</li>
<li>
<p><a href="monitoring_kubernetes.html">Kubernetes überwachen</a></p>
</li>
<li>
<p><a href="monitoring_openshift.html">OpenShift überwachen</a></p>
</li>
<li>
<p><a href="monitoring_docker.html">Docker überwachen</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_endpunkte">
<a class="anchor" href="#_endpunkte"></a>6.4. Endpunkte</h3>
<div class="ulist">
<ul>
<li>
<p><a href="active_checks.html">Netzwerkdienste überwachen (Aktive Checks)</a></p>
</li>
<li>
<p><a href="robotmk.html">Checkmk Synthetic Monitoring mit Robotmk</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_dashboards_views_metriken">
<a class="anchor" href="#_dashboards_views_metriken"></a>7. Dashboards, Views, Metriken</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="user_interface.html">Die Benutzeroberfläche</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_allgemein">
<a class="anchor" href="#_allgemein"></a>7.1. Allgemein</h3>
<div class="ulist">
<ul>
<li>
<p><a href="views.html">Ansichten von Hosts und Services (Views)</a></p>
</li>
<li>
<p><a href="dashboards.html">Dashboards</a></p>
</li>
<li>
<p><a href="graphing.html">Messwerte und Graphing</a></p>
</li>
<li>
<p><a href="custom_notes.html">Anmerkungen (Custom notes)</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_kommandos_in_ansichten">
<a class="anchor" href="#_kommandos_in_ansichten"></a>7.2. Kommandos in Ansichten</h3>
<div class="ulist">
<ul>
<li>
<p><a href="commands.html">Kommandos</a></p>
</li>
<li>
<p><a href="basics_ackn.html">Quittierung von Problemen</a></p>
</li>
<li>
<p><a href="basics_downtimes.html">Wartungszeiten</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_auswertungen_und_prognosen">
<a class="anchor" href="#_auswertungen_und_prognosen"></a>8. Auswertungen und Prognosen</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_auswertungen">
<a class="anchor" href="#_auswertungen"></a>8.1. Auswertungen</h3>
<div class="ulist">
<ul>
<li>
<p><a href="availability.html">Verfügbarkeit (Availability)</a></p>
</li>
<li>
<p><a href="sla.html">Erweiterte Verfügbarkeiten (SLAs)</a></p>
</li>
<li>
<p><a href="bi.html">Business Intelligence (BI)</a></p>
</li>
<li>
<p><a href="reporting.html">Berichte (Reports)</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_prognosen">
<a class="anchor" href="#_prognosen"></a>8.2. Prognosen</h3>
<div class="ulist">
<ul>
<li>
<p><a href="predictive_monitoring.html">Prognosebasiertes Monitoring</a></p>
</li>
<li>
<p><a href="forecast_graphs.html">Vorhersagegraphen erstellen</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_anbindung_anderer_applikationen">
<a class="anchor" href="#_anbindung_anderer_applikationen"></a>9. Anbindung anderer Applikationen</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="monitoring_prometheus.html">Prometheus integrieren</a></p>
</li>
<li>
<p><a href="integrating_datadog.html">Datadog integrieren</a></p>
</li>
<li>
<p><a href="nagvis.html">NagVis: Statusdaten auf Karten und Diagrammen</a></p>
</li>
<li>
<p><a href="ntop.html">ntopng in Checkmk integrieren</a></p>
</li>
<li>
<p><a href="grafana.html">Checkmk in Grafana integrieren</a></p>
</li>
<li>
<p><a href="metrics_exporter.html">Metriken an InfluxDB und Graphite senden</a></p>
</li>
<li>
<p><a href="nagstamon.html">Nagstamon mit Checkmk verbinden</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_besonderheiten_in_den_editionen">
<a class="anchor" href="#_besonderheiten_in_den_editionen"></a>10. Besonderheiten in den Editionen</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="cse.html">Checkmk Enterprise</a></p>
</li>
<li>
<p><a href="cce.html">Checkmk Cloud</a></p>
</li>
<li>
<p><a href="managed.html">Checkmk MSP</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_automatisierung_und_programmierung">
<a class="anchor" href="#_automatisierung_und_programmierung"></a>11. Automatisierung und Programmierung</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="apis_intro.html">Übersicht der API-Ressourcen</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_apis_zur_automatisierung">
<a class="anchor" href="#_apis_zur_automatisierung"></a>11.1. APIs zur Automatisierung</h3>
<div class="ulist">
<ul>
<li>
<p><a href="rest_api.html">Die Checkmk REST-API</a></p>
</li>
<li>
<p><a href="livestatus.html">Statusdaten abrufen via Livestatus</a></p>
</li>
<li>
<p><a href="livestatus_references.html">Livestatus Befehlsreferenz</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_apis_zur_programmierung">
<a class="anchor" href="#_apis_zur_programmierung"></a>11.2. APIs zur Programmierung</h3>
<div class="ulist">
<ul>
<li>
<p><a href="bakery_api.html">Die Bakery-API</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_programmierung_von_check_plugins">
<a class="anchor" href="#_programmierung_von_check_plugins"></a>11.3. Programmierung von Check-Plugins</h3>
<div class="ulist">
<ul>
<li>
<p><a href="devel_intro.html">Erweiterungen für Checkmk entwickeln</a></p>
</li>
<li>
<p><a href="devel_check_plugins.html">Agentenbasierte Check-Plugins schreiben</a></p>
</li>
<li>
<p><a href="devel_check_plugins_snmp.html">SNMP-basierte Check-Plugins schreiben</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_konzepte">
<a class="anchor" href="#_konzepte"></a>12. Konzepte</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="monitoring_basics.html">Grundlagen des Monitorings mit Checkmk</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_der_checkmk_micro_core_cmc">
<a class="anchor" href="#_der_checkmk_micro_core_cmc"></a>12.1. Der Checkmk Micro Core (CMC)</h3>
<div class="ulist">
<ul>
<li>
<p><a href="cmc.html">Der Checkmk Micro Core (CMC)</a></p>
</li>
<li>
<p><a href="cmc_differences.html">Besonderheiten des CMC</a></p>
</li>
<li>
<p><a href="cmc_migration.html">Migration auf den CMC</a></p>
</li>
<li>
<p><a href="cmc_files.html">Dateien und Verzeichnisse des CMC</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_die_checkmk_appliance">
<a class="anchor" href="#_die_checkmk_appliance"></a>13. Die Checkmk Appliance</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="appliance_rack1_quick_start.html">Schnellstart-Anleitung für Checkmk-Racks</a></p>
</li>
<li>
<p><a href="appliance_virt1_quick_start.html">Schnellstart-Anleitung für Checkmk virt1</a></p>
</li>
<li>
<p><a href="appliance_install_virt1.html">Virtuelle Appliance installieren</a></p>
</li>
<li>
<p><a href="appliance_usage.html">Appliance einrichten und nutzen</a></p>
</li>
<li>
<p><a href="appliance_backup.html">Backup in der Appliance</a></p>
</li>
<li>
<p><a href="appliance_cluster.html">Appliance im Cluster-Betrieb</a></p>
</li>
<li>
<p><a href="appliance_rack_config.html">Besonderheiten der Hardware-Appliance</a></p>
</li>
</ul>
</div>
</div>
</div>
</div></div>
<div class="main-nav__utils">
<div class="dropup dropdown__utils">
<button class="btn dropdown-toggle" type="button" id="aboutMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">About Checkmk</button><div class="dropdown-menu dropup" aria-labelledby="aboutMenuButton">
<a class="dropdown-item" href="https://checkmk.com/product/features" target="_blank">Features</a><a class="dropdown-item" href="https://checkmk.com/product/editions" target="_blank">Editions</a><a class="dropdown-item" href="https://checkmk.com/integrations" target="_blank">Integrations</a><a class="dropdown-item" href="https://checkmk.com/imprint" target="_blank">Imprint</a><a class="dropdown-item" href="copyright.html" target="_blank">Copyright</a>
</div>
</div>
<div class="dropup dropdown__utils">
<button class="btn dropdown-toggle" type="button" id="learnMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Learn</button><div class="dropdown-menu dropup" aria-labelledby="learnMenuButton">
<a class="dropdown-item" href="https://checkmk.com/videos">Videos</a><a class="dropdown-item" href="https://checkmk.com/webinars">Webinars</a><a class="dropdown-item" href="https://checkmk.com/trainings/classes">Trainings</a>
</div>
</div>
<a class="main-nav__utils__link" href="https://forum.checkmk.com">Forum</a>
</div>
</div></aside><main><div id="header">
<h1>Microsoft Azure überwachen</h1>
<div class="details">
<span id="revdate">Last modified on 19-Oct-2024</span><a class="edit-document" href="https://github.com/Checkmk/checkmk-docs/edit/2.3.0/src/common/de/monitoring_azure.asciidoc">Edit this page on GitHub</a>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="heading__einleitung">
<span class="hidden-anchor sr-only" id="_einleitung"></span>1. Einleitung</h2>
<div class="sectionbody">
<div class="imageblock inline-image"><div class="content"><img src="../images/azure_logo.png" alt="azure logo" width="140"></div></div>
<div class="paragraph"><p>Checkmk enthält ein umfangreiches Monitoring von Microsoft Azure, welches aus einem Konnektor zu Azure und einer stattlichen Sammlung von Check-Plugins besteht, die für Sie verschiedenste Metriken und Zustände abrufen und auswerten.</p></div>
<div class="paragraph"><p>Neben den allgemeinen Informationen zu den <a href="https://checkmk.com/de/integrations/azure_usagedetails" target="_blank">Kosten</a> Ihrer Azure-Umgebung und dem aktuellen <a href="https://checkmk.com/de/integrations/azure_status" target="_blank">Status</a> der Azure-Dienste in Ihrer Region, können Sie mit allen Editionen von Checkmk die folgenden Microsoft Azure-Produkte überwachen:</p></div>
<div class="ulist"><ul>
<li><p><a href="https://checkmk.com/de/integrations?distributions%5B%5D=check_mk&amp;distributions%5B%5D=check_mk_cloud&amp;search=azure_vm" target="_blank">Virtual Machines</a></p></li>
<li><p><a href="https://checkmk.com/de/integrations?distributions%5B%5D=check_mk&amp;distributions%5B%5D=check_mk_cloud&amp;search=azure_storageaccounts" target="_blank">Storage Accounts</a></p></li>
<li><p><a href="https://checkmk.com/de/integrations?distributions%5B%5D=check_mk&amp;distributions%5B%5D=check_mk_cloud&amp;search=azure_mysql" target="_blank">MySQL Database</a></p></li>
<li><p><a href="https://checkmk.com/de/integrations?distributions%5B%5D=check_mk&amp;distributions%5B%5D=check_mk_cloud&amp;search=azure_postgresql" target="_blank">PostgreSQL Database</a></p></li>
<li><p><a href="https://checkmk.com/de/integrations?distributions%5B%5D=check_mk&amp;distributions%5B%5D=check_mk_cloud&amp;search=azure_databases" target="_blank">SQL Database</a></p></li>
<li><p><a href="https://checkmk.com/de/integrations?distributions%5B%5D=check_mk&amp;distributions%5B%5D=check_mk_cloud&amp;search=azure_load_balancer" target="_blank">Load Balancer</a></p></li>
<li><p><a href="https://checkmk.com/de/integrations?distributions%5B%5D=check_mk&amp;distributions%5B%5D=check_mk_cloud&amp;search=azure_virtual_network" target="_blank">Virtual Network Gateways</a></p></li>
<li><p><a href="https://checkmk.com/de/integrations?distributions%5B%5D=check_mk&amp;distributions%5B%5D=check_mk_cloud&amp;search=azure_traffic_manager" target="_blank">Traffic Manager</a></p></li>
<li><p><a href="https://checkmk.com/de/integrations?distributions%5B%5D=check_mk&amp;distributions%5B%5D=check_mk_cloud&amp;search=azure_ad" target="_blank">Active Directory (AD) Connect</a></p></li>
<li><p><a href="https://checkmk.com/de/integrations/azure_sites" target="_blank">Webserver</a></p></li>
</ul></div>
<div class="paragraph"><p>Mit <span class="image-inline"><img src="../images/icons/CSE.png" alt="CSE" width="20" title="Checkmk Cloud"></span> <strong>Checkmk Cloud</strong> können Sie darüber hinaus noch die folgenden Produkte in Ihr Monitoring aufnehmen:</p></div>
<div class="ulist"><ul>
<li><p><a href="https://checkmk.com/de/integrations/azure_app_gateway" target="_blank">Application Gateway</a></p></li>
<li><p><a href="https://checkmk.com/de/integrations/azure_vault_backup_containers" target="_blank">Recovery Services vaults</a></p></li>
</ul></div>
<div class="paragraph"><p>Eine vollständige Auflistung aller verfügbaren Check-Plugins für die Überwachung von Azure finden Sie in unserem <a href="https://checkmk.com/de/integrations?tags=azure" target="_blank">Katalog der Check-Plugins</a> und wie Sie Ihre AKS-Cluster (Azure Kubernetes Service) ins Monitoring aufnehmen, beschreiben wir im Artikel <a href="monitoring_kubernetes.html">Kubernetes überwachen</a>.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="heading_preparation">
<span class="hidden-anchor sr-only" id="preparation"></span>2. Azure für Checkmk vorbereiten</h2>
<div class="sectionbody">
<div class="paragraph"><p>Um Azure mit Checkmk zu überwachen, benötigen Sie einige Daten aus Ihrer Azure-Umgebung.
Mindestens die Directory-ID (auch Tenant-ID genannt) und eine Application-ID (auch Client-ID genannt) werden zwingend benötigt.
In den meisten Fällen müssen Sie auch Ihre Subskriptions-ID angeben.
Letztere benötigen Sie nur dann <strong>nicht</strong>, wenn Sie <strong>ausschließlich</strong> Ihr Azure AD überwachen wollen.</p></div>
<div class="paragraph"><p>In den folgenden Kapiteln zeigen wir Ihnen, wo Sie diese Daten finden bzw. welche Voraussetzungen Sie dafür schaffen müssen.</p></div>
<div class="admonitionblock tip"><table><tr>
<td class="icon"><img src="../images/icons/tip.png" alt="Tip"></td>
<td class="content"><div class="paragraph"><p>An dieser Stelle ist zu sagen, dass sich Webportale von Hyperscalern und Anbietern von Cloud-Diensten mit schöner Regelmäßigkeit ändern.
Wir bemühen uns, die folgenden Informationen aktuell und gleichzeitig so allgemein zu halten, dass die jeweiligen Orte und Funktionen im Portal auch auffindbar bleiben, wenn ein Screenshot mal nicht mehr zu 100 % zum Gesehenen passt.</p></div></td>
</tr></table></div>
<div class="sect2">
<h3 id="heading_app_registration">
<span class="hidden-anchor sr-only" id="app_registration"></span>2.1. App anlegen</h3>
<div class="paragraph"><p>Registrieren Sie zunächst eine App in Azure.
Über diese App wird Checkmk die gewünschten Daten aus Azure auslesen.
Sie finden die Option dafür im <a href="https://portal.azure.com" target="_blank">Azure-Portal</a> unter <span class="guihint">(All services &gt; Identity &gt; Identity management &gt; ) App registrations</span>.
Alternativ können Sie hier die Suche des Portals verwenden und dort <code>App registrations</code> eingeben.
Auf der Seite angekommen, müssen Sie nun auf <span class="guihint">New registration</span> klicken.</p></div>
<div class="paragraph"><p>Vergeben Sie einen Namen Ihrer Wahl.
Im Beispiel verwenden wir <code>my-checkmk-app</code>.
Der Name ist jedoch nur informativ.
Der Bezug auf die App wird stattdessen über eine UUID hergestellt, die Sie in einem nächsten Schritt angezeigt bekommen.
Im Abschnitt <span class="guihint">Supported account types</span> müssen Sie nichts ändern und das Feld <span class="guihint">Redirect URI</span> muss leer bleiben.
Bestätigen Sie Ihre Eingaben mit einem Klick auf <span class="guihint">Register</span>.</p></div>
<div class="imageblock border"><div class="content"><img src="../images/azure_register_1.png" alt="azure register 1"></div></div>
<div class="paragraph"><p>Nachdem Sie die App angelegt haben, sollten Sie in einer Übersicht zu dieser neuen App landen.
Ist dem nicht so, finden Sie die neue App in der oben beschriebenen Liste aller <span class="guihint">App registrations</span> im Reiter <span class="guihint">All applications</span>.
In den Details der App finden Sie nun sowohl die <span class="guihint">Application (client) ID</span> als auch die <span class="guihint">Directory (tenant) ID</span>, welche Sie später in Checkmk eintragen müssen.</p></div>
<div class="imageblock border"><div class="content"><img src="../images/azure_register_2.png" alt="azure register 2"></div></div>
</div>
<div class="sect2">
<h3 id="heading_client_secret">
<span class="hidden-anchor sr-only" id="client_secret"></span>2.2. Client-Schlüssel für die App anlegen</h3>
<div class="paragraph"><p>Nun brauchen Sie noch einen geheimen Client-Schlüssel (im Englischen schlicht <em>client secret</em> genannt), mit dem sich Checkmk bei der API von Azure anmelden kann.
Um einen solchen Schlüssel zu erzeugen, klicken Sie in der Übersicht der App auf <span class="guihint">Certificates &amp; secrets</span>, dann auf den Reiter <span class="guihint">Client secrets</span> und schließlich auf <span class="guihint">New client secret.</span></p></div>
<div class="imageblock border"><div class="content"><img src="../images/azure_register_5.png" alt="azure register 5"></div></div>
<div class="paragraph"><p>Dadurch öffnet sich der Dialog <span class="guihint">Add a client secret</span>.
Vergeben Sie einen beliebigen Namen und wählen Sie aus, wie lange der Schlüssel gültig sein soll.
Wenn Sie später, in der <a href="#azure_agent">Regel für den Spezialagenten,</a> die Option <span class="guihint">App Registrations</span> aktiveren, bekommen Sie einen praktischen Service, der Sie daran erinnert, wenn sich diese Gültigkeitsdauer dem Ende nähert.
Bestätigen Sie den Dialog mit einem Klick auf <span class="guihint">Add.</span></p></div>
<div class="imageblock"><div class="content"><img src="../images/azure_register_6.png" alt="azure register 6" width="76%"></div></div>
<div class="paragraph"><p>Jetzt ist es wichtig, dass Sie den <span class="guihint">Value</span> dieses neuen Schlüssel umgehend kopieren.
Nach einer gewissen Zeit werden im Azure-Portal nur noch die ersten drei Zeichen solcher Schlüssel angezeigt.</p></div>
<div class="imageblock border"><div class="content"><img src="../images/monitoring_azure_copy_secret.png" alt="monitoring azure copy secret"></div></div>
</div>
<div class="sect2">
<h3 id="heading__optional_weitere_api_berechtigungen_hinzufügen">
<span class="hidden-anchor sr-only" id="_optional_weitere_api_berechtigungen_hinzufügen"></span>2.3. Optional: Weitere API-Berechtigungen hinzufügen</h3>
<div class="paragraph"><p>Sie müssen der App zusätzliche API-Berechtigungen erteilen, wenn Sie die folgenden Services mit Checkmk überwachen möchten:</p></div>
<div class="ulist"><ul>
<li><p>Users in the Active Directory</p></li>
<li><p>AD Connect Sync</p></li>
<li><p>App Registrations</p></li>
</ul></div>
<div class="paragraph"><p>Die Vergabe der Berechtigungen starten Sie in der Übersicht Ihrer neuen App, die Sie noch vom vorherigen Abschnitt geöffnet haben sollten.</p></div>
<div class="paragraph"><p>Klicken Sie auf <span class="guihint">API permissions</span> und anschließend auf <span class="guihint">Add a permission.</span>
In dem Dialog, der sich öffnet, müssen Sie den Punkt <span class="guihint">Microsoft Graph</span> finden und anklicken.
Wählen Sie anschließend <span class="guihint">Application permissions</span> und tippen Sie <code>Directory.Read.All</code> in die Suche ein.
Aktivieren Sie die zugehörige Checkbox und klicken Sie auf <span class="guihint">Add permissions</span>.
Für diese Berechtigung wird eine zusätzliche Zustimmung durch einen Administrator Ihrer Azure-Umgebung benötigt (<span class="guihint">Admin consent required</span>.)
Wenn Sie über der Liste der erteilten Berechtigungen nicht den Knopf <span class="guihint">Grant admin consent</span> sehen, müssen Sie sich an einen solchen Admin wenden.</p></div>
</div>
<div class="sect2">
<h3 id="heading_assign_role">
<span class="hidden-anchor sr-only" id="assign_role"></span>2.4. Rolle zuweisen</h3>
<div class="paragraph"><p>Damit Checkmk über die neue App an die Monitoring-Daten kommen kann, müssen Sie der App noch eine Rolle auf Ebene der Subskription zuweisen.
Wählen Sie dazu in der Hauptnavigation auf der linken Seite den Punkt <span class="guihint">All services</span> und dann unter <span class="guihint">General</span> den Punkt <span class="guihint">Subscriptions.</span>
Auch hier können Sie wieder die Suche im Portal bemühen, wenn sich der entsprechende Knopf nicht finden lässt.</p></div>
<div class="paragraph"><p>Eventuell müssen Sie nun noch den Namen der Subskription anklicken, den Sie überwachen möchten.
In der folgenden Übersicht finden Sie auch die <span class="guihint">Subscription ID</span>, die Sie später in die Regel des Spezialagenten eintragen müssen.
Sobald diese notiert ist, klicken Sie auf <span class="guihint">Access Control (IAM)</span> und dort auf <span class="guihint">Add</span> und dann auf <span class="guihint">Add role assignment:</span></p></div>
<div class="imageblock border"><div class="content"><img src="../images/azure_access_control.png" alt="azure access control"></div></div>
<div class="paragraph"><p>Wählen Sie jetzt die Rolle aus, die <span class="guihint">Reader</span> heißt und den <span class="guihint">Type</span> <span class="guihint">BuiltInRole</span> hat.
Da es insgesamt über 100 Rollen gibt, die das Wort Reader im Namen tragen, gilt es hier aufmerksam zu sein.
Klicken Sie anschließend auf <span class="guihint">Next</span>, um zum Reiter <span class="guihint">Members</span> zu kommen.</p></div>
<div class="paragraph"><p>Klicken Sie hier auf <span class="guihint">+ Select members.</span></p></div>
<div class="imageblock border"><div class="content"><img src="../images/azure_role_assignment.png" alt="azure role assignment"></div></div>
<div class="paragraph"><p>Im Dialog <span class="guihint">Select members</span> geben Sie im Suchfeld den Namen der App ein, wie Sie ihn vorhin angelegt haben, wählen die App aus und klicken auf <span class="guihint">Select.</span>
Nach zwei weiteren Klicks auf <span class="guihint">Review + assign</span> ist die Einrichtung im Azure-Portal abgeschlossen.</p></div>
<div class="paragraph"><p>Sie sollten jetzt über die folgenden vier Informationen verfügen:</p></div>
<div class="olist arabic"><ol class="arabic">
<li><p>Ihre Tenant-ID (auch bekannt als „Directory-ID“)</p></li>
<li><p>Die Application-ID (Client-ID) der App</p></li>
<li><p>Den geheimen Client-Schlüssel zu dieser App</p></li>
<li><p>Ihre Subskriptions-ID</p></li>
</ol></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="heading_setup">
<span class="hidden-anchor sr-only" id="setup"></span>3. Grundlegendes Monitoring in Checkmk konfigurieren</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="heading_create_host">
<span class="hidden-anchor sr-only" id="create_host"></span>3.1. Host für Azure anlegen</h3>
<div class="paragraph"><p>Auch wenn Sie es bei Azure nicht mit einem physikalischen Host zu tun haben, legen Sie in Checkmk für Ihr Azure-Directory einen Host an.
Den Host-Namen können Sie nach Belieben vergeben.
Wichtig: Da Azure ein Dienst ist und daher keine IP-Adresse oder DNS-Namen hat (den Zugriff macht der Spezialagent von selbst),
müssen Sie die <span class="guihint">IP address family</span> auf <span class="guihint">No IP</span> einstellen.</p></div>
<div class="imageblock"><div class="content"><img src="../images/azure_wato_no_ip.png" alt="azure wato no ip"></div></div>
<div class="paragraph"><p>Speichern Sie am besten mit <span class="guihint">Save &amp; Finish,</span> da die Service-Erkennung natürlich noch nicht funktionieren kann.</p></div>
</div>
<div class="sect2">
<h3 id="heading_azure_agent">
<span class="hidden-anchor sr-only" id="azure_agent"></span>3.2. Den Azure-Agenten konfigurieren</h3>
<div class="paragraph"><p>Da Azure nicht über den normalen Checkmk-Agenten abgefragt werden kann, richten Sie jetzt den <a href="glossar.html#special_agent">Spezialagenten</a> für Azure ein,
welcher auch als <a href="datasource_programs.html">Datenquellenprogramm</a> bezeichnet wird.
Hierbei kontaktiert Checkmk den Ziel-Host nicht wie üblich über TCP Port 6556, sondern ruft stattdessen ein Hilfsprogramm auf,
welches mit dem Zielsystem über ein die anwendungsspezifische API von Azure kommuniziert.</p></div>
<div class="paragraph"><p>Dazu legen Sie unter <span class="guihint">Setup &gt; Agents &gt; VM, Cloud, Container &gt; Microsoft Azure</span> eine Regel an,
deren <a href="wato_rules.html#conditions">Bedingungen</a> ausschließlich auf den gerade angelegten Azure-Host greifen.
Dort finden Sie die Eingabefelder für die IDs und das Secret:</p></div>
<div class="imageblock"><div class="content"><img src="../images/azure_agent_rule.png" alt="azure agent rule"></div></div>
<div class="paragraph"><p>Hier können Sie auch die Ressourcengruppen oder Ressourcen auswählen, die Sie überwachen möchten.
Wenn Sie <span class="guihint">explicitly specified groups</span> <strong>nicht</strong> angekreuzt haben, werden automatisch alle Ressourcengruppen überwacht.</p></div>
</div>
<div class="sect2">
<h3 id="heading__test">
<span class="hidden-anchor sr-only" id="_test"></span>3.3. Test</h3>
<div class="paragraph"><p>Wenn Sie jetzt eine Service-Erkennung auf dem Azure-Host machen, sollte auf diesem ein einziger Service mit dem Namen <span class="guihint">Azure Agent Info</span> erkannt werden:</p></div>
<div class="imageblock"><div class="content"><img src="../images/azure_services_ok.png" alt="azure services ok"></div></div>
<div class="paragraph"><p>Falls der Zugriff auf die API nicht klappt (z.B. wegen einer falschen ID oder fehlerhaften Berechtigungen),
erscheint im Statustext von <span class="guihint">Azure Agent Info</span> eine Fehlermeldung der Azure-API:</p></div>
<div class="imageblock"><div class="content"><img src="../images/azure_services_fail.png" alt="azure services fail"></div></div>
</div>
<div class="sect2">
<h3 id="heading_resource_groups">
<span class="hidden-anchor sr-only" id="resource_groups"></span>3.4. Ressourcengruppen als Hosts verfügbar machen</h3>
<div class="paragraph"><p>Aus Gründen der Übersichtlichkeit ist das Azure-Monitoring von Checkmk so aufgebaut, dass jede Azure-Ressourcengruppe durch einen (sozusagen logischen) Host im Checkmk repräsentiert wird.
Dies geschieht mit Hilfe des <a href="piggyback.html">Piggyback-Verfahrens</a>.
Dabei werden Daten, die vom Azure-Host per Spezialagenten abgerufen werden, innerhalb von Checkmk an diese Ressourcengruppen-Hosts umgeleitet.</p></div>
<div class="paragraph"><p>Die Ressourcengruppen-Hosts erscheinen nicht automatisch im Checkmk.
Legen Sie diese Hosts entweder von Hand an oder optional mit dem <a href="dcd.html">Dynamic Configuration Daemon (DCD).</a>
Wichtig dabei ist, dass die Namen der Hosts exakt mit den Namen der Ressourcengruppen übereinstimmen — und zwar auch die Groß-/Kleinschreibung!
Wenn Sie sich über die genaue Schreibung der Gruppen unsicher sind, können Sie diese direkt aus dem Service <span class="guihint">Azure Agent Info</span> auf dem Azure-Host ablesen.</p></div>
<div class="paragraph"><p>Übrigens: mit dem Hilfsskript <code>find_piggy_orphans</code> aus dem treasures-Verzeichnis finden Sie alle Piggyback Hosts, für es Daten gibt,
die aber noch nicht als Host im Checkmk angelegt sind:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">OMD[mysite]:~$ </span>share/doc/check_mk/treasures/find_piggy_orphans
<span class="tok-go">Glastonbury</span>
<span class="tok-go">Woodstock</span></code></pre></div></div>
<div class="paragraph"><p>Konfigurieren Sie die Ressourcengruppen-Hosts ohne IP-Adresse (analog zum Azure-Host) und wählen Sie als Agent <span class="guihint">No API integrations, no Checkmk agent</span> und als Piggyback <span class="guihint">Always use and expect piggyback data</span> aus.</p></div>
<div class="imageblock"><div class="content"><img src="../images/wato_host_no_agent.png" alt="wato host no agent"></div></div>
<div class="paragraph"><p>Wenn Sie jetzt die Service-Erkennung zu einem dieser Ressourcengruppen-Hosts machen, finden Sie dort weitere Services, welche speziell diese Ressourcengruppe betreffen:</p></div>
<div class="imageblock"><div class="content"><img src="../images/azure_services_piggy.png" alt="azure services piggy"></div></div>
<div class="admonitionblock tip"><table><tr>
<td class="icon"><img src="../images/icons/tip.png" alt="Tip"></td>
<td class="content"><div class="paragraph"><p>Wenn Sie die Namen der Ressourcengruppen-Hosts frei wählen möchten, können Sie mit der Regel <span class="guihint">Setup &gt; Agents &gt; Access to Agents &gt; Hostname translation for piggybacked hosts</span> eine Umrechnung von Ressourcengruppen zu Hosts definieren.</p></div></td>
</tr></table></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="heading_advanced_configuration">
<span class="hidden-anchor sr-only" id="advanced_configuration"></span>4. Erweiterte Konfiguration</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="heading_azure_vms">
<span class="hidden-anchor sr-only" id="azure_vms"></span>4.1. Virtuelle Maschinen (VMs)</h3>
<div class="paragraph"><p>Wenn Sie über Azure virtuelle Maschinen überwachen, welche Sie gleichzeitig als normale Hosts in Checkmk haben, können Sie die Azure-Services, welche sich auf diese VMs beziehen, anstelle zu den Ressourcengruppen-Hosts direkt zu den VM-Hosts in Checkmk zuordnen lassen.</p></div>
<div class="paragraph"><p>Wählen Sie dazu in der Azure-Regel bei der Option <span class="guihint">Map data relating to VMs</span> die Einstellung <span class="guihint">Map data to the VM itself.</span>
Damit dies funktioniert, muss der Checkmk-Host der VM im Monitoring den exakt gleichen Namen haben wie die entsprechende VM in Azure.</p></div>
</div>
<div class="sect2">
<h3 id="heading_monitor_cost">
<span class="hidden-anchor sr-only" id="monitor_cost"></span>4.2. Kosten überwachen</h3>
<div class="paragraph"><p>Die Regel <span class="guihint">Microsoft Azure</span> ist so voreingestellt, dass Checkmk auch alle Kosten, die in Ihrer Azure-Umgebung anfallen, überwacht.
Konkret zeigen die Services die Kosten an, welche am Vortag angefallen sind.
Auf diese Weise erkennen Sie schnell, wenn es hier zu Veränderungen gekommen ist.</p></div>
<div class="paragraph"><p>Um eine bessere Übersicht zu erhalten, wo genau Kosten entstanden sind und um gezielt Schwellwerte setzen zu können, werden mehrere Services erzeugt.
Die Gesamtkosten auf Ebene Ihres Azure-Directorys, werden bei dem <a href="#create_host">Azure-Host</a> angezeigt, den sie zuerst angelegt haben.
Zusätzlich werden Services für jeden Host erzeugt, der eine <a href="#resource_groups">Ressourcengruppe</a> repräsentiert.
Auf beiden Ebenen erzeugt Checkmk pro sogenanntem „Resource Provider“ (bspw. <code>microsoft.compute</code> and <code>microsoft.network</code>) einen Service für die Kosten.
Die Gesamtsumme für die Ressourcengruppe bzw. das gesamte Azure-Directory zeigt dann der Service <span class="guihint">Costs Summary.</span></p></div>
<div class="paragraph"><p>Für all diese Services können Sie mit der Regel <span class="guihint">Azure Usage Details (Costs)</span> individuelle Schwellwerte festlegen.</p></div>
<div class="paragraph"><p>Sollten Sie keine Kostenüberwachung wünschen, müssen Sie in der Regel <span class="guihint">Microsoft Azure</span> die Option <span class="guihint">Usage Details</span> deaktivieren.</p></div>
</div>
<div class="sect2">
<h3 id="heading_rate_limit">
<span class="hidden-anchor sr-only" id="rate_limit"></span>4.3. Rate-Limit der API-Abfragen</h3>
<div class="paragraph"><p>Stand heute sind die API-Abfragen, die Checkmk zum Monitoring benötigt, bei Azure kostenlos (im Gegensatz zu <a href="monitoring_aws.html">AWS</a>).
Allerdings gibt es eine Begrenzung in der Anzahl der Abfragen pro Zeit („Rate-Limit“).
Pro Application-ID liegt die Grenze bei 12.000 Leseabfragen pro Stunde.</p></div>
<div class="paragraph"><p>Aufgrund der Bauart der API benötigt Checkmk pro abgefragte Ressource mindestens eine oder mehrere Abfragen.
Daher skaliert die Gesamtzahl der benötigten Abfragen linear mit der Anzahl der überwachten Ressourcen.
Wird das Rate-Limit erreicht oder überschritten, scheitert die Abfrage mit einem HTTP-Code 429 (Too many requests) und der <span class="guihint">Check_MK</span> Service des Azure-Hosts geht auf <span class="state2">CRIT</span>.</p></div>
<div class="paragraph"><p>Das Rate-Limit ist von Azure als sogenannter „Token Bucket“ Algorithmus realisiert.
Alles beginnt damit, dass Sie ein „Guthaben“ von 12.000 verbleibenden Abfragen haben.
Jede Abfrage verbraucht davon einen.
Gleichzeitig kommen 3,33 Abfragen pro Sekunde zum Guthaben dazu.
In der Ausgabe des Services <span class="guihint">Azure Agent Info</span> sehen Sie, wie viele Abfragen aktuell noch übrig sind.</p></div>
<div class="paragraph"><p>Konkret bedeutet das:</p></div>
<div class="ulist"><ul>
<li><p>Wenn Ihre Abfragerate ausreichend klein ist, sind die verfügbaren Abfragen immer knapp unter 12.000.</p></li>
<li><p>Wenn Ihre Rate zu hoch ist, sinkt das Guthaben langsam auf 0 und es werden dann sporadisch Fehler bei der Abfrage auftreten.</p></li>
</ul></div>
<div class="paragraph"><p>In diesem Fall können Sie die Abfragerate reduzieren, indem Sie weniger Ressourcengruppen oder Ressourcen abfragen oder indem Sie das Check-Intervall des aktiven Checks <span class="guihint">Check_MK</span> auf dem Azure-Host reduzieren.
Dies geht mit der Regel <span class="guihint">Normal check interval for service checks.</span></p></div>
<div class="paragraph"><p>Damit Sie rechtzeitig reagieren können, überwacht der Service <span class="guihint">Azure Agent Info</span> die Anzahl der verbleibenden Abfragen und warnt Sie rechtzeitig vorher.
Per Default ist die Warnschwelle bei 50 % und die kritische Schwelle bei 25 % verbleibender Abfragen.</p></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="heading_dashboards">
<span class="hidden-anchor sr-only" id="dashboards"></span>5. Dashboards</h2>
<div class="sectionbody">
<div class="paragraph"><p><span class="image-inline"><img src="../images/CEE.svg" alt="CEE" class="icon-left"></span>
Zum komfortablen Einstieg in die Überwachung von Azure liefert Checkmk Cloud von Checkmk die beiden eingebauten <a href="glossar.html#dashboard">Dashboards</a> <span class="guihint">Azure VM instances</span> und <span class="guihint">Azure storage accounts</span> mit aus.
Beide finden Sie im Monitoring als Menüeinträge unter <span class="guihint">Monitor &gt; Cloud.</span></p></div>
<div class="paragraph"><p>Damit Sie einen direkten Eindruck bekommen, finden Sie nachfolgend zwei Beispiele, wie diese Dashboards aufgebaut sind.
Zuerst das Dashboard zu den VM-Instanzen, bei der Sie auf der linken Seite den aktuellen Zustand und auf der rechten Seite den zeitlichen Verlauf der wichtigsten Metriken vergleichen können:</p></div>
<div class="imageblock"><div class="content"><img src="../images/monitoring_azure_dashboard_vm.png" alt="Dashboard zu den Azure VM-Instanzen."></div></div>
<div class="paragraph"><p>Das Dashboard zu den Storage Accounts ist ganz ähnlich aufgebaut.
Auf der linken Seite finden Sie aktuelle Daten der jeweiligen Buckets.
Auf der rechten werden wieder die wichtigsten Metriken im zeitlichen Verlauf dargestellt:</p></div>
<div class="imageblock"><div class="content"><img src="../images/monitoring_azure_dashboard_storage.png" alt="Dashboard zu den Azure Storage Accounts."></div></div>
</div>
</div>
</div></main><div id="toc" class="toc2">
<div id="toctitle">Auf dieser Seite</div>
<ul class="sectlevel1">
<li><a href="#_einleitung">1. Einleitung</a></li>
<li>
<a href="#preparation">2. Azure für Checkmk vorbereiten</a><ul class="sectlevel1">
<li><a href="#app_registration">2.1. App anlegen</a></li>
<li><a href="#client_secret">2.2. Client-Schlüssel für die App anlegen</a></li>
<li><a href="#_optional_weitere_api_berechtigungen_hinzuf%C3%BCgen">2.3. Optional: Weitere API-Berechtigungen hinzufügen</a></li>
<li><a href="#assign_role">2.4. Rolle zuweisen</a></li>
</ul>
</li>
<li>
<a href="#setup">3. Grundlegendes Monitoring in Checkmk konfigurieren</a><ul class="sectlevel1">
<li><a href="#create_host">3.1. Host für Azure anlegen</a></li>
<li><a href="#azure_agent">3.2. Den Azure-Agenten konfigurieren</a></li>
<li><a href="#_test">3.3. Test</a></li>
<li><a href="#resource_groups">3.4. Ressourcengruppen als Hosts verfügbar machen</a></li>
</ul>
</li>
<li>
<a href="#advanced_configuration">4. Erweiterte Konfiguration</a><ul class="sectlevel1">
<li><a href="#azure_vms">4.1. Virtuelle Maschinen (VMs)</a></li>
<li><a href="#monitor_cost">4.2. Kosten überwachen</a></li>
<li><a href="#rate_limit">4.3. Rate-Limit der API-Abfragen</a></li>
</ul>
</li>
<li><a href="#dashboards">5. Dashboards</a></li>
</ul>
</div>
<script src="../../assets/js/manifest.js?id=7db827d654313dce4250"></script>
<script src="../../assets/js/vendor.js?id=581a3d4a61b7156d04df"></script>
<script src="../../assets/js/app.js?id=959ccd04b1f8b7b78c5e"></script>
<script src="../../assets/js/lunr.js"></script>
<script src="../../assets/js/lunr.stemmer.support.js"></script>
<script src="../../assets/js/lunr.de.js"></script>
<script src="../lunr.index.de.js"></script>
<script src="../../assets/js/lunr.client.js"></script>
</body>
</html>
