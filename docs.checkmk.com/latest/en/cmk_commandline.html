<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]--><meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<link rel="icon" href="/favicon.png">
<meta name="description" content="If you want to use Checkmk on the command line, here you will find the most important commands (e.g. cmk) and the associated files and directories.">
<meta name="og:locale" content="en">
<meta name="og:site_name" content="Checkmk Docs">
<meta name="og:title" content="Checkmk on the command line - Understanding and using command line commands">
<meta name="og:description" content="If you want to use Checkmk on the command line, here you will find the most important commands (e.g. cmk) and the associated files and directories.">
<meta name="og:image" content="https://docs.checkmk.com/assets/images/share_image.png">
<meta name="twitter:site" content="@checkmk">
<meta name="twitter:creator" content="@checkmk">
<title>Checkmk on the command line - Understanding and using command line commands</title>
<link rel="stylesheet" href="../../assets/css/checkmk.css?id=4473d2acbb1ea6136428">
<link rel="stylesheet" href="../../assets/css/pygments-monokai.css">
<link rel="stylesheet" href="../../assets/css/addons.css">
<link rel="stylesheet" href="../../assets/css/SourceCodePro.css">
<link rel="search" href="./opensearch.xml" type="application/opensearchdescription+xml" title="Search docs.checkmk.com">
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-NJ3VGL8');</script>
<!-- End Google Tag Manager --><style>
#staticinfo { font-style: italic; }
</style>
</head>
<body class="article toc2 toc-right">
<!-- Cookie Consent (GDPR Compliance) -->

<!-- End Cookie Consent (GDPR Compliance) -->
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NJ3VGL8" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) --><div class="header-top">
<div class="header-top__left">
<a class="header-top__logo d-none d-xl-inline-block" href="/latest/en"><img src="../../assets/images/docs_logo.png" alt="Checkmk"></a><a class="header-top__icon d-inline-block d-xl-none" href="/latest/en"><img src="../../assets/images/logo_icon.svg" alt="Checkmk"></a>
</div>
<div class="header-top__center">
<input type="text" class="header-top__search" placeholder="Search the checkmk docs"><div class="header-top__search__results"></div>
</div>
<div class="header-top__right d-block">
<button class="header-top__search__toggle d-inline-block d-md-none"><img class="header-top__search__toggle__icon" src="../../assets/images/search.svg" alt="Search"></button><div class="dropdown dropdown__language">
                    <button class="btn dropdown-toggle" type="button" id="languageMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">en</button>
                    <div class="dropdown-menu  dropdown-menu-right" aria-labelledby="languageMenuButton"><a class="dropdown-item" href="../../latest/de/cmk_commandline.html">Deutsch</a></div>
</div>
<div class="dropdown dropdown__branch">
                        <button class="btn dropdown-toggle" type="button" id="branchMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">latest (2.3.0)</button>
                        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="branchMenuButton">
<a class="dropdown-item" href="../../2.1.0/en/cmk_commandline.html">2.1.0</a><a class="dropdown-item" href="../../2.2.0/en/cmk_commandline.html">2.2.0</a>
</div>
</div>
<a class="header-top__back d-none d-lg-inline-block" href="https://checkmk.com">to checkmk.com</a><button class="header-top__toggle d-inline-block d-lg-none"><span class="header-top__toggle__icon"></span></button>
</div>
</div>
<aside><div class="main-nav">
<div class="main-nav__content"><div id="content">
<div class="sect1">
<h2 id="_welcome_to_checkmk">
<a class="anchor" href="#_welcome_to_checkmk"></a>1. Welcome to Checkmk</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="welcome.html">Welcome to the Checkmk User Guide</a></p>
</li>
<li>
<p><a href="release_notes.html">Release notes</a></p>
</li>
<li>
<p><a href="glossar.html">Glossary</a></p>
</li>
<li>
<p><a href="search.html">Searching docs.checkmk.com</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_beginners_guide">
<a class="anchor" href="#_beginners_guide"></a>2. Beginner’s Guide</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="intro_setup.html">Setting up Checkmk</a></p>
</li>
<li>
<p><a href="intro_gui.html">The Checkmk user interface</a></p>
</li>
<li>
<p><a href="intro_setup_monitor.html">Setting up monitoring</a></p>
</li>
<li>
<p><a href="intro_tools.html">The monitoring tools</a></p>
</li>
<li>
<p><a href="intro_monitor.html">Checkmk in monitoring</a></p>
</li>
<li>
<p><a href="intro_finetune.html">Fine-tuning the monitoring</a></p>
</li>
<li>
<p><a href="intro_users.html">Working with multiple users</a></p>
</li>
<li>
<p><a href="intro_notifications.html">Switching on notifications</a></p>
</li>
<li>
<p><a href="intro_extend.html">Extending the monitoring system further</a></p>
</li>
<li>
<p><a href="intro_bestpractise.html">Best practices, tips &amp; tricks</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_installation">
<a class="anchor" href="#_installation"></a>3. Installation</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="install_packages.html">Basic information on the installation of Checkmk</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_server_and_vms">
<a class="anchor" href="#_server_and_vms"></a>3.1. Server and VMs</h3>
<div class="ulist">
<ul>
<li>
<p><a href="install_packages_debian.html">Installation on Debian and Ubuntu</a></p>
</li>
<li>
<p><a href="install_packages_redhat.html">Installation on Red Hat and derivatives</a></p>
</li>
<li>
<p><a href="install_packages_sles.html">Installation on SUSE Linux Enterprise Server</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_appliance_container_cloud">
<a class="anchor" href="#_appliance_container_cloud"></a>3.2. Appliance, container, cloud</h3>
<div class="ulist">
<ul>
<li>
<p><a href="install_appliance_cmk.html">Installation of Checkmk in the appliance</a></p>
</li>
<li>
<p><a href="introduction_docker.html">Installation as a Docker container</a></p>
</li>
<li>
<p><a href="install_azure.html">Installation from Azure Marketplace</a></p>
</li>
<li>
<p><a href="install_aws.html">Installation from AWS Marketplace</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_updates">
<a class="anchor" href="#_updates"></a>3.3. Updates</h3>
<div class="ulist">
<ul>
<li>
<p><a href="update.html">Updates and Upgrades</a></p>
</li>
<li>
<p><a href="update_major.html">Update to version <span class="new">2.3.0</span></a></p>
</li>
<li>
<p><a href="update_matrix.html">Update matrix for version <span class="new">2.3.0</span></a></p>
</li>
<li>
<p><a href="release_upgrade.html">Linux upgrade on the Checkmk server</a></p>
</li>
<li>
<p><a href="cmk_versions.html">Checkmk versions</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_administration_of_checkmk">
<a class="anchor" href="#_administration_of_checkmk"></a>4. Administration of Checkmk</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_server">
<a class="anchor" href="#_server"></a>4.1. Server</h3>
<div class="ulist">
<ul>
<li>
<p><a href="saml.html">Authentication with SAML</a></p>
</li>
<li>
<p><a href="kerberos.html">Single sign-on with Kerberos</a></p>
</li>
<li>
<p><a href="managing_docker.html">Checkmk server in a Docker container</a></p>
</li>
<li>
<p><a href="security.html">Security</a></p>
</li>
<li>
<p><a href="ports.html">Ports</a></p>
</li>
<li>
<p><a href="omd_https.html">Securing the web interface with HTTPS</a></p>
</li>
<li>
<p><a href="support_diagnostics.html">Support diagnostics</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_sites">
<a class="anchor" href="#_sites"></a>4.2. Sites</h3>
<div class="ulist">
<ul>
<li>
<p><a href="omd_basics.html">Site administration with omd</a></p>
</li>
<li>
<p><a href="cmk_commandline.html">Checkmk on the command line</a></p>
</li>
<li>
<p><a href="license.html">Managing licenses</a></p>
</li>
<li>
<p><a href="distributed_monitoring.html">Distributed monitoring</a></p>
</li>
<li>
<p><a href="backup.html">Backups</a></p>
</li>
<li>
<p><a href="password_store.html">Password store</a></p>
</li>
<li>
<p><a href="analyze_configuration.html">Analyzing the Checkmk site configuration</a></p>
</li>
<li>
<p><a href="mkps.html">Checkmk extension packages (MKPs)</a></p>
</li>
<li>
<p><a href="mkp_viewables.html">MKPs for GUI extensions</a></p>
</li>
<li>
<p><a href="simulation_mode.html">Simulation mode</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_configuration">
<a class="anchor" href="#_configuration"></a>5. Configuration</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="wato.html">Configuring Checkmk</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_hosts">
<a class="anchor" href="#_hosts"></a>5.1. Hosts</h3>
<div class="ulist">
<ul>
<li>
<p><a href="hosts_setup.html">Host administration</a></p>
</li>
<li>
<p><a href="hosts_structure.html">Host structuring</a></p>
</li>
<li>
<p><a href="host_tags.html">Host tags</a></p>
</li>
<li>
<p><a href="dcd.html">Dynamic host configuration</a></p>
</li>
<li>
<p><a href="hosts_autoregister.html">Automated host creation</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_services">
<a class="anchor" href="#_services"></a>5.2. Services</h3>
<div class="ulist">
<ul>
<li>
<p><a href="wato_services.html">Understanding and configuring services</a></p>
</li>
<li>
<p><a href="clustered_services.html">Monitoring cluster services</a></p>
</li>
<li>
<p><a href="piggyback.html">The piggyback mechanism</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_rules">
<a class="anchor" href="#_rules"></a>5.3. Rules</h3>
<div class="ulist">
<ul>
<li>
<p><a href="wato_rules.html">Rules</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_supporting_configurations">
<a class="anchor" href="#_supporting_configurations"></a>5.4. Supporting configurations</h3>
<div class="ulist">
<ul>
<li>
<p><a href="timeperiods.html">Time periods</a></p>
</li>
<li>
<p><a href="labels.html">Labels</a></p>
</li>
<li>
<p><a href="regexes.html">Regular expressions in Checkmk</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_users_and_permissions">
<a class="anchor" href="#_users_and_permissions"></a>5.5. Users and permissions</h3>
<div class="ulist">
<ul>
<li>
<p><a href="wato_user.html">Users, roles and permissions</a></p>
</li>
<li>
<p><a href="ldap.html">User management with LDAP/Active Directory</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_notifications">
<a class="anchor" href="#_notifications"></a>5.6. Notifications</h3>
<div class="ulist">
<ul>
<li>
<p><a href="notifications.html">Notifications</a></p>
</li>
<li>
<p><a href="notifications_webex.html">Notifications via Cisco Webex Teams</a></p>
</li>
<li>
<p><a href="notifications_ilert.html">Notifications via ilert</a></p>
</li>
<li>
<p><a href="notifications_jira.html">Notifications via Jira</a></p>
</li>
<li>
<p><a href="notifications_mattermost.html">Notifications via Mattermost</a></p>
</li>
<li>
<p><a href="notifications_teams.html">Notifications via Microsoft Teams</a></p>
</li>
<li>
<p><a href="notifications_pagerduty.html">Notifications via PagerDuty</a></p>
</li>
<li>
<p><a href="notifications_pushover.html">Notifications via Pushover</a></p>
</li>
<li>
<p><a href="notifications_opsgenie.html">Notifications via Opsgenie</a></p>
</li>
<li>
<p><a href="notifications_servicenow.html">Notifications via ServiceNow</a></p>
</li>
<li>
<p><a href="notifications_signl4.html">Notifications via SIGNL4</a></p>
</li>
<li>
<p><a href="notifications_slack.html">Notifications via Slack</a></p>
</li>
<li>
<p><a href="notifications_splunkoncall.html">Notifications via Splunk On-Call</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_events">
<a class="anchor" href="#_events"></a>5.7. Events</h3>
<div class="ulist">
<ul>
<li>
<p><a href="ec.html">The Event Console</a></p>
</li>
<li>
<p><a href="alert_handlers.html">Alert handlers</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_monitoring_systems">
<a class="anchor" href="#_monitoring_systems"></a>6. Monitoring systems</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="wato_monitoringagents.html">Monitoring agents</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_checkmk_agents_and_snmp">
<a class="anchor" href="#_checkmk_agents_and_snmp"></a>6.1. Checkmk agents and SNMP</h3>
<div class="ulist">
<ul>
<li>
<p><a href="agent_deployment.html">Automatic agent updates</a></p>
</li>
<li>
<p><a href="agent_linux.html">Monitoring Linux</a></p>
</li>
<li>
<p><a href="agent_linux_legacy.html">Monitoring Linux in legacy mode</a></p>
</li>
<li>
<p><a href="agent_windows.html">Monitoring Windows</a></p>
</li>
<li>
<p><a href="agent_freebsd.html">Monitoring FreeBSD</a></p>
</li>
<li>
<p><a href="snmp.html">Monitoring via SNMP</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_agent_extensions">
<a class="anchor" href="#_agent_extensions"></a>6.2. Agent extensions</h3>
<div class="ulist">
<ul>
<li>
<p><a href="inventory.html">The HW/SW inventory</a></p>
</li>
<li>
<p><a href="mk_filestats.html">Monitoring files</a></p>
</li>
<li>
<p><a href="monitoring_logfiles.html">Monitoring log files</a></p>
</li>
<li>
<p><a href="monitoring_oracle.html">Monitoring Oracle databases</a></p>
</li>
<li>
<p><a href="monitoring_mysql.html">Monitoring MySQL</a></p>
</li>
<li>
<p><a href="monitoring_mssql.html">Monitoring MSSQL</a></p>
</li>
<li>
<p><a href="monitoring_mssql_legacy.html">Monitoring MSSQL with the legacy plug-in</a></p>
</li>
<li>
<p><a href="monitoring_jobs.html">Monitoring time-based processes (Cronjobs)</a></p>
</li>
<li>
<p><a href="spool_directory.html">The spool directory</a></p>
</li>
<li>
<p><a href="localchecks.html">Local checks</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_vm_cloud_container">
<a class="anchor" href="#_vm_cloud_container"></a>6.3. VM, cloud, container</h3>
<div class="ulist">
<ul>
<li>
<p><a href="datasource_programs.html">Datasource programs</a></p>
</li>
<li>
<p><a href="monitoring_vmware.html">Monitoring VMware ESXi</a></p>
</li>
<li>
<p><a href="monitoring_aws.html">Monitoring Amazon Web Services (AWS)</a></p>
</li>
<li>
<p><a href="monitoring_azure.html">Monitoring Microsoft Azure</a></p>
</li>
<li>
<p><a href="monitoring_gcp.html">Monitoring Google Cloud Platform (GCP)</a></p>
</li>
<li>
<p><a href="monitoring_kubernetes.html">Monitoring Kubernetes</a></p>
</li>
<li>
<p><a href="monitoring_openshift.html">Monitoring OpenShift</a></p>
</li>
<li>
<p><a href="monitoring_docker.html">Monitoring Docker</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_endpoints">
<a class="anchor" href="#_endpoints"></a>6.4. Endpoints</h3>
<div class="ulist">
<ul>
<li>
<p><a href="active_checks.html">Monitoring network services (Active checks)</a></p>
</li>
<li>
<p><a href="robotmk.html">Checkmk Synthetic Monitoring with Robotmk</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_dashboards_views_metrics">
<a class="anchor" href="#_dashboards_views_metrics"></a>7. Dashboards, views, metrics</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="user_interface.html">The user interface</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_general">
<a class="anchor" href="#_general"></a>7.1. General</h3>
<div class="ulist">
<ul>
<li>
<p><a href="views.html">Host and service views</a></p>
</li>
<li>
<p><a href="dashboards.html">Dashboards</a></p>
</li>
<li>
<p><a href="graphing.html">Measured values and graphing</a></p>
</li>
<li>
<p><a href="custom_notes.html">Custom notes</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_commands_in_views">
<a class="anchor" href="#_commands_in_views"></a>7.2. Commands in views</h3>
<div class="ulist">
<ul>
<li>
<p><a href="commands.html">Commands</a></p>
</li>
<li>
<p><a href="basics_ackn.html">Acknowledging problems</a></p>
</li>
<li>
<p><a href="basics_downtimes.html">Scheduled downtimes</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_analysis_and_prognosis">
<a class="anchor" href="#_analysis_and_prognosis"></a>8. Analysis and prognosis</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_analysis">
<a class="anchor" href="#_analysis"></a>8.1. Analysis</h3>
<div class="ulist">
<ul>
<li>
<p><a href="availability.html">Availability</a></p>
</li>
<li>
<p><a href="sla.html">Extended availability (SLAs)</a></p>
</li>
<li>
<p><a href="bi.html">Business Intelligence (BI)</a></p>
</li>
<li>
<p><a href="reporting.html">Reports</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_prognosis">
<a class="anchor" href="#_prognosis"></a>8.2. Prognosis</h3>
<div class="ulist">
<ul>
<li>
<p><a href="predictive_monitoring.html">Predictive monitoring</a></p>
</li>
<li>
<p><a href="forecast_graphs.html">Forecast graphs</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_connection_of_other_applications">
<a class="anchor" href="#_connection_of_other_applications"></a>9. Connection of other applications</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="monitoring_prometheus.html">Integrating Prometheus</a></p>
</li>
<li>
<p><a href="integrating_datadog.html">Integrating Datadog</a></p>
</li>
<li>
<p><a href="nagvis.html">NagVis: status data on maps and diagrams</a></p>
</li>
<li>
<p><a href="ntop.html">Integrating ntopng in Checkmk</a></p>
</li>
<li>
<p><a href="grafana.html">Integrating Checkmk in Grafana</a></p>
</li>
<li>
<p><a href="metrics_exporter.html">Sending metrics to InfluxDB and Graphite</a></p>
</li>
<li>
<p><a href="nagstamon.html">Integrating Checkmk in Nagstamon</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_specifics_to_the_editions">
<a class="anchor" href="#_specifics_to_the_editions"></a>10. Specifics to the editions</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="cse.html">Checkmk Enterprise</a></p>
</li>
<li>
<p><a href="cce.html">Checkmk Cloud</a></p>
</li>
<li>
<p><a href="managed.html">Checkmk MSP</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_automation_and_development">
<a class="anchor" href="#_automation_and_development"></a>11. Automation and development</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="apis_intro.html">Overview of API resources</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_apis_for_automation">
<a class="anchor" href="#_apis_for_automation"></a>11.1. APIs for automation</h3>
<div class="ulist">
<ul>
<li>
<p><a href="rest_api.html">The Checkmk REST API</a></p>
</li>
<li>
<p><a href="livestatus.html">Retrieving status data via Livestatus</a></p>
</li>
<li>
<p><a href="livestatus_references.html">Livestatus command reference</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_apis_for_development">
<a class="anchor" href="#_apis_for_development"></a>11.2. APIs for development</h3>
<div class="ulist">
<ul>
<li>
<p><a href="bakery_api.html">The Bakery-API</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_development_of_check_plug_ins">
<a class="anchor" href="#_development_of_check_plug_ins"></a>11.3. Development of check plug-ins</h3>
<div class="ulist">
<ul>
<li>
<p><a href="devel_intro.html">Developing extensions for Checkmk</a></p>
</li>
<li>
<p><a href="devel_check_plugins.html">Writing agent-based check plug-ins</a></p>
</li>
<li>
<p><a href="devel_check_plugins_snmp.html">Writing SNMP-based check plug-ins</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_concepts">
<a class="anchor" href="#_concepts"></a>12. Concepts</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="monitoring_basics.html">Basic principles of monitoring with Checkmk</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_the_checkmk_micro_core_cmc">
<a class="anchor" href="#_the_checkmk_micro_core_cmc"></a>12.1. The Checkmk Micro Core (CMC)</h3>
<div class="ulist">
<ul>
<li>
<p><a href="cmc.html">The Checkmk Micro Core (CMC)</a></p>
</li>
<li>
<p><a href="cmc_differences.html">Special characteristics of the CMC</a></p>
</li>
<li>
<p><a href="cmc_migration.html">Migration to the CMC</a></p>
</li>
<li>
<p><a href="cmc_files.html">CMC files and directories</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_checkmk_appliance">
<a class="anchor" href="#_the_checkmk_appliance"></a>13. The Checkmk appliance</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="appliance_rack1_quick_start.html">Quick start guide for Checkmk racks</a></p>
</li>
<li>
<p><a href="appliance_virt1_quick_start.html">Quick start guide for Checkmk virt1</a></p>
</li>
<li>
<p><a href="appliance_install_virt1.html">Installation of the virtual appliance</a></p>
</li>
<li>
<p><a href="appliance_usage.html">Configuring and using the appliance</a></p>
</li>
<li>
<p><a href="appliance_backup.html">Backup in the appliance</a></p>
</li>
<li>
<p><a href="appliance_cluster.html">Appliance in cluster operation</a></p>
</li>
<li>
<p><a href="appliance_rack_config.html">Special features of the hardware appliance</a></p>
</li>
</ul>
</div>
</div>
</div>
</div></div>
<div class="main-nav__utils">
<div class="dropup dropdown__utils">
<button class="btn dropdown-toggle" type="button" id="aboutMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">About Checkmk</button><div class="dropdown-menu dropup" aria-labelledby="aboutMenuButton">
<a class="dropdown-item" href="https://checkmk.com/product/features" target="_blank">Features</a><a class="dropdown-item" href="https://checkmk.com/product/editions" target="_blank">Editions</a><a class="dropdown-item" href="https://checkmk.com/integrations" target="_blank">Integrations</a><a class="dropdown-item" href="https://checkmk.com/imprint" target="_blank">Imprint</a><a class="dropdown-item" href="copyright.html" target="_blank">Copyright</a>
</div>
</div>
<div class="dropup dropdown__utils">
<button class="btn dropdown-toggle" type="button" id="learnMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Learn</button><div class="dropdown-menu dropup" aria-labelledby="learnMenuButton">
<a class="dropdown-item" href="https://checkmk.com/videos">Videos</a><a class="dropdown-item" href="https://checkmk.com/webinars">Webinars</a><a class="dropdown-item" href="https://checkmk.com/trainings/classes">Trainings</a>
</div>
</div>
<a class="main-nav__utils__link" href="https://forum.checkmk.com">Forum</a>
</div>
</div></aside><main><div id="header">
<h1>Checkmk on the command line</h1>
<div class="details">
<span id="revdate">Last modified on 06-Mar-2024</span><a class="edit-document" href="https://github.com/Checkmk/checkmk-docs/edit/2.3.0/src/onprem/en/cmk_commandline.asciidoc">Edit this page on GitHub</a>
</div>
</div>
<div id="content">
<div id="preamble">
<div id="staticinfo">This page was exported for offline usage on 2025-01-07 22:12:14 +0000. It may not reflect the current state of the Checkmk documentation. To view a daily updated version, visit <a href="https://docs.checkmk.com/" target="_blank">docs.checkmk.com</a>.</div>
<div class="sectionbody"><div class="paragraph">
<p></p>
<div class="dropdown dropdown__related">
<button class="btn btn-primary dropdown-toggle" type="button" id="relatedMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Related Articles</button><div class="dropdown-menu dropdown-menu-right" aria-labelledby="relatedMenuButton">
<a href="wato.html">Configuring Checkmk</a>
<a href="livestatus.html">Retrieving status data via Livestatus</a>
</div>
</div>
</div></div>
</div>
<div class="sect1">
<h2 id="heading__why_command_line">
<span class="hidden-anchor sr-only" id="_why_command_line"></span>1. Why command line?</h2>
<div class="sectionbody">
<div class="paragraph"><p>When a Checkmk-System has been installed, it can be 100 % configured and
operated using the web interface. There are nonetheless situations in
which it is useful to dive into the depths of the command line,
for example:</p></div>
<div class="ulist"><ul>
<li><p>when searching for the source of problems</p></li>
<li><p>when automating the administration of Checkmk</p></li>
<li><p>when programming and testing your own extensions</p></li>
<li><p>to be able to understand how Checkmk functions internally</p></li>
<li><p>if you simply enjoy working with the command line!</p></li>
</ul></div>
<div class="paragraph"><p>This article will present the most important commands, files and directories
on Checkmk’s command line.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="heading_site_user">
<span class="hidden-anchor sr-only" id="site_user"></span>2. The site user</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="heading__login_as_site_user">
<span class="hidden-anchor sr-only" id="_login_as_site_user"></span>2.1. Login as site user</h3>
<div class="paragraph"><p>When administering Checkmk, with a few exceptions you need never work
as the <code>root</code>-user. In this article we will generally assume that
you are logged in as a <em>site user</em>. That is done with, e.g.:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">root@linux# </span>su<span class="tok-w"> </span>-<span class="tok-w"> </span>mysite</code></pre></div></div>
<div class="paragraph"><p>It is also possible to make a direct SSH-login to a site without a detour
via <code>root</code>. Since the site user is a ‘completely normal’ Linux user,
you must simply assign a password for this (which
requires <code>root</code>-permissions, once only, for the configuration):</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">root@linux# </span>passwd<span class="tok-w"> </span>mysite
<span class="tok-go">Enter new UNIX password: <strong>**********</strong></span>
<span class="tok-go">Retype new UNIX password: <strong>**********</strong></span>
<span class="tok-go">passwd: password updated successfully</span></code></pre></div></div>
<div class="paragraph"><p>Afterwards an SSH-login directly from another computer should be possible
(Windows-users preferably use PuTTY for this). From Linux this login is simply
performed in the command line using the <code>ssh</code> command:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-go">user@otherhost&gt; ssh mysite@myserver123</span>
<span class="tok-go">mysite@localhost's password: <strong>**********</strong></span></code></pre></div></div>
<div class="paragraph"><p>At the first login a ‘warning’ regarding an unknown host key will probably
be received. When you are certain that in this brief moment no attacker has
taken over your operating system’s IP-address, you can simply verify it
with <code>yes</code>.</p></div>
<div class="paragraph"><p>You can also work with the command line on the Checkmk-appliance.
How that is done is explained in its <a href="appliance_usage.html#ssh">own article</a>.</p></div>
</div>
<div class="sect2">
<h3 id="heading__profile_and_environment_variables">
<span class="hidden-anchor sr-only" id="_profile_and_environment_variables"></span>2.2. Profile and environment variables</h3>
<div class="paragraph"><p>So that as few problems as possible arise, particularly as a result of individual
distributions or differing operating system configurations, the Checkmk-system
ensures that the site user – and likewise all of the monitoring’s processes
 – always have a clearly defined environment. Along with the home directory
and the permissions, the <strong>environment variables</strong> play an important role.</p></div>
<div class="paragraph"><p>Among other things, when logging in as a site user the following variables
will be set or modified. These variables are available for use in all processes
running within the site. This also applies to scripts that are indirectly
invoked by these processes (for example, a user’s own <a href="notifications.html#scripts">notification scripts</a>).</p></div>
<table class="table-responsive table-bordered table tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>OMD_SITE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The site’s name (<code>mysite</code>). In custom scripts this variable should always be used rather than a hard coded site name (e.g. with <code>$OMD_SITE</code> in the shell). With this the script can also be used unchanged in other sites.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>OMD_ROOT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The path for the site directory (<code>/omd/sites/mysite</code>)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>PATH</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Directories in which executable programs will be searched for. For example, Checkmk keeps the site’s <code>bin/</code> here. In the case of identical names, Checkmk programs have priority – this is important, e.g., for the <code>mail</code> command, a special version of which is provided with a Checkmk installation.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LD_LIBRARY_PATH</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Directories in which additional binary libraries are searched for. Using this variable Checkmk ensures that libraries provided with Checkmk have priority over those installed in the normal operating system.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>PERL5LIB</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Search path for the Perl module. Here, too, module variants delivered by Checkmk have priority in case of doubt.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LANG</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The language setting for command line commands. This setting is adopted from the Linux installation. This variable is automatically deleted in the site’s processes, and the setting reverts to the default English! This also affects other regional settings.  Removing <code>LANG</code> is very important, since a number of standard Nagios plug-ins, for example, the German language setting, uses a comma for the decimal separator instead of a point. Your output can thus not be accurately processed.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph"><p>With the <code>env</code> command you can output all of the environment variables
 – adding <code>| sort</code> to this command arranges the list a bit more clearly:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">OMD[mysite]:~$ </span>env<span class="tok-w"> </span><span class="tok-p">|</span><span class="tok-w"> </span>sort
<span class="tok-go">HOME=/omd/sites/mysite</span>
<span class="tok-go">LANG=de_DE.UTF-8</span>
<span class="tok-go">LD_LIBRARY_PATH=/omd/sites/mysite/local/lib:/omd/sites/mysite/lib</span>
<span class="tok-go">LOGNAME=mysite</span>
<span class="tok-go">MAILRC=/omd/sites/mysite/etc/mail.rc</span>
<span class="tok-go">MAIL=/var/mail/mysite</span>
<span class="tok-go">MANPATH=/omd/sites/mysite/share/man:</span>
<span class="tok-go">MODULEBUILDRC=/omd/sites/mysite/.modulebuildrc</span>
<span class="tok-go">MP_STATE_DIRECTORY=/omd/sites/mysite/var/monitoring-plugins</span>
<span class="tok-go">NAGIOS_PLUGIN_STATE_DIRECTORY=/omd/sites/mysite/var/monitoring-plugins</span>
<span class="tok-go">OMD_ROOT=/omd/sites/mysite</span>
<span class="tok-go">OMD_SITE=mysite</span>
<span class="tok-go">PATH=/omd/sites/mysite/lib/perl5/bin:/omd/sites/mysite/local/bin:/omd/sites/mysite/bin:/omd/sites/mysite/local/lib/perl5/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games</span>
<span class="tok-go">PERL5LIB=/omd/sites/mysite/local/lib/perl5/lib/perl5:/omd/sites/mysite/lib/perl5/lib/perl5:</span>
<span class="tok-go">PERL_MM_OPT=INSTALL_BASE=/omd/sites/mysite/local/lib/perl5/</span>
<span class="tok-go">PWD=/omd/sites/mysite</span>
<span class="tok-go">REQUESTS_CA_BUNDLE=/omd/sites/mysite/var/ssl/ca-certificates.crt</span>
<span class="tok-go">SHELL=/bin/bash</span>
<span class="tok-go">SHLVL=1</span>
<span class="tok-go">TERM=xterm</span>
<span class="tok-go">USER=mysite</span>
<span class="tok-go">_=/usr/bin/env</span></code></pre></div></div>
<div class="paragraph"><p>Under Linux the environment is an attribute of a <em>process</em>. Every process
has its own variables, which it automatically passes on to sub-processes.
These start initially with the same, inherited variables, but can also alter them.</p></div>
<div class="paragraph"><p>With the <code>env</code> command you can always only view the current shell’s
environment. If you suspect there is an error in a particular process’s
environment, with a small trick you can nonetheless output a listing of its environment.
For this you only need the process-ID (PID).
You can identify this with, e.g., <code>ps ax</code>, <code>pstree -p</code> or <code>top</code>.
With this you can then access the process’s <code>environ</code> file directly via
the <code>/proc</code> file system. Here as an example
is a suitable command for the PID <code>13222</code>:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">OMD[mysite]:~$ </span>tr<span class="tok-w"> </span><span class="tok-se">\\</span><span class="tok-m">0</span><span class="tok-w"> </span><span class="tok-se">\\</span>n<span class="tok-w"> </span>&lt;<span class="tok-w"> </span>/proc/13222/environ<span class="tok-w"> </span><span class="tok-p">|</span><span class="tok-w"> </span>sort</code></pre></div></div>
<div class="paragraph"><p>If you require custom variables for your own scripts or other software to be run
in the site, store them in the <code>etc/environment</code> file which has been
specially created for this purpose. All variables defined here will
be available everywhere within the site:</p></div>
<div class="listingblock">
<div class="title">etc/environment</div>
<div class="content"><pre class="pygments highlight"><code><span></span># Custom environment variables
#
# Here you can set environment variables. These will
# be set in interactive mode when logging in as site
# user and also when starting the OMD processes with
# omd start.
#
# This file has shell syntax, but without 'export'.
# Better use quotes if your values contain spaces.
#
# Example:
#
# FOO="bar"
# FOO2="With some spaces"
#
MY_SUPER_VAR=blabla123
MY_OTHER_VAR=10.88.112.17</code></pre></div>
</div>
</div>
<div class="sect2">
<h3 id="heading__customizing_the_shell">
<span class="hidden-anchor sr-only" id="_customizing_the_shell"></span>2.3. Customizing the shell</h3>
<div class="paragraph"><p>If you wish to customize your shell (Prompt or other things), you can perform this as
usual in the <code>.bashrc</code> file. Environment variables nonetheless belong to
<code>etc/environment</code>, so that they are certain to be available to all processes.</p></div>
<div class="paragraph"><p>There is also nothing to prevent you having your own <code>.vimrc</code> file
if you like working with VIM.</p></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="heading_folder_structure">
<span class="hidden-anchor sr-only" id="folder_structure"></span>3. The directory structure</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="heading__the_separation_of_software_and_data">
<span class="hidden-anchor sr-only" id="_the_separation_of_software_and_data"></span>3.1. The separation of software and data</h3>
<div class="paragraph"><p>The following graphic shows the most important directories in a Checkmk installation with a site named <code>mysite</code> and a <code>&lt;version&gt;</code> called for example <code>2.0.0p8.cee</code>:</p></div>
<div class="imageblock"><div class="content"><img src="../images/filesystem.png" alt="Illustration of the directory structure of a Checkmk site."></div></div>
<div class="paragraph"><p>The basis for this structure is provided by the <code>/omd</code> directory.
Without exception, all of the files for Checkmk are found here.
<code>/omd</code> is in fact a symbolic link to <code>/opt/omd</code>, while the actual <em>physical</em>
data is located in <code>/opt</code> – but all data paths in Checkmk always use <code>/omd</code>.</p></div>
<div class="paragraph"><p>Important is the separation of data (highlighted yellow) and software (blue).
The site’s data is found in <code>/omd/sites</code>, and the installed software
in <code>/omd/versions</code>.</p></div>
</div>
<div class="sect2">
<h3 id="heading_sitedir">
<span class="hidden-anchor sr-only" id="sitedir"></span>3.2. Site directory</h3>
<div class="paragraph"><p>Like every Linux user, the site user also has a home directory,
which we refer to as the site directory. If your site is named
<code>mysite</code> it will be found in <code>/omd/sites/mysite</code>.
As usual in Linux the shell abbreviates the its own home directory with a
tilde (<code>~</code>) (or swung dash). Since immediately following a login you will
actually be in this directory, the tilde appears automatically in the input prompt:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">OMD[mysite]<mark>:~$</mark></span></code></pre></div></div>
<div class="paragraph"><p>Subdirectories of the site directory are shown relative to the tilde:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">OMD[mysite]:~$ </span><span class="tok-nb">cd</span><span class="tok-w"> </span>var/log
<span class="tok-gp">OMD[mysite]<mark>:~/var/log$</mark></span></code></pre></div></div>
<div class="paragraph"><p>A number of subdirectories are located within the site directory,
these can be listed with <code>ll</code>:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">OMD[mysite]:~$ </span>ll
<span class="tok-go">total 16</span>
<span class="tok-go">lrwxrwxrwx  1 mysite mysite   11 Jan 24 11:56 bin -&gt; version/bin/</span>
<span class="tok-go">drwxr-xr-x 19 mysite mysite 4096 Jan 24 11:56 etc/</span>
<span class="tok-go">lrwxrwxrwx  1 mysite mysite   15 Jan 24 11:56 include -&gt; version/include/</span>
<span class="tok-go">lrwxrwxrwx  1 mysite mysite   11 Jan 24 11:56 lib -&gt; version/lib/</span>
<span class="tok-go">drwxr-xr-x  5 mysite mysite 4096 Jan 24 11:56 local/</span>
<span class="tok-go">lrwxrwxrwx  1 mysite mysite   13 Jan 24 11:56 share -&gt; version/share/</span>
<span class="tok-go">drwxr-xr-x  2 mysite mysite 4096 Jan 24 09:57 tmp/</span>
<span class="tok-go">drwxr-xr-x 12 mysite mysite 4096 Jan 24 11:56 var/</span>
<span class="tok-go">lrwxrwxrwx  1 mysite mysite   29 Jan 24 11:56 version -&gt; ../../versions/2.0.0p8.cee/</span></code></pre></div></div>
<div class="paragraph"><p>As can be seen, the directories <code>bin</code>, <code>include</code>, <code>lib</code>,
<code>share</code> and <code>version</code> are symbolic links.
The rest are ‘normal’ directories. This mirrors the separation of software and
and data as explained above. The software directory must be accessible as a
subdirectory in the site, but it is physically located in <code>/omd/versions</code>,
and can also possibly be used by other sites.</p></div>
<table class="table-responsive table-bordered table tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 35%;">
<col style="width: 40%;">
</colgroup>
<thead><tr>
<th class="tableblock halign-left valign-top"></th>
<th class="tableblock halign-left valign-top">Software</th>
<th class="tableblock halign-left valign-top">Data</th>
</tr></thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Directories</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>bin</code>, <code>include</code>, <code>lib</code>, <code>share</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>etc</code>, <code>local</code>, <code>tmp</code>, <code>var</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Owner</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>root</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Site user (<code>mysite</code>)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Created by</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Checkmk installation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Site creation, configuration, and monitoring</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Physical location</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/omd/versions/2.0.0p8.cee/</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/omd/sites/mysite/</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">File type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Symbolic links</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Normal directories</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="heading__software">
<span class="hidden-anchor sr-only" id="_software"></span>3.3. Software</h3>
<div class="paragraph"><p>The software directories, as usual under Linux, belong to <code>root</code>
and thus may not be altered by a site user. The following subdirectories
are present – those in the example are physically located within the
<code>/omd/versions/2.0.0p8.cee</code>, and they are accessible via symbolic links
from the site directory:</p></div>
<table class="table-responsive table-bordered table tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>bin/</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Directory for executable programs. Here the <code>cmk</code> command is found, for example.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>lib/</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C-directories, plug-ins for Apache and Python – and in the <code>nagios/plugins</code> subdirectory – standard monitoring plug-ins, which are mostly written in C or Perl.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>share/</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The main part of the installed software. Very many components are located in <code>share/check_mk</code> – among others, well over 2,000 check plug-ins.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>include/</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Contains Include-files for C-programs, which should be linked to libraries in <code>lib/</code>. This directory is not important and is only used if you wish to translate C-programs yourself.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph"><p>The <code>version/</code> symbolic link is a ‘intermediate stop’ and serves as a relay
point for the version used by the site. During a <a href="update.html">software update</a> this
will be switched from the old to the new version. Nonetheless, please do not attempt
to perform an update manually by altering the link, since an update
requires a number of other further steps – which will fail.</p></div>
</div>
<div class="sect2">
<h3 id="heading_data">
<span class="hidden-anchor sr-only" id="data"></span>3.4. Data</h3>
<div class="paragraph"><p>The actual <strong>data</strong> for a site is found in the remaining subdirectories
in the site directory. Without exception, these belong to the site user.
The site directory itself is also included. Checkmk stores nothing apart from
the directories listed there. You can create your own files and directories
without problem here, in which tests, downloaded data, copies of log files, etc.
can be kept as desired.</p></div>
<div class="paragraph"><p>The following directories have been predefined:</p></div>
<table class="table-responsive table-bordered table tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 15%;">
<col style="width: 85%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>etc/</code></p></td>
<td class="tableblock halign-left valign-top">
<p class="tableblock">Configuration files. These can be edited either by hand or by using Checkmk’s <a href="wato.html">Setup</a>.</p>
<p class="tableblock">Note: The scripts in <code>etc/init.d</code> are actually also ‘configuration’ files, since they are found in <code>etc/</code>. This is based on the same pattern as found in every Linux system under <code>/etc/init.d/</code>. We do advise against changing this script however, since this can lead to <a href="update.html#conflicts">conflicts</a> during a software update. Changes to the scripts are not necessary.</p>
</td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>var/</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Runtime data. All data generated by the monitoring will be stored here. Depending on the number of hosts and services, an immense volume of data can be accumulated – of which the largest part is the performance data recorded in the <a href="graphing.html#rrds">RRDs</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>tmp/</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Volatile data. Checkmk and other components store temporary data (which does not need to be retained) here. A <code>tmpfs</code> is therefore mounted here. This is a file system which manages data in RAM, thus generating zero Disk-IO. Restarting the computer results in the loss of all data in <code>tmp/</code>! Stopping and starting the site does <em>not</em> delete the data.  Data such as sockets, pipes and PID-files can be found in <code>tmp/run</code> – these are necessary for communication and managing the server processes.  Do <strong>not</strong> use <code>tmp/</code> for storing your own data, since this directory is mounted to the RAM where space is rather limited. Store your own data directly in the site directory, or in your own subdirectory within it.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>local/</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Own extensions. A ‘shadow’ hierarchy of the software directories <code>bin/</code>, <code>lib/</code> and <code>share/</code> can be found in <code>local/</code>. These are intended for your own changes or extensions to the software.  Also applicable here: Under no circumstances store test files, log files, security copies or anything else that does not belong there, in <code>local/</code>. Checkmk could attempt to execute these files as a part of the software. Likewise, in a distributed monitoring the data will also be duplicated to all remote sites.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="heading_local">
<span class="hidden-anchor sr-only" id="local"></span>3.5. Modifying and extending Checkmk – the local files</h3>
<div class="paragraph"><p>As just shown in the above table, the <code>local</code> directory with its numerous
subdirectories is intended for your own extensions.
In a new site, all of the directories in <code>local/</code> are initially empty.</p></div>
<div class="paragraph"><p>With the practical <code>tree</code> command you can quickly get an overview of the
structure of <code>local</code>.
The <code>-L 3</code> option restricts the depth to 3:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">OMD[mysite]:~$ </span>tree<span class="tok-w"> </span>-L<span class="tok-w"> </span><span class="tok-m">3</span><span class="tok-w"> </span><span class="tok-nb">local</span>
<span class="tok-go">local</span>
<span class="tok-go">├── bin</span>
<span class="tok-go">├── lib</span>
<span class="tok-go">│   ├── apache</span>
<span class="tok-go">│   ├── check_mk -&gt; python3/cmk</span>
<span class="tok-go">│   ├── nagios</span>
<span class="tok-go">│   │   └── plugins</span>
<span class="tok-go">│   ├── python</span>
<span class="tok-go">│   └── python3</span>
<span class="tok-go">│       └── cmk</span>
<span class="tok-go">└── share</span>
<span class="tok-go">    ├── check_mk</span>
<span class="tok-go">    │   ├── agents</span>
<span class="tok-go">    │   ├── alert_handlers</span>
<span class="tok-go">    │   ├── checkman</span>
<span class="tok-go">    │   ├── checks</span>
<span class="tok-go">    │   ├── inventory</span>
<span class="tok-go">    │   ├── locale</span>
<span class="tok-go">    │   ├── mibs</span>
<span class="tok-go">    │   ├── notifications</span>
<span class="tok-go">    │   ├── pnp-rraconf</span>
<span class="tok-go">    │   ├── pnp-templates</span>
<span class="tok-go">    │   ├── reporting</span>
<span class="tok-go">    │   └── web</span>
<span class="tok-go">    ├── diskspace</span>
<span class="tok-go">    ├── doc</span>
<span class="tok-go">    │   └── check_mk</span>
<span class="tok-go">    ├── nagios</span>
<span class="tok-go">    │   └── htdocs</span>
<span class="tok-go">    ├── nagvis</span>
<span class="tok-go">    │   └── htdocs</span>
<span class="tok-go">    └── snmp</span>
<span class="tok-go">        └── mibs</span></code></pre></div></div>
<div class="paragraph"><p>All of the directories in the <em>lowest</em> level are actively integrated in the software.
A file stored here will be treated in the same way as if it was in the directory with the
same name within <code>/omd/versions/…​</code> (or respectively, in the logical path from the
site under <code>bin</code>, <code>lib</code> or <code>share</code>).</p></div>
<div class="paragraph"><p>Example: In the site, executable programs will be searched for in <code>bin</code>
and in <code>local/bin</code>.</p></div>
<div class="paragraph"><p>Here it applies that in the case of <em>identical names</em> the file in <code>local</code>
always has priority. This enables modification of the software without the need
to change installation files in  <code>/omd/versions/</code>. The procedure is simple:</p></div>
<div class="olist arabic"><ol class="arabic">
<li><p>Copy the desired file to the appropriate directory in <code>local</code>.</p></li>
<li><p>Modify this file.</p></li>
<li><p>Restart the appropriate service so that the change can take effect.</p></li>
</ol></div>
<div class="paragraph"><p>Regarding point 3 above, if it is not known exactly which service to which the
change applies, simply restart the complete site with <code>omd restart</code>.</p></div>
</div>
<div class="sect2">
<h3 id="heading_logs">
<span class="hidden-anchor sr-only" id="logs"></span>3.6. Log files</h3>
<div class="paragraph"><p>In Checkmk – as already-described – the log files are stored in the
<a href="#data">directory</a> <code>var/</code>.
All log files of the relevant components can be found there:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">OMD[mysite]:~$ </span>ll<span class="tok-w"> </span>-R<span class="tok-w"> </span>var/log/
<span class="tok-go">var/log/:</span>
<span class="tok-go">total 48</span>
<span class="tok-go">-rw-r--r-- 1 mysite mysite  759 Sep 21 16:54 alerts.log</span>
<span class="tok-go">drwxr-xr-x 2 mysite mysite 4096 Sep 21 16:52 apache/</span>
<span class="tok-go">-rw-r--r-- 1 mysite mysite 8603 Sep 21 16:54 cmc.log</span>
<span class="tok-go">-rw-r--r-- 1 mysite mysite 3175 Sep 21 11:38 dcd.log</span>
<span class="tok-go">-rw-rw---- 1 mysite mysite    0 Oct 27 11:05 diskspace.log</span>
<span class="tok-go">-rw-r--r-- 1 mysite mysite  313 Sep 21 16:54 liveproxyd.log</span>
<span class="tok-go">-rw-r--r-- 1 mysite mysite   62 Sep 21 16:54 liveproxyd.state</span>
<span class="tok-go">drwxr-xr-x 2 mysite mysite 4096 Sep 20 13:44 mkeventd/</span>
<span class="tok-go">-rw-r--r-- 1 mysite mysite  676 Sep 21 16:54 mkeventd.log</span>
<span class="tok-go">-rw-r--r-- 1 mysite mysite  310 Sep 21 16:54 mknotifyd.log</span>
<span class="tok-go">-rw-r--r-- 1 mysite mysite  327 Sep 21 16:54 notify.log</span>
<span class="tok-go">-rw-r--r-- 1 mysite mysite  458 Sep 21 16:54 rrdcached.log</span>
<span class="tok-go">-rw-r--r-- 1 mysite mysite    0 Sep 21 16:52 web.log</span>

<span class="tok-go">var/log/apache:</span>
<span class="tok-go">total 32</span>
<span class="tok-go">-rw-r--r-- 1 mysite mysite 26116 Sep 21 16:54 access_log</span>
<span class="tok-go">-rw-r--r-- 1 mysite mysite   841 Sep 21 16:54 error_log</span>
<span class="tok-go">-rw-r--r-- 1 mysite mysite     0 Sep 22 10:21 stats</span>

<span class="tok-go">var/log/mkeventd:</span>
<span class="tok-go">total 0</span></code></pre></div></div>
<div class="paragraph"><p>On the web interface you can easily configure the extent to which data should be written to the log files by searching in <span class="guihint">Setup &gt; General &gt; Global settings</span> for all entries with <code>logging</code>:</p></div>
<div class="imageblock"><div class="content"><img src="../images/cmk_commandline_global_settings_logging.png" alt="List of global settings for logging."></div></div>
<div class="paragraph"><p>Alternatively it is possible to also customize the log levels on the command line in configuration files.
The files are each called <code>global.mk</code>, but are located in different directories.
Specify the entries if they are not already present, which is the case, if a <span class="guihint">Factory setting</span> has not yet been changed.</p></div>
<div class="listingblock">
<div class="title">~/etc/check_mk/conf.d/wato/global.mk</div>
<div class="content"><pre class="pygments highlight"><code><span></span>notification_logging = 15
alert_logging = 10
cmc_log_levels = {
 'cmk.alert'        : 5,
 'cmk.carbon'       : 5,
 'cmk.core'         : 5,
 'cmk.downtime'     : 5,
 'cmk.helper'       : 5,
 'cmk.livestatus'   : 5,
 'cmk.notification' : 5,
 'cmk.rrd'          : 5,
 'cmk.smartping'    : 5,
}
cmc_log_rrdcreation = None</code></pre></div>
</div>
<div class="paragraph"><p>In this file the <span class="guihint">Monitoring Core</span>, <span class="guihint">Notifications</span> and <span class="guihint">Alert Handlers</span> entries are set:</p></div>
<div class="ulist"><ul>
<li><p>For <code>notification_logging</code> you can choose between the values 10 for <span class="guihint">Full dump of all variables and command</span>,
15 for <span class="guihint">Normal logging</span> and 20 for <span class="guihint">Minimal logging</span>.</p></li>
<li><p>The <code>alert_logging</code> can be set to 10 for <span class="guihint">Full dump of all variables</span> or 20 for <span class="guihint">Normal logging</span>.</p></li>
<li><p>For <code>cmc_log_levels</code> the amount of logged data increases by increasing the number.
Here there are eight gradations (0 to 7) ranging from 0 for <span class="guihint">Emergency</span> to 7 which stands for <span class="guihint">Debug</span>.</p></li>
<li><p>With the three values <code>None</code>, <code>'terse'</code> and <code>'full'</code> for <code>cmc_log_rrdcreation</code> you can decide whether the creation of <a href="graphing.html#rrds">RRDs</a>  should be logged and how.</p></li>
</ul></div>
<div class="listingblock">
<div class="title">~/etc/check_mk/multisite.d/wato/global.mk</div>
<div class="content"><pre class="pygments highlight"><code><span></span>log_levels = {
 'cmk.web'                : 50,
 'cmk.web.auth'           : 10,
 'cmk.web.automations'    : 15,
 'cmk.web.background-job' : 10,
 'cmk.web.bi.compilation' : 20,
 'cmk.web.ldap'           : 30,
}</code></pre></div>
</div>
<div class="paragraph"><p>In this file you can set the <span class="guihint">User Interface</span> logging.</p></div>
<div class="paragraph"><p>The amount of logged data increases inversely as the count decreases.
The lowest log level is 50 (<span class="guihint">Critical</span>) while the most data will be logged at 10 which corresponds to the highest (<span class="guihint">Debug</span>).</p></div>
<div class="listingblock">
<div class="title">~/etc/check_mk/liveproxyd.d/wato/global.mk</div>
<div class="content"><pre class="pygments highlight"><code><span></span>liveproxyd_log_levels = {'cmk.liveproxyd': 20}</code></pre></div>
</div>
<div class="paragraph"><p>This file is used for <span class="guihint">Livestatus Proxy logging</span>.
The possible values here correspond to those for <span class="guihint">User Interface</span> logging.</p></div>
<div class="paragraph"><p><strong>Important</strong>: Log files can quickly become very large if a high level has been set.
It is generally advisable to use such settings for a 'temporary' customization,
as an aid in problem identification for example.</p></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="heading_cmk">
<span class="hidden-anchor sr-only" id="cmk"></span>4. The cmk command</h2>
<div class="sectionbody">
<div class="paragraph"><p>Along with the <a href="omd_basics.html"><code>omd</code> command</a>, which serves for starting
and stopping sites, for the basic configuration of components, and for starting a
<a href="update.html">software update</a>, <code>cmk</code> is the most important command.
With this a configuration for a monitoring core can be created, checks executed manually,
a service discovery performed, and much more.</p></div>
<div class="sect2">
<h3 id="heading_options">
<span class="hidden-anchor sr-only" id="options"></span>4.1. The command options</h3>
<div class="paragraph"><p>The command <code>cmk</code> is actually an abbreviation for <code>check_mk</code>, introduced to make the command faster to type.
The command includes a built-in, very detailed online help, that can be called up with <code>--help</code> option:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">OMD[mysite]:~$ </span>cmk<span class="tok-w"> </span>-h
<span class="tok-go">WAYS TO CALL:</span>
<span class="tok-go"> cmk  --automation [COMMAND...]          Internal helper to invoke Check_MK actions</span>
<span class="tok-go"> cmk  --backup BACKUPFILE.tar.gz         make backup of configuration and data</span>
<span class="tok-go"> cmk  --cap [pack|unpack|list FILE.cap]  Pack/unpack agent packages (Enterprise only)</span>
<span class="tok-go"> cmk  --check [HOST [IPADDRESS]]         Check all services on the given HOST</span>
<span class="tok-go">...</span></code></pre></div></div>
<div class="paragraph"><p>As you can see in the command above, we have called help with the option <code>-h</code> instead of <code>--help</code>.
Because what is true for the command itself is also true for its options: The less there is to type, the faster it goes.
Not for all options, but for those that are often needed, there is therefore a short form in addition to the long form.
Even though the long form is more intuitive, especially for beginners (<code>check_mk --list-hosts</code>) than the short form (<code>cmk -l</code>), we will use the short form in the User guide. If in doubt, you can always consult the command help.
A longer look in the command help is a good idea in any case, as we will not present all options in the User guide.</p></div>
<div class="paragraph"><p>By entering an option, you start the command <code>cmk</code> in a certain mode.
Here follows the overview of the options we will present in this chapter, but also in other parts of the manual:</p></div>
<table class="table-responsive table-bordered table tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 40%;">
<col style="width: 60%;">
</colgroup>
<thead><tr>
<th class="tableblock halign-left valign-top">Option</th>
<th class="tableblock halign-left valign-top">Function</th>
</tr></thead>
<tbody>
<tr><td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><strong>Monitoring core</strong></p></td></tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cmk -R</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#commands_core">Restarting the core</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cmk -O</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#commands_core">Loading a new configuration into the core</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cmk -U</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#commands_core">Creating a new configuration for the core</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cmk -N</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#commands_core">Output the Nagios configuration of the core</a></p></td>
</tr>
<tr><td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><strong>Checks</strong></p></td></tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cmk myserver123</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#execute_checks">Executing checks</a> on host <code>myserver123</code></p></td>
</tr>
<tr><td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><strong>Services</strong></p></td></tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cmk -I myserver123</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="wato_services.html#commandline">Executing a service discovery</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cmk --check-discovery myserver123</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Runs the <a href="wato_services.html#discovery_check">discovery check</a> on the host, which checks for new and disappeared services and for new host labels. When a change occurs, the host is 'marked' by creating a file with the host name in <code>var/check_mk/autodiscovery</code> — but only if automatic service configuration update is enabled in Checkmk (in the <span class="guihint">Periodic service discovery</span> rule set).</p></td>
</tr>
<tr><td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><strong>Agents</strong></p></td></tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cmk -d myserver123</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dump_agent">Retrieving agent output</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cmk -A myserver123</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#bake_agents">Baking agents</a></p></td>
</tr>
<tr><td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><strong>Diagnostics</strong></p></td></tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cmk -l</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#list_hosts">Listing hosts</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cmk --list-tag mytag</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#list_hosts">Listing hosts with host tag</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cmk -D myserver123</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dump_host">Displaying host configuration</a></p></td>
</tr>
<tr><td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><strong>Information</strong></p></td></tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cmk -V</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Displays the Checkmk version installed in the site.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cmk -L</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#info_plugins">Listing check plug-ins</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cmk -m</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#info_plugins">Accessing the check plug-ins catalog</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cmk -M df</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#info_plugins">Showing a check plug-in manual page</a> (here of plug-in <code>df</code>)</p></td>
</tr>
<tr><td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><strong>Special topics</strong></p></td></tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cmk --update-dns-cache</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Deletes the DNS cache and re-creates it. For details on the DNS cache, see the <a href="hosts_setup.html#dns">article on hosts</a>. By default, this command is executed in a Checkmk site once a day via cronjob.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cmk --cleanup-piggyback</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Deletes all obsolete <a href="piggyback.html">piggyback data</a> in the <code>tmp/check_mk/piggyback/</code> directory. By default, this command is executed in a Checkmk site once a day via cronjob.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cmk -P</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="mkps.html#commandline">Managing MKPs</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cmk --convert-rrds</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="graphing.html#customise_rrds">Converting RRDs</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cmk --snmpwalk myswitch</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="snmp.html#simulation">Pulling an SNMP walk</a> from host <code>myswitch</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cmk --snmptranslate</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="devel_check_plugins_snmp.html#locating_oids">Translating an SNMP walk</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cmk --create-diagnostics-dump</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="support_diagnostics.html#commandline">Creating support diagnostics dump</a></p></td>
</tr>
</tbody>
</table>
<div class="paragraph"><p>In some modes, further, specific options are available to you,
e.g. you can limit the service discovery to certain checks, e.g. to the check <code>df</code> with the command <code>cmk -I --detect-plugins=df myserver123</code>.</p></div>
<div class="paragraph"><p>A number of options always work — regardless of the mode with which the command is executed:</p></div>
<table class="table-responsive table-bordered table tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 35%;">
<col style="width: 65%;">
</colgroup>
<thead><tr>
<th class="tableblock halign-left valign-top">Option</th>
<th class="tableblock halign-left valign-top">Function</th>
</tr></thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cmk -v</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Prompts <code>cmk</code> to produce a detailed dump of its current activity ('verbose')</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cmk -vv</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The same as the above, with even more details: ‘very verbose’</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cmk --cache</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The information is read from cache files, even if they are out of date. The agent is only contacted if no cache file exists. The cached agent data of the host can be found under <code>tmp/check_mk/cache</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cmk --no-tcp</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Works like <code>--cache</code>, however it will interrupt with if a cache file is absent or not current. Thus in any situation you can suppress an access to the agent.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cmk --no-cache</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The information is always fetched up to date, i.e. no cache files are used.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cmk --usewalk</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For SNMP hosts: instead of accessing the SNMP agent this uses a stored SNMP walk, that has been previously pulled with <code>cmk --snmpwalk myserver123</code>. These walks are stored in <code>var/check_mk/snmpwalks</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cmk --debug</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If an error occurs, this option ensures that it will no longer be intercepted, rather the original Python exception will be displayed in full. This can be important information for the developer, by showing the exact program location in which the error is located. It will also be very helpful with locating errors in self-written check plug-ins.  If when invoking <code>cmk</code> an error is encountered which should be reported to support or feedback, repeat the request with the added <code>--debug</code> option, and attach the Python trace to your e-mail.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph"><p>In the following section we will show how the commands can be used.
The examples are mostly shown in an abbreviated form.</p></div>
</div>
<div class="sect2">
<h3 id="heading_commands_core">
<span class="hidden-anchor sr-only" id="commands_core"></span>4.2. Commands for the monitoring core</h3>
<div class="paragraph"><p>The commercial editions utilizes the <a href="cmc.html">Checkmk Micro Core</a> (CMC) as its monitoring core, <span class="image-inline"><img src="../images/icons/CRE.png" alt="CRE" width="20" title="Checkmk Raw"></span> <strong>Checkmk Raw</strong> uses Nagios.
An important task for the <code>cmk</code> is the generation of a
configuration file that is readable for the core, and which contains all of the
configured hosts, services, contacts, contact groups, time periods, etc. On the
basis of this information the core knows which checks are to be executed and
which objects it should provide using the GUI’s <a href="livestatus.html">Livestatus</a>.</p></div>
<div class="paragraph"><p>For Nagios as well as for the CMC, it is fundamental that the number of hosts,
services and other objects always remains static during the operation, and that
this number can only be altered through the generation of a new configuration,
followed by a reloading of the core. With Nagios a restart of the core is also
needed. The CMC has a very efficient function for the reloading of its
configuration during active processing.</p></div>
<div class="paragraph"><p>The following table highlights important differences between the configurations of both cores:</p></div>
<table class="table-responsive table-bordered table tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 20%;">
<col style="width: 45%;">
<col style="width: 35%;">
</colgroup>
<thead><tr>
<th class="tableblock halign-left valign-top"></th>
<th class="tableblock halign-left valign-top">Nagios</th>
<th class="tableblock halign-left valign-top">CMC</th>
</tr></thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configuration file</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>etc/nagios/conf.d/check_mk_objects.cfg</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>var/check_mk/core/config</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">File type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Text file with <code>define</code>-commands</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compressed and optimized binary file</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Activation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Core restart</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Core command for reloading the configuration</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Command</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cmk -R</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cmk -O</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph"><p>Regenerating the configuration is always necessary if the contents of the
configuration file in <code>etc/check_mk/conf.d</code>, or automatically-detected
services in <code>var/check_mk/autochecks</code> have been modified.
The Setup keeps a record of such changes and highlights them in the GUI as to <a href="wato.html#activate_changes">activating changes</a>.
Should you ‘bypass the Setup’ by modifying the configuration manually or with a script,
you will also need to attend to the activation manually.
The following commands serve this function:</p></div>
<table class="table-responsive table-bordered table tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 35%;">
<col style="width: 65%;">
</colgroup>
<thead><tr>
<th class="tableblock halign-left valign-top">Option</th>
<th class="tableblock halign-left valign-top">Function</th>
</tr></thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cmk -R</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Generates a new configuration for the core and restarts the core (analogous to <code>omd restart core</code>). This is the method provided for Nagios.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cmk -O</code></p></td>
<td class="tableblock halign-left valign-top">
<p class="tableblock">Generates the configuration for the core and loads this without a restart of the active processing (analogous to <code>omd reload core</code>). This is the recommended variant with the CMC.</p>
<p class="tableblock"><strong>Attention:</strong> With Nagios as the core this option still functions, but it can lead to memory holes and other instabilities. Apart from that, this option does in any case not perform a genuine reload, rather it internally stops and restarts the process, as it were.</p>
</td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cmk -U</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Generates the configuration for the core <em>without</em> activating it.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cmk -N</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For diagnostic purposes, this outputs the configuration to be generated on the standard output, without altering the actual configuration file. Here you can enter a host’s name simply in order to view the host’s configuration (e.g. <code>cmk -N myserver123</code>).</p></td>
</tr>
</tbody>
</table>
<div class="paragraph"><p>To summarize: If you want to customize a Checkmk configuration and activate
the changes, in Nagios you will subsequently require:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">OMD[mysite]:~$ </span>cmk<span class="tok-w"> </span>-R</code></pre></div></div>
<div class="paragraph"><p>And with the CMC:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">OMD[mysite]:~$ </span>cmk<span class="tok-w"> </span>-O</code></pre></div></div>
</div>
<div class="sect2">
<h3 id="heading_execute_checks">
<span class="hidden-anchor sr-only" id="execute_checks"></span>4.3. Executing checks</h3>
<div class="paragraph"><p>A second mode in Checkmk deals with the execution of a host’s Checkmk-based checks.
With this you can allow all automatically detected, and also manually configured
services, to be immediately checked, without needing to bother yourself with the
monitoring core or the GUI.</p></div>
<div class="paragraph"><p>To do this, enter <code>cmk --check</code> followed by the name of a host configured in the monitoring.
Since the <code>--check</code> option is the default option of <code>cmk</code>, you can also omit it.
In addition, you should always add the two options <code>-n</code> (do not send results to the core) and <code>-v</code> (output all results).
More on this in the description of the options below.</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">OMD[mysite]:~$ </span>cmk<span class="tok-w"> </span>-nv<span class="tok-w"> </span>myserver123
<span class="tok-go">Checkmk version 2.0.0p8</span>
<span class="tok-go">CPU load             <span class="green">15 min load 0.22 at 8 Cores (0.03 per Core)</span></span>
<span class="tok-go">CPU utilization      <span class="green">Total CPU: 8.20%</span></span>
<span class="tok-go">Disk IO SUMMARY      <span class="green">Read: 14.0 kB/s, Write: 316 kB/s, Latency: 442 microseconds</span></span>
<span class="tok-go">Filesystem /         <span class="yellow">82.0% used (177.01 of 215.81 GB), (warn/crit at 80.00/90.00%),</span></span>
<span class="tok-go">Interface 2          <span class="green">[wlo1], (up), MAC: 5C:80:B6:3E:38:7F, Speed: unknown, In: 1.02 kB/s, Out: 902 B/s</span></span>
<span class="tok-go">Kernel Performance   <span class="green">Process Creations: 67.82/s, Context Switches: 4183.41/s, Major Page Faults: 1.71/s, Page Swap in: 0.00/s, Page Swap Out: 0.00/s</span></span>
<span class="tok-go">Memory               <span class="green">Total virtual memory: 37.07% - 6.08 GB of 16.41 GB</span></span>
<span class="tok-go">Mount options of /   <span class="green">Mount options exactly as expected</span></span>
<span class="tok-go">NTP Time             <span class="green">sys.peer - stratum 2, offset 16.62 ms, jitter 5.19 ms, last reac</span></span>
<span class="tok-go">Number of threads    <span class="green">Count: 1501 threads, Usage: 1.19%</span></span>
<span class="tok-go">TCP Connections      <span class="green">Established: 11</span></span>
<span class="tok-go">Temperature Zone 0   <span class="green">25.0 °C</span></span>
<span class="tok-go">Uptime               <span class="green">Up since Jul 29 2021 08:38:32, Uptime: 4 hours 43 minutes</span></span>
<span class="tok-go">[agent] Version: 2.0.0b5, OS: linux, execution time 0.9 sec | execution_time=0.850 user_time=0.050 system_time=0.010 children_user_time=0.000 children_system_time=0.000 cmk_time_agent=0.800</span></code></pre></div></div>
<div class="paragraph"><p>Further tips:</p></div>
<div class="ulist"><ul>
<li><p>Do not use this command in monitored production hosts which use log file monitoring. Log messages are only sent once by agents, and it can happen that a manual <code>cmk -nv</code> ‘catches’ these and that they will then be lost from the monitoring. In such a situation use the <code>--no-tcp</code> option.</p></li>
<li><p>If Nagios is being used for the core and <code>-n</code> is omitted, the effect will be an immediate actualization of the check results in the core and in the GUI.</p></li>
<li><p>The command is useful when developing your own check plug-ins, because it enables a quicker test than by using the GUI. If the check fails and returns an <span class="state3">UNKNOWN</span>, the <code>--debug</code> option can help to find the problem location in the code.</p></li>
</ul></div>
<div class="paragraph"><p>The following options influence the command:</p></div>
<table class="table-responsive table-bordered table tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 35%;">
<col style="width: 65%;">
</colgroup>
<thead><tr>
<th class="tableblock halign-left valign-top">Option</th>
<th class="tableblock halign-left valign-top">Function</th>
</tr></thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>-v</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Check results output: Without this option you will only see the output from the service <span class="guihint">Check_MK</span> itself, and not the results from the other services.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>-n</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dry run: Results are <strong>not</strong> passed to the core, the performance counter is not updated.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--detect-plugins=df,uptime</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Restricts the execution to the check plug-ins <code>df</code> and <code>uptime</code>. In the case of SNMP hosts, only the data required for these will be retrieved. This option is practical if you develop your own check plug-ins and only want to test these.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="heading_dump_agent">
<span class="hidden-anchor sr-only" id="dump_agent"></span>4.4. Retrieving agent output</h3>
<div class="paragraph"><p>The command <code>cmk -d</code> retrieves and displays the output from a host’s Checkmk agent.
With <code>cmk -d</code> agent data is retrieved in the same way as with the monitoring.
It is neither validated nor processed.
Thus the data showed exactly matches the data that is turned over to the Agent Controller (when TLS encryption is enabled) or to a tunneling program in case <a href="datasource_programs.html">datasource programs</a> are configured.</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">OMD[mysite]:~$ </span>cmk<span class="tok-w"> </span>-d<span class="tok-w"> </span>myserver123
<span class="tok-go">&lt;&lt;&lt;check_mk&gt;&gt;&gt;</span>
<span class="tok-go">Version: 2.1.0b5</span>
<span class="tok-go">AgentOS: linux</span>
<span class="tok-go">Hostname: myserver123</span>
<span class="tok-go">AgentDirectory: /etc/check_mk</span>
<span class="tok-go">DataDirectory: /var/lib/check_mk_agent</span>
<span class="tok-go">SpoolDirectory: /var/lib/check_mk_agent/spool</span>
<span class="tok-go">PluginsDirectory: /usr/lib/check_mk_agent/plugins</span>
<span class="tok-go">LocalDirectory: /usr/lib/check_mk_agent/local</span>
<span class="tok-go">OnlyFrom:</span>
<span class="tok-go">&lt;&lt;&lt;df&gt;&gt;&gt;</span>
<span class="tok-go">udev              devtmpfs     8155492         4   8155488       1% /dev</span>
<span class="tok-go">tmpfs             tmpfs        1634036      1208   1632828       1% /run</span>
<span class="tok-go">/dev/sda5         ext4       226298268 175047160  39732696      82% /</span>
<span class="tok-go">none              tmpfs              4         0         4       0% /sys/fs/cgroup</span></code></pre></div></div>
<div class="paragraph"><p>You can even run <code>cmk -d</code> using the name or IP address of a host that is not configured in the monitoring.
In this case legacy settings for the host will be assumed (TCP connection to port 6556, no Agent Controller, no encryption, no datasource program).</p></div>
</div>
<div class="sect2">
<h3 id="heading_bake_agents">
<span class="hidden-anchor sr-only" id="bake_agents"></span>4.5. Baking agents</h3>
<div class="paragraph"><p>In the commercial editions you can also bake the agents from the command line, as you would otherwise do via the <a href="wato_monitoringagents.html#bakery">web interface</a>. This gives you the option, for example, of updating the agents regularly, for example via a cronjob.</p></div>
<div class="paragraph"><p>To bake the agents, use the option <code>-A</code> followed by the name of a host (or several):</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">OMD[mysite]:~$ </span>cmk<span class="tok-w"> </span>-Av<span class="tok-w"> </span>myserver123
<span class="tok-go">myserver123...linux_deb:baking...linux_rpm:baking...(fast repackage)...solaris_pkg:baking...windows_msi:baking...linux_tgz:baking...(fast repackage)...solaris_tgz:baking...(fast repackage)...aix_tgz:baking...OK</span></code></pre></div></div>
<div class="paragraph"><p>The output shows that the agent packages available for the host <code>myserver123</code> have been successfully baked. If you do not specify a host, the packages will be baked for all hosts.</p></div>
<div class="paragraph"><p>The command only bakes when necessary. If the packages are still up to date, the output will look something like this:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">OMD[mysite]:~$ </span>cmk<span class="tok-w"> </span>-Av<span class="tok-w"> </span>myserver123
<span class="tok-go">myserver123..linux_deb:uptodate...linux_rpm:uptodate...solaris_pkg:uptodate...windows_msi:uptodate...linux_tgz:uptodate...solaris_tgz:uptodate...aix_tgz:uptodate...OK</span></code></pre></div></div>
<div class="paragraph"><p>You can still force baking with the <code>-f</code> (<em>force</em>) option.</p></div>
</div>
<div class="sect2">
<h3 id="heading_list_hosts">
<span class="hidden-anchor sr-only" id="list_hosts"></span>4.6. Listing hosts</h3>
<div class="paragraph"><p>The <code>cmk -l</code> command simply lists the names of all hosts configured in the Setup:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">OMD[mysite]:~$ </span>cmk<span class="tok-w"> </span>-l
<span class="tok-go">myserver123</span>
<span class="tok-go">myserver124</span>
<span class="tok-go">myserver125</span></code></pre></div></div>
<div class="paragraph"><p>Because the data is provided ‘naked’ and ‘unprocessed’, it is easy to use
in scripts – for example a loop across all host names can be constructed:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">OMD[mysite]:~$ </span><span class="tok-k">for</span><span class="tok-w"> </span>host<span class="tok-w"> </span><span class="tok-k">in</span><span class="tok-w"> </span><span class="tok-k">$(</span>cmk<span class="tok-w"> </span>-l<span class="tok-k">)</span><span class="tok-w"> </span><span class="tok-p">;</span><span class="tok-w"> </span><span class="tok-k">do</span><span class="tok-w"> </span><span class="tok-nb">echo</span><span class="tok-w"> </span><span class="tok-s2">"Host: </span><span class="tok-nv">$host</span><span class="tok-s2">"</span><span class="tok-w"> </span><span class="tok-p">;</span><span class="tok-w"> </span><span class="tok-k">done</span>
<span class="tok-go">Host: myserver123</span>
<span class="tok-go">Host: myserver124</span>
<span class="tok-go">Host: myserver125</span></code></pre></div></div>
<div class="paragraph"><p>If, instead of <code>echo</code> you insert a command that performs something
meaningful, this can be really useful.</p></div>
<div class="paragraph"><p>The <code>cmk --list-tag</code> invocation likewise outputs host names, but also offers
the possibility of filtering by <a href="glossar.html#host_tag">host tags</a>. Simply enter a
host tag and you will receive all hosts having this tag. The following example lists
all hosts that are monitored by SNMP:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">OMD[mysite]:~$ </span>cmk<span class="tok-w"> </span>--list-tag<span class="tok-w"> </span>snmp
<span class="tok-go">myswitch01</span>
<span class="tok-go">myswitch02</span>
<span class="tok-go">myswitch03</span></code></pre></div></div>
<div class="paragraph"><p>Enter multiple tags and they will be linked with ‘and’.
The below command delivers all hosts that are monitored by both SNMP <strong>and</strong> Checkmk agents.
As no hosts fulfill this condition, the output remains empty:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">OMD[mysite]:~$ </span>cmk<span class="tok-w"> </span>--list-tag<span class="tok-w"> </span>snmp<span class="tok-w"> </span>tcp</code></pre></div></div>
</div>
<div class="sect2">
<h3 id="heading_dump_host">
<span class="hidden-anchor sr-only" id="dump_host"></span>4.7. Displaying host configuration</h3>
<div class="paragraph"><p>For one or more specified host, <code>cmk -D</code> displays the configured
services, host tags, labels and other attributes. Because the list of services is so
extensive it can look somewhat confusing on the terminal. Send the output
through <code>less -S</code> to avoid a break:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">OMD[mysite]:~$ </span>cmk<span class="tok-w"> </span>-D<span class="tok-w"> </span>myserver123<span class="tok-w"> </span><span class="tok-p">|</span><span class="tok-w"> </span>less<span class="tok-w"> </span>-S
<span class="tok-go">myserver123</span>
<span class="tok-go">Addresses:              192.168.178.34</span>
<span class="tok-go">Tags:                   [address_family:ip-v4-only], [agent:cmk-agent], [criticality:prod], [ip-v4:ip-v4], [networking:lan], [piggyback:auto-piggyback], [site:mysite], [tcp:tcp]</span>
<span class="tok-go">Labels:                 [cmk/check_mk_server:yes], [cmk/os_family:linux]</span>
<span class="tok-go">Host groups:            mylinuxservers</span>
<span class="tok-go">Contact groups:         all</span>
<span class="tok-go">Agent mode:             Normal Checkmk agent, or special agent if configured</span>
<span class="tok-go">Type of agent:</span>
<span class="tok-go">  TCP: 192.168.178.34:6556</span>
<span class="tok-go">  Process piggyback data from /omd/sites/mysite/tmp/check_mk/piggyback/mycmkserver</span>
<span class="tok-go">Services:</span>
<span class="tok-go">Type of agent:          TCP (port: 6556)</span>
<span class="tok-go">Is aggregated:          no</span>
<span class="tok-go">Services:</span>
<span class="tok-go">  checktype        item              params</span>
<span class="tok-go">  ---------------- ----------------- ------------</span>
<span class="tok-go">  cpu.loads        None              (5.0, 10.0)</span>
<span class="tok-go">  kernel.util      None              {}</span></code></pre></div></div>
</div>
<div class="sect2">
<h3 id="heading_info_plugins">
<span class="hidden-anchor sr-only" id="info_plugins"></span>4.8. Information on the check plug-ins</h3>
<div class="paragraph"><p>Checkmk provides a large number of ready to use plug-ins as standard.
In every release a few new ones are added, and Version <span class="new">2.0.0</span> already includes around 2,000 plug-ins.
Three <code>cmk</code> command options give you access to information about these plug-ins.</p></div>
<div class="paragraph"><p><code>cmk -L</code> produces a table of all plug-ins with their name, type and a description.
At the same time, any self-written plug-ins stored in <code>local/</code> will also be listed.</p></div>
<div class="paragraph"><p>The following are possible types:</p></div>
<table class="table-responsive table-bordered table tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>agent</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Evaluates the data from a Checkmk agent. This is (normally) retrieved via TCP Port 6556.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>snmp</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Serves the monitoring of devices via SNMP.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>active</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Calls a standard type of Nagios-compatible plug-in for the monitoring. Here Checkmk actually only adopts the configuration.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph"><p>The list can of course be filtered simply with <code>grep</code> if something specific is
being searched for:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">OMD[mysite]:~$ </span>cmk<span class="tok-w"> </span>-L<span class="tok-w"> </span><span class="tok-p">|</span><span class="tok-w"> </span>grep<span class="tok-w"> </span>f5
<span class="tok-go">f5_bigip_apm                      snmp  F5 Big-IP: Number of Current SSL/VPN Connections</span>
<span class="tok-go">f5_bigip_chassis_temp             snmp  F5 Big-IP: Chassis Temperature</span>
<span class="tok-go">f5_bigip_cluster                  snmp  F5 Big-IP: Cluster State, Up to Firmware Version 10</span>
<span class="tok-go">f5_bigip_cluster_status           snmp  F5 Big-IP: Active/Active or Passive/Active Cluster Status (&lt; V11.2)</span>
<span class="tok-go">f5_bigip_cluster_status_v11_2     snmp  F5 Big-IP: Active/Active or Passive/Active Cluster Status (&gt; V11.2)</span>
<span class="tok-go">f5_bigip_cluster_v11              snmp  F5 Big-IP: Cluster State for Firmware Version &gt;= 11</span>
<span class="tok-go">f5_bigip_conns                    snmp  F5 Big-IP: Number of Current Connections</span>
<span class="tok-go">f5_bigip_cpu_temp                 snmp  F5 Big-IP: CPU Temperature</span>
<span class="tok-go">f5_bigip_fans                     snmp  F5 Big-IP: System Fans</span>
<span class="tok-go">f5_bigip_interfaces               snmp  F5 Big-IP: Special Network Interfaces</span>
<span class="tok-go">f5_bigip_mem                      snmp  F5 Big-IP: Usage of Memory</span>
<span class="tok-go">f5_bigip_mem_tmm                  snmp  F5 Big-IP: Usage of TMM Memory</span>
<span class="tok-go">f5_bigip_pool                     snmp  F5 Big-IP: Load Balancing Pools</span>
<span class="tok-go">f5_bigip_psu                      snmp  F5 Big-IP: Power Supplies</span>
<span class="tok-go">f5_bigip_snat                     snmp  F5 Big-IP: Source NAT</span>
<span class="tok-go">f5_bigip_vcmpfailover             snmp  F5 Big-IP: Active/Active or Passive/Active vCMP Guest Failover Status</span>
<span class="tok-go">f5_bigip_vcmpguests               snmp  F5 Big-IP: Show Failover States of all vCMP Guests Running on a vCMP Host</span>
<span class="tok-go">f5_bigip_vserver                  snmp  F5 Big-IP: Virtual Servers</span></code></pre></div></div>
<div class="paragraph"><p>If you want more information on a certain plug-in, documentation as manual page (or man page) can be called up with <code>cmk -M</code>:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">OMD[mysite]:~$ </span>cmk<span class="tok-w"> </span>-M<span class="tok-w"> </span>f5_bigip_pool</code></pre></div></div>
<div class="paragraph"><p>This produces the following output:</p></div>
<div class="imageblock"><div class="content"><img src="../images/check_manpage_example.png" alt="Example of a check plug-in manual page."></div></div>
<div class="paragraph"><p>Using <code>cmk -m</code> with no further options will access a complete catalog of all check plug-ins man pages.</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">OMD[mysite]:~$ </span>cmk<span class="tok-w"> </span>-m</code></pre></div></div>
<div class="paragraph"><p>You can navigate interactively in this catalog:</p></div>
<div class="imageblock"><div class="content"><img src="../images/cmk_commandline_manpage_catalog_level1.png" alt="Main menu for selecting a manual page." width="65%"></div></div>
<div class="imageblock"><div class="content"><img src="../images/cmk_commandline_manpage_catalog_level2.png" alt="Submenu for selecting a manual page." width="65%"></div></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="heading_config">
<span class="hidden-anchor sr-only" id="config"></span>5. Configuration without Setup</h2>
<div class="sectionbody">
<div class="paragraph"><p>The <a href="wato.html">Setup menu</a> is a great configuration tool. There are however good reasons
to prefer a configuration with text files in the good, old Linux tradition.
If you are of the same opinion there is some good news:
Checkmk can be completely configured using text files. And since the <span class="guihint">Setup</span> menu actions does no more
than process (this same) text files, this is not even an either/or situation.</p></div>
<div class="sect2">
<h3 id="heading__where_is_the_documentation">
<span class="hidden-anchor sr-only" id="_where_is_the_documentation"></span>5.1. Where is the documentation?</h3>
<div class="paragraph"><p>If you are expecting a comprehensive compendium covering the exact structure
of all of the configuration files used by Checkmk, we will unfortunately
have to disappoint you here. The complexity and diversity contained in the
configuration files is simply too much to describe completely in this User guide.</p></div>
<div class="paragraph"><p>The following example shows an entire completed parameter set for the check plug-in
which monitors file systems in Checkmk. Because of the many parameters, the
screenshot is divided into two parts, and set in lower-case characters:</p></div>
<div class="imageblock border"><div class="content"><img src="../images/cmk_commandline_parameters_for_df_check.png" alt="Complete parameter set of the check plug-in for monitoring file systems."></div></div>
<div class="paragraph"><p>The corresponding passage in the configuration file looks like this (somewhat
more nicely formatted):</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code><span></span>{ 'inodes_levels'      : (10.0, 5.0),
  'levels'             : (80.0, 90.0),
  'levels_low'         : (50.0, 60.0),
  'magic'              : 0.8,
  'magic_normsize'     : 20,
  'show_inodes'        : 'onlow',
  'show_levels'        : 'onmagic',
  'show_reserved'      : True,
  'subtract_reserved'  : False,
  'trend_mb'           : (100, 200),
  'trend_perc'         : (5.0, 10.0),
  'trend_perfdata'     : True,
  'trend_range'        : 24,
  'trend_showtimeleft' : True,
  'trend_timeleft'     : (12, 6)},</code></pre></div></div>
<div class="paragraph"><p>As can be seen, there are more than 10 different parameters, each with
its own individual logic. Some are configured using floating-point numbers,
(<code>0.8</code>), some with integers (<code>24</code>), some with
keywords (<code>'onlow'</code>), some with boolean values (<code>True</code>),
and others using tuples to code various combinations of these (<code>(5.0,
10.0)</code>).</p></div>
<div class="paragraph"><p>This is just one example from over 2,000 plug-ins. And there are of course
other configurations possible as check parameters: One only needs to think
of time periods, Event Console rules, user profiles, and many more.</p></div>
<div class="paragraph"><p>Of course that doesn’t mean you cannot use text files as  configuration!
If you don’t yet know the exact syntax for your chosen configuration task,
you only need the correct tool for it – and this tool we call <strong>Setup</strong>:</p></div>
<div class="olist arabic"><ol class="arabic">
<li><p>Create a Checkmk test site.</p></li>
<li><p>Use the <span class="guihint">Setup</span> menu to configure the desired parameters.</p></li>
<li><p>Locate the configuration file that has been changed as a result (more on this below).</p></li>
<li><p>Carry over the exact syntax from the relevant section of this file in your production system.</p></li>
</ol></div>
<div class="paragraph"><p>You thus only need to know in which file Setup writes.</p></div>
<div class="paragraph"><p><strong>Note:</strong> When it comes to the names of directories, files or even file contents, you will often find the term <code>wato</code>. <strong>WATO</strong> is the abbreviation for Web Administration Tool: the Checkmk configuration tool up to and including version <span class="new">1.6.0</span>.
The function of WATO has been taken over by the <span class="guihint">Setup</span> menu, or <strong>Setup</strong> for short, from version <span class="new">2.0.0</span> onwards. Although WATO has been (almost) completely replaced by Setup in the web interface, it lives on in the file system.</p></div>
</div>
<div class="sect2">
<h3 id="heading__which_configuration_file_is_used">
<span class="hidden-anchor sr-only" id="_which_configuration_file_is_used"></span>5.2. Which configuration file is used?</h3>
<div class="paragraph"><p>There is a practical command for finding out which file Setup has
just changed: <code>find</code>. By invoking ‘find’ with the following parameters
you can find all files (<code>-type f</code>) under <code>etc/</code> which have
been altered within the last minute (<code>-mmin -1</code>):</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">OMD[mysite]:~$ </span>find<span class="tok-w"> </span>etc/<span class="tok-w"> </span>-mmin<span class="tok-w"> </span>-1<span class="tok-w"> </span>-type<span class="tok-w"> </span>f
<span class="tok-go">etc/check_mk/conf.d/wato/rules.mk</span></code></pre></div></div>
<div class="paragraph"><p>The basis of a configuration is always the <code>etc/check_mk</code> directory.
Below this is a subdivision into various domains, which generally apply to
a specific service.
At the same time each has a directory with the suffix <code>.d</code>,
under which all files with the suffix <code>.mk</code> will be read automatically
in <em>alphabetic order</em>.
In some there will also be a main file which is read first of all.
This is intended only for manual alteration, and is never modified by Setup.</p></div>
<table class="table-responsive table-bordered table tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 30%;">
<col style="width: 20%;">
<col style="width: 25%;">
</colgroup>
<thead><tr>
<th class="tableblock halign-left valign-top">Domain</th>
<th class="tableblock halign-left valign-top">Configuration directory</th>
<th class="tableblock halign-left valign-top">Main file</th>
<th class="tableblock halign-left valign-top">Changes activated</th>
</tr></thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Monitoring</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>etc/check_mk/conf.d/</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>main.mk</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cmk -O</code> or <code>cmk -R</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="user_interface.html">GUI</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>etc/check_mk/multisite.d/</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>multisite.mk</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">automatically</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="ec.html">Event Console</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>etc/check_mk/mkeventd.d/</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>mkeventd.mk</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>omd reload mkeventd</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="notifications.html#async">Notification spooler</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>etc/check_mk/mknotifyd.d/</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">automatically</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="heading__setup_and_configuration_files">
<span class="hidden-anchor sr-only" id="_setup_and_configuration_files"></span>5.3. Setup and configuration files</h3>
<div class="paragraph"><p>Below the <code>.d/</code> configuration directories there is always the subdirectory <code>wato</code>, e.g. <code>etc/check_mk/conf.d/wato</code>.
The Setup fundamentally only reads and writes here.
However, the service responsible for the configuration directory also reads the other files in "its" <code>.d</code> directory, if you have stored some manually-created files there. This means:</p></div>
<div class="ulist"><ul>
<li><p>If it is required that the manual configuration be visible and editable in the Setup, use the existing paths.</p></li>
<li><p>If it is required that the configuration simply functions, but is not visible in the Setup, then use your own files externally to <code>wato/</code>.</p></li>
<li><p>If it is required that the configuration be visible in the Setup, but not changeable, some of the files can be <em>locked</em>.</p></li>
</ul></div>
<div class="sect3">
<h4 id="heading__locking_files_and_folders">
<span class="hidden-anchor sr-only" id="_locking_files_and_folders"></span>Locking files and folders</h4>
<div class="paragraph"><p>A common reason for manually creating configuration files without Setup is needing to import
hosts to be monitored from a Configuration Management Database (CMDB).
Here, in contrast to methods using the <a href="rest_api.html">REST API</a>, you create the folders for the hosts with a script directly in <code>etc/check_mk/conf.d/wato</code> and in each case the file <code>hosts.mk</code> for the hosts contained in the folder and possibly also the file <code>.wato</code>, which contains the folder attributes.</p></div>
<div class="paragraph"><p>If this import is not just a one-off, rather it is to be repeated regularly
because the CMDB is the leading system, it would be very impractical if your
users make any changes to the files using the Setup, as these will be lost with the
next import.</p></div>
<div class="paragraph"><p>A <code>hosts.mk</code>-file can be locked by inserting a line for the <code>lock</code> attribute:</p></div>
<div class="listingblock">
<div class="title">hosts.mk</div>
<div class="content"><pre class="pygments highlight"><code><span></span># Created by WATO
# encoding: utf-8

_lock = True</code></pre></div>
</div>
<div class="paragraph"><p>When opening this folder in the Setup, the following message is displayed above the Hosts list:</p></div>
<div class="imageblock"><div class="content"><img src="../images/cmk_commandline_locked_host_attributes.png" alt="Message that editing of hosts in the folder is locked."></div></div>
<div class="paragraph"><p>All actions which would alter the <code>hosts.mk</code> file are thus locked in the GUI.
This does <em>not</em> apply to the service discovery of course. A host’s configured
services are stored in <code>var/check_mk/autochecks/</code>.</p></div>
<div class="paragraph"><p>The folder attributes can also be locked.
This is done by an entry in the folder’s <code>.wato</code> file: set the <code>lock</code> attribute to <code>True</code> in the file’s dictionary:</p></div>
<div class="listingblock">
<div class="title">.wato</div>
<div class="content"><pre class="pygments highlight"><code><span></span>{'title': 'My folder',
 'attributes': {},
 'num_hosts': 1,
 'lock': True,
 'lock_subfolders': False,
 '__id': '7f2a8906d3c3448fac8a379e2d1cec0e'}</code></pre></div>
</div>
<div class="paragraph"><p>If you also set the <code>lock_subfolders</code> attribute to <code>True</code>, you prevent the creation and deletion of subfolders.</p></div>
<div class="paragraph"><p>Locking of other files – such as <code>rules.mk</code>, for example – is not currently possible.</p></div>
</div>
</div>
<div class="sect2">
<h3 id="heading__the_files_syntax">
<span class="hidden-anchor sr-only" id="_the_files_syntax"></span>5.4. The files syntax</h3>
<div class="paragraph"><p>In purely formal terms, all of Checkmk’s configuration files are written
in <strong>Python 3</strong> syntax. There are two types of files:</p></div>
<div class="ulist"><ul>
<li><p>Those which are <em>executed</em> like a script by Python. Among these is, e.g., <code>hosts.mk</code>.</p></li>
<li><p>Those which are read in as values by Python. Among these is, e.g., <code>.wato</code>.</p></li>
</ul></div>
<div class="paragraph"><p>The executable files can be recognized by their having variables which are substituted
for assignments with values (<code>=</code>). The other files usually contain a
Python dictionary which begin with an opening bracket <code>{</code>. Sometimes they are simple values.</p></div>
<div class="paragraph"><p>If a non-ASCII character is required in a file (a German Umlaut (<code>ä</code>, <code>ö</code>, <code>ü</code>), for example),
the following comment must be coded in the first or second line:</p></div>
<div class="listingblock">
<div class="title">somefile.mk</div>
<div class="content"><pre class="pygments highlight"><code><span></span># encoding: utf-8</code></pre></div>
</div>
<div class="paragraph"><p>A syntax error will otherwise occur when reading the file. For further tips on Python syntax
we recommend visiting a specialist site, for example:
<a href="https://docs.python.org/3/reference/">The Python Language Reference</a>.</p></div>
</div>
<div class="sect2">
<h3 id="heading_check_config_files">
<span class="hidden-anchor sr-only" id="check_config_files"></span>5.5. Checking configuration files</h3>
<div class="paragraph"><p>If you edit configuration files in <code>etc/check_mk/</code> manually, it is a good idea to have the configuration checked.
You can do this with the tool <code>cmk-update-config</code>, which is actually only executed automatically after a version update with <code>omd update</code>:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">OMD[mysite]:~$ </span>cmk-update-config
<span class="tok-go">...</span>
<span class="tok-go">Verifying Checkmk configuration...</span>
<span class="tok-go"> 01/05 Cleanup precompiled host and folder files...</span>
<span class="tok-go"> 02/05 Rulesets...</span>
<span class="tok-go">Exception while trying to load rulesets: Cannot read configuration file "/omd/sites/mysite/etc/check_mk/conf.d/wato/rules.mk":</span>
<span class="hll"><span class="tok-go"> '[' was never closed (&lt;string&gt;, line 44)</span>
</span>
<span class="tok-go">You can abort the update process (A) and try to fix the incompatibilities or try to continue the update (c).</span>
<span class="tok-go">Abort update? [A/c]</span>
<span class="tok-go">...</span></code></pre></div></div>
<div class="paragraph"><p>For example, in the excerpt above you can see the reference to an unclosed bracket.</p></div>
</div>
</div>
</div>
</div></main><div id="toc" class="toc2">
<div id="toctitle">On this page</div>
<ul class="sectlevel1">
<li><a href="#_why_command_line">1. Why command line?</a></li>
<li>
<a href="#site_user">2. The site user</a><ul class="sectlevel1">
<li><a href="#_login_as_site_user">2.1. Login as site user</a></li>
<li><a href="#_profile_and_environment_variables">2.2. Profile and environment variables</a></li>
<li><a href="#_customizing_the_shell">2.3. Customizing the shell</a></li>
</ul>
</li>
<li>
<a href="#folder_structure">3. The directory structure</a><ul class="sectlevel1">
<li><a href="#_the_separation_of_software_and_data">3.1. The separation of software and data</a></li>
<li><a href="#sitedir">3.2. Site directory</a></li>
<li><a href="#_software">3.3. Software</a></li>
<li><a href="#data">3.4. Data</a></li>
<li><a href="#local">3.5. Modifying and extending Checkmk – the local files</a></li>
<li><a href="#logs">3.6. Log files</a></li>
</ul>
</li>
<li>
<a href="#cmk">4. The cmk command</a><ul class="sectlevel1">
<li><a href="#options">4.1. The command options</a></li>
<li><a href="#commands_core">4.2. Commands for the monitoring core</a></li>
<li><a href="#execute_checks">4.3. Executing checks</a></li>
<li><a href="#dump_agent">4.4. Retrieving agent output</a></li>
<li><a href="#bake_agents">4.5. Baking agents</a></li>
<li><a href="#list_hosts">4.6. Listing hosts</a></li>
<li><a href="#dump_host">4.7. Displaying host configuration</a></li>
<li><a href="#info_plugins">4.8. Information on the check plug-ins</a></li>
</ul>
</li>
<li>
<a href="#config">5. Configuration without Setup</a><ul class="sectlevel1">
<li><a href="#_where_is_the_documentation">5.1. Where is the documentation?</a></li>
<li><a href="#_which_configuration_file_is_used">5.2. Which configuration file is used?</a></li>
<li>
<a href="#_setup_and_configuration_files">5.3. Setup and configuration files</a><ul class="sectlevel2"><li><a href="#_locking_files_and_folders">Locking files and folders</a></li></ul>
</li>
<li><a href="#_the_files_syntax">5.4. The files syntax</a></li>
<li><a href="#check_config_files">5.5. Checking configuration files</a></li>
</ul>
</li>
</ul>
</div>
<script src="../../assets/js/manifest.js?id=7db827d654313dce4250"></script>
<script src="../../assets/js/vendor.js?id=581a3d4a61b7156d04df"></script>
<script src="../../assets/js/app.js?id=959ccd04b1f8b7b78c5e"></script>
<script src="../../assets/js/lunr.js"></script>
<script src="../../assets/js/lunr.stemmer.support.js"></script>
<script src="../lunr.index.en.js"></script>
<script src="../../assets/js/lunr.client.js"></script>
</body>
</html>
