<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]--><meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<link rel="icon" href="/favicon.png">
<meta name="description" content="Complex relationships can be easily visualized with Business Intelligence (BI). Learn step by step how to build BIs - rule-based and dynamically.">
<meta name="og:locale" content="en">
<meta name="og:site_name" content="Checkmk Docs">
<meta name="og:title" content="Business Intelligence (BI) - Reduce complexity with BI">
<meta name="og:description" content="Complex relationships can be easily visualized with Business Intelligence (BI). Learn step by step how to build BIs - rule-based and dynamically.">
<meta name="og:image" content="https://docs.checkmk.com/assets/images/share_image.png">
<meta name="twitter:site" content="@checkmk">
<meta name="twitter:creator" content="@checkmk">
<title>Business Intelligence (BI) - Reduce complexity with BI</title>
<link rel="stylesheet" href="../../assets/css/checkmk.css?id=4473d2acbb1ea6136428">
<link rel="stylesheet" href="../../assets/css/pygments-monokai.css">
<link rel="stylesheet" href="../../assets/css/addons.css">
<link rel="stylesheet" href="../../assets/css/SourceCodePro.css">
<link rel="search" href="./opensearch.xml" type="application/opensearchdescription+xml" title="Search docs.checkmk.com">
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-NJ3VGL8');</script>
<!-- End Google Tag Manager --><style>
#staticinfo { font-style: italic; }
</style>
</head>
<body class="article toc2 toc-right">
<!-- Cookie Consent (GDPR Compliance) -->

<!-- End Cookie Consent (GDPR Compliance) -->
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NJ3VGL8" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) --><div class="header-top">
<div class="header-top__left">
<a class="header-top__logo d-none d-xl-inline-block" href="/latest/en"><img src="../../assets/images/docs_logo.png" alt="Checkmk"></a><a class="header-top__icon d-inline-block d-xl-none" href="/latest/en"><img src="../../assets/images/logo_icon.svg" alt="Checkmk"></a>
</div>
<div class="header-top__center">
<input type="text" class="header-top__search" placeholder="Search the checkmk docs"><div class="header-top__search__results"></div>
</div>
<div class="header-top__right d-block">
<button class="header-top__search__toggle d-inline-block d-md-none"><img class="header-top__search__toggle__icon" src="../../assets/images/search.svg" alt="Search"></button><div class="dropdown dropdown__language">
                    <button class="btn dropdown-toggle" type="button" id="languageMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">en</button>
                    <div class="dropdown-menu  dropdown-menu-right" aria-labelledby="languageMenuButton"><a class="dropdown-item" href="../../latest/de/bi.html">Deutsch</a></div>
</div>
<div class="dropdown dropdown__branch">
                        <button class="btn dropdown-toggle" type="button" id="branchMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">latest (2.3.0)</button>
                        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="branchMenuButton">
<a class="dropdown-item" href="../../2.1.0/en/bi.html">2.1.0</a><a class="dropdown-item" href="../../2.2.0/en/bi.html">2.2.0</a>
</div>
</div>
<a class="header-top__back d-none d-lg-inline-block" href="https://checkmk.com">to checkmk.com</a><button class="header-top__toggle d-inline-block d-lg-none"><span class="header-top__toggle__icon"></span></button>
</div>
</div>
<aside><div class="main-nav">
<div class="main-nav__content"><div id="content">
<div class="sect1">
<h2 id="_welcome_to_checkmk">
<a class="anchor" href="#_welcome_to_checkmk"></a>1. Welcome to Checkmk</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="welcome.html">Welcome to the Checkmk User Guide</a></p>
</li>
<li>
<p><a href="release_notes.html">Release notes</a></p>
</li>
<li>
<p><a href="glossar.html">Glossary</a></p>
</li>
<li>
<p><a href="search.html">Searching docs.checkmk.com</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_beginners_guide">
<a class="anchor" href="#_beginners_guide"></a>2. Beginner’s Guide</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="intro_setup.html">Setting up Checkmk</a></p>
</li>
<li>
<p><a href="intro_gui.html">The Checkmk user interface</a></p>
</li>
<li>
<p><a href="intro_setup_monitor.html">Setting up monitoring</a></p>
</li>
<li>
<p><a href="intro_tools.html">The monitoring tools</a></p>
</li>
<li>
<p><a href="intro_monitor.html">Checkmk in monitoring</a></p>
</li>
<li>
<p><a href="intro_finetune.html">Fine-tuning the monitoring</a></p>
</li>
<li>
<p><a href="intro_users.html">Working with multiple users</a></p>
</li>
<li>
<p><a href="intro_notifications.html">Switching on notifications</a></p>
</li>
<li>
<p><a href="intro_extend.html">Extending the monitoring system further</a></p>
</li>
<li>
<p><a href="intro_bestpractise.html">Best practices, tips &amp; tricks</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_installation">
<a class="anchor" href="#_installation"></a>3. Installation</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="install_packages.html">Basic information on the installation of Checkmk</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_server_and_vms">
<a class="anchor" href="#_server_and_vms"></a>3.1. Server and VMs</h3>
<div class="ulist">
<ul>
<li>
<p><a href="install_packages_debian.html">Installation on Debian and Ubuntu</a></p>
</li>
<li>
<p><a href="install_packages_redhat.html">Installation on Red Hat and derivatives</a></p>
</li>
<li>
<p><a href="install_packages_sles.html">Installation on SUSE Linux Enterprise Server</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_appliance_container_cloud">
<a class="anchor" href="#_appliance_container_cloud"></a>3.2. Appliance, container, cloud</h3>
<div class="ulist">
<ul>
<li>
<p><a href="install_appliance_cmk.html">Installation of Checkmk in the appliance</a></p>
</li>
<li>
<p><a href="introduction_docker.html">Installation as a Docker container</a></p>
</li>
<li>
<p><a href="install_azure.html">Installation from Azure Marketplace</a></p>
</li>
<li>
<p><a href="install_aws.html">Installation from AWS Marketplace</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_updates">
<a class="anchor" href="#_updates"></a>3.3. Updates</h3>
<div class="ulist">
<ul>
<li>
<p><a href="update.html">Updates and Upgrades</a></p>
</li>
<li>
<p><a href="update_major.html">Update to version <span class="new">2.3.0</span></a></p>
</li>
<li>
<p><a href="update_matrix.html">Update matrix for version <span class="new">2.3.0</span></a></p>
</li>
<li>
<p><a href="release_upgrade.html">Linux upgrade on the Checkmk server</a></p>
</li>
<li>
<p><a href="cmk_versions.html">Checkmk versions</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_administration_of_checkmk">
<a class="anchor" href="#_administration_of_checkmk"></a>4. Administration of Checkmk</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_server">
<a class="anchor" href="#_server"></a>4.1. Server</h3>
<div class="ulist">
<ul>
<li>
<p><a href="saml.html">Authentication with SAML</a></p>
</li>
<li>
<p><a href="kerberos.html">Single sign-on with Kerberos</a></p>
</li>
<li>
<p><a href="managing_docker.html">Checkmk server in a Docker container</a></p>
</li>
<li>
<p><a href="security.html">Security</a></p>
</li>
<li>
<p><a href="ports.html">Ports</a></p>
</li>
<li>
<p><a href="omd_https.html">Securing the web interface with HTTPS</a></p>
</li>
<li>
<p><a href="support_diagnostics.html">Support diagnostics</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_sites">
<a class="anchor" href="#_sites"></a>4.2. Sites</h3>
<div class="ulist">
<ul>
<li>
<p><a href="omd_basics.html">Site administration with omd</a></p>
</li>
<li>
<p><a href="cmk_commandline.html">Checkmk on the command line</a></p>
</li>
<li>
<p><a href="license.html">Managing licenses</a></p>
</li>
<li>
<p><a href="distributed_monitoring.html">Distributed monitoring</a></p>
</li>
<li>
<p><a href="backup.html">Backups</a></p>
</li>
<li>
<p><a href="password_store.html">Password store</a></p>
</li>
<li>
<p><a href="analyze_configuration.html">Analyzing the Checkmk site configuration</a></p>
</li>
<li>
<p><a href="mkps.html">Checkmk extension packages (MKPs)</a></p>
</li>
<li>
<p><a href="mkp_viewables.html">MKPs for GUI extensions</a></p>
</li>
<li>
<p><a href="simulation_mode.html">Simulation mode</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_configuration">
<a class="anchor" href="#_configuration"></a>5. Configuration</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="wato.html">Configuring Checkmk</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_hosts">
<a class="anchor" href="#_hosts"></a>5.1. Hosts</h3>
<div class="ulist">
<ul>
<li>
<p><a href="hosts_setup.html">Host administration</a></p>
</li>
<li>
<p><a href="hosts_structure.html">Host structuring</a></p>
</li>
<li>
<p><a href="host_tags.html">Host tags</a></p>
</li>
<li>
<p><a href="dcd.html">Dynamic host configuration</a></p>
</li>
<li>
<p><a href="hosts_autoregister.html">Automated host creation</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_services">
<a class="anchor" href="#_services"></a>5.2. Services</h3>
<div class="ulist">
<ul>
<li>
<p><a href="wato_services.html">Understanding and configuring services</a></p>
</li>
<li>
<p><a href="clustered_services.html">Monitoring cluster services</a></p>
</li>
<li>
<p><a href="piggyback.html">The piggyback mechanism</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_rules">
<a class="anchor" href="#_rules"></a>5.3. Rules</h3>
<div class="ulist">
<ul>
<li>
<p><a href="wato_rules.html">Rules</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_supporting_configurations">
<a class="anchor" href="#_supporting_configurations"></a>5.4. Supporting configurations</h3>
<div class="ulist">
<ul>
<li>
<p><a href="timeperiods.html">Time periods</a></p>
</li>
<li>
<p><a href="labels.html">Labels</a></p>
</li>
<li>
<p><a href="regexes.html">Regular expressions in Checkmk</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_users_and_permissions">
<a class="anchor" href="#_users_and_permissions"></a>5.5. Users and permissions</h3>
<div class="ulist">
<ul>
<li>
<p><a href="wato_user.html">Users, roles and permissions</a></p>
</li>
<li>
<p><a href="ldap.html">User management with LDAP/Active Directory</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_notifications">
<a class="anchor" href="#_notifications"></a>5.6. Notifications</h3>
<div class="ulist">
<ul>
<li>
<p><a href="notifications.html">Notifications</a></p>
</li>
<li>
<p><a href="notifications_webex.html">Notifications via Cisco Webex Teams</a></p>
</li>
<li>
<p><a href="notifications_ilert.html">Notifications via ilert</a></p>
</li>
<li>
<p><a href="notifications_jira.html">Notifications via Jira</a></p>
</li>
<li>
<p><a href="notifications_mattermost.html">Notifications via Mattermost</a></p>
</li>
<li>
<p><a href="notifications_teams.html">Notifications via Microsoft Teams</a></p>
</li>
<li>
<p><a href="notifications_pagerduty.html">Notifications via PagerDuty</a></p>
</li>
<li>
<p><a href="notifications_pushover.html">Notifications via Pushover</a></p>
</li>
<li>
<p><a href="notifications_opsgenie.html">Notifications via Opsgenie</a></p>
</li>
<li>
<p><a href="notifications_servicenow.html">Notifications via ServiceNow</a></p>
</li>
<li>
<p><a href="notifications_signl4.html">Notifications via SIGNL4</a></p>
</li>
<li>
<p><a href="notifications_slack.html">Notifications via Slack</a></p>
</li>
<li>
<p><a href="notifications_splunkoncall.html">Notifications via Splunk On-Call</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_events">
<a class="anchor" href="#_events"></a>5.7. Events</h3>
<div class="ulist">
<ul>
<li>
<p><a href="ec.html">The Event Console</a></p>
</li>
<li>
<p><a href="alert_handlers.html">Alert handlers</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_monitoring_systems">
<a class="anchor" href="#_monitoring_systems"></a>6. Monitoring systems</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="wato_monitoringagents.html">Monitoring agents</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_checkmk_agents_and_snmp">
<a class="anchor" href="#_checkmk_agents_and_snmp"></a>6.1. Checkmk agents and SNMP</h3>
<div class="ulist">
<ul>
<li>
<p><a href="agent_deployment.html">Automatic agent updates</a></p>
</li>
<li>
<p><a href="agent_linux.html">Monitoring Linux</a></p>
</li>
<li>
<p><a href="agent_linux_legacy.html">Monitoring Linux in legacy mode</a></p>
</li>
<li>
<p><a href="agent_windows.html">Monitoring Windows</a></p>
</li>
<li>
<p><a href="agent_freebsd.html">Monitoring FreeBSD</a></p>
</li>
<li>
<p><a href="snmp.html">Monitoring via SNMP</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_agent_extensions">
<a class="anchor" href="#_agent_extensions"></a>6.2. Agent extensions</h3>
<div class="ulist">
<ul>
<li>
<p><a href="inventory.html">The HW/SW inventory</a></p>
</li>
<li>
<p><a href="mk_filestats.html">Monitoring files</a></p>
</li>
<li>
<p><a href="monitoring_logfiles.html">Monitoring log files</a></p>
</li>
<li>
<p><a href="monitoring_oracle.html">Monitoring Oracle databases</a></p>
</li>
<li>
<p><a href="monitoring_mysql.html">Monitoring MySQL</a></p>
</li>
<li>
<p><a href="monitoring_mssql.html">Monitoring MSSQL</a></p>
</li>
<li>
<p><a href="monitoring_mssql_legacy.html">Monitoring MSSQL with the legacy plug-in</a></p>
</li>
<li>
<p><a href="monitoring_jobs.html">Monitoring time-based processes (Cronjobs)</a></p>
</li>
<li>
<p><a href="spool_directory.html">The spool directory</a></p>
</li>
<li>
<p><a href="localchecks.html">Local checks</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_vm_cloud_container">
<a class="anchor" href="#_vm_cloud_container"></a>6.3. VM, cloud, container</h3>
<div class="ulist">
<ul>
<li>
<p><a href="datasource_programs.html">Datasource programs</a></p>
</li>
<li>
<p><a href="monitoring_vmware.html">Monitoring VMware ESXi</a></p>
</li>
<li>
<p><a href="monitoring_aws.html">Monitoring Amazon Web Services (AWS)</a></p>
</li>
<li>
<p><a href="monitoring_azure.html">Monitoring Microsoft Azure</a></p>
</li>
<li>
<p><a href="monitoring_gcp.html">Monitoring Google Cloud Platform (GCP)</a></p>
</li>
<li>
<p><a href="monitoring_kubernetes.html">Monitoring Kubernetes</a></p>
</li>
<li>
<p><a href="monitoring_openshift.html">Monitoring OpenShift</a></p>
</li>
<li>
<p><a href="monitoring_docker.html">Monitoring Docker</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_endpoints">
<a class="anchor" href="#_endpoints"></a>6.4. Endpoints</h3>
<div class="ulist">
<ul>
<li>
<p><a href="active_checks.html">Monitoring network services (Active checks)</a></p>
</li>
<li>
<p><a href="robotmk.html">Checkmk Synthetic Monitoring with Robotmk</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_dashboards_views_metrics">
<a class="anchor" href="#_dashboards_views_metrics"></a>7. Dashboards, views, metrics</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="user_interface.html">The user interface</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_general">
<a class="anchor" href="#_general"></a>7.1. General</h3>
<div class="ulist">
<ul>
<li>
<p><a href="views.html">Host and service views</a></p>
</li>
<li>
<p><a href="dashboards.html">Dashboards</a></p>
</li>
<li>
<p><a href="graphing.html">Measured values and graphing</a></p>
</li>
<li>
<p><a href="custom_notes.html">Custom notes</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_commands_in_views">
<a class="anchor" href="#_commands_in_views"></a>7.2. Commands in views</h3>
<div class="ulist">
<ul>
<li>
<p><a href="commands.html">Commands</a></p>
</li>
<li>
<p><a href="basics_ackn.html">Acknowledging problems</a></p>
</li>
<li>
<p><a href="basics_downtimes.html">Scheduled downtimes</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_analysis_and_prognosis">
<a class="anchor" href="#_analysis_and_prognosis"></a>8. Analysis and prognosis</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_analysis">
<a class="anchor" href="#_analysis"></a>8.1. Analysis</h3>
<div class="ulist">
<ul>
<li>
<p><a href="availability.html">Availability</a></p>
</li>
<li>
<p><a href="sla.html">Extended availability (SLAs)</a></p>
</li>
<li>
<p><a href="bi.html">Business Intelligence (BI)</a></p>
</li>
<li>
<p><a href="reporting.html">Reports</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_prognosis">
<a class="anchor" href="#_prognosis"></a>8.2. Prognosis</h3>
<div class="ulist">
<ul>
<li>
<p><a href="predictive_monitoring.html">Predictive monitoring</a></p>
</li>
<li>
<p><a href="forecast_graphs.html">Forecast graphs</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_connection_of_other_applications">
<a class="anchor" href="#_connection_of_other_applications"></a>9. Connection of other applications</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="monitoring_prometheus.html">Integrating Prometheus</a></p>
</li>
<li>
<p><a href="integrating_datadog.html">Integrating Datadog</a></p>
</li>
<li>
<p><a href="nagvis.html">NagVis: status data on maps and diagrams</a></p>
</li>
<li>
<p><a href="ntop.html">Integrating ntopng in Checkmk</a></p>
</li>
<li>
<p><a href="grafana.html">Integrating Checkmk in Grafana</a></p>
</li>
<li>
<p><a href="metrics_exporter.html">Sending metrics to InfluxDB and Graphite</a></p>
</li>
<li>
<p><a href="nagstamon.html">Integrating Checkmk in Nagstamon</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_specifics_to_the_editions">
<a class="anchor" href="#_specifics_to_the_editions"></a>10. Specifics to the editions</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="cse.html">Checkmk Enterprise</a></p>
</li>
<li>
<p><a href="cce.html">Checkmk Cloud</a></p>
</li>
<li>
<p><a href="managed.html">Checkmk MSP</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_automation_and_development">
<a class="anchor" href="#_automation_and_development"></a>11. Automation and development</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="apis_intro.html">Overview of API resources</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_apis_for_automation">
<a class="anchor" href="#_apis_for_automation"></a>11.1. APIs for automation</h3>
<div class="ulist">
<ul>
<li>
<p><a href="rest_api.html">The Checkmk REST API</a></p>
</li>
<li>
<p><a href="livestatus.html">Retrieving status data via Livestatus</a></p>
</li>
<li>
<p><a href="livestatus_references.html">Livestatus command reference</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_apis_for_development">
<a class="anchor" href="#_apis_for_development"></a>11.2. APIs for development</h3>
<div class="ulist">
<ul>
<li>
<p><a href="bakery_api.html">The Bakery-API</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_development_of_check_plug_ins">
<a class="anchor" href="#_development_of_check_plug_ins"></a>11.3. Development of check plug-ins</h3>
<div class="ulist">
<ul>
<li>
<p><a href="devel_intro.html">Developing extensions for Checkmk</a></p>
</li>
<li>
<p><a href="devel_check_plugins.html">Writing agent-based check plug-ins</a></p>
</li>
<li>
<p><a href="devel_check_plugins_snmp.html">Writing SNMP-based check plug-ins</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_concepts">
<a class="anchor" href="#_concepts"></a>12. Concepts</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="monitoring_basics.html">Basic principles of monitoring with Checkmk</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_the_checkmk_micro_core_cmc">
<a class="anchor" href="#_the_checkmk_micro_core_cmc"></a>12.1. The Checkmk Micro Core (CMC)</h3>
<div class="ulist">
<ul>
<li>
<p><a href="cmc.html">The Checkmk Micro Core (CMC)</a></p>
</li>
<li>
<p><a href="cmc_differences.html">Special characteristics of the CMC</a></p>
</li>
<li>
<p><a href="cmc_migration.html">Migration to the CMC</a></p>
</li>
<li>
<p><a href="cmc_files.html">CMC files and directories</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_checkmk_appliance">
<a class="anchor" href="#_the_checkmk_appliance"></a>13. The Checkmk appliance</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="appliance_rack1_quick_start.html">Quick start guide for Checkmk racks</a></p>
</li>
<li>
<p><a href="appliance_virt1_quick_start.html">Quick start guide for Checkmk virt1</a></p>
</li>
<li>
<p><a href="appliance_install_virt1.html">Installation of the virtual appliance</a></p>
</li>
<li>
<p><a href="appliance_usage.html">Configuring and using the appliance</a></p>
</li>
<li>
<p><a href="appliance_backup.html">Backup in the appliance</a></p>
</li>
<li>
<p><a href="appliance_cluster.html">Appliance in cluster operation</a></p>
</li>
<li>
<p><a href="appliance_rack_config.html">Special features of the hardware appliance</a></p>
</li>
</ul>
</div>
</div>
</div>
</div></div>
<div class="main-nav__utils">
<div class="dropup dropdown__utils">
<button class="btn dropdown-toggle" type="button" id="aboutMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">About Checkmk</button><div class="dropdown-menu dropup" aria-labelledby="aboutMenuButton">
<a class="dropdown-item" href="https://checkmk.com/product/features" target="_blank">Features</a><a class="dropdown-item" href="https://checkmk.com/product/editions" target="_blank">Editions</a><a class="dropdown-item" href="https://checkmk.com/integrations" target="_blank">Integrations</a><a class="dropdown-item" href="https://checkmk.com/imprint" target="_blank">Imprint</a><a class="dropdown-item" href="copyright.html" target="_blank">Copyright</a>
</div>
</div>
<div class="dropup dropdown__utils">
<button class="btn dropdown-toggle" type="button" id="learnMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Learn</button><div class="dropdown-menu dropup" aria-labelledby="learnMenuButton">
<a class="dropdown-item" href="https://checkmk.com/videos">Videos</a><a class="dropdown-item" href="https://checkmk.com/webinars">Webinars</a><a class="dropdown-item" href="https://checkmk.com/trainings/classes">Trainings</a>
</div>
</div>
<a class="main-nav__utils__link" href="https://forum.checkmk.com">Forum</a>
</div>
</div></aside><main><div id="header">
<h1>Business Intelligence (BI)</h1>
<div class="details">
<span id="revdate">Last modified on 11-May-2023</span><a class="edit-document" href="https://github.com/Checkmk/checkmk-docs/edit/2.3.0/src/common/en/bi.asciidoc">Edit this page on GitHub</a>
</div>
</div>
<div id="content">
<div id="preamble">
<div id="staticinfo">This page was exported for offline usage on 2025-01-07 22:12:14 +0000. It may not reflect the current state of the Checkmk documentation. To view a daily updated version, visit <a href="https://docs.checkmk.com/" target="_blank">docs.checkmk.com</a>.</div>
<div class="sectionbody"><div class="paragraph">
<p></p>
<div class="dropdown dropdown__related">
<button class="btn btn-primary dropdown-toggle" type="button" id="relatedMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Related Articles</button><div class="dropdown-menu dropdown-menu-right" aria-labelledby="relatedMenuButton">
<a href="views.html">Host and service views</a>
<a href="availability.html">Availability</a>
<a href="basics_downtimes.html">Scheduled downtimes</a>
</div>
</div>
</div></div>
</div>
<div class="sect1">
<h2 id="heading__introduction">
<span class="hidden-anchor sr-only" id="_introduction"></span>1. Introduction</h2>
<div class="sectionbody">
<div class="imageblock inline-image"><div class="content"><img src="../images/bi_large_icon_aggr.png" alt="bi large icon aggr" width="80"></div></div>
<div class="paragraph"><p>Checkmk Business Intelligence — that admittedly sounds a bit lofty
for what is basically a simple thing. But this name describes the core of the
<em>BI</em> module in Checkmk pretty well. It is all about deriving the overall state of <strong>business-critical applications</strong> from the many individual state values,
and presenting them clearly.</p></div>
<div class="paragraph"><p>Take as an example the service <em>email</em>, which is still indispensable for many companies.
This service is based on the correct functioning of a variety of hardware and software components — from specific switches, to SMTP and IMAP services, and to
infrastructure services such as LDAP and DNS.</p></div>
<div class="paragraph"><p>The failure of an essential building block is not a problem if this
has been designed to be redundant. Conversely, a problem may occur in a
service that at first glance has nothing to do with email, but which can have much
more serious effects. A simple look at a list of services in Checkmk is not
always meaningful — at least not for everyone!</p></div>
<div class="paragraph"><p><em>Checkmk BI</em> allows you to derive a summary of the overall health of an application
from the current state of individual hosts and services.
You use BI rules to define — in a tree-like structure — how various elements are interdependent.
Each application is then overall <span class="state0">OK</span>, <span class="state1">WARN</span> or <span class="state2">CRIT</span>. The
Information about the condition and the dependencies can be accessed in various ways:</p></div>
<div class="ulist"><ul>
<li><p>A display of the overall state of an application in the GUI.</p></li>
<li><p>Calculation of the <a href="availability.html">availability</a> of an application.</p></li>
<li><p><a href="notifications.html">Notifications</a> in the event of a problem, or even a failure of an application.</p></li>
<li><p>Impact Analysis: A service is in a <span class="state2">CRIT</span> state — so which applications are affected?</p></li>
<li><p>Planning maintenance times and 'what if…​?' analyses.</p></li>
</ul></div>
<div class="paragraph"><p>In addition there is the possibility of using the tree representation in BI for a
'drill down' view of the state of a host and all of its services.</p></div>
<div class="paragraph"><p>A distinctive feature of Checkmk’s BI, unlike comparable tools in the
monitoring field, is that here Checkmk also works with a <em>rule-based</em> structure.
This allows you to dynamically describe an indefinite number of similar applications
with a generic set of rules. That immensely facilitates the work and helps to avoid
mistakes — especially in very dynamic environments.</p></div>
<div class="imageblock"><div class="content"><img src="../images/business_intelligence.png" alt="business intelligence"></div></div>
</div>
</div>
<div class="sect1">
<h2 id="heading_first">
<span class="hidden-anchor sr-only" id="first"></span>2. Configuration Part 1: The first aggregation</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="heading__terminology">
<span class="hidden-anchor sr-only" id="_terminology"></span>2.1. Terminology</h3>
<div class="paragraph"><p>Before you begin step by step with the practical application of BI, you first need know a few terms:</p></div>
<div class="paragraph"><p>Each application formalized with BI is called an <strong>Aggregation</strong>,
since a general state is aggregated from many individual states.</p></div>
<div class="paragraph"><p>An aggregation is constructed as a 'tree' of objects. These objects are called <strong>nodes</strong>.
The bottom nodes — the <em>leaves</em> of the tree — are the hosts and services in
your Checkmk instances. The remaining nodes are artificially-created BI objects.</p></div>
<div class="paragraph"><p>Each node is created by a <strong>rule</strong>. This also applies to the
root of the tree — the topmost node. These rules determine which
nodes hang under another node, and how from their states the state
of the higher node is to be determined.</p></div>
<div class="paragraph"><p>The top node of an aggregation — the root of the tree — is also generated with a rule.
In this way a rule can generate multiple aggregations.</p></div>
</div>
<div class="sect2">
<h3 id="heading__an_example">
<span class="hidden-anchor sr-only" id="_an_example"></span>2.2. An example</h3>
<div class="paragraph"><p>The easiest way understand this is to use a concrete example.
We have thought up the <em>'Mystery Application'</em> for this article.
Suppose that this is an important application in an unspecified company.
Among other things, five servers and two network switches are playing
an important role. So that you can better understand the example,
we use simple names like <code>srv-mys-1</code> or <code>switch-1</code>.
The following diagram gives a simple overview of the structure:</p></div>
<div class="imageblock"><div class="content"><img src="../images/bi_example.jpeg" alt="bi example" width="90%"></div></div>
<div class="ulist"><ul>
<li><p>The two servers <code>srv-mys-1</code> and <code>srv-mys-2</code> form a redundant cluster on which the actual application runs.</p></li>
<li><p><code>srv-db</code> is a database server that stores the application’s data.</p></li>
<li><p><code>switch-1</code> and <code>switch-2</code> are two redundant routers connecting the server network to a higher network.</p></li>
<li><p>In each there is a timer <code>srv-ntp</code> which ensures an exactly-synchronous time.</p></li>
<li><p>In addition the server <code>srv-spool</code> works here and passes the results calculated by the Mystery Application into a spool directory.</p></li>
<li><p>From the spool directory the data is picked up by a mysterious parent service.</p></li>
</ul></div>
<div class="paragraph"><p>If you want to work through the following steps one by one,
you can simply replicate the monitoring objects as shown in our example. For a test
it is sufficient if you clone an existing host several times and name the
clones accordingly. Later there are a few services to be added
into the game, for which you then have time to record the relevant hosts
in the monitoring. Even there you can cheat again: with simple
<a href="localchecks.html">dummy-local-checks</a> you will quickly get matching services
to play with.</p></div>
<div class="paragraph"><p>The hosts will then look something like this in the monitoring:</p></div>
<div class="imageblock"><div class="content"><img src="../images/bi_2_example_2.png" alt="bi 2 example 2"></div></div>
</div>
<div class="sect2">
<h3 id="heading__your_first_bi_rule">
<span class="hidden-anchor sr-only" id="_your_first_bi_rule"></span>2.3. Your first BI rule</h3>
<div class="paragraph"><p>Start with something simple — with the simplest possible
meaningful aggregation — an aggregation with only two nodes. You then want to
summarize the states of the hosts <code>switch-1</code> and <code>switch-2</code>.
The aggregation should be called <em>Network</em> and should be <span class="state0">OK</span>
if both switches are available. In the case of a partial failure, it should go to
<span class="state1">WARN</span>, and if both switches are off, <span class="state2">CRIT</span>.</p></div>
<div class="imageblock inline-image"><div class="content"><img src="../images/bi_aggregation_icon.png" alt="bi aggregation icon" width="80"></div></div>
<div class="paragraph"><p>Get started: configure BI via <span class="guihint">Setup &gt; Business Intelligence &gt; Business Intelligence.</span>
The configuration of the rules and aggregations is performed within the
configuration packages — the <em>BI Packs</em>.
The packages are not only practical because you can better manage more
complex configurations with them — you can also apply permissions to a package
and assign certain contact groups — and even allow users without admin rights — permissions to edit parts of the configuration.
But more on that later …​</p></div>
<div class="paragraph"><p>The first time you call the BI module it should something like this:</p></div>
<div class="imageblock"><div class="content"><img src="../images/bi_2_default.png" alt="bi 2 default"></div></div>
<div class="paragraph"><p>A package titled <span class="guihint">Default Pack</span> is already present.
This contains a demo for an aggregation which summarizes the data for an individual host.</p></div>
<div class="paragraph"><p>For this example it is best to create a new package — with the <span class="guihint">Add BI Pack</span> button — which you name <em>Mystery</em>.
As always in Checkmk, specify an internal ID (<code>mystery</code>) which cannot be changed later,
and a descriptive title. The <span class="guihint">Public</span> option is needed by other users if there are rules
in this package they want to use for their own rules or aggregations.
Because you probably want do your experiments alone in peace, leave this option disabled:</p></div>
<div class="imageblock"><div class="content"><img src="../images/bi_2_create_pack.png" alt="bi 2 create pack"></div></div>
<div class="paragraph"><p>After the creation you will of course find two packages in the main list:</p></div>
<div class="imageblock"><div class="content"><img src="../images/bi_2_two_rulepacks.png" alt="bi 2 two rulepacks"></div></div>
<div class="paragraph"><p>With each entry is a symbol for editing the properties (<span class="image-inline"><img src="../images/icons/icon_edit.png" alt="icon edit"></span>),
and a symbol to get to the actual <em>content</em> of the
Package (<span class="image-inline"><img src="../images/icons/icon_rules.png" alt="icon rules"></span>), which is where you want to go now.
Once there, create your first rule right away via <span class="guihint">Add rule</span>.</p></div>
<div class="paragraph"><p>As always in Checkmk, this rule also needs to have a unique ID and a title. The
title of the rule not only has a documentation function, but will later
also be visible as the name of the node this rule creates:</p></div>
<div class="imageblock"><div class="content"><img src="../images/bi_2_create_rule_2.png" alt="bi 2 create rule 2"></div></div>
<div class="paragraph"><p>The next box is named <span class="guihint">Child Node Generation</span>, and is
the most important. Here you specify which objects in this node
should be summarized. This can either be other BI nodes — for which you would choose a different BI rule — or be
monitoring objects, i.e., hosts or services.</p></div>
<div class="paragraph"><p>For the first example select the second variant (<span class="guihint">State of a host</span>) and create
two objects as children — namely the two hosts <code>switch-1</code>
and <code>switch-2</code>. This is done with the <span class="guihint">Add child node generator</span> button.
Here you naturally choose <span class="guihint">State of a host</span>, and enter a name for each host:</p></div>
<div class="imageblock"><div class="content"><img src="../images/bi_2_create_rule_3.png" alt="bi 2 create rule 3"></div></div>
<div class="paragraph" id="aggregationfunction"><p>In the third and final box, <span class="guihint">Aggregation Function</span>, you specify how the monitoring
state of the node should be calculated.
The basis for this is always the list of states of the subnodes. Different logical
links are possible.</p></div>
<div class="paragraph"><p>Pre-selected is <span class="guihint">Best — take best of all node states</span>. That would mean that
the node becomes <span class="state2">CRIT</span> when all sub-nodes are <span class="state2">CRIT</span> or <span class="hstate1">DOWN</span>.
As mentioned above this should not be the case here. Choose instead
<span class="guihint">Count the number of nodes in state OK</span> to get the number of subnodes with state
<span class="state0">OK</span> as a yardstick. Here the numbers 2 and 1 are suggested for the thresholds.
That is great because it is exactly what you need:</p></div>
<div class="ulist"><ul>
<li><p>If both switches are <span class="hstate0">UP</span> (this is treated as <span class="state0">OK</span>), the node should then also be <span class="state0">OK</span>.</p></li>
<li><p>If only one switch is <span class="hstate0">UP</span>, the state becomes <span class="state1">WARN</span>.</p></li>
<li><p>And when both switches are <span class="hstate1">DOWN</span>, the state becomes <span class="state2">CRIT</span>.</p></li>
</ul></div>
<div class="paragraph"><p>This is how the filled-out mask will look:</p></div>
<div class="imageblock"><div class="content"><img src="../images/bi_2_create_rule_5.png" alt="bi 2 create rule 5"></div></div>
<div class="paragraph"><p>With a click on <span class="guihint">Create</span> you will have your first rule:</p></div>
<div class="imageblock"><div class="content"><img src="../images/bi_2_create_rule_6.png" alt="bi 2 create rule 6"></div></div>
</div>
<div class="sect2">
<h3 id="heading__your_first_aggregation">
<span class="hidden-anchor sr-only" id="_your_first_aggregation"></span>2.4. Your first aggregation</h3>
<div class="paragraph"><p>Now it is important to understand that a rule is not yet an aggregation.
Checkmk can not yet know if this is everything or just part of a bigger tree!
Real BI objects are only created and become visible in the status interface
when you create an <em>Aggregation</em>.
To do this, switch to the list of <span class="image-inline"><img src="../images/icons/button_aggregations.png" alt="button aggregations"></span> aggregations.</p></div>
<div class="paragraph"><p>The button <span class="image-inline"><img src="../images/icons/button_add_aggregation.png" alt="button add aggregation"></span> takes you to a mask for creating a new aggregation.
There is little to fill in here. In the <span class="guihint">Aggregation groups</span> you can specify any name of your choosing.
These names then appear in the status interface as groups,
under which all of those aggregations which share this group name become visible.
This is actually the same concept as with hashtags or keywords.</p></div>
<div class="paragraph"><p>You define the content of the aggregation via <span class="guihint">Add new element.</span>
Select the setting <span class="guihint">Call a rule</span> and at
 <span class="guihint">Rule:</span> the rule you just created (and before that the rule package it is in).</p></div>
<div class="imageblock"><div class="content"><img src="../images/bi_2_new_aggregation.png" alt="bi 2 new aggregation"></div></div>
<div class="paragraph"><p>If you now save the aggregation with <span class="image-inline"><img src="../images/icons/icon_save.png" alt="icon save"></span>, you will be done!
Your first aggregation should now appear in the status interface — assuming
that you in fact also have at least one of the hosts <code>switch-1</code> or <code>switch-2</code>!</p></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="heading_statusgui">
<span class="hidden-anchor sr-only" id="statusgui"></span>3. BI in Operation Part 1: The Status view</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="heading__displaying_all_aggregations">
<span class="hidden-anchor sr-only" id="_displaying_all_aggregations"></span>3.1. Displaying all aggregations</h3>
<div class="paragraph"><p>If you have done everything correctly you will now be able to see your first aggregation in the
status interface. The easiest way to do this is via <span class="guihint">Monitor &gt; Business Intelligence &gt; All Aggregations</span>:</p></div>
<div class="imageblock"><div class="content"><img src="../images/bi_3_status_gui_1.png" alt="bi 3 status gui 1"></div></div>
<div class="sect3">
<h4 id="heading__creating_views_for_bi">
<span class="hidden-anchor sr-only" id="_creating_views_for_bi"></span>Creating views for BI</h4>
<div class="paragraph"><p>In addition to the ready-made BI views, you can also custom-make your own.
To do so, select one of the BI data sources when <a href="views.html#new">creating a new view.</a>
<span class="guihint">BI Aggregations</span> provides information about the Aggregations,
<span class="guihint">BI Hostname Aggregations</span> adds filters and information for individual hosts,
<span class="guihint">BI Aggregations affected by one host</span> shows only Aggregations related to one
single host, and <span class="guihint">BI Aggregations for Hosts by Hostgroups</span> allows you to
distinguish between host groups.</p></div>
</div>
</div>
<div class="sect2">
<h3 id="heading__working_with_the_tree">
<span class="hidden-anchor sr-only" id="_working_with_the_tree"></span>3.2. Working with the tree</h3>
<div class="paragraph"><p>Take a closer look at the appearance of the BI tree. The following example
shows your mini-aggregation in a situation where one of the two switches is
<span class="hstate1">DOWN</span>, and the other <span class="hstate0">UP</span>. As desired, the aggregation enters the <span class="state1">WARN</span> state:</p></div>
<div class="imageblock"><div class="content"><img src="../images/bi_3_tree_minimal.png" alt="bi 3 tree minimal"></div></div>
<div class="paragraph"><p>You can also see that in order to standardize hosts and services, the host that is <span class="hstate1">DOWN</span>,
is treated almost like a service that is <span class="state2">CRIT</span>. Likewise <span class="hstate0">UP</span> accordingly becomes <span class="state0">OK</span>.</p></div>
<div class="paragraph"><p>The leaves of the tree show the states of hosts and services.
The host name — and for services also the service name — is clickable
and takes you to the current state of the corresponding object.
Furthermore, you can also see the last output from the check plug-in.</p></div>
<div class="paragraph"><p>To the left of each aggregation you will find two symbols: <span class="image-inline"><img src="../images/icons/icon_showbi.png" alt="icon showbi"></span>
and <span class="image-inline"><img src="../images/icons/button_availability.png" alt="button availability"></span>. With the first icon — <span class="image-inline"><img src="../images/icons/icon_showbi.png" alt="icon showbi"></span> — you come
to a page that displays just that single aggregation. This is naturally
mainly useful if you have created more than one aggregation.
It is for, example, well-suited as a bookmark.
<span class="image-inline"><img src="../images/icons/button_availability.png" alt="button availability"></span> will take you to the calculation of the availability.
More on this later.</p></div>
</div>
<div class="sect2">
<h3 id="heading__trying_bi_what_if">
<span class="hidden-anchor sr-only" id="_trying_bi_what_if"></span>3.3. Trying BI: what if?</h3>
<div class="paragraph"><p>To the left of the host name you will find an interesting icon: <span class="image-inline"><img src="../images/icons/icon_assume_none.png" alt="icon assume none"></span>.
This allows a 'what if?' analysis. The idea behind this is simple: through
clicking on the icon it will switch the object to another state as a test — however only
for the BI interface — NOT for real!
Multiple clicks will take you from <span class="image-inline"><img src="../images/icons/icon_assume_0.png" alt="icon assume 0"></span> (<span class="state0">OK</span>) via
<span class="image-inline"><img src="../images/icons/icon_assume_1.png" alt="icon assume 1"></span> (<span class="state1">WARN</span>), <span class="image-inline"><img src="../images/icons/icon_assume_2.png" alt="icon assume 2"></span> (<span class="state2">CRIT</span>) and
<span class="image-inline"><img src="../images/icons/icon_assume_3.png" alt="icon assume 3"></span> (<span class="state3">UNKNOWN</span>), and back to <span class="image-inline"><img src="../images/icons/icon_assume_none.png" alt="icon assume none"></span>.</p></div>
<div class="paragraph"><p>BI then constructs the complete tree based on the assumed state.
The following figure shows the minimum aggregation under the assumption that alongside
<code>switch-1</code> which has actually failed, that <code>switch-2</code> would also be <span class="hstate1">DOWN</span>:</p></div>
<div class="imageblock"><div class="content"><img src="../images/bi_3_assume_example_1.png" alt="bi 3 assume example 1"></div></div>
<div class="paragraph"><p>The overall state of the aggregation thereby goes from <span class="state1">WARN</span> to <span class="state2">CRIT</span>. At the same
time the state’s color is backed by a checked pattern. This pattern indicates to you
that the <strong>real</strong> state is actually different. This is not always the case,
because some changes in a host or service are no longer relevant to the overall condition — for example, if the one in question is already <span class="state2">CRIT</span>.</p></div>
<div class="paragraph"><p>You can use this 'what if?' analysis in several ways, for example:</p></div>
<div class="ulist"><ul>
<li><p>To test if the BI aggregation reacts the way that you want.</p></li>
<li><p>When planning to shut down a component for maintenance.</p></li>
</ul></div>
<div class="paragraph"><p>In the latter scenario, as a test you set the device to be serviced or its services
to <span class="image-inline"><img src="../images/icons/icon_assume_2.png" alt="icon assume 2"></span>. If the whole aggregation then remains <span class="state0">OK</span>, it must
mean that the failure can <strong>currently</strong> be compensated for by redundancy.</p></div>
</div>
<div class="sect2">
<h3 id="heading__testing_bi_using_fake_states">
<span class="hidden-anchor sr-only" id="_testing_bi_using_fake_states"></span>3.4. Testing BI using fake states</h3>
<div class="paragraph"><p>There is another way to test the BI aggregations:
by directly changing the <em>actual</em> state of an object.
This is especially practical in a test system.</p></div>
<div class="paragraph"><p>For this purpose, the <a href="commands.html">commands</a>
have a host/service command named <span class="guihint">Fake check results</span>. It is by default
only available for the Administrator role. This method has been used, for example,
for the creation of the screenshots used in this article where <code>switch-1</code>
has been set to <span class="hstate1">DOWN</span>. This is where the telltale text
<span class="guihint">Manually set to Down by cmkadmin</span> comes from.</p></div>
<div class="imageblock"><div class="content"><img src="../images/bi_3_fake_check_results.png" alt="bi 3 fake check results"></div></div>
<div class="imageblock inline-image"><div class="content"><img src="../images/bi_3_master_control_checks_off.png" alt="bi 3 master control checks off" width="280]"></div></div>
<div class="paragraph"><p>Here is a helpful little hint: If you work with this method,
it’s best to disable the active checks for the relevant hosts and services,
otherwise at the next check interval they will immediately go back to their
actual state. If you are lazy just do it globally via the <span class="guihint">Master Control</span> sidebar element.
Just — NEVER forget to turn it back on afterwards!</p></div>
</div>
<div class="sect2">
<h3 id="heading__bi_groups">
<span class="hidden-anchor sr-only" id="_bi_groups"></span>3.5. BI-groups</h3>
<div class="paragraph"><p>While creating the aggregation we briefly addressed the possibilities of the <span class="guihint">Aggregation Groups</span> input.
In the example you simply confirmed the suggested <span class="guihint">Main</span> here.
You are of course completely free in the allocation of names,
and you can also assign an aggregation to multiple groups.</p></div>
<div class="paragraph"><p>Groups become important when the number of aggregations possibly exceeds want you to see on a screen.
You get to a group by clicking on one of the displayed group names on
the <span class="guihint">All aggregations</span> page — in our example above that is simply on the <span class="guihint">Main</span> heading.
Of course, if so far you only have this single aggregation not much will change.
However if you look closely, you will realize that:</p></div>
<div class="ulist"><ul>
<li><p>The title of the page is now called <span class="guihint">Aggregation group Main</span>.</p></li>
<li><p>The group heading <span class="guihint">Main</span> has disappeared.</p></li>
</ul></div>
<div class="paragraph"><p>If you want to visit this view more often,
simply bookmark it — preferably with the <span class="guihint">Bookmarks</span> element in the sidebar.</p></div>
</div>
<div class="sect2">
<h3 id="heading__from_hostservice_to_aggregation">
<span class="hidden-anchor sr-only" id="_from_hostservice_to_aggregation"></span>3.6. From host/service to aggregation</h3>
<div class="paragraph"><p>Once you have set up BI aggregations, in the context menu at your hosts and services
you will find a new <span class="image-inline"><img src="../images/icons/icon_aggr.png" alt="icon aggr"></span> icon:</p></div>
<div class="imageblock"><div class="content"><img src="../images/bi_3_service_popup.png" alt="bi 3 service popup"></div></div>
<div class="paragraph"><p>This icon takes you to the list of all aggregations in which the
affected host or service is included.</p></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="heading_multilevel">
<span class="hidden-anchor sr-only" id="multilevel"></span>4. Configuration Part 2: Multi-level trees</h2>
<div class="sectionbody">
<div class="paragraph"><p>Following this first brief impression of the BI status interface, we return
to configuration — because of course you cannot really impress anybody with such a mini aggregation.</p></div>
<div class="paragraph"><p>It starts with you extending the tree by one level — that is,
from two levels (root and leaves) to three levels (root, intermediate level, leaves).
To do this combine your existing node 'Switches 1 &amp; 2' with the NTP time synchronization state into a topmost node 'Infrastructure'.</p></div>
<div class="paragraph"><p>But one thing at a time — first of all, a preview the result:</p></div>
<div class="imageblock"><div class="content"><img src="../images/bi_4_rule_infra_4.png" alt="bi 4 rule infra 4"></div></div>
<div class="paragraph"><p>The prerequisite is that there is a host <code>srv-ntp</code> which
has a service named <code>NTP Time</code>:</p></div>
<div class="imageblock"><div class="content"><img src="../images/bi_4_service_ntp.png" alt="bi 4 service ntp"></div></div>
<div class="paragraph"><p>First create a BI rule which as subnode 1 receives the rule 'Switches 1 &amp; 2',
and as subnode 2 directly-receives the service <code>NTP Time</code> of the host <code>srv-ntp</code>.
At the top of the rule, select <code>infrastructure</code> as the rule ID, and <span class="guihint">Infrastructure</span> as the name.
You need to enter no more information at this point:</p></div>
<div class="imageblock"><div class="content"><img src="../images/bi_4_rule_infra_1.png" alt="bi 4 rule infra 1"></div></div>
<div class="paragraph"><p>In the <span class="guihint">Child Node Generation</span> it gets interesting. The first entry is
now of the <span class="guihint">Call a rule</span> type, and as the rule choose your rule from the above — so that you
actually 'hang' these rules effectively in the subtree.</p></div>
<div class="paragraph"><p>The second subnode is of the <span class="guihint">State of a service</span> type, and here choose
your <code>NTP Time</code> service (observe the exact spelling here,
including upper and lower case characters):</p></div>
<div class="imageblock"><div class="content"><img src="../images/bi_4_rule_infra_2.png" alt="bi 4 rule infra 2"></div></div>
<div class="paragraph"><p>This time set the <span class="guihint">Aggregation Function</span> in the third box to
<span class="guihint">Worst - take worst state of all nodes.</span></p></div>
<div class="paragraph"><p>In this function the state of the node is thus derived from the worst
state of a service below it. In this case, if <code>NTP Time</code> goes to <span class="state2">CRIT</span>
the node also goes to <span class="state2">CRIT</span>.</p></div>
<div class="paragraph"><p>Of course to make the new, bigger tree visible, you’ll once again need
to create an aggregation.
It is best to simply change the existing aggregation so that from now on the new rule is used:</p></div>
<div class="imageblock"><div class="content"><img src="../images/bi_4_rule_infra_3.png" alt="bi 4 rule infra 3"></div></div>
<div class="paragraph"><p>In this way you stick to a <em>single</em> aggregation, which then looks
like as below (this time both switches are back on <span class="state0">OK</span>):</p></div>
<div class="imageblock"><div class="content"><img src="../images/bi_4_rule_infra_4.png" alt="bi 4 rule infra 4"></div></div>
</div>
</div>
<div class="sect1">
<h2 id="heading_displayoptions">
<span class="hidden-anchor sr-only" id="displayoptions"></span>5. BI in operation Part 2: Alternative displays</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="heading__introduction_2">
<span class="hidden-anchor sr-only" id="_introduction_2"></span>5.1. Introduction</h3>
<div class="paragraph"><p>Now that you have a slightly more interesting tree you can get a little closer
to dealing with the various display options that CMK offers. The starting point
for these are the <span class="guihint">Modify display options,</span> which you can access via the <span class="guihint">Display</span> menu. This opens a box with various options.
The content of the box always conforms to the elements shown on the page.
In the case of BI you can currently find four options:</p></div>
<div class="imageblock"><div class="content"><img src="../images/bi_5_display_options_screen.png" alt="bi 5 display options screen"></div></div>
<div class="sect3">
<h4 id="heading__instantly_expand_or_collapse_trees">
<span class="hidden-anchor sr-only" id="_instantly_expand_or_collapse_trees"></span>Instantly expand or collapse trees</h4>
<div class="paragraph"><p>If you display not just a single aggregation, but many, then the
<strong>Initial expansion of aggregations</strong> setting is helpful.
Here you define how far the trees should be unfolded when first displayed.
The selection ranges from closed (<span class="guihint">collapsed</span>) over the first three levels,
to completely open (<span class="guihint">complete</span>).</p></div>
</div>
<div class="sect3">
<h4 id="heading__only_show_problems">
<span class="hidden-anchor sr-only" id="_only_show_problems"></span>Only show problems</h4>
<div class="paragraph"><p>If you enable the <strong>Show only problems</strong> option, only such branches that do not
have the <span class="state0">OK</span> state will be displayed in the trees. This will then look like this:</p></div>
<div class="imageblock"><div class="content"><img src="../images/bi_5_only_problems.png" alt="bi 5 only problems"></div></div>
</div>
<div class="sect3">
<h4 id="heading__types_of_tree_displays">
<span class="hidden-anchor sr-only" id="_types_of_tree_displays"></span>Types of tree displays</h4>
<div class="paragraph"><p>Under the <strong>Type of tree layout</strong> item you will find several alternative
display types for the tree. One of these is called <span class="guihint">Table: top down</span>
and looks like this:</p></div>
<div class="imageblock"><div class="content"><img src="../images/bi_5_top_down.png" alt="bi 5 top down"></div></div>
<div class="paragraph"><p>Extremely space-saving — especially if you want to see many units at the same time — is the <span class="guihint">Boxes</span> display. Here each node is a colored box which can be
expanded with a click. The tree structure is no longer visible, but you can
quickly click through to a problem with minimal space required. Here in the example
the boxes are unfolded completely:</p></div>
<div class="imageblock"><div class="content"><img src="../images/bi_5_boxes.png" alt="bi 5 boxes"></div></div>
</div>
</div>
<div class="sect2">
<h3 id="heading__more_options">
<span class="hidden-anchor sr-only" id="_more_options"></span>5.2. More options</h3>
<div class="paragraph"><p>Finally, you can set a <span class="guihint">Refresh interval</span> of 30, 60 or 90 seconds and specify the number of columns via <span class="guihint">Entries per row</span>.</p></div>
</div>
<div class="sect2">
<h3 id="heading_visualization">
<span class="hidden-anchor sr-only" id="visualization"></span>5.3. Visualizing BI aggregations</h3>
<div class="paragraph"><p>From version <span class="new">1.6.0</span>, in addition to tabular representations Checkmk
also masters the visualization of BI aggregations. You can view aggregations
from a new perspective, and sometimes more clearly. You will find the
<span class="guihint">BI Visualization</span> via <span class="image-inline"><img src="../images/icons/icon_aggr.png" alt="icon aggr"></span> in the regular
Aggregations View.</p></div>
<div class="imageblock"><div class="content"><img src="../images/bi_5_visualization_start.png" alt="bi 5 visualization start"></div></div>
<div class="paragraph"><p>You can move the tree freely by clicking on the background, and scale the entire display using the mouse wheel. As soon as the mouse pointer is over an individual node, you get the node’s associated state information
via a hover window. Use the mouse wheel to scale the length of the tree’s branches.</p></div>
<div class="imageblock"><div class="content"><img src="../images/bi_5_visualization_standard.png" alt="bi 5 visualization standard"></div></div>
<div class="paragraph"><p>Clicking on the leaf nodes takes you directly to the detailed views
of the host or service. A right click on the other nodes — depending on the type of node — gives access to display options and, for example, the responsible rule itself — <span class="guihint">Edit rule</span> in the below image.</p></div>
<div class="imageblock"><div class="content"><img src="../images/bi_5_visualization_context.png" alt="bi 5 visualization context"></div></div>
<div class="sect3">
<h4 id="heading__customizing_a_display">
<span class="hidden-anchor sr-only" id="_customizing_a_display"></span>Customizing a display</h4>
<div class="paragraph"><p>It starts getting really interesting with the <span class="guihint">Layout Designer</span>, which is opened
with <span class="image-inline"><img src="../images/icons/icon_aggr.png" alt="icon aggr"></span> at the top, next to the search field. First of all,
you’ll see two new items — the <span class="guihint">Layout Configuration</span>, and
two new icons at the root — <span class="image-inline"><img src="../images/icons/icon_bi_visualization_rotate.png" alt="icon bi visualization rotate"></span> and
<span class="image-inline"><img src="../images/icons/icon_bi_visualization_resize.png" alt="icon bi visualization resize"></span>.</p></div>
<div class="paragraph"><p>In a configuration you can choose between different types of line
and can activate the <span class="guihint">Node icons</span>.
This will display the icons that you can specify in the rules for
BI aggregations in the <a href="#aggregationfunction">Aggregation Function</a> section
(this can be reached directly via the node’s context menu).
Using the <span class="image-inline"><img src="../images/icons/icon_bi_visualization_rotate.png" alt="icon bi visualization rotate"></span> and <span class="image-inline"><img src="../images/icons/icon_bi_visualization_resize.png" alt="icon bi visualization resize"></span> icons
the tree can be viewed, and via click &amp; drag rotated or scaled in length and width.
Further display options also appear in the <span class="guihint">Style configuration</span> box.
You can find the ones most suitable for your needs by simply trying out what is available.</p></div>
<div class="imageblock"><div class="content"><img src="../images/bi_5_visualization_designer2.png" alt="bi 5 visualization designer2"></div></div>
<div class="paragraph"><p>The biggest customization possibilities can be found in the nodes' context menus,
which in the designer mode offer four different displays for the hierarchy
from this node:</p></div>
<div class="olist arabic"><ol class="arabic">
<li><p><span class="guihint">Hierarchical style</span>: The standard setting with a simple hierarchy.</p></li>
<li><p><span class="guihint">Radial style</span>: A circular format with a customizable sector of a circle.</p></li>
<li><p><span class="guihint">Leaf-Nodes Block style</span>: Leaf nodes are shown as a group with a gray background.</p></li>
<li><p><span class="guihint">Free-Floating style</span>: A dynamic layout with options such as attraction, spacing, length of the branches.</p></li>
</ol></div>
<div class="imageblock"><div class="content"><img src="../images/bi_5_visualization_styles.png" alt="bi 5 visualization styles"></div></div>
<div class="paragraph"><p>Nodes that have been assigned a style can be placed anywhere.
The available options also differ depending on the style — with <span class="guihint">Radial style</span>,
at the root node there is a third <span class="image-inline"><img src="../images/icons/icon_bi_visualization_pie.png" alt="icon bi visualization pie"></span> icon
which you can use to limit the display to a sector of a circle.</p></div>
<div class="paragraph"><p>With the <span class="guihint">Detach from parent style</span> option you can detach a node’s style from the style of its
higher parent node, then configure these subnodes differently and position them freely.
<span class="guihint">Include parent rotation</span> is also similarly-intended to allow you to include or exclude parent nodes when rotating.</p></div>
<div class="paragraph"><p>These style options are basically all self-explanatory — only the <span class="guihint">Free-Floating style</span>
needs some explanation. This is a system of attraction and repulsion as you know it from gravitational simulations.</p></div>
<table class="table-responsive table-bordered table tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="guihint">Center force strength</span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Center of gravity of the nodes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="guihint">Repulsion force leaf</span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Strength of the repulsion-effect of leaves on other nodes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="guihint">Repulsion force branches</span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Strength of the repulsion from nodes to others in the same branch.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="guihint">Link distance leaf</span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ideal distance from the leaf node to the previous node.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="guihint">Link distance branches</span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ideal distance from the branch node to the previous node.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="guihint">Link strength</span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Strength with which the ideal distance is enforced.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="guihint">Collision box leaf</span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Size of the leaf node area that repels other nodes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="guihint">Collision box branch/leaf</span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Size of the branch node area that repels other nodes.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph"><p>The following image shows a branch in the <span class="guihint">Free-Floating style</span> — the positions
of the individual leaves result dynamically depending on the options specified.</p></div>
<div class="imageblock"><div class="content"><img src="../images/bi_5_visualization_float.png" alt="bi 5 visualization float"></div></div>
</div>
<div class="sect3">
<h4 id="heading__specifying_layout_styles_for_bi_rules">
<span class="hidden-anchor sr-only" id="_specifying_layout_styles_for_bi_rules"></span>Specifying layout styles for BI-Rules</h4>
<div class="paragraph"><p>For BI rules — which you can access from the nodes' context menu — in the <span class="guihint">Rule Properties</span> menu you can assign the <span class="guihint">Hierarchical</span>, <span class="guihint">Radial</span>
or <span class="guihint">Leaf-Nodes Block</span> layouts, and likewise set the relevant options.</p></div>
<div class="imageblock"><div class="content"><img src="../images/bi_5_visualization_rule.png" alt="bi 5 visualization rule"></div></div>
</div>
<div class="sect3">
<h4 id="heading__the_search_function">
<span class="hidden-anchor sr-only" id="_the_search_function"></span>The search function</h4>
<div class="paragraph"><p>The search function is of enormous help with larger trees. In the <span class="guihint">Search node</span> search field
you can simply enter a part of the name of the desired node and get a list of hits directly and live.
If you now use the mouse to run over this list of suggestions, the tree’s node under the mouse pointer
will be highlighted by a blue border — this makes a first orientation easier.
Clicking on a node in the list will center the tree there.
In this way, even in displays with hundreds of nodes you can quickly find the right section in the infrastructure.</p></div>
<div class="imageblock"><div class="content"><img src="../images/bi_5_visualization_search.png" alt="bi 5 visualization search"></div></div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="heading_config3">
<span class="hidden-anchor sr-only" id="config3"></span>6. Configuration Part 3: Variables, Templates, Searches</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="heading__configuration_with_more_intelligence">
<span class="hidden-anchor sr-only" id="_configuration_with_more_intelligence"></span>6.1. Configuration with more intelligence</h3>
<div class="paragraph"><p>Continue with the configuration. Now it’s time to really get down to business.
So far the example has been so simple that it was possible to individually list all
of the objects in the aggregation without difficulty.
But what if things get more complex?
What if you want to formulate many recurring same or similar dependencies?
What if an application includes not a single, but multiple instances?
What if you should want to merge hundreds of a database’s individual services into one
BI node?</p></div>
<div class="paragraph"><p>Well, for such requirements you need more powerful methods of configuration.
And these are exactly what distinguishes Checkmk BI over other tools — and unfortunately here the learning curve is a bit steeper. It is also the
reason why Checkmk BI does not allow itself to be configured by „drag and drop“.
Once you get to know the possibilities however, you will certainly not want to go without them.</p></div>
</div>
<div class="sect2">
<h3 id="heading__parameters">
<span class="hidden-anchor sr-only" id="_parameters"></span>6.2. Parameters</h3>
<div class="paragraph"><p>Let’s start with the <em>parameters</em>.
Take the following situation: you not only want to know if the two switches are <span class="hstate0">UP</span>,
but also want know the state of the two ports that are responsible for the uplink.
In overall terms, it concerns the following four services:</p></div>
<div class="imageblock"><div class="content"><img src="../images/bi_6_switch_service.png" alt="bi 6 switch service"></div></div>
<div class="paragraph"><p>Now the node <span class="guihint">Switch 1 &amp; 2</span> should be extended to replace the two host states for
switches 1 and 2 so that each has a subnode showing the host state <strong>and</strong> the two uplink interfaces.
These two subnodes should be <span class="guihint">Switch 1</span> or <span class="guihint">Switch 2</span>.</p></div>
<div class="paragraph"><p>Actually you now need two new rules — one for each switch. It is better
to do this by creating a new &lt;switch&gt; rule, and equip it with a <em>parameter</em>.
This parameter is a variable that you call when you call the rule
from the parent node — which here can be provided by the old rule <code>Switch 1 &amp; 2</code>.
In this example you can simply pass either a <code>1</code> or a <code>2</code>.
The parameter gets a name which you can choose freely.
Take here for example the name <code>NUMBER</code>.
The spelling with capital letters is purely arbitrary,
and if you find lowercase letters more beautiful you are also free to use these.</p></div>
<div class="paragraph"><p>And the rule’s heading will look like this:</p></div>
<div class="imageblock"><div class="content"><img src="../images/bi_6_rule_with_parameter.png" alt="bi 6 rule with parameter"></div></div>
<div class="paragraph"><p>You can choose <code>switch</code> as the ID for the new rule. At <span class="guihint">parameter</span>
simply enter the name of the variable: <code>NUMBER</code>. Also important
now is that the variable is used in the rule’s <span class="guihint">Rule Title</span>
so that both nodes are not just called <code>switch</code> and thus
have the same name.
When <strong>using</strong> the variable a leading and trailing dollar sign is set — as usual at
many places in Checkmk.
As a result the two nodes will then be called <code>Switch 1</code> and
<code>Switch 2</code>.</p></div>
<div class="sect3">
<h4 id="heading__prefix_match_is_the_default_for_service_name">
<span class="hidden-anchor sr-only" id="_prefix_match_is_the_default_for_service_name"></span>Prefix match is the default for service name</h4>
<div class="paragraph"><p>For the <span class="guihint">Child node generator</span>, the first thing to do is to insert the host state.
Instead of the <code>1</code> or <code>2</code> in the host name you may simply use your
variable, again each with a leading and trailing <code>$</code>.</p></div>
<div class="paragraph"><p>The same thing happens with the host names of the uplink interfaces. And here comes
the second trick — because as you might think from the small service list
seen above, the services for the uplink are named differently at each switch!
But that is no problem, because BI always interprets the service name as a prefix match using regular expressions — completely-analogous to the well-known <a href="wato_rules.html">rules</a> service.
So by simply writing <code>Interface Uplink</code>,
you catch all of the services <em>on the respective host</em> which <strong>start</strong>
with <code>Interface Uplink</code>:</p></div>
<div class="imageblock"><div class="content"><img src="../images/bi_6_rule_with_parameter_2.png" alt="bi 6 rule with parameter 2"></div></div>
<div class="paragraph"><p>By the way: By appending <code>$</code> you can disable the prefix behavior.
In regular expressions a <code>$</code> means 'The text must end here'.
So <code>Interface 1$</code> matches only with <code>Interface 1</code>,
and not also, for example, with <code>Interface 10</code>!</p></div>
<div class="paragraph"><p>Now modify the old <span class="guihint">Switch 1 &amp; 2</span> rule so that instead of the host states this
new rule is only ever invoked once for each of the two switches.
And here is also where the values <code>1</code> and <code>2</code> are provided as the
parameters for the variable <code>NUMBER</code>:</p></div>
<div class="imageblock"><div class="content"><img src="../images/bi_6_rule_with_parameter_3.png" alt="bi 6 rule with parameter 3"></div></div>
<div class="paragraph"><p>And voila — you now have a pretty tree with three levels:</p></div>
<div class="imageblock"><div class="content"><img src="../images/bi_6_rule_with_parameter_4.png" alt="bi 6 rule with parameter 4"></div></div>
</div>
</div>
<div class="sect2">
<h3 id="heading__regular_expressions_missing_objects">
<span class="hidden-anchor sr-only" id="_regular_expressions_missing_objects"></span>6.3. Regular expressions, missing objects</h3>
<div class="paragraph"><p>The subject of <a href="regexes.html">regular expressions</a> is again worth a closer look.
When matching the service name we have at the beginning tacitly understated that
it basically only concerns regular expressions. As just mentioned, there is a prefix match.</p></div>
<div class="paragraph"><p>So in a BI node, if for example, under service name you specify <code>disk</code>,
all of the of the host in question’s services that <em>begin</em> with <code>Disk</code>
will be captured.</p></div>
<div class="paragraph"><p>The following principles generally apply:</p></div>
<div class="olist arabic"><ol class="arabic">
<li><p>If a node refers to objects that do not (currently) exist, they are simply omitted.</p></li>
<li><p>If a node becomes empty, it will be omitted.</p></li>
<li><p>If the root node of an aggregation is also empty, the aggregation itself will be omitted.</p></li>
</ol></div>
<div class="paragraph"><p>Maybe that sounds a bit bold for you! Is not it dangerous to just silently omit things
that should be there if they are missing?</p></div>
<div class="paragraph"><p>Well — over time you will notice how practical this concept is,
because this will allow you to write 'smart' rules that can react to very
different situations. Is there a service that does not exist with every instance
of an application? No problem — it is only considered if it is there!
Or can hosts or services be temporarily removed from monitoring?
These then simply disappear from BI without leading to errors or the like.
BI is <strong>not</strong> there to see if your monitoring configuration is complete!</p></div>
<div class="paragraph"><p>Incidentally — this principle also applies to <em>explicitly</em> defined services,
since these do not actually exist because the service names are always viewed as
regular expressions even if they do not contain special characters such as <code>.*</code>.
It is always automatically a search pattern.</p></div>
</div>
<div class="sect2">
<h3 id="heading__creating_a_node_as_the_result_of_a_search">
<span class="hidden-anchor sr-only" id="_creating_a_node_as_the_result_of_a_search"></span>6.4. Creating a node as the result of a search</h3>
<div class="paragraph"><p>But you can still automate further and, above all, react flexibly to changes.
Continue with the example of the two application servers
<code>srv-mys-1</code> and <code>srv-mys-2</code> from the example. Your tree should
continue to grow. The <span class="guihint">Infrastructure</span> node should slip to level 2.
And as a definitive root, there should be a rule with the
title <span class="guihint">The Mystery Application</span> under which everything will hang.
Alongside <span class="guihint">Infrastructure</span> there should be a node named <span class="guihint">Mystery Servers</span>.
Under this the (currently) two mystery-servers are supposed to hang. In each
a few generic services come into the aggregation.
The result should look like this:</p></div>
<div class="imageblock"><div class="content"><img src="../images/bi_6_mystery_tree.png" alt="bi 6 mystery tree"></div></div>
<div class="sect3">
<h4 id="heading__bottom_rule_mystery_server_x">
<span class="hidden-anchor sr-only" id="_bottom_rule_mystery_server_x"></span>Bottom Rule: Mystery Server X</h4>
<div class="paragraph"><p>Start from the bottom, because that is always the easiest way in BI.
Below is the new <span class="guihint">Mystery Server X</span> rule. Of course you have a single
parameter so that you do not need a separate rule for each server.
You can again name the parameter <code>NUMBER</code>, for example.
It should then later have the value <code>1</code> or <code>2</code>.
As already done above you will again have to enter <code>NUMBER</code>
in the header at <span class="guihint">Parameters</span>.</p></div>
<div class="paragraph"><p>The resulting child-node generator looks like this:</p></div>
<div class="imageblock"><div class="content"><img src="../images/bi_6_mystery_server_rule.png" alt="bi 6 mystery server rule"></div></div>
<div class="paragraph"><p>What follows is remarkable:</p></div>
<div class="ulist"><ul>
<li><p>The host name <code>srv-mys-$NUMBER$</code> will use the number from the parameter.</p></li>
<li><p>With <span class="guihint">Service:</span> the sophisticated <a href="regexes.html">regular expression</a> <code>CPU|Memory</code> which uses a vertical bar to allow alternative service names (prefixes) is used, and this matches all services that begin with <code>CPU</code> or <code>Memory</code>. This saves a doubling of the configuration!</p></li>
</ul></div>
<div class="paragraph"><p>Incidentally, this example is of course not necessarily perfect.
For example, the state of the host itself has not been recorded at all.
So if one of the servers goes <span class="hstate1">DOWN</span>, the services on this will become obsolete (go <span class="guihint">stale</span>),
but the state will remain <span class="state0">OK</span>, and the aggregation will not 'notice' that failure.
If you want to know something like that, as well as the services you should in any case also
record the host state.</p></div>
</div>
<div class="sect3">
<h4 id="heading__middle_rule_mystery_servers">
<span class="hidden-anchor sr-only" id="_middle_rule_mystery_servers"></span>Middle Rule: Mystery Servers</h4>
<div class="paragraph"><p>This rule is interesting. It summarizes the two mystery servers
together into a node. Now it should be possible that the number of servers
is not fixed, and later there can sometimes be three or more,
or it could be that there are dozens of instances of the mystery
application — each with a different number of servers!</p></div>
<div class="paragraph"><p>The trick is in the child node generator type <span class="guihint">Create nodes based on a host search</span>.
This searches for existing hosts and creates nodes based on the hosts found.
It looks like this:</p></div>
<div class="imageblock"><div class="content"><img src="../images/bi_6_mystery_server_rule2.png" alt="bi 6 mystery server rule2"></div></div>
<div class="paragraph"><p>The whole thing works like this:</p></div>
<div class="olist arabic"><ol class="arabic">
<li><p>You formulate a search condition to find hosts.</p></li>
<li><p>A child node is created for each host found.</p></li>
<li><p>You can cut parts out of the found host names and provide these as parameters.</p></li>
</ol></div>
<div class="paragraph"><p>Finding is the beginning.
As usual there are host tags available.
In the example you can omit this and instead use the regular expression <code>srv-mys-(.*)</code> for the host name.
This matches to all host names starting with <code>srv-mys-</code>.
The <code>.*</code> stands for any string.</p></div>
<div class="paragraph"><p>It is important that the <code>.*</code> is <em>bracketed</em>, thus <code>(.*)</code>.
By using the parentheses the match forms a so-called <em>group</em>.
With this the text which exactly matches <code>.*</code> is captured (and stored) — here <code>1</code> or <code>2</code>.
The match groups are numbered internally. Here there is only one that receives the number 1.
You can then later access the matched text with <code>$1$</code>.</p></div>
<div class="paragraph"><p>The search will now find two hosts:</p></div>
<table class="table-responsive table-bordered table tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead><tr>
<th class="tableblock halign-left valign-top">Host name</th>
<th class="tableblock halign-left valign-top">Value for <code>$1$</code>
</th>
</tr></thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>srv-mys-1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>srv-mys-2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
</tbody>
</table>
<div class="paragraph"><p>For each host found you will now create a subnode with the <span class="guihint">Call a rule</span> function.
Select the rule <code>Mystery Server $NUMBER$</code> which you just created.
As the argument for <code>NUMBER</code> now pass the match group: <code>$1$</code>.</p></div>
<div class="paragraph"><p>Now the sub-rule <code>Mystery Server $NUMBER$</code> is called twice — once with <code>1</code> and once with <code>2</code>.</p></div>
<div class="paragraph"><p>If in the future a new server with the name <code>srv-mys-3</code> is added into the monitoring,
this will <strong>automatically</strong> appear in the BI aggregation!
The state of the host does not matter.
Even if the server is <span class="hstate1">DOWN</span>, it will of course <strong>not</strong> be removed from the aggregation!</p></div>
<div class="paragraph"><p>Granted, it is a very steep learning curve here. This method is
really complex. But once you have tried it and understood it,
you will realize just how powerful the whole concept is — and so far we have only scratched the surface of the possibilities!</p></div>
</div>
<div class="sect3">
<h4 id="heading__the_top_level_rule">
<span class="hidden-anchor sr-only" id="_the_top_level_rule"></span>The top-level rule</h4>
<div class="paragraph"><p>The new top-level node <span class="guihint">The Mystery Application</span> is now simple:
a new rule which has two child nodes of the <span class="guihint">Call a rule</span> type
is additionally necessary.
These two rules are the existing <span class="guihint">Infrastructure</span> rule,
and the just newly-created <span class="guihint">Mystery Servers</span> rule.</p></div>
</div>
</div>
<div class="sect2">
<h3 id="heading__creating_a_node_with_service_search">
<span class="hidden-anchor sr-only" id="_creating_a_node_with_service_search"></span>6.5. Creating a node with service search</h3>
<div class="paragraph"><p>Similar to the host search, there is also a child generator type called
<span class="guihint">Create nodes based on a service search</span>. Here is an example:</p></div>
<div class="imageblock"><div class="content"><img src="../images/bi_6_service_search.png" alt="bi 6 service search"></div></div>
<div class="paragraph"><p>You can use <code>()</code> here – bracketing partial expressions – both at the host and at the service,
where:</p></div>
<div class="ulist"><ul>
<li><p>If you choose <span class="guihint">Regex for host name</span> you <em>must</em> define exactly one parenthesis expression. The match text is then provided as <code>$1$</code>.</p></li>
<li><p>If you choose <span class="guihint">All hosts</span>, the complete host name will be provided as <code>$1$</code>.</p></li>
<li><p>You can use several subgroups in the service name. The associated match texts are provided as <code>$2$</code>, <code>$3$</code> and so on.</p></li>
</ul></div>
<div class="paragraph"><p>And never forget that you can always use <span class="image-inline"><img src="../images/icons/icon_help.png" alt="icon help"></span> to get inline help.</p></div>
</div>
<div class="sect2">
<h3 id="heading__all_other_services">
<span class="hidden-anchor sr-only" id="_all_other_services"></span>6.6. All other services</h3>
<div class="paragraph"><p>In your attempts you may have stumbled over the child generator
<span class="guihint">State of remaining services</span>.
This generates a node for any of your host’s services that have not yet been
sorted into your BI aggregation.
This is useful if you use BI to combine the states of all of a host’s services
into clearly-arranged groups - as it is is done in the included example.</p></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="heading_hostaggr">
<span class="hidden-anchor sr-only" id="hostaggr"></span>7. The predefined host aggregation</h2>
<div class="sectionbody">
<div class="paragraph"><p>As just mentioned you can also use BI to provide the services
of a host in a structured way. You combine all services into one
tree into an aggregation, and basically use the <span class="guihint">worst</span> function.
The overall state of a host will then only be displayed if there is a
problem with the host — you use BI as a clear 'drill down' method.</p></div>
<div class="paragraph"><p>For this purpose Checkmk already provides a predefined set of
rules which you just need to unlock. These rules are
optimized for rendering services on Windows or Linux hosts,
but of course you can customize them to your liking. You can find
all of the rules in the rule package <span class="guihint">Default</span>.
As usual, access the rules by clicking <span class="image-inline"><img src="../images/icons/icon_rules.png" alt="icon rules"></span>:</p></div>
<div class="imageblock"><div class="content"><img src="../images/bi_7_wato_start.png" alt="bi 7 wato start"></div></div>
<div class="paragraph"><p>There you will find a list of twelve rules (abbreviated here):</p></div>
<div class="imageblock"><div class="content"><img src="../images/bi_7_host_tree_rules.png" alt="bi 7 host tree rules"></div></div>
<div class="paragraph"><p>The first rule is the rule for the root of the tree. The symbol
<span class="image-inline"><img src="../images/icons/icon_aggr.png" alt="icon aggr"></span> for this rule takes you to a tree view.
Here you can see how the rules are nested among each other:</p></div>
<div class="imageblock"><div class="content"><img src="../images/bi_7_host_tree_tree.png" alt="bi 7 host tree tree" width="40%"></div></div>
<div class="paragraph"><p>Back in the list of rules, with the <span class="image-inline"><img src="../images/icons/button_aggregations.png" alt="button aggregations"></span> <span class="guihint">Aggregations</span> button you can access
the list of aggregations in this rule package — which consists of only one
Aggregation. In the <span class="image-inline"><img src="../images/icons/icon_edit.png" alt="icon edit"></span> Details simply uncheck the
checkbox at <span class="guihint">Currently disable this aggregation</span> and immediately get, per
host, an aggregation titled <code>Host myhost123</code>.
The result will then look like this, for example:</p></div>
<div class="imageblock"><div class="content"><img src="../images/bi_7_host_aggregation.png" alt="bi 7 host aggregation"></div></div>
</div>
</div>
<div class="sect1">
<h2 id="heading_permissions">
<span class="hidden-anchor sr-only" id="permissions"></span>8. Permissions and visibility</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="heading__permissions_for_editing">
<span class="hidden-anchor sr-only" id="_permissions_for_editing"></span>8.1. Permissions for editing</h3>
<div class="paragraph"><p>Again, back to the rule packages.
For all editing actions in BI you usually need to have the <span class="guihint">Administrator</span> role.
More precisely, for BI there are two <a href="wato_user.html#roles">permissions</a>, to find under <span class="guihint">Setup &gt; Users &gt; Roles &amp; permissions:</span></p></div>
<div class="imageblock"><div class="content"><img src="../images/bi_8_wato_permissions.png" alt="bi 8 wato permissions"></div></div>
<div class="paragraph"><p>By default the <span class="guihint">User</span> role is only the first of the two active permissions.
Normal users can only work in such rule packages for which they have been defined as a contact.
This is done in the <span class="image-inline"><img src="../images/icons/icon_edit.png" alt="icon edit"></span> Details of the rule package.</p></div>
<div class="paragraph"><p>In the following example <span class="guihint">Permitted Contact Groups</span> the <span class="guihint">The Mystery Admins</span> contact group has been authorized — thus all members of this group can now edit the rules in this package:</p></div>
<div class="imageblock"><div class="content"><img src="../images/bi_8_pack_properties.png" alt="bi 8 pack properties"></div></div>
<div class="paragraph"><p>By the way, with <span class="guihint">Public &gt; Allow all users to refer to rules contained in this pack</span>
you can allow other users to at least <strong>use</strong> the rules contained here — i.e. to (elsewhere) define their own rules — which can then invoke these rules as subnodes.</p></div>
</div>
<div class="sect2">
<h3 id="heading__permissions_on_hosts_and_services">
<span class="hidden-anchor sr-only" id="_permissions_on_hosts_and_services"></span>8.2. Permissions on Hosts and Services</h3>
<div class="paragraph"><p>How is it with the actual visibility of the aggregations in the
Status Interface? Which contacts are allowed to see something?</p></div>
<div class="paragraph"><p>Well, you cannot assign any rights in the BI aggregations themselves.
This is performed indirectly through the visibility of the hosts and services,
and it is governed by the <span class="guihint">See all hosts and services</span> option under
<span class="guihint">Setup &gt; Roles &amp; Permissions:</span></p></div>
<div class="imageblock"><div class="content"><img src="../images/bi_8_see_all.png" alt="bi 8 see all"></div></div>
<div class="paragraph"><p>In the <span class="guihint">User</span> role, this right is by default disabled.
Normal users can see only shared hosts and services,
and in BI these are expressed in such a way that they can see exactly all of
the BI aggregations which contain at least one shared host or service.
Such aggregations however contain <strong>only</strong> these authorized objects,
and they may therefore be somewhat 'thinned out'.
And this in turn means that they can have different states for different users!</p></div>
<div class="paragraph"><p>Whether that is good or bad depends on what you want.
If in doubt you can toggle the permission, and through a detour via BI allow some
or all users to see hosts and services for which they are not contacts — and thus
ensure that the state of an aggregation is always the same for everyone.</p></div>
<div class="paragraph"><p>Of course this whole issue only matters if there are in fact aggregations that are
so colorfully thrown together that only some users are contacts only for parts of it.</p></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="heading_operating">
<span class="hidden-anchor sr-only" id="operating"></span>9. BI in Operation Part 3: Maintenance times, acknowledgments</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="heading__the_general_idea">
<span class="hidden-anchor sr-only" id="_the_general_idea"></span>9.1. The General Idea</h3>
<div class="paragraph"><p>How does BI actually manage <span class="image-inline"><img src="../images/icons/icon_downtime.png" alt="icon downtime"></span> <a href="basics_downtimes.html">maintenance times</a>?
Well, we have thought long and hard about the matter, and discussed it with many users — the result is as follows:</p></div>
<div class="ulist"><ul>
<li><p>You can not put a BI unit itself directly into a maintenance time — but you do not have to, because …​</p></li>
<li><p>The maintenance time for a BI aggregation is derived automatically from the maintenance times of its hosts and services.</p></li>
</ul></div>
<div class="paragraph"><p>To understand which rule BI calculates the „in maintenance“ state, it helps when you are
reminded of what the real idea behind maintenance times is:
<em>The object in question is currently being worked on. Failures can be expected. Even if the object is currently <span class="state0">OK</span>, you should not rely on it. It can become <span class="state2">CRIT</span> at any time. This is known and documented — it should therefore not trigger a notification.</em></p></div>
<div class="paragraph"><p>This idea can be transferred 1:1 into BI: In the aggregation there may be a few hosts and
services that are currently in maintenance. Whether these are just <span class="state0">OK</span> or <span class="state2">CRIT</span> does not
play a role, because it is actually a coincidence if during the maintenance work the objects
sometimes go off and on again, or not. Just because there is a maintenance object in the unit
it does not immediately mean that the application that maps the aggregation is itself 'threatened'
and must also be marked as „in maintenance“. It can also have an installed redundancy which
compensates for the failure of the objects in maintenance. Only if such a failure would actually
lead to a <span class="state2">CRIT</span> state for the aggregation — so there is not <em>not</em> enough redundancy and the
aggregation really is threatened — only then will Checkmk mark it as 'in maintenance'.
Where here as well the <em>current</em> state of the objects generally does not matter.</p></div>
<div class="paragraph"><p>To put it more concisely, the exact rule is as follows:</p></div>
<div class="paragraph"><p>If a <span class="state2">CRIT</span> state of a host/service <strong>would</strong> result in a <span class="state2">CRIT</span> state of the aggregation, an „in maintenance“ state of that host/service results in an „in maintenance“ state of the aggregation.</p></div>
<div class="paragraph"><p>Important: the <em>real</em> current state of the hosts/services plays <em>no</em> role in the calculation - what is in maintenance is assumed to be <span class="state2">CRIT</span> in the BI logic. Why? Because an <span class="hstate0">UP</span> or <span class="state0">OK</span> state during a maintenance period is pure coincidence, for example if a host reports <span class="hstate0">UP</span> for a few seconds in between several restarts.</p></div>
<div class="paragraph"><p>And here we have another example. To save space, this is a variant with only one mystery server instead of two:</p></div>
<div class="imageblock"><div class="content"><img src="../images/bi_9_downtimes.png" alt="bi 9 downtimes"></div></div>
<div class="paragraph"><p>First, the host <code>switch-1</code> is under maintenance.
For the <code>Infrastructure</code> node this has no effect, because <code>switch-2</code>
is <em>not</em> in maintenance, and thus <code>Infrastructure</code> is also
not in maintenance. There is therefore no icon <span class="image-inline"><img src="../images/icons/icon_derived_downtime.png" alt="icon derived downtime"></span> for
derived maintenance times.</p></div>
<div class="paragraph"><p>But, the service <code>Memory</code> on <code>srv-mys-1</code> is also under maintenance.
This one is <em>not</em> redundant. The maintenance is therefore inherited by the
father node <code>Mystery Server 1</code>, then continues up to <code>Mystery Servers</code>
and finally to the top node <code>The Mystery Application</code>.
So this top node is also in maintenance.</p></div>
</div>
<div class="sect2">
<h3 id="heading__the_maintenance_time_command">
<span class="hidden-anchor sr-only" id="_the_maintenance_time_command"></span>9.2. The Maintenance Time Command</h3>
<div class="paragraph"><p>We wrote above that you cannot manually put a BI aggregation into maintenance time?
That’s only half true, since in fact you can find a <span class="image-inline"><img src="../images/icons/icon_commands.png" alt="icon commands"></span> command
for setting maintenance times in BI aggregations!
But this does nothing more than to record a maintenance entry
for <em>each host and service</em> in the aggregation!
This of course usually leads to the aggregation itself being flagged as in maintenance.
But that is only indirect.</p></div>
</div>
<div class="sect2">
<h3 id="heading__tuning_options">
<span class="hidden-anchor sr-only" id="_tuning_options"></span>9.3. Tuning Options</h3>
<div class="paragraph"><p>Above you have seen that the maintenance time calculation is based on an
assumed <span class="state2">CRIT</span> state. In the properties of an aggregation you can customize the
algorithm so that a node that assumes the <span class="state1">WARN</span> state is marked as in maintenance.
The option for this is called <span class="guihint">Escalate downtimes based on aggregated WARN state</span>:</p></div>
<div class="imageblock"><div class="content"><img src="../images/bi_9_downtimes_on_warn.png" alt="bi 9 downtimes on warn"></div></div>
<div class="paragraph"><p>The basic assumption remains that objects under maintenance are <span class="state2">CRIT</span>.
There is only a difference where, due to the aggregation function in which
a <span class="state2">CRIT</span> can become a <span class="state1">WARN</span> — as was the case in our very first example
with <span class="guihint">Count the number of nodes in state OK</span>.
Here a maintenance time would already have been be accepted if only one of the
two switches was in maintenance.</p></div>
</div>
<div class="sect2">
<h3 id="heading__acknowledgments">
<span class="hidden-anchor sr-only" id="_acknowledgments"></span>9.4. Acknowledgments</h3>
<div class="paragraph"><p>Quite similar to the process with the maintenance times is that if a problem
has been <span class="image-inline"><img src="../images/icons/icon_ack.png" alt="icon ack"></span> <a href="basics_ackn.html">acknowledged</a> the information is also
calculated automatically by BI.
This time the state of the objects certainly plays a role.</p></div>
<div class="paragraph"><p>The idea here is to transfer the following concept to BI:
An object has a problem (<span class="state1">WARN</span>, <span class="state2">CRIT</span>), but this is known, and someone is
working on it (<span class="image-inline"><img src="../images/icons/icon_ack.png" alt="icon ack"></span>).</p></div>
<div class="paragraph"><p>You can calculate this for an aggregation as follows:</p></div>
<div class="ulist"><ul>
<li><p>Suppose that all hosts and services that have <span class="image-inline"><img src="../images/icons/icon_ack.png" alt="icon ack"></span> acknowledged problems are <span class="state0">OK</span> again.</p></li>
<li><p>Then would the unit itself again be <span class="state0">OK</span>? Exactly then it is also acknowledged as <span class="image-inline"><img src="../images/icons/icon_ack.png" alt="icon ack"></span>.</p></li>
</ul></div>
<div class="paragraph"><p>However if the aggregation were to remain <span class="state1">WARN</span> or <span class="state2">CRIT</span>,
then it would <strong>not</strong> be considered as acknowledged, because then there must be at
least one important problem that has not been acknowledged, and thus the <span class="state0">OK</span> state
will be removed from the unit.</p></div>
<div class="paragraph"><p>By the way, the <span class="image-inline"><img src="../images/icons/icon_commands.png" alt="icon commands"></span> will offer you a command
for the BI aggregation to acknowledge its problems, but this only means
that <em>all</em> hosts and services detected in the aggregation will be acknowledged
(only those which currently have problems).</p></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="heading_freeze">
<span class="hidden-anchor sr-only" id="freeze"></span>10. Making changes visible</h2>
<div class="sectionbody">
<div class="paragraph"><p>The nodes of an aggregation can sometimes change during operation.
By using <em>frozen aggregations</em> you can make such changes visible.</p></div>
<div class="paragraph"><p>Here is an example:
A switch with 6 ports should be <span class="state0">OK</span> when 5 of its services/ports are <span class="state0">OK</span>.
However, as part of a firmware update, 2 of the ports are renamed and their associated services disappear from the monitoring.</p></div>
<div class="paragraph"><p>The aggregation would then consist of 4 services with state <span class="state0">OK</span>, but the aggregation itself would be <span class="state1">WARN</span> or <span class="state2">CRIT</span> — without providing any indication of the reason.
This is exactly where frozen aggregations come in:
You freeze the current state, and later you can click to list what has changed since then, i.e. which nodes have been added or dropped out.
In other words, while the rules of an aggregation indicate its state, frozen aggregations inform of state changes.</p></div>
<div class="sect2">
<h3 id="heading__freezing_and_comparing">
<span class="hidden-anchor sr-only" id="_freezing_and_comparing"></span>10.1. Freezing and comparing</h3>
<div class="paragraph"><p>Using the freeze function is very simple:
Enable the <span class="guihint">New aggregations are frozen</span> option in <span class="guihint">Aggregation Properties</span>.</p></div>
<div class="imageblock"><div class="content"><img src="../images/bi_freeze_option.png" alt="Option to freeze an aggregation."></div></div>
<div class="paragraph"><p>This will freeze the aggregation when it is saved — and will do so whenever the check mark is newly set;
even if the aggregation has previously existed (despite the reference to <span class="guihint">New aggregations …​</span>).
To unfreeze the frozen status, remove the check mark accordingly.</p></div>
<div class="paragraph"><p>In the monitoring, you will now see a new <span class="image-inline"><img src="../images/icons/icon_bi_freeze.png" alt="snowflake icon"></span> snowflake icon next to the aggregation.
This will take you to the view showing the differences:
On the left the frozen tree, on the right the current tree with the changes highlighted (here the removal of the service <span class="guihint">backup3)</span>:</p></div>
<div class="imageblock">
<div class="content"><img src="../images/bi_freeze_diff.png" alt="Differences between the frozen and the current states of an aggregation."></div>
<div class="title">Without the frozen state option the removal of <span class="guihint">backup3</span> would remain unnoticed</div>
</div>
<div class="paragraph"><p>If you again want to freeze the current state, you can do this via <span class="guihint">Commands &gt; Freeze aggregations</span>.
But be careful: There is always only one frozen current state and no history including older states.</p></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="heading_availability">
<span class="hidden-anchor sr-only" id="availability"></span>11. Availability</h2>
<div class="sectionbody">
<div class="paragraph"><p>Exactly as with hosts and services, you can also access the BI <a href="availability.html">availability</a>
of one or more aggregations for any period of time in the past.
To do this the BI module reconstructs the state based on the history of the aggregation’s hosts
and services for each past time period. Thus you can also calculate availability for such
periods in which the unit was not yet configured!</p></div>
<div class="imageblock"><div class="content"><img src="../images/bi_10_availability_example.png" alt="bi 10 availability example"></div></div>
<div class="paragraph"><p>For full details on BI and availability, see the availability article in the
section on <a href="availability.html#bi">BI</a>.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="heading__bi_in_distributed_monitoring">
<span class="hidden-anchor sr-only" id="_bi_in_distributed_monitoring"></span>12. BI in Distributed Monitoring</h2>
<div class="sectionbody">
<div class="paragraph"><p>What is actually happening in BI in a <a href="distributed_monitoring.html">distributed environment</a>?
That is, when the hosts are spread across multiple monitoring servers?</p></div>
<div class="paragraph"><p>The answer is relatively simple: it works — without you needing to pay attention to anything.
Because BI is a component of the GUI, and as standard this is delivered with distributed environment support-capability, it is completely transparent to BI.</p></div>
<div class="paragraph"><p>Should a location be currently unavailable or manually hidden by you from the GUI,
the site hosts no longer exist for BI.
That then means:</p></div>
<div class="ulist"><ul>
<li><p>BI aggregations which are constructed <em>exclusively</em> from objects at this location disappear.</p></li>
<li><p>BI aggregations that are constructed <em>partially</em> from objects at this location are thinned out.</p></li>
</ul></div>
<div class="paragraph"><p>In the latter case, of course, this can affect the state of the affected aggregations.
What exact effects it can have depend on your aggregation’s functions.
If you, for example, have used <span class="guihint">worst</span> everywhere, the state overall
simply stays the same or gets better, because objects at the no-longer existing location
could already have had <span class="state1">WARN</span> or <span class="state2">CRIT</span>. Of course other states can also arise for other
aggregation functions.</p></div>
<div class="paragraph"><p>Whether or not this behavior is practical for your operation will have to be assessed
for individual cases.
BI is in any case constructed so that nonexistent objects cannot by included in an
aggregation, and thus cannot be missed, because all BI rules work — as already explained above — exclusively with search patterns.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="heading_biasservice">
<span class="hidden-anchor sr-only" id="biasservice"></span>13. Notifications, BI as a service</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="heading__active_checks_or_data_source_programs">
<span class="hidden-anchor sr-only" id="_active_checks_or_data_source_programs"></span>13.1. Active Checks or Data Source Programs</h3>
<div class="imageblock inline-image"><div class="content"><img src="../images/bi_large_icon_notifications.png" alt="bi large icon notifications" width="80"></div></div>
<div class="paragraph"><p>Can you actually <a href="notifications.html">notify</a> of state changes in BI aggregations?
Well — that’s not directly-possible at first, since BI exists exclusively in the GUI
and has no relation to the actual monitoring. But you can turn BI aggregations into normal
services, and these can in turn of course trigger notifications.
There are two possibilities:</p></div>
<div class="ulist"><ul>
<li><p>Using the data source program <span class="guihint">Check state of BI Aggregations</span></p></li>
<li><p>With Active Checks of the <span class="guihint">Check State of BI Aggregation</span> type</p></li>
</ul></div>
</div>
<div class="sect2">
<h3 id="heading__notifications_via_a_data_source_program">
<span class="hidden-anchor sr-only" id="_notifications_via_a_data_source_program"></span>13.2. Notifications via a data source program</h3>
<div class="paragraph"><p>We will start with the <a href="datasource_programs.html">data source program</a> method,
because this is always good if you wish to generate more than a handful of
aggregations as services.
You will find the appropriate rule set under <span class="guihint">Setup &gt; Agents &gt; Other integrations &gt; BI Aggregations:</span></p></div>
<div class="imageblock"><div class="content"><img src="../images/bi_12_datasource_program.png" alt="bi 12 datasource program"></div></div>
<div class="paragraph"><p>Here you can even specify different options for which hosts the services should be added.
You do not necessarily have to stick to the host which is running the data source program
(<span class="guihint">Assign to the querying host</span>).
It is also possible to assign to the hosts which are affected by the aggregation
(<span class="guihint">Assign to the affected hosts</span>).
That however only makes sense if it concerns only a single Host.
Regular expressions and substitutions can make you even more flexible with assignments.
The whole thing is then performed via the <a href="piggyback.html">piggyback mechanism</a>.</p></div>
<div class="paragraph"><p><strong>Important:</strong> If the host to which you assign this rule should continue to be monitored through the normal agent, ensure in its settings that Agent <strong>and</strong> data source programs are run:</p></div>
<div class="imageblock"><div class="content"><img src="../images/bi_12_agent_and_all_ds_program.png" alt="bi 12 agent and all ds program"></div></div>
</div>
<div class="sect2">
<h3 id="heading__notifications_via_an_active_check">
<span class="hidden-anchor sr-only" id="_notifications_via_an_active_check"></span>13.3. Notifications via an active check</h3>
<div class="paragraph"><p>Notification with an active check is more or less the more direct way, and it requires
no artificial 'helper host' when executing the data source program, since it has to query each unit individually, but with larger numbers of aggregations it is significantly less efficient and also more complicated to set up.</p></div>
<div class="paragraph"><p>Putting it all simply: There is an active check which can retrieve the state of BI aggregations using HTTP from the REST API of Checkmk.
You can easily set this up with the
<span class="guihint">Setup &gt; Services &gt; Other services &gt; Check State of BI Aggregation</span> rule set:</p></div>
<div class="imageblock"><div class="content"><img src="../images/bi_12_active_check_rule.png" alt="bi 12 active check rule"></div></div>
<div class="paragraph"><p>Note the following:</p></div>
<div class="ulist"><ul>
<li><p>Enable this rule only for the host that should receive the corresponding new BI service.</p></li>
<li><p>The URL must be the one that allows <strong>this host</strong> to access the Checkmk GUI.</p></li>
<li><p>The user must be an <a href="wato_user.html#automation">automation user</a> — only such users may call the REST API. The <code>automation</code> user offers itself here as it is always created automatically for such purposes.</p></li>
<li><p>At <span class="guihint">Automation Secret</span> enter user’s <span class="guihint">Automation secret for machine accounts</span>, which you find in the configuration mask of the user properties (only if you use another automation user than <code>automation</code>).</p></li>
</ul></div>
<div class="paragraph"><p>In the example <span class="guihint">Automatically track downtimes of aggregation</span> is activated.
Strictly speaking, this means the <em>scheduled</em> downtimes — thus the planned maintenance times.
This will make the new active service automatically get a maintenance time,
even if the BI aggregation also does this!</p></div>
<div class="paragraph"><p>The new service then shows — with a delay of up to one
Check Interval of course — the state of the unit.
The example shows the BI-Check on the host <code>srv-mys-1</code>:</p></div>
<div class="imageblock"><div class="content"><img src="../images/bi_12_active_check_output.png" alt="bi 12 active check output"></div></div>
<div class="paragraph"><p>As usual you can assign this service to contacts and use it as a basis for a notifications.</p></div>
</div>
</div>
</div>
</div></main><div id="toc" class="toc2">
<div id="toctitle">On this page</div>
<ul class="sectlevel1">
<li><a href="#_introduction">1. Introduction</a></li>
<li>
<a href="#first">2. Configuration Part 1: The first aggregation</a><ul class="sectlevel1">
<li><a href="#_terminology">2.1. Terminology</a></li>
<li><a href="#_an_example">2.2. An example</a></li>
<li><a href="#_your_first_bi_rule">2.3. Your first BI rule</a></li>
<li><a href="#_your_first_aggregation">2.4. Your first aggregation</a></li>
</ul>
</li>
<li>
<a href="#statusgui">3. BI in Operation Part 1: The Status view</a><ul class="sectlevel1">
<li>
<a href="#_displaying_all_aggregations">3.1. Displaying all aggregations</a><ul class="sectlevel2"><li><a href="#_creating_views_for_bi">Creating views for BI</a></li></ul>
</li>
<li><a href="#_working_with_the_tree">3.2. Working with the tree</a></li>
<li><a href="#_trying_bi_what_if">3.3. Trying BI: what if?</a></li>
<li><a href="#_testing_bi_using_fake_states">3.4. Testing BI using fake states</a></li>
<li><a href="#_bi_groups">3.5. BI-groups</a></li>
<li><a href="#_from_hostservice_to_aggregation">3.6. From host/service to aggregation</a></li>
</ul>
</li>
<li><a href="#multilevel">4. Configuration Part 2: Multi-level trees</a></li>
<li>
<a href="#displayoptions">5. BI in operation Part 2: Alternative displays</a><ul class="sectlevel1">
<li>
<a href="#_introduction_2">5.1. Introduction</a><ul class="sectlevel2">
<li><a href="#_instantly_expand_or_collapse_trees">Instantly expand or collapse trees</a></li>
<li><a href="#_only_show_problems">Only show problems</a></li>
<li><a href="#_types_of_tree_displays">Types of tree displays</a></li>
</ul>
</li>
<li><a href="#_more_options">5.2. More options</a></li>
<li>
<a href="#visualization">5.3. Visualizing BI aggregations</a><ul class="sectlevel2">
<li><a href="#_customizing_a_display">Customizing a display</a></li>
<li><a href="#_specifying_layout_styles_for_bi_rules">Specifying layout styles for BI-Rules</a></li>
<li><a href="#_the_search_function">The search function</a></li>
</ul>
</li>
</ul>
</li>
<li>
<a href="#config3">6. Configuration Part 3: Variables, Templates, Searches</a><ul class="sectlevel1">
<li><a href="#_configuration_with_more_intelligence">6.1. Configuration with more intelligence</a></li>
<li>
<a href="#_parameters">6.2. Parameters</a><ul class="sectlevel2"><li><a href="#_prefix_match_is_the_default_for_service_name">Prefix match is the default for service name</a></li></ul>
</li>
<li><a href="#_regular_expressions_missing_objects">6.3. Regular expressions, missing objects</a></li>
<li>
<a href="#_creating_a_node_as_the_result_of_a_search">6.4. Creating a node as the result of a search</a><ul class="sectlevel2">
<li><a href="#_bottom_rule_mystery_server_x">Bottom Rule: Mystery Server X</a></li>
<li><a href="#_middle_rule_mystery_servers">Middle Rule: Mystery Servers</a></li>
<li><a href="#_the_top_level_rule">The top-level rule</a></li>
</ul>
</li>
<li><a href="#_creating_a_node_with_service_search">6.5. Creating a node with service search</a></li>
<li><a href="#_all_other_services">6.6. All other services</a></li>
</ul>
</li>
<li><a href="#hostaggr">7. The predefined host aggregation</a></li>
<li>
<a href="#permissions">8. Permissions and visibility</a><ul class="sectlevel1">
<li><a href="#_permissions_for_editing">8.1. Permissions for editing</a></li>
<li><a href="#_permissions_on_hosts_and_services">8.2. Permissions on Hosts and Services</a></li>
</ul>
</li>
<li>
<a href="#operating">9. BI in Operation Part 3: Maintenance times, acknowledgments</a><ul class="sectlevel1">
<li><a href="#_the_general_idea">9.1. The General Idea</a></li>
<li><a href="#_the_maintenance_time_command">9.2. The Maintenance Time Command</a></li>
<li><a href="#_tuning_options">9.3. Tuning Options</a></li>
<li><a href="#_acknowledgments">9.4. Acknowledgments</a></li>
</ul>
</li>
<li>
<a href="#freeze">10. Making changes visible</a><ul class="sectlevel1"><li><a href="#_freezing_and_comparing">10.1. Freezing and comparing</a></li></ul>
</li>
<li><a href="#availability">11. Availability</a></li>
<li><a href="#_bi_in_distributed_monitoring">12. BI in Distributed Monitoring</a></li>
<li>
<a href="#biasservice">13. Notifications, BI as a service</a><ul class="sectlevel1">
<li><a href="#_active_checks_or_data_source_programs">13.1. Active Checks or Data Source Programs</a></li>
<li><a href="#_notifications_via_a_data_source_program">13.2. Notifications via a data source program</a></li>
<li><a href="#_notifications_via_an_active_check">13.3. Notifications via an active check</a></li>
</ul>
</li>
</ul>
</div>
<script src="../../assets/js/manifest.js?id=7db827d654313dce4250"></script>
<script src="../../assets/js/vendor.js?id=581a3d4a61b7156d04df"></script>
<script src="../../assets/js/app.js?id=959ccd04b1f8b7b78c5e"></script>
<script src="../../assets/js/lunr.js"></script>
<script src="../../assets/js/lunr.stemmer.support.js"></script>
<script src="../lunr.index.en.js"></script>
<script src="../../assets/js/lunr.client.js"></script>
</body>
</html>
