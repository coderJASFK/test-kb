<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]--><meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<link rel="icon" href="/favicon.png">
<meta name="description" content="With the agent plug-in for Windows, Linux, Solaris and AIX you can fully monitor Oracle databases. Details about the configuration can be found here.">
<meta name="og:locale" content="en">
<meta name="og:site_name" content="Checkmk Docs">
<meta name="og:title" content="Monitoring Oracle databases">
<meta name="og:description" content="With the agent plug-in for Windows, Linux, Solaris and AIX you can fully monitor Oracle databases. Details about the configuration can be found here.">
<meta name="og:image" content="https://docs.checkmk.com/assets/images/share_image.png">
<meta name="twitter:site" content="@checkmk">
<meta name="twitter:creator" content="@checkmk">
<title>Monitoring Oracle databases</title>
<link rel="stylesheet" href="../../assets/css/checkmk.css?id=4473d2acbb1ea6136428">
<link rel="stylesheet" href="../../assets/css/pygments-monokai.css">
<link rel="stylesheet" href="../../assets/css/addons.css">
<link rel="stylesheet" href="../../assets/css/SourceCodePro.css">
<link rel="search" href="./opensearch.xml" type="application/opensearchdescription+xml" title="Search docs.checkmk.com">
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-NJ3VGL8');</script>
<!-- End Google Tag Manager --><style>
#staticinfo { font-style: italic; }
</style>
</head>
<body class="article toc2 toc-right">
<!-- Cookie Consent (GDPR Compliance) -->

<!-- End Cookie Consent (GDPR Compliance) -->
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NJ3VGL8" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) --><div class="header-top">
<div class="header-top__left">
<a class="header-top__logo d-none d-xl-inline-block" href="/latest/en"><img src="../../assets/images/docs_logo.png" alt="Checkmk"></a><a class="header-top__icon d-inline-block d-xl-none" href="/latest/en"><img src="../../assets/images/logo_icon.svg" alt="Checkmk"></a>
</div>
<div class="header-top__center">
<input type="text" class="header-top__search" placeholder="Search the checkmk docs"><div class="header-top__search__results"></div>
</div>
<div class="header-top__right d-block">
<button class="header-top__search__toggle d-inline-block d-md-none"><img class="header-top__search__toggle__icon" src="../../assets/images/search.svg" alt="Search"></button><div class="dropdown dropdown__language">
                    <button class="btn dropdown-toggle" type="button" id="languageMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">en</button>
                    <div class="dropdown-menu  dropdown-menu-right" aria-labelledby="languageMenuButton"><a class="dropdown-item" href="../../latest/de/monitoring_oracle.html">Deutsch</a></div>
</div>
<div class="dropdown dropdown__branch">
                        <button class="btn dropdown-toggle" type="button" id="branchMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">latest (2.3.0)</button>
                        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="branchMenuButton">
<a class="dropdown-item" href="../../2.1.0/en/monitoring_oracle.html">2.1.0</a><a class="dropdown-item" href="../../2.2.0/en/monitoring_oracle.html">2.2.0</a>
</div>
</div>
<a class="header-top__back d-none d-lg-inline-block" href="https://checkmk.com">to checkmk.com</a><button class="header-top__toggle d-inline-block d-lg-none"><span class="header-top__toggle__icon"></span></button>
</div>
</div>
<aside><div class="main-nav">
<div class="main-nav__content"><div id="content">
<div class="sect1">
<h2 id="_welcome_to_checkmk">
<a class="anchor" href="#_welcome_to_checkmk"></a>1. Welcome to Checkmk</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="welcome.html">Welcome to the Checkmk User Guide</a></p>
</li>
<li>
<p><a href="release_notes.html">Release notes</a></p>
</li>
<li>
<p><a href="glossar.html">Glossary</a></p>
</li>
<li>
<p><a href="search.html">Searching docs.checkmk.com</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_beginners_guide">
<a class="anchor" href="#_beginners_guide"></a>2. Beginner’s Guide</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="intro_setup.html">Setting up Checkmk</a></p>
</li>
<li>
<p><a href="intro_gui.html">The Checkmk user interface</a></p>
</li>
<li>
<p><a href="intro_setup_monitor.html">Setting up monitoring</a></p>
</li>
<li>
<p><a href="intro_tools.html">The monitoring tools</a></p>
</li>
<li>
<p><a href="intro_monitor.html">Checkmk in monitoring</a></p>
</li>
<li>
<p><a href="intro_finetune.html">Fine-tuning the monitoring</a></p>
</li>
<li>
<p><a href="intro_users.html">Working with multiple users</a></p>
</li>
<li>
<p><a href="intro_notifications.html">Switching on notifications</a></p>
</li>
<li>
<p><a href="intro_extend.html">Extending the monitoring system further</a></p>
</li>
<li>
<p><a href="intro_bestpractise.html">Best practices, tips &amp; tricks</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_installation">
<a class="anchor" href="#_installation"></a>3. Installation</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="install_packages.html">Basic information on the installation of Checkmk</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_server_and_vms">
<a class="anchor" href="#_server_and_vms"></a>3.1. Server and VMs</h3>
<div class="ulist">
<ul>
<li>
<p><a href="install_packages_debian.html">Installation on Debian and Ubuntu</a></p>
</li>
<li>
<p><a href="install_packages_redhat.html">Installation on Red Hat and derivatives</a></p>
</li>
<li>
<p><a href="install_packages_sles.html">Installation on SUSE Linux Enterprise Server</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_appliance_container_cloud">
<a class="anchor" href="#_appliance_container_cloud"></a>3.2. Appliance, container, cloud</h3>
<div class="ulist">
<ul>
<li>
<p><a href="install_appliance_cmk.html">Installation of Checkmk in the appliance</a></p>
</li>
<li>
<p><a href="introduction_docker.html">Installation as a Docker container</a></p>
</li>
<li>
<p><a href="install_azure.html">Installation from Azure Marketplace</a></p>
</li>
<li>
<p><a href="install_aws.html">Installation from AWS Marketplace</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_updates">
<a class="anchor" href="#_updates"></a>3.3. Updates</h3>
<div class="ulist">
<ul>
<li>
<p><a href="update.html">Updates and Upgrades</a></p>
</li>
<li>
<p><a href="update_major.html">Update to version <span class="new">2.3.0</span></a></p>
</li>
<li>
<p><a href="update_matrix.html">Update matrix for version <span class="new">2.3.0</span></a></p>
</li>
<li>
<p><a href="release_upgrade.html">Linux upgrade on the Checkmk server</a></p>
</li>
<li>
<p><a href="cmk_versions.html">Checkmk versions</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_administration_of_checkmk">
<a class="anchor" href="#_administration_of_checkmk"></a>4. Administration of Checkmk</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_server">
<a class="anchor" href="#_server"></a>4.1. Server</h3>
<div class="ulist">
<ul>
<li>
<p><a href="saml.html">Authentication with SAML</a></p>
</li>
<li>
<p><a href="kerberos.html">Single sign-on with Kerberos</a></p>
</li>
<li>
<p><a href="managing_docker.html">Checkmk server in a Docker container</a></p>
</li>
<li>
<p><a href="security.html">Security</a></p>
</li>
<li>
<p><a href="ports.html">Ports</a></p>
</li>
<li>
<p><a href="omd_https.html">Securing the web interface with HTTPS</a></p>
</li>
<li>
<p><a href="support_diagnostics.html">Support diagnostics</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_sites">
<a class="anchor" href="#_sites"></a>4.2. Sites</h3>
<div class="ulist">
<ul>
<li>
<p><a href="omd_basics.html">Site administration with omd</a></p>
</li>
<li>
<p><a href="cmk_commandline.html">Checkmk on the command line</a></p>
</li>
<li>
<p><a href="license.html">Managing licenses</a></p>
</li>
<li>
<p><a href="distributed_monitoring.html">Distributed monitoring</a></p>
</li>
<li>
<p><a href="backup.html">Backups</a></p>
</li>
<li>
<p><a href="password_store.html">Password store</a></p>
</li>
<li>
<p><a href="analyze_configuration.html">Analyzing the Checkmk site configuration</a></p>
</li>
<li>
<p><a href="mkps.html">Checkmk extension packages (MKPs)</a></p>
</li>
<li>
<p><a href="mkp_viewables.html">MKPs for GUI extensions</a></p>
</li>
<li>
<p><a href="simulation_mode.html">Simulation mode</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_configuration">
<a class="anchor" href="#_configuration"></a>5. Configuration</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="wato.html">Configuring Checkmk</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_hosts">
<a class="anchor" href="#_hosts"></a>5.1. Hosts</h3>
<div class="ulist">
<ul>
<li>
<p><a href="hosts_setup.html">Host administration</a></p>
</li>
<li>
<p><a href="hosts_structure.html">Host structuring</a></p>
</li>
<li>
<p><a href="host_tags.html">Host tags</a></p>
</li>
<li>
<p><a href="dcd.html">Dynamic host configuration</a></p>
</li>
<li>
<p><a href="hosts_autoregister.html">Automated host creation</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_services">
<a class="anchor" href="#_services"></a>5.2. Services</h3>
<div class="ulist">
<ul>
<li>
<p><a href="wato_services.html">Understanding and configuring services</a></p>
</li>
<li>
<p><a href="clustered_services.html">Monitoring cluster services</a></p>
</li>
<li>
<p><a href="piggyback.html">The piggyback mechanism</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_rules">
<a class="anchor" href="#_rules"></a>5.3. Rules</h3>
<div class="ulist">
<ul>
<li>
<p><a href="wato_rules.html">Rules</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_supporting_configurations">
<a class="anchor" href="#_supporting_configurations"></a>5.4. Supporting configurations</h3>
<div class="ulist">
<ul>
<li>
<p><a href="timeperiods.html">Time periods</a></p>
</li>
<li>
<p><a href="labels.html">Labels</a></p>
</li>
<li>
<p><a href="regexes.html">Regular expressions in Checkmk</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_users_and_permissions">
<a class="anchor" href="#_users_and_permissions"></a>5.5. Users and permissions</h3>
<div class="ulist">
<ul>
<li>
<p><a href="wato_user.html">Users, roles and permissions</a></p>
</li>
<li>
<p><a href="ldap.html">User management with LDAP/Active Directory</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_notifications">
<a class="anchor" href="#_notifications"></a>5.6. Notifications</h3>
<div class="ulist">
<ul>
<li>
<p><a href="notifications.html">Notifications</a></p>
</li>
<li>
<p><a href="notifications_webex.html">Notifications via Cisco Webex Teams</a></p>
</li>
<li>
<p><a href="notifications_ilert.html">Notifications via ilert</a></p>
</li>
<li>
<p><a href="notifications_jira.html">Notifications via Jira</a></p>
</li>
<li>
<p><a href="notifications_mattermost.html">Notifications via Mattermost</a></p>
</li>
<li>
<p><a href="notifications_teams.html">Notifications via Microsoft Teams</a></p>
</li>
<li>
<p><a href="notifications_pagerduty.html">Notifications via PagerDuty</a></p>
</li>
<li>
<p><a href="notifications_pushover.html">Notifications via Pushover</a></p>
</li>
<li>
<p><a href="notifications_opsgenie.html">Notifications via Opsgenie</a></p>
</li>
<li>
<p><a href="notifications_servicenow.html">Notifications via ServiceNow</a></p>
</li>
<li>
<p><a href="notifications_signl4.html">Notifications via SIGNL4</a></p>
</li>
<li>
<p><a href="notifications_slack.html">Notifications via Slack</a></p>
</li>
<li>
<p><a href="notifications_splunkoncall.html">Notifications via Splunk On-Call</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_events">
<a class="anchor" href="#_events"></a>5.7. Events</h3>
<div class="ulist">
<ul>
<li>
<p><a href="ec.html">The Event Console</a></p>
</li>
<li>
<p><a href="alert_handlers.html">Alert handlers</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_monitoring_systems">
<a class="anchor" href="#_monitoring_systems"></a>6. Monitoring systems</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="wato_monitoringagents.html">Monitoring agents</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_checkmk_agents_and_snmp">
<a class="anchor" href="#_checkmk_agents_and_snmp"></a>6.1. Checkmk agents and SNMP</h3>
<div class="ulist">
<ul>
<li>
<p><a href="agent_deployment.html">Automatic agent updates</a></p>
</li>
<li>
<p><a href="agent_linux.html">Monitoring Linux</a></p>
</li>
<li>
<p><a href="agent_linux_legacy.html">Monitoring Linux in legacy mode</a></p>
</li>
<li>
<p><a href="agent_windows.html">Monitoring Windows</a></p>
</li>
<li>
<p><a href="agent_freebsd.html">Monitoring FreeBSD</a></p>
</li>
<li>
<p><a href="snmp.html">Monitoring via SNMP</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_agent_extensions">
<a class="anchor" href="#_agent_extensions"></a>6.2. Agent extensions</h3>
<div class="ulist">
<ul>
<li>
<p><a href="inventory.html">The HW/SW inventory</a></p>
</li>
<li>
<p><a href="mk_filestats.html">Monitoring files</a></p>
</li>
<li>
<p><a href="monitoring_logfiles.html">Monitoring log files</a></p>
</li>
<li>
<p><a href="monitoring_oracle.html">Monitoring Oracle databases</a></p>
</li>
<li>
<p><a href="monitoring_mysql.html">Monitoring MySQL</a></p>
</li>
<li>
<p><a href="monitoring_mssql.html">Monitoring MSSQL</a></p>
</li>
<li>
<p><a href="monitoring_mssql_legacy.html">Monitoring MSSQL with the legacy plug-in</a></p>
</li>
<li>
<p><a href="monitoring_jobs.html">Monitoring time-based processes (Cronjobs)</a></p>
</li>
<li>
<p><a href="spool_directory.html">The spool directory</a></p>
</li>
<li>
<p><a href="localchecks.html">Local checks</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_vm_cloud_container">
<a class="anchor" href="#_vm_cloud_container"></a>6.3. VM, cloud, container</h3>
<div class="ulist">
<ul>
<li>
<p><a href="datasource_programs.html">Datasource programs</a></p>
</li>
<li>
<p><a href="monitoring_vmware.html">Monitoring VMware ESXi</a></p>
</li>
<li>
<p><a href="monitoring_aws.html">Monitoring Amazon Web Services (AWS)</a></p>
</li>
<li>
<p><a href="monitoring_azure.html">Monitoring Microsoft Azure</a></p>
</li>
<li>
<p><a href="monitoring_gcp.html">Monitoring Google Cloud Platform (GCP)</a></p>
</li>
<li>
<p><a href="monitoring_kubernetes.html">Monitoring Kubernetes</a></p>
</li>
<li>
<p><a href="monitoring_openshift.html">Monitoring OpenShift</a></p>
</li>
<li>
<p><a href="monitoring_docker.html">Monitoring Docker</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_endpoints">
<a class="anchor" href="#_endpoints"></a>6.4. Endpoints</h3>
<div class="ulist">
<ul>
<li>
<p><a href="active_checks.html">Monitoring network services (Active checks)</a></p>
</li>
<li>
<p><a href="robotmk.html">Checkmk Synthetic Monitoring with Robotmk</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_dashboards_views_metrics">
<a class="anchor" href="#_dashboards_views_metrics"></a>7. Dashboards, views, metrics</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="user_interface.html">The user interface</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_general">
<a class="anchor" href="#_general"></a>7.1. General</h3>
<div class="ulist">
<ul>
<li>
<p><a href="views.html">Host and service views</a></p>
</li>
<li>
<p><a href="dashboards.html">Dashboards</a></p>
</li>
<li>
<p><a href="graphing.html">Measured values and graphing</a></p>
</li>
<li>
<p><a href="custom_notes.html">Custom notes</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_commands_in_views">
<a class="anchor" href="#_commands_in_views"></a>7.2. Commands in views</h3>
<div class="ulist">
<ul>
<li>
<p><a href="commands.html">Commands</a></p>
</li>
<li>
<p><a href="basics_ackn.html">Acknowledging problems</a></p>
</li>
<li>
<p><a href="basics_downtimes.html">Scheduled downtimes</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_analysis_and_prognosis">
<a class="anchor" href="#_analysis_and_prognosis"></a>8. Analysis and prognosis</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_analysis">
<a class="anchor" href="#_analysis"></a>8.1. Analysis</h3>
<div class="ulist">
<ul>
<li>
<p><a href="availability.html">Availability</a></p>
</li>
<li>
<p><a href="sla.html">Extended availability (SLAs)</a></p>
</li>
<li>
<p><a href="bi.html">Business Intelligence (BI)</a></p>
</li>
<li>
<p><a href="reporting.html">Reports</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_prognosis">
<a class="anchor" href="#_prognosis"></a>8.2. Prognosis</h3>
<div class="ulist">
<ul>
<li>
<p><a href="predictive_monitoring.html">Predictive monitoring</a></p>
</li>
<li>
<p><a href="forecast_graphs.html">Forecast graphs</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_connection_of_other_applications">
<a class="anchor" href="#_connection_of_other_applications"></a>9. Connection of other applications</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="monitoring_prometheus.html">Integrating Prometheus</a></p>
</li>
<li>
<p><a href="integrating_datadog.html">Integrating Datadog</a></p>
</li>
<li>
<p><a href="nagvis.html">NagVis: status data on maps and diagrams</a></p>
</li>
<li>
<p><a href="ntop.html">Integrating ntopng in Checkmk</a></p>
</li>
<li>
<p><a href="grafana.html">Integrating Checkmk in Grafana</a></p>
</li>
<li>
<p><a href="metrics_exporter.html">Sending metrics to InfluxDB and Graphite</a></p>
</li>
<li>
<p><a href="nagstamon.html">Integrating Checkmk in Nagstamon</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_specifics_to_the_editions">
<a class="anchor" href="#_specifics_to_the_editions"></a>10. Specifics to the editions</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="cse.html">Checkmk Enterprise</a></p>
</li>
<li>
<p><a href="cce.html">Checkmk Cloud</a></p>
</li>
<li>
<p><a href="managed.html">Checkmk MSP</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_automation_and_development">
<a class="anchor" href="#_automation_and_development"></a>11. Automation and development</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="apis_intro.html">Overview of API resources</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_apis_for_automation">
<a class="anchor" href="#_apis_for_automation"></a>11.1. APIs for automation</h3>
<div class="ulist">
<ul>
<li>
<p><a href="rest_api.html">The Checkmk REST API</a></p>
</li>
<li>
<p><a href="livestatus.html">Retrieving status data via Livestatus</a></p>
</li>
<li>
<p><a href="livestatus_references.html">Livestatus command reference</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_apis_for_development">
<a class="anchor" href="#_apis_for_development"></a>11.2. APIs for development</h3>
<div class="ulist">
<ul>
<li>
<p><a href="bakery_api.html">The Bakery-API</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_development_of_check_plug_ins">
<a class="anchor" href="#_development_of_check_plug_ins"></a>11.3. Development of check plug-ins</h3>
<div class="ulist">
<ul>
<li>
<p><a href="devel_intro.html">Developing extensions for Checkmk</a></p>
</li>
<li>
<p><a href="devel_check_plugins.html">Writing agent-based check plug-ins</a></p>
</li>
<li>
<p><a href="devel_check_plugins_snmp.html">Writing SNMP-based check plug-ins</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_concepts">
<a class="anchor" href="#_concepts"></a>12. Concepts</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="monitoring_basics.html">Basic principles of monitoring with Checkmk</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_the_checkmk_micro_core_cmc">
<a class="anchor" href="#_the_checkmk_micro_core_cmc"></a>12.1. The Checkmk Micro Core (CMC)</h3>
<div class="ulist">
<ul>
<li>
<p><a href="cmc.html">The Checkmk Micro Core (CMC)</a></p>
</li>
<li>
<p><a href="cmc_differences.html">Special characteristics of the CMC</a></p>
</li>
<li>
<p><a href="cmc_migration.html">Migration to the CMC</a></p>
</li>
<li>
<p><a href="cmc_files.html">CMC files and directories</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_checkmk_appliance">
<a class="anchor" href="#_the_checkmk_appliance"></a>13. The Checkmk appliance</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="appliance_rack1_quick_start.html">Quick start guide for Checkmk racks</a></p>
</li>
<li>
<p><a href="appliance_virt1_quick_start.html">Quick start guide for Checkmk virt1</a></p>
</li>
<li>
<p><a href="appliance_install_virt1.html">Installation of the virtual appliance</a></p>
</li>
<li>
<p><a href="appliance_usage.html">Configuring and using the appliance</a></p>
</li>
<li>
<p><a href="appliance_backup.html">Backup in the appliance</a></p>
</li>
<li>
<p><a href="appliance_cluster.html">Appliance in cluster operation</a></p>
</li>
<li>
<p><a href="appliance_rack_config.html">Special features of the hardware appliance</a></p>
</li>
</ul>
</div>
</div>
</div>
</div></div>
<div class="main-nav__utils">
<div class="dropup dropdown__utils">
<button class="btn dropdown-toggle" type="button" id="aboutMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">About Checkmk</button><div class="dropdown-menu dropup" aria-labelledby="aboutMenuButton">
<a class="dropdown-item" href="https://checkmk.com/product/features" target="_blank">Features</a><a class="dropdown-item" href="https://checkmk.com/product/editions" target="_blank">Editions</a><a class="dropdown-item" href="https://checkmk.com/integrations" target="_blank">Integrations</a><a class="dropdown-item" href="https://checkmk.com/imprint" target="_blank">Imprint</a><a class="dropdown-item" href="copyright.html" target="_blank">Copyright</a>
</div>
</div>
<div class="dropup dropdown__utils">
<button class="btn dropdown-toggle" type="button" id="learnMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Learn</button><div class="dropdown-menu dropup" aria-labelledby="learnMenuButton">
<a class="dropdown-item" href="https://checkmk.com/videos">Videos</a><a class="dropdown-item" href="https://checkmk.com/webinars">Webinars</a><a class="dropdown-item" href="https://checkmk.com/trainings/classes">Trainings</a>
</div>
</div>
<a class="main-nav__utils__link" href="https://forum.checkmk.com">Forum</a>
</div>
</div></aside><main><div id="header">
<h1>Monitoring Oracle databases</h1>
<div class="details">
<span id="revdate">Last modified on 27-Aug-2024</span><a class="edit-document" href="https://github.com/Checkmk/checkmk-docs/edit/2.3.0/src/common/en/monitoring_oracle.asciidoc">Edit this page on GitHub</a>
</div>
</div>
<div id="content">
<div id="preamble">
<div id="staticinfo">This page was exported for offline usage on 2025-01-07 22:12:14 +0000. It may not reflect the current state of the Checkmk documentation. To view a daily updated version, visit <a href="https://docs.checkmk.com/" target="_blank">docs.checkmk.com</a>.</div>
<div class="sectionbody"><div class="paragraph">
<p></p>
<div class="dropdown dropdown__related">
<button class="btn btn-primary dropdown-toggle" type="button" id="relatedMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Related Articles</button><div class="dropdown-menu dropdown-menu-right" aria-labelledby="relatedMenuButton">
<a href="wato_monitoringagents.html">Monitoring agents</a>
<a href="agent_linux.html">Monitoring Linux</a>
<a href="agent_windows.html">Monitoring Windows</a>
<a href="https://checkmk.com/integrations">Catalog of Check Plug-ins</a>
</div>
</div>
</div></div>
</div>
<div class="sect1">
<h2 id="heading_intro">
<span class="hidden-anchor sr-only" id="intro"></span>1. Introduction</h2>
<div class="sectionbody">
<div class="paragraph"><p>Checkmk provides comprehensive options for the monitoring of Oracle databases.
With the <a href="glossar.html#agent_plugin">agent plug-in</a> you can not only retrieve a database’s tablespaces or its active sessions, but also many other types of metrics.
A complete list of monitoring options with our <a href="glossar.html#check_plugin">check plug-ins</a> can be found in the <a href="https://checkmk.com/integrations?tags=oracle" target="_blank">Catalog of Check Plug-ins</a>.
We regularly add new plug-ins and update existing ones, so it is always worth looking in the catalog.
Among others, Checkmk can monitor the following values:</p></div>
<div class="ulist"><ul>
<li><p><a href="https://checkmk.com/integrations/oracle_instance" target="_blank">Oracle Instance: Status of Database</a></p></li>
<li><p><a href="https://checkmk.com/integrations/oracle_instance_uptime" target="_blank">Oracle Instance: Uptime of Database</a></p></li>
<li><p><a href="https://checkmk.com/integrations/oracle_undostat" target="_blank">Oracle Instance: Undo Retention</a></p></li>
<li><p><a href="https://checkmk.com/integrations/oracle_version" target="_blank">Oracle Database: Version</a></p></li>
<li><p><a href="https://checkmk.com/integrations/oracle_jobs" target="_blank">Oracle Database: Jobs</a></p></li>
<li><p><a href="https://checkmk.com/integrations/oracle_locks" target="_blank">Oracle Database: Locks</a></p></li>
<li><p><a href="https://checkmk.com/integrations/oracle_processes" target="_blank">Oracle Database: Processes</a></p></li>
<li><p><a href="https://checkmk.com/integrations/oracle_sessions" target="_blank">Oracle Database: Number of Active Sessions</a></p></li>
<li><p><a href="https://checkmk.com/integrations/oracle_recovery_area" target="_blank">Oracle Database: Recovery Area</a></p></li>
<li><p><a href="https://checkmk.com/integrations/oracle_logswitches" target="_blank">Oracle Database: Log Switch Activity</a></p></li>
<li><p><a href="https://checkmk.com/integrations/oracle_tablespaces" target="_blank">Oracle Tablespaces: General Information</a></p></li>
<li><p><a href="https://checkmk.com/integrations/oracle_performance" target="_blank">Oracle Tablespaces: Performance Data</a></p></li>
<li><p><a href="https://checkmk.com/integrations/oracle_longactivesessions" target="_blank">Oracle Database: Long Active Sessions</a></p></li>
<li><p><a href="https://checkmk.com/integrations/oracle_recovery_status" target="_blank">Oracle: Checkpoint and User Managed Backup State of Datafiles</a></p></li>
<li><p><a href="https://checkmk.com/integrations/oracle_sql" target="_blank">Oracle Database: Custom SQLs</a></p></li>
<li><p><a href="https://checkmk.com/integrations/oracle_rman" target="_blank">Oracle: RMAN Backup Status</a></p></li>
<li><p><a href="https://checkmk.com/integrations/oracle_asm_diskgroup" target="_blank">Oracle: ASM Disk Groups</a></p></li>
<li><p><a href="https://checkmk.com/integrations/oracle_dataguard_stats" target="_blank">Oracle Data-Guard: Apply and Transport Lag</a></p></li>
</ul></div>
<div class="paragraph"><p>To be able to monitor the databases only the agent plug-in is required in addition to the agent on the database server.
The Linux, Solaris, AIX and Windows operating systems are currently supported.
The agent plug-in for Linux, Solaris, AIX is called <code>mk_oracle</code> and for Windows <code>mk_oracle.ps1</code>.
No further additional software will be required for a monitoring, either on the Checkmk server or on the database server.</p></div>
<div class="paragraph"><p>Many of the steps to set up monitoring are the same for both Linux and Windows.
For this reason, we will first describe the general steps, then the specific steps for the respective operating system group and finally the <a href="glossar.html#agent_bakery">Agent Bakery</a> in the commercial editions.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="heading_first_steps">
<span class="hidden-anchor sr-only" id="first_steps"></span>2. Initial setup</h2>
<div class="sectionbody">
<div class="paragraph"><p>The configuration files with sample content presented in this and the following chapters can be found on the Checkmk server — either via the <a href="#files_cmk">command line</a> or via the Checkmk web interface.
In Checkmk Raw select <span class="guihint">Setup &gt; Agents</span> and in the commercial editions <span class="guihint">Setup &gt; Agents &gt; Windows, Linux, Solaris, AIX &gt; Related</span>.
In all editions you will find menu entries for the different operating systems.
The configuration files can be found in the <span class="guihint">Example Configurations</span> box.</p></div>
<div class="sect2">
<h3 id="heading_create_user">
<span class="hidden-anchor sr-only" id="create_user"></span>2.1. Creating a database user</h3>
<div class="paragraph"><p>In principle, the first setup is quick and requires only three steps.
The first step, of course, is to have a user who is also allowed to query the databases.
Provided that you are not using <a href="#rac">Real Application Cluster (RAC)</a>, create a user in each database to be monitored.
How to access an instance differs depending on the installed operating system.
For Linux, you can do this, for example, by always first setting the relevant instance as an environment variable in which a user is to be created.
Normally you first switch to the <code>oracle</code> user,
but this can differ depending on the setup:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">root@linux# </span>su<span class="tok-w"> </span>-<span class="tok-w"> </span>oracle
<span class="tok-gp">oracle@linux$ </span><span class="tok-nb">export</span><span class="tok-w"> </span><span class="tok-nv">ORACLE_SID</span><span class="tok-o">=</span>MYINST1</code></pre></div></div>
<div class="paragraph"><p>Then log on to the instance and create a user for the monitoring.
To get all of the data, the following permissions are required.
In the following example, the newly-created user is named <code>checkmk</code>.
You can also specify any other desired name:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="sql"><span></span><span class="tok-n">sqlplus</span><span class="tok-o">&gt;</span><span class="tok-w"> </span><span class="tok-k">create</span><span class="tok-w"> </span><span class="tok-k">user</span><span class="tok-w"> </span><span class="tok-n">checkmk</span><span class="tok-w"> </span><span class="tok-n">identified</span><span class="tok-w"> </span><span class="tok-k">by</span><span class="tok-w"> </span><span class="tok-n">myPassword</span><span class="tok-p">;</span>
<span class="tok-n">sqlplus</span><span class="tok-o">&gt;</span><span class="tok-w"> </span><span class="tok-k">grant</span><span class="tok-w"> </span><span class="tok-n">select_catalog_role</span><span class="tok-w"> </span><span class="tok-k">to</span><span class="tok-w"> </span><span class="tok-n">checkmk</span><span class="tok-p">;</span>
<span class="tok-n">sqlplus</span><span class="tok-o">&gt;</span><span class="tok-w"> </span><span class="tok-k">grant</span><span class="tok-w"> </span><span class="tok-k">create</span><span class="tok-w"> </span><span class="tok-k">session</span><span class="tok-w"> </span><span class="tok-k">to</span><span class="tok-w"> </span><span class="tok-n">checkmk</span><span class="tok-p">;</span>
<span class="tok-n">sqlplus</span><span class="tok-o">&gt;</span><span class="tok-w"> </span><span class="tok-k">connect</span><span class="tok-w"> </span><span class="tok-n">checkmk</span><span class="tok-o">/</span><span class="tok-n">myPassword</span>
<span class="tok-n">sqlplus</span><span class="tok-o">&gt;</span><span class="tok-w"> </span><span class="tok-n">exit</span></code></pre></div></div>
<div class="paragraph"><p>You can find out exactly how the login to a specific instance works in the Oracle documentation.</p></div>
<div class="sect3">
<h4 id="heading__multi_tenant_databases">
<span class="hidden-anchor sr-only" id="_multi_tenant_databases"></span>Multi-tenant databases</h4>
<div class="paragraph"><p>You can also configure the login for <a href="https://docs.oracle.com/en/database/oracle/oracle-database/19/multi/introduction-to-the-multitenant-architecture.html" target="_blank">multi-tenant databases</a>.
This is usually performed in the configuration using a special user and with the prefix <code>C##</code>.
The assignment of permissions is a bit different as for regular users as you need to specify them for all current containers and for all future containers:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="sql"><span></span><span class="tok-n">sqlplus</span><span class="tok-o">&gt;</span><span class="tok-w"> </span><span class="tok-k">create</span><span class="tok-w"> </span><span class="tok-k">user</span><span class="tok-w"> </span><span class="tok-k">c</span><span class="tok-o">##</span><span class="tok-n">checkmk</span><span class="tok-w"> </span><span class="tok-n">identified</span><span class="tok-w"> </span><span class="tok-k">by</span><span class="tok-w"> </span><span class="tok-n">myPassword</span><span class="tok-p">;</span>
<span class="tok-n">sqlplus</span><span class="tok-o">&gt;</span><span class="tok-w"> </span><span class="tok-k">alter</span><span class="tok-w"> </span><span class="tok-k">user</span><span class="tok-w"> </span><span class="tok-k">c</span><span class="tok-o">##</span><span class="tok-n">checkmk</span><span class="tok-w"> </span><span class="tok-k">set</span><span class="tok-w"> </span><span class="tok-n">container_data</span><span class="tok-o">=</span><span class="tok-k">all</span><span class="tok-w"> </span><span class="tok-n">container</span><span class="tok-o">=</span><span class="tok-k">current</span><span class="tok-p">;</span>
<span class="tok-n">sqlplus</span><span class="tok-o">&gt;</span><span class="tok-w"> </span><span class="tok-k">grant</span><span class="tok-w"> </span><span class="tok-n">select_catalog_role</span><span class="tok-w"> </span><span class="tok-k">to</span><span class="tok-w"> </span><span class="tok-k">c</span><span class="tok-o">##</span><span class="tok-n">checkmk</span><span class="tok-w"> </span><span class="tok-n">container</span><span class="tok-o">=</span><span class="tok-k">all</span><span class="tok-p">;</span>
<span class="tok-n">sqlplus</span><span class="tok-o">&gt;</span><span class="tok-w"> </span><span class="tok-k">grant</span><span class="tok-w"> </span><span class="tok-k">create</span><span class="tok-w"> </span><span class="tok-k">session</span><span class="tok-w"> </span><span class="tok-k">to</span><span class="tok-w"> </span><span class="tok-k">c</span><span class="tok-o">##</span><span class="tok-n">checkmk</span><span class="tok-w"> </span><span class="tok-n">container</span><span class="tok-o">=</span><span class="tok-k">all</span><span class="tok-p">;</span>
<span class="tok-n">sqlplus</span><span class="tok-o">&gt;</span><span class="tok-w"> </span><span class="tok-n">exit</span></code></pre></div></div>
</div>
</div>
<div class="sect2">
<h3 id="heading_user_config">
<span class="hidden-anchor sr-only" id="user_config"></span>2.2. Creating the configuration</h3>
<div class="paragraph"><p>After you have created a user, the next step is to enable the agent plug-in to later receive this information.
The simplest way is for you to define the same login data for all instances, and set a default in the configuration.
Now on the Oracle host create a new configuration file <code>mk_oracle.cfg</code> for <a href="#linux">Linux, AIX, Solaris</a> or <code>mk_oracle_cfg.ps1</code> for <a href="#windows">Windows</a>.
In the following example the file for Unix-like systems can be seen:</p></div>
<div class="listingblock">
<div class="title">/etc/check_mk/mk_oracle.cfg</div>
<div class="content"><pre class="pygments highlight"><code><span></span># Syntax:
# DBUSER='USERNAME:PASSWORD'
DBUSER='checkmk:myPassword'</code></pre></div>
</div>
<div class="paragraph"><p>For Windows this procedure looks very similar.
There you set the variable in a PowerShell script:</p></div>
<div class="listingblock">
<div class="title">C:\ProgramData\checkmk\agent\config\mk_oracle_cfg.ps1</div>
<div class="content"><pre class="pygments highlight"><code><span></span># Syntax:
# $DBUSER = @("USERNAME","PASSWORD")
$DBUSER = @("checkmk","myPassword")</code></pre></div>
</div>
<div class="paragraph"><p>The standard user is all that the agent plug-in really requires.
All other options that you can set in <a href="#adv_linux">Unix-like systems</a> or under <a href="#adv_windows">Windows</a> are optional.</p></div>
</div>
<div class="sect2">
<h3 id="heading_oracle_wallet">
<span class="hidden-anchor sr-only" id="oracle_wallet"></span>2.3. Using the Oracle Wallet</h3>
<div class="paragraph"><p>As an alternative to specifying the user directly and with a password in a configuration file, you can also use the <em>Oracle Wallet</em>.
This has the advantage that you no longer need to store the access data in an unencrypted form on the Checkmk server and on the Oracle host.
So even if you have defined the configuration file’s access rights on the Oracle host to suit, the access data has nevertheless left the server and is located on the Checkmk server as long as you use the <a href="#bakery">Agent Bakery</a>.</p></div>
<div class="paragraph"><p>The Oracle Wallet in turn stores the encrypted access data on the host to be monitored so that they can only be used, but no login data has to be made known explicitly.
Checkmk can thus use this wallet so that the access data needs only be known to the database administrator (DBA).
Create — or the DBA can create — a wallet on the appropriate server:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">root@linux# </span>mkstore<span class="tok-w"> </span>-wrl<span class="tok-w"> </span>/etc/check_mk/oracle_wallet<span class="tok-w"> </span>-create</code></pre></div></div>
<div class="paragraph"><p>The agent plug-in will access this file later whenever a connection to an instance is to be established.
So that the necessary user data can also be found, you must enter this once in the wallet.
In the following example you thus add the user <code>checkmk</code> for the instance <code>MYINST1</code>:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">root@linux# </span>mkstore<span class="tok-w"> </span>-wrl<span class="tok-w"> </span>/etc/check_mk/oracle_wallet<span class="tok-w"> </span>-createCredential<span class="tok-w"> </span>MYINST1<span class="tok-w"> </span>checkmk<span class="tok-w"> </span>myPassword</code></pre></div></div>
<div class="paragraph"><p>For the agent plug-in to know where to look for the wallet, it must find two files.
The first file is <code>sqlnet.ora</code> in which the info for the wallet’s location can be found.
The second file — <code>tnsnames.ora</code> — defines the address of the instance so that it can also be addressed via its <a href="#tns_config">alias</a>.
So that the agent plug-in can access these files you can specify the path under Linux, Solaris and AIX using the environment variable <a href="#tns_config"><code>TNS_ADMIN</code></a>.
This is especially useful if the files already exist.
Alternatively, you can create them explicitly.
Windows even requires that you specify them manually.</p></div>
<div class="paragraph"><p>First create the <code>sqlnet.ora</code> file.
The agent plug-in alternatively searches in this file for the login data, so the correct file path to the wallet file you just created must be entered here.
Make sure that you set the <code>SQLNET.WALLET_OVERRIDE</code> parameter to <code>TRUE</code>:</p></div>
<div class="listingblock">
<div class="title">/etc/check_mk/sqlnet.ora</div>
<div class="content"><pre class="pygments highlight"><code><span></span>LOG_DIRECTORY_CLIENT = /var/log/check_mk/oracle_client
DIAG_ADR_ENABLED = OFF

SQLNET.WALLET_OVERRIDE = TRUE
WALLET_LOCATION =
 (SOURCE=
   (METHOD = FILE)
   (METHOD_DATA = (DIRECTORY=/etc/check_mk/oracle_wallet))
 )</code></pre></div>
</div>
<div class="paragraph"><p>Now the plug-in knows which credentials should be used.
So that it also accesses the correct address, create <code>tnsnames.ora</code> as the second file.
The exact syntax can be found in the Oracle documentation, but as an example the file could look like this:</p></div>
<div class="listingblock">
<div class="title">/etc/check_mk/tnsnames.ora</div>
<div class="content"><pre class="pygments highlight"><code><span></span>MYINST1
  (DESCRIPTION =
    (ADDRESS = (PROTOCOL = TCP)(HOST = 127.0.0.1)(PORT = 1521))
    (CONNECT_DATA =
      (SERVER = DEDICATED)
      (SERVICE_NAME = MYINST1_ALIAS)
    )
  )</code></pre></div>
</div>
<div class="paragraph"><p>With this step you have created the prerequisites for removing the access data from the <a href="#user_config">agent plug-in’s configuration file</a>.
Instead of the access data, you simply enter a <code>/</code> (slash):</p></div>
<div class="listingblock">
<div class="title">/etc/check_mk/mk_oracle.cfg</div>
<div class="content"><pre class="pygments highlight"><code><span></span>DBUSER='/:'</code></pre></div>
</div>
<div class="paragraph"><p>You can of course add further access data to the wallet at a later date.
The <code>tnsnames.ora</code> file must then simply be amended as necessary.</p></div>
<div class="paragraph"><p>Finally, change the permissions of the files and directories created manually in this section so that <a href="#access_linux">access rights on execution</a> are set correctly.
The agent plug-in executed as <code>root</code> will switch to the owner of the Oracle binaries (such as <code>$ORACLE_HOME/bin/sqlplus</code>) before executing them.
As a minimum, the group of the owner of the Oracle binaries therefore needs read access to the manually created files in <code>/etc/check_mk/</code>.
In the following example, we assume that the group is <code>oinstall</code>.</p></div>
<div class="paragraph"><p>The following commands change the group to <code>oinstall</code>:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">root@linux# </span>chgrp<span class="tok-w"> </span>oinstall<span class="tok-w"> </span>/etc/check_mk/sqlnet.ora<span class="tok-w"> </span>/etc/check_mk/tnsnames.ora
<span class="tok-gp">root@linux# </span>chgrp<span class="tok-w"> </span>-R<span class="tok-w"> </span>oinstall<span class="tok-w"> </span>/etc/check_mk/oracle_wallet</code></pre></div></div>
<div class="paragraph"><p>These commands then ensure that the group can read the <code>oracle_wallet</code> directory and its contents:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">root@linux# </span>chmod<span class="tok-w"> </span>g+x<span class="tok-w"> </span>/etc/check_mk/oracle_wallet
<span class="tok-gp">root@linux# </span>chmod<span class="tok-w"> </span>-R<span class="tok-w"> </span>g+r<span class="tok-w"> </span>/etc/check_mk/oracle_wallet</code></pre></div></div>
<div class="paragraph"><p>The permissions should then look something like this:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">root@linux# </span>tree<span class="tok-w"> </span>-ugpR<span class="tok-w"> </span>/etc/check_mk
<span class="tok-go">[drwxr-xr-x root     root    ]  /etc/check_mk</span>
<span class="tok-go">├── [drwxr-x--- root   oinstall ]  oracle_wallet</span>
<span class="tok-go">│   └── [-rw-r----- root   oinstall ]  cwallet.sso</span>
<span class="tok-go">│   └── [-rw-r----- root   oinstall ]  cwallet.sso.lck</span>
<span class="tok-go">│   └── [-rw-r----- root   oinstall ]  ewallet.p12</span>
<span class="tok-go">│   └── [-rw-r----- root   oinstall ]  ewallet.p12.lck</span>
<span class="tok-go">├── [-rw-r--r-- root   oinstall ]  sqlnet.ora</span>
<span class="tok-go">├── [-rw-r--r-- root   oinstall ]  tnsnames.ora</span></code></pre></div></div>
<div class="paragraph"><p>The command output only shows the files and directories in question.</p></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="heading_linux">
<span class="hidden-anchor sr-only" id="linux"></span>3. Setting up for Linux, Solaris, AIX</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="heading__plug_in_and_configuration_paths">
<span class="hidden-anchor sr-only" id="_plug_in_and_configuration_paths"></span>3.1. Plug-in and configuration paths</h3>
<div class="paragraph"><p>Under Unix-like systems Checkmk uses a uniform agent plug-in.
On the one hand, this reduces maintenance effort, since SQL queries are not duplicated, and on the other hand you only need to pay attention to a single agent plug-in.
On all supported systems the file paths for the agents are the same or very similar.
Specifically, you need the following directories:</p></div>
<table class="table-responsive table-bordered table tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 37.5%;">
<col style="width: 37.5%;">
</colgroup>
<thead><tr>
<th class="tableblock halign-left valign-top">Operating system</th>
<th class="tableblock halign-left valign-top">Plug-in path</th>
<th class="tableblock halign-left valign-top">Configuration path</th>
</tr></thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Linux, Solaris, AIX</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/usr/lib/check_mk_agent/plugins/</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/etc/check_mk/</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Linux with <code>systemd</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/usr/lib/check_mk_agent/plugins/&lt;Number&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/etc/check_mk/</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AIX</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/usr/check_mk/lib/plugins/</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/usr/check_mk/conf/</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="heading_install_linux">
<span class="hidden-anchor sr-only" id="install_linux"></span>3.2. Installing the agent plug-in</h3>
<div class="paragraph"><p>Once you have created a user in the <a href="#first_steps">initial setup</a> and stored this in the configuration file, install the agent plug-in.
Copy the <code>mk_oracle</code> file from the Checkmk server’s directory <code>~/share/check_mk/agents/plugins/</code> to the Oracle host’s plug-in directory described above.</p></div>
<div class="admonitionblock important"><table><tr>
<td class="icon"><img src="../images/icons/important.png" alt="Important"></td>
<td class="content"><div class="paragraph"><p>The agent plug-in for Unix-like systems <code>mk_oracle</code> does not work well with <code>systemd</code> (see <a href="https://checkmk.com/werk/13732" target="_blank">Werk #13732</a>).
On systems with <code>systemd</code>, you must therefore run the agent plug-in <a href="agent_linux.html#async_plugins">asynchronously</a>.
This means that you do not install the agent plug-in directly under <code>/usr/lib/check_mk_agent/plugins/</code>, but in a subfolder <code>/usr/lib/check_mk_agent/plugins/&lt;Number&gt;/</code>.
<code>&lt;Number&gt;</code> means the execution interval in seconds.
We recommend execution once per minute, i.e. <code>/usr/lib/check_mk_agent/plugins/60/</code>.
When setting up via the <a href="#bakery">Agent Bakery</a>, you can do this using the Oracle rule’s option <span class="guihint">Host uses xinetd or systemd</span>, which is set to <span class="guihint">xinetd</span> by default.</p></div></td>
</tr></table></div>
<div class="paragraph"><p>Be sure to make the agent plug-in executable, and correct it if necessary:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">root@linux# </span><span class="tok-nb">cd</span><span class="tok-w"> </span>/usr/lib/check_mk_agent/plugins/
<span class="tok-gp">root@linux# </span>ls<span class="tok-w"> </span>-lA
<span class="tok-go">-rw-r--r-- 1 root root 120808 Jan 25 11:29 mk_oracle</span>
<span class="tok-gp">root@linux# </span>chmod<span class="tok-w"> </span>+x<span class="tok-w"> </span>mk_oracle
<span class="tok-gp">root@linux# </span>ls<span class="tok-w"> </span>-lA
<span class="tok-go">-rwxr-xr-x 1 root root 120808 Jan 25 11:29 mk_oracle</span></code></pre></div></div>
</div>
<div class="sect2">
<h3 id="heading_adv_linux">
<span class="hidden-anchor sr-only" id="adv_linux"></span>3.3. Advanced options</h3>
<div class="paragraph"><p>In the <a href="#first_steps">initial setup</a> you have already learned about the first variables for getting monitoring data from their Oracle instances.
However, depending on the application scenario, you will quickly need further possibilities for better, individual control of the monitoring for each instance.
You will find these options in the following sections.</p></div>
<div class="sect3">
<h4 id="heading_adv_user_linux">
<span class="hidden-anchor sr-only" id="adv_user_linux"></span>Advanced user configuration</h4>
<div class="paragraph"><p>With the standard login you can use regular or possibly even all instances for a database.
However, there are special cases in which you require individual access data for specific instances.
In the configuration file you therefore have the following three options for specifying users:</p></div>
<table class="table-responsive table-bordered table tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead><tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr></thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DBUSER</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The default if no individual access data has been defined for the database instance.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DBUSER_MYINST1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Access data for a specific database instance — in this case for the instance <code>MYINST1</code>.
The access data is only used for this instance.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ASMUSER</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Special access data for Automatic Storage Management (ASM).<br>
<strong>Important:</strong> For an ASM only one login at a time can be specified.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph"><p>These variables additionally allow even more options apart from user name and password.
You can also determine whether the user is a <code>SYSDBA</code> or <code>SYSASM</code>, on which combination of address and port the instance listens to, and even which <a href="#tns_config">TNS alias</a> (<code>TNSALIAS</code>) should be used.
However, these specifications are always — unlike user and password — optional.
In addition to the <a href="#user_config">above example</a>, a configuration can look like this:</p></div>
<div class="listingblock">
<div class="title">/etc/check_mk/mk_oracle.cfg</div>
<div class="content"><pre class="pygments highlight"><code><span></span># Syntax
# DBUSER='USERNAME:PASSWORD:ROLE:HOST:PORT:TNSALIAS'
DBUSER='checkmk:myPassword'

DBUSER_MYINST1='cmk_specific1:myPassword1:SYSDBA:localhost:1521'
DBUSER_MYINST2='cmk_specific2:myPassword2::localhost::INST2'

ASMUSER='cmk_asm:myASMPassword:SYSASM'</code></pre></div>
</div>
<div class="paragraph"><p>A few explanations for the above example:</p></div>
<div class="ulist"><ul>
<li><p>You can define any number of individual access data.
These are always preferred to the standard.</p></li>
<li><p>Each option is separated from the others by a <code>:</code> (colon).</p></li>
<li><p>If an optional field is omitted in the middle of the string, a colon must be coded, as with the <code>DBUSER_MYINST2</code> entry, where no role and no port was specified.</p></li>
<li><p>If after a certain point, no more optional fields are needed, you can omit the colons, as with the <code>ASMUSER</code> entry, where neither host, port nor TNS alias was specified.</p></li>
</ul></div>
</div>
<div class="sect3">
<h4 id="heading_skip_include">
<span class="hidden-anchor sr-only" id="skip_include"></span>Including or excluding instances</h4>
<div class="paragraph"><p>In some cases you may not want to include particular instances in the monitoring.
This may be because it is only a playground for developers, or for other reasons.
To make the configuration as simple as possible in individual situations, you have various options to entirely or partially exclude one or more instances:</p></div>
<table class="table-responsive table-bordered table tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead><tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr></thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ONLY_SIDS</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Here you can determine which instances are to be monitored.
An instance is named by its <em>system identifier (SID)</em>.
This is a positive list, ignoring all instances that are not explicitly listed.
This parameter is very useful if the number of instances to be monitored is smaller than the number of instances to be ignored.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SKIP_SIDS</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unlike <code>ONLY_SIDS</code>, this is a negative list where all instances are monitored except those explicitly listed here.
This parameter is very suitable if the number of instances to be ignored is smaller than the number to be monitored.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>EXCLUDE_&lt;SID&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">With this parameter you can partially exclude an instance by excluding certain sections of the instance from monitoring.
In this way, you define a negative list of the sections of an instance.
You can also exclude all sections with the value <code>ALL</code> and and thus do the same as if you were to add the instance to <code>SKIP_SIDS</code>.<br>
<strong>Important:</strong> For ASM SIDs you cannot use this procedure, however you can use <code>SKIP_SIDS="+ASM1 …​"</code> instead.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph"><p>You will have already guessed:
The order in which these parameters are processed determines the result.
The entries are in fact processed <em>per instance</em> exactly in sequence as shown in the table above.
Therefore if the variable <code>ONLY_SIDS</code> is set, <code>SKIP_SIDS</code> is no longer evaluated nor is it checked whether the <code>EXCLUDE_&lt;SID&gt;</code> variable is set to <code>ALL</code> for this instance.
If <code>ONLY_SIDS</code> is not set, the system proceeds according to the sequence.
In case of doubt — that is, as the default behavior — the instance will be monitored accordingly.</p></div>
<div class="paragraph"><p>Below is an example in which all variables are set and what the behavior is like:</p></div>
<div class="listingblock">
<div class="title">/etc/check_mk/mk_oracle.cfg</div>
<div class="content"><pre class="pygments highlight"><code><span></span>ONLY_SIDS='INST1 INST2 INST5'
SKIP_SIDS='INST7 INST3 INST2'
EXCLUDE_INST1='ALL'
EXCLUDE_INST2='tablespaces rman'</code></pre></div>
</div>
<div class="paragraph"><p>Since the positive list from the first line always has priority, the second and third lines are no longer evaluated.
Only the fourth (last) line will be considered at a later date, since the instance is only to be partially evaluated here.</p></div>
<div class="paragraph"><p>In practice, it only makes sense to use <em>one</em> of the variables to determine the number of instances to be monitored.</p></div>
</div>
<div class="sect3">
<h4 id="heading_sections">
<span class="hidden-anchor sr-only" id="sections"></span>Determining the data to be fetched</h4>
<div class="paragraph"><p>As you learned in the previous section, it is not only possible to disable instances completely, but also to only partially monitor them.
The operational requirements are diverse, and it is especially practical when it is undesirable to have certain long-running sections to be included in everything, or when only basic information from test instances is required, for example.
To restrict sections globally, set the corresponding variables directly — to restrict only certain instances you can slot in the <code>EXCLUDE_&lt;SID&gt;</code> variable which you have already learned about in the <a href="#skip_include">previous section</a>.
The global variables are:</p></div>
<table class="table-responsive table-bordered table tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead><tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr></thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SYNC_SECTIONS</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sections that are to be queried synchronously, i.e. every time the agent runs.
Since the query interval is 60 seconds by default, the SQL queries used must be run through correspondingly fast.
If the variable is not specified, all sections are queried.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ASYNC_SECTIONS</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sections that are to be queried asynchronously, i.e. only every x minutes.
How long the data remains valid is determined by the <code>CACHE_MAXAGE</code> variable, below in this table.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SYNC_ASM_SECTIONS</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Here for ASM sections the same mechanism applies as in the general description for the <code>SYNC_SECTIONS</code> variable.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ASYNC_ASM_SECTIONS</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Here for ASM sections the same mechanism applies as in the general description for the <code>ASYNC_SECTIONS</code> variable.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CACHE_MAXAGE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This variable is used to determine how long asynchronously retrieved data remains valid.
If the variable’s value is not specified, a default of 600 seconds (10 minutes) is used.
Make sure that the time range is not shorter than the interval at which the Checkmk agent delivers the data (60 seconds by default).
Otherwise, the data may be considered outdated and not delivered by the agent.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>MAX_TASKS</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of SIDs that are processed in parallel. The default value is 1.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph"><p>The mechanism therefore allows you to set a default in the configuration file and overwrite it for individual instances as required.
A configuration could then look like this, for example:</p></div>
<div class="listingblock">
<div class="title">/etc/check_mk/mk_oracle.cfg</div>
<div class="content"><pre class="pygments highlight"><code><span></span># DEFAULTS:
# SYNC_SECTIONS="instance sessions logswitches undostat recovery_area processes recovery_status longactivesessions dataguard_stats performance locks"
# ASYNC_SECTIONS="tablespaces rman jobs ts_quotas resumable"
# SYNC_ASM_SECTIONS="instance processes"
# ASYNC_ASM_SECTIONS="asm_diskgroup"
# CACHE_MAXAGE=600

SYNC_ASM_SECTIONS='instance'
ASYNC_SECTIONS='tablespaces jobs rman resumable'

CACHE_MAXAGE=300

EXCLUDE_INST1='undostat locks'
EXCLUDE_INST2='jobs'</code></pre></div>
</div>
<div class="paragraph"><p>As you can see in the example, only the <code>instance</code> section is queried for the ASM instances and a minimum set for the asynchronous sections is specified on all regular instances.
Additionally, on the <code>INST1</code> instance the synchronous sections <code>undostat</code> and <code>locks</code> will be omitted.
Since the synchronous sections are not explicitly specified, all synchronous sections are retrieved from all other instances.
In the <code>INST2</code> instance in turn, only three of the four asynchronous sections are queried, since <code>jobs</code> was additionally excluded.
And finally, the cache of 10 minutes is reduced to 5 minutes (300 seconds), as this is sufficient time to get all data.</p></div>
<div class="admonitionblock important"><table><tr>
<td class="icon"><img src="../images/icons/important.png" alt="Important"></td>
<td class="content"><div class="paragraph"><p>If you define in the configuration file which sections you would like to retrieve, and by which method — you can also alter a asynchronous section to a synchronous section — you must specify
<strong>all</strong> sections which should be executed in the respective area.</p></div></td>
</tr></table></div>
<div class="paragraph"><p>For example, if you only want <code>locks</code> from the synchronous query, specify the entire synchronous list and simply omit <code>locks</code>:</p></div>
<div class="listingblock">
<div class="title">/etc/check_mk/mk_oracle.cfg</div>
<div class="content"><pre class="pygments highlight"><code><span></span># Just exclude 'locks' from sync sections:
SYNC_SECTIONS='instance sessions logswitches undostat recovery_area processes recovery_status longactivesessions dataguard_stats performance'</code></pre></div>
</div>
<div class="paragraph"><p>The same applies for the other three variables in which the sections can be determined.</p></div>
</div>
<div class="sect3">
<h4 id="heading_tns_config">
<span class="hidden-anchor sr-only" id="tns_config"></span>Configuring TNS alias and TNS_ADMIN</h4>
<div class="paragraph"><p>The TNS alias is a user-friendly name for a database connection.
TNS stands for the Oracle network technology <em>Transparent Network Substrate</em>.
A TNS alias makes it possible to establish a connection to a database instance without having to enter the full connection details (such as host name, port number or service name) each time.
TNS aliases are defined in the file <code>tnsnames.ora</code>.
The section on <a href="#oracle_wallet">Oracle Wallet</a> contains an example of how to define a TNS alias.</p></div>
<div class="paragraph"><p><code>TNS_ADMIN</code> is an environment variable that points to the directory in which Oracle configuration files such as <code>sqlnet.ora</code> and <code>tnsnames.ora</code> are located.
By default, <code>TNS_ADMIN</code> is set by Oracle to <code>$ORACLE_HOME/network/admin</code>.
In the configuration file, you can assign a different path to <code>TNS_ADMIN</code>, as in the following example for a specific Oracle installation:</p></div>
<div class="listingblock">
<div class="title">/etc/check_mk/mk_oracle.cfg</div>
<div class="content"><pre class="pygments highlight"><code><span></span>export TNS_ADMIN=/opt/oracle/product/19c/dbhome_1/network/admin/</code></pre></div>
</div>
<div class="paragraph"><p>Only if the variable is not set at all, it is set by the agent plug-in to <code>/etc/check_mk/</code>.</p></div>
</div>
<div class="sect3">
<h4 id="heading_access_linux">
<span class="hidden-anchor sr-only" id="access_linux"></span>Access rights on execution</h4>
<div class="paragraph"><p>For security reasons, the agent plug-in <code>mk_oracle</code> no longer executes Oracle binaries under the <code>root</code> user.
This affects the programs <code>sqlplus</code>, <code>tnsping</code> and — if available — <code>crsctl</code>.
Instead, <code>mk_oracle</code>, for example, changes to the owner of the file <code>$ORACLE_HOME/bin/sqlplus</code> before executing <code>sqlplus</code>.
This ensures that Oracle programs are only executed by a non-privileged user and thus prevents a malicious Oracle user from replacing a binary such as <code>sqlplus</code> and running it as <code>root</code> user.</p></div>
<div class="admonitionblock tip"><table><tr>
<td class="icon"><img src="../images/icons/tip.png" alt="Tip"></td>
<td class="content"><div class="paragraph"><p>You can find out in which patch version of Checkmk this change was made in the Werks <a href="https://checkmk.com/werk/15327" target="_blank">#15327</a> and <a href="https://checkmk.com/werk/15328" target="_blank">#15328</a>.</p></div></td>
</tr></table></div>
<div class="paragraph"><p>The execution of Oracle programs by a non-privileged user can lead to problems when using an Oracle wallet, as this user may not be able to access the wallet-specific files.
The non-privileged user needs the permissions to read the files <code>$TNS_ADMIN/sqlnet.ora</code> and <code>$TNS_ADMIN/tnsnames.ora</code>, to execute the wallet folder and to read the files in the wallet folder.
You should not have any problems with the access rights as long as you have changed the group of the files and directories as described at the end of the section on <a href="#oracle_wallet">Oracle Wallet</a>.</p></div>
<div class="paragraph"><p>The agent plug-in helps you with the diagnosis and checks whether there are problems accessing the files mentioned and displays them in the <a href="#connection_test">connection test</a>.
The exact procedure for diagnosing and correcting access rights can be found in the <a href="https://checkmk.atlassian.net/wiki/spaces/KB/pages/70582273/" target="_blank">Checkmk Knowledge Base</a>.</p></div>
</div>
</div>
<div class="sect2">
<h3 id="heading_remote_instances">
<span class="hidden-anchor sr-only" id="remote_instances"></span>3.4. Monitoring remote databases</h3>
<div class="paragraph"><p>Under Unix-like systems, you can not only retrieve locally running instances, but also log on to remote ones and retrieve the databases running there.
This, for example, is advantageous if you do not have access to the underlying system, but still want to monitor the database.
It is also possible to monitor remote databases from a host on which the agent plug-in is running but no Oracle database.</p></div>
<div class="paragraph"><p>For monitoring remote databases, the following requirements must be met on the host on which the agent plug-in is installed:</p></div>
<div class="ulist"><ul>
<li><p>The <em>Linux AIO access library</em> is installed.
Under RHEL and derivatives the package is called <code>libaio</code>.</p></li>
<li><p>The <a href="https://www.oracle.com/database/technologies/instant-client.html" target="_blank">Oracle Instant Client</a> is installed.</p></li>
<li><p>The <code>sqlplus</code> program already exists in the installation, or may have been installed as an extension package to the client.</p></li>
</ul></div>
<div class="paragraph"><p>As a rule, the conditions are already fulfilled if there is an Oracle installation on the host.
Otherwise install the appropriate packages to do so.</p></div>
<div class="paragraph"><p>In order for the agent plug-in to connect to the remote database, first store the access data in the configuration file.
These are similar to the details for <code>DBUSER</code>, you already seen in the <a href="#adv_user_linux">advanced user configuration</a>.
However there are a number of additional mandatory specifications:</p></div>
<div class="listingblock">
<div class="title">/etc/check_mk/mk_oracle.cfg</div>
<div class="content"><pre class="pygments highlight"><code><span></span># Syntax:
# REMOTE_INSTANCE_[ID]='USER:PASSWORD:ROLE:HOST:PORT:PIGGYBACKHOST:SID:VERSION:TNSALIAS'

REMOTE_INSTANCE_1='check_mk:mypassword::myRemoteHost:1521:myOracleHost:MYINST3:11.2'
REMOTE_INSTANCE_myinst1='/:::myRemoteHost:1521::MYINST1:11.2:INST1'

REMOTE_ORACLE_HOME='/usr/lib/oracle/11.2/client64'</code></pre></div>
</div>
<div class="paragraph"><p>In the example, two remote instances are being configured with two lines.
So that each text line is unique, an ID is defined at the end of each variable.
These can be freely-chosen — they just have to be unique for each configuration file.
As you have probably already noticed, the port specification is now followed by further values.
These are partly optional, and partly necessary to establish a connection.</p></div>
<div class="paragraph"><p>The first new value <code>PIGGYBACKHOST</code> is set to <code>myOracleHost</code> for the <code>MYINST3</code> instance.
This specification assigns the results from the query by the <a href="glossar.html#piggyback">piggyback mechanism</a> to the specified host.
If this is present as a host in Checkmk, the new services will appear there accordingly instead of on the host where the agent plug-in is running or from which the data was fetched.
You do not see this specification on the second instance <code>MYINST1</code> — the assignment to another host is <em>optional</em>.</p></div>
<div class="paragraph"><p>The second new value <code>SID</code> is the instance name.
Since the agent plug-in cannot see what instances are running on the remote host, a configuration line must be specified for each remote instance — this value is therefore <em>required</em> and thus not optional.</p></div>
<div class="paragraph"><p>The third value <code>VERSION</code> is <em>required</em> and is also due to the fact that much metadata is only available if you are directly on the host.
Therefore the version specification can also not be omitted, and this determines which SQL queries can be passed to the instance.
In the example, both remote instances use version <code>11.2</code>.</p></div>
<div class="paragraph"><p>The fourth and last value <code>TNSALIAS</code> is again <em>optional</em> and can be used if you access the remote instance via the <a href="#oracle_wallet">Oracle Wallet</a> or the LDAP/Active Directory.
In the event that the instance responds only to a specific TNS alias, you can specify this alias here.
For the second remote instance, <code>TNSALIAS</code> has the value <code>INST1</code>.</p></div>
<div class="paragraph"><p>To ensure that the <code>sqlplus</code> program is also found, use the <code>REMOTE_ORACLE_HOME</code> variable to specify where the Oracle client is located on the host that is runs the agent plug-in.
Only then are all resources available that are required for the queries.</p></div>
<div class="paragraph"><p>When querying remote instances, there are some restrictions and special features:</p></div>
<div class="ulist"><ul>
<li><p>Since you have explicitly entered the remote instances in the configuration file, you cannot <a href="#skip_include">exclude</a> these instances using <code>SKIP_SIDS</code>, and in return you do not need to include them using <code>ONLY_SIDS</code>.</p></li>
<li><p>Instances with the same name (<code>SID</code>) may not be assigned to the same host.
This is especially relevant if you are fetching instances from multiple remote and/or local hosts where identical names are used.</p></li>
</ul></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="heading_windows">
<span class="hidden-anchor sr-only" id="windows"></span>4. Setting up for Windows</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="heading__plug_in_and_configuration_paths_2">
<span class="hidden-anchor sr-only" id="_plug_in_and_configuration_paths_2"></span>4.1. Plug-in and configuration paths</h3>
<div class="paragraph"><p>On Windows, PowerShell is used as a scripting language to monitor Oracle databases.
The functionality is similar to the agent plug-in under <a href="#linux">Unix-like systems</a>, but contains only a part of this.
To use the agent plug-in under Windows you need the following file paths, if you have not changed them.</p></div>
<table class="table-responsive table-bordered table tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 37.5%;">
<col style="width: 37.5%;">
</colgroup>
<thead><tr>
<th class="tableblock halign-left valign-top">Operating system</th>
<th class="tableblock halign-left valign-top">Plug-in path</th>
<th class="tableblock halign-left valign-top">Configuration path</th>
</tr></thead>
<tbody><tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Windows</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>C:\ProgramData\checkmk\agent\plugins</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>C:\ProgramData\checkmk\agent\config</code></p></td>
</tr></tbody>
</table>
</div>
<div class="sect2">
<h3 id="heading_install_windows">
<span class="hidden-anchor sr-only" id="install_windows"></span>4.2. Installing the agent plug-in</h3>
<div class="paragraph"><p>After you have created a user in the <a href="#first_steps">initial setup</a> and stored this in the configuration file, install the agent plug-in.
The agent plug-ins for Windows are stored on the host during the installation of the Checkmk agent for Windows.
On the Oracle host, copy the file <code>mk_oracle.ps1</code> from the directory <code>C:\Program Files (x86)\checkmk\service\plugins\</code> into the plug-in directory described above.
Alternatively, you can <a href="agent_windows.html#customizeexecution">refer</a> to the file in the installation path by updating the configuration file of the Checkmk agent.</p></div>
</div>
<div class="sect2">
<h3 id="heading__special_features_under_windows">
<span class="hidden-anchor sr-only" id="_special_features_under_windows"></span>4.3. Special features under Windows</h3>
<div class="paragraph"><p>Windows normally prevents the execution of PowerShell scripts if they have not been signed.
You can now work around this problem very easily by modifying the policies for running PowerShell scripts for the user who is running the Checkmk agent:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="powershell"><span></span><span class="tok-nb">PS </span><span class="tok-n">C</span><span class="tok-p">:\</span><span class="tok-n">ProgramData</span><span class="tok-p">\</span><span class="tok-n">checkmk</span><span class="tok-p">\</span><span class="tok-n">agent</span><span class="tok-p">\&gt;</span> <span class="tok-nb">Set-ExecutionPolicy</span> <span class="tok-n">-ExecutionPolicy</span> <span class="tok-n">Bypass</span> <span class="tok-n">-Scope</span> <span class="tok-n">LocalMachine</span>
<span class="tok-nb">PS </span><span class="tok-n">C</span><span class="tok-p">:\</span><span class="tok-n">ProgramData</span><span class="tok-p">\</span><span class="tok-n">checkmk</span><span class="tok-p">\</span><span class="tok-n">agent</span><span class="tok-p">\&gt;</span> <span class="tok-nb">Get-ExecutionPolicy</span> <span class="tok-n">-Scope</span> <span class="tok-n">LocalMachine</span>
<span class="tok-n">Bypass</span></code></pre></div></div>
<div class="paragraph"><p>This option is useful if for a short time you want to test a script or the general functionality of the Checkmk agent.
To avoid compromising the security of your system, revert this setting on production servers after testing has been completed:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="powershell"><span></span><span class="tok-nb">PS </span><span class="tok-n">C</span><span class="tok-p">:\</span><span class="tok-n">Program</span><span class="tok-p">\</span><span class="tok-n">checkmk</span><span class="tok-p">\</span><span class="tok-n">agent</span><span class="tok-p">\&gt;</span> <span class="tok-nb">Set-ExecutionPolicy</span> <span class="tok-n">-ExecutionPolicy</span> <span class="tok-n">RemoteSigned</span> <span class="tok-n">-Scope</span> <span class="tok-n">LocalMachine</span>
<span class="tok-nb">PS </span><span class="tok-n">C</span><span class="tok-p">:\</span><span class="tok-n">Program</span><span class="tok-p">\</span><span class="tok-n">checkmk</span><span class="tok-p">\</span><span class="tok-n">agent</span><span class="tok-p">\&gt;</span> <span class="tok-nb">Get-ExecutionPolicy</span> <span class="tok-n">-Scope</span> <span class="tok-n">LocalMachine</span>
<span class="tok-n">RemoteSigned</span></code></pre></div></div>
<div class="paragraph"><p>Understandably, you probably don’t want to change the guidelines every 60 seconds.
You therefore set a permanent exception only for the relevant scripts.
The configuration file of the agent plug-in must also be added to the exceptions.
For easy readability, in this example the output has been completely omitted:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="powershell"><span></span><span class="tok-nb">PS </span><span class="tok-n">C</span><span class="tok-p">:\</span><span class="tok-n">ProgramData</span><span class="tok-p">\</span><span class="tok-n">checkmk</span><span class="tok-p">\</span><span class="tok-n">agent</span><span class="tok-p">\&gt;</span> <span class="tok-nb">Unblock-File</span> <span class="tok-n">-Path</span> <span class="tok-p">.\</span><span class="tok-n">plugins</span><span class="tok-p">\</span><span class="tok-n">mk_oracle</span><span class="tok-p">.</span><span class="tok-n">ps1</span>
<span class="tok-nb">PS </span><span class="tok-n">C</span><span class="tok-p">:\</span><span class="tok-n">ProgramData</span><span class="tok-p">\</span><span class="tok-n">checkmk</span><span class="tok-p">\</span><span class="tok-n">agent</span><span class="tok-p">\&gt;</span> <span class="tok-nb">Unblock-File</span> <span class="tok-n">-Path</span> <span class="tok-p">.\</span><span class="tok-n">config</span><span class="tok-p">\</span><span class="tok-n">mk_oracle_cfg</span><span class="tok-p">.</span><span class="tok-n">ps1</span></code></pre></div></div>
</div>
<div class="sect2">
<h3 id="heading_adv_windows">
<span class="hidden-anchor sr-only" id="adv_windows"></span>4.4. Advanced options</h3>
<div class="paragraph"><p>In the <a href="#first_steps">initial setup</a> you have already learned about the first variables to get monitoring data from your Oracle instances.
Depending on the application scenario, however, you will quickly need further options to be able to control the monitoring better and individually for each instance.
Options that are also available to you under Windows are described in the following sections.</p></div>
<div class="sect3">
<h4 id="heading_adv_user_windows">
<span class="hidden-anchor sr-only" id="adv_user_windows"></span>Advanced user configuration</h4>
<div class="paragraph"><p>As under <a href="#adv_user_linux">Linux</a>, you can also define not only a standard login for the Windows agent plug-in, but also individual access data for individual instances.
You therefore have the same three options for specifying users:</p></div>
<table class="table-responsive table-bordered table tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead><tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr></thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DBUSER</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The default if no individual access data has been defined for the database instance.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DBUSER_MYINST1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Access data for a specific database instance — in this case for the instance <code>MYINST1</code>.
The access data is only used for this instance.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ASMUSER</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Special access data for Automatic Storage Management (ASM).<br>
<strong>Important:</strong> For an ASM only one login at a time can be specified.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph"><p>In addition, more options other than user name or password can also be specified here — these additional entries are also optional,
however each entry must be filled in if it is used.
A configuration may then look like this, for example:</p></div>
<div class="listingblock">
<div class="title">C:\ProgramData\checkmk\agent\config\mk_oracle_cfg.ps1</div>
<div class="content"><pre class="pygments highlight"><code><span></span># Syntax
# DBUSER = @("USERNAME", "PASSWORD", "ROLE", "HOST", "PORT")
# Default
# DBUSER = @("", "", "", "localhost", "1521")
$DBUSER = @("checkmk", "myPassword", "SYSDBA", "localhost", "1521")

@DBUSER_MYINST1 = @("cmk_specific1", "myPassword1", "", "10.0.0.73")
@DBUSER_MYINST2 = @("cmk_specific2", "myPassword2", "SYSDBA", "localhost", "1531")

@ASMUSER = @("cmk_asm", "myASMPassword", "SYSASM")</code></pre></div>
</div>
<div class="paragraph"><p>A few explanations regarding the above example:</p></div>
<div class="ulist"><ul>
<li><p>You can define any number of individual access data.
These are always preferred to the standard.</p></li>
<li><p>Each option is defined in a list.
The order of the entries is not arbitrary, so therefore the order may not be rearranged.</p></li>
<li><p>When an optional field remains unchanged but a field following it is to be edited, <em>both</em> fields must be specified correctly, as with the <code>DBUSER_MYINST2</code> entry, where the <code>HOST</code> is still set to <code>localhost</code> even though only the <code>PORT</code> is to be changed.</p></li>
<li><p>If optional fields are no longer needed after a certain point, they can be omitted, as with the <code>ASMUSER</code> entry, in which only the user’s role was specified.</p></li>
<li><p>If no special role is to be assigned to the user, but <code>HOST</code> or <code>PORT</code> is to be customized, simply enter a pair of inverted commas/double quotes (<code>""</code>) in this position.</p></li>
</ul></div>
</div>
<div class="sect3">
<h4 id="heading_skip_include_windows">
<span class="hidden-anchor sr-only" id="skip_include_windows"></span>Enabling and disabling instances</h4>
<div class="paragraph"><p>Even under Windows, one does not always want to include certain instances.
The reasons for this have already been described in the section covering <a href="#skip_include">Linux</a>.
Two of the three parameters that you know from Linux can also be used with Windows:</p></div>
<table class="table-responsive table-bordered table tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead><tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr></thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ONLY_SIDS</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Here you can determine which instances are to be monitored.
An instance is named by its <em>system identifier (SID)</em>.
This is a positive list, ignoring all instances that are not explicitly listed.
This parameter is very useful if the number of instances to be monitored is smaller than the number of instances to be ignored.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>EXCLUDE_&lt;sid&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Since the <a href="#skip_include"><code>SKIP_SIDS</code></a> parameter is not available under Windows, you can only use <code>EXCLUDE_&lt;SID&gt;</code> to exclude instances and thus define a negative list.
You do this by setting the value of the variable to <code>ALL</code>.
You can also use this parameter to partially exclude an instance by excluding certain sections of the instance from monitoring.
In this way, you define a negative list of the sections of an instance.<br>
<strong>Important:</strong> An (<code>+ASM</code>) cannot be completely deactivated with this option.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph"><p>The processing is done for each instance in the order shown in the table above.
So first it is checked whether the instance is in <code>ONLY_SIDS</code>, and only then whether certain sections are to be excluded.
If the variable <code>EXCLUDE_&lt;SID&gt;</code> is set to <code>ALL</code>, no section will be executed.</p></div>
<div class="paragraph"><p>Below is an example where each variable is shown once:</p></div>
<div class="listingblock">
<div class="title">C:\ProgramData\checkmk\agent\config\mk_oracle_cfg.ps1</div>
<div class="content"><pre class="pygments highlight"><code><span></span>$ONLY_SIDS = @("MYINST1", "MYINST3")
$EXCLUDE_INST1 = "tablespaces rman"
$EXCLUDE_INST3 = "ALL"</code></pre></div>
</div>
<div class="paragraph"><p>Note that <code>ONLY_SIDS</code> is a list, whereas <code>EXCLUDE_INST1</code> is a string containing sections separated by spaces.</p></div>
</div>
<div class="sect3">
<h4 id="heading_sections_windows">
<span class="hidden-anchor sr-only" id="sections_windows"></span>Determining the data to be fetched</h4>
<div class="paragraph"><p>The specification of which sections are to be actually fetched is done in the same way as with <a href="#sections">Linux</a>,
and the following is only an example for a Windows configuration:</p></div>
<div class="listingblock">
<div class="title">C:\ProgramData\checkmk\agent\config\mk_oracle_cfg.ps1</div>
<div class="content"><pre class="pygments highlight"><code><span></span># DEFAULTS:
# $SYNC_SECTIONS = @("instance", "sessions", "logswitches", "undostat", "recovery_area", "processes", "recovery_status", "longactivesessions", "dataguard_stats", "performance", "locks")
# $ASYNC_SECTIONS = @("tablespaces", "rman", "jobs", "ts_quotas", "resumable")
# $SYNC_ASM_SECTIONS = @("instance", "processes")
# $ASYNC_ASM_SECTIONS = @("asm_diskgroup")
# $CACHE_MAXAGE = 600

$SYNC_ASM_SECTIONS = @("instance")
$ASYNC_SECTIONS = @("tablespaces", "jobs", "rman", "resumable")

$CACHE_MAXAGE = 300

$EXCLUDE_INST1 = "undostat locks"
$EXCLUDE_INST2 = "jobs'</code></pre></div>
</div>
<div class="admonitionblock important"><table><tr>
<td class="icon"><img src="../images/icons/important.png" alt="Important"></td>
<td class="content"><div class="paragraph"><p>If you define in the configuration file which sections you would like to retrieve, and by which method — you can also alter a asynchronous section to a synchronous section — you must specify
<strong>all</strong> sections which should be executed in the respective area.</p></div></td>
</tr></table></div>
<div class="paragraph"><p>For example, if you only want <code>locks</code> from the synchronous query, specify the entire synchronous list and simply omit <code>locks</code>:</p></div>
<div class="listingblock">
<div class="title">C:\ProgramData\checkmk\agent\config\mk_oracle_cfg.ps1</div>
<div class="content"><pre class="pygments highlight"><code><span></span># Just exclude 'locks' from sync sections:
$SYNC_SECTIONS = @("instance", "sessions", "logswitches", "undostat", "recovery_area", "processes", "recovery_status", "longactivesessions", "dataguard_stats", "performance")</code></pre></div>
</div>
<div class="paragraph"><p>The same applies for the other three variables in which the sections are determined.</p></div>
</div>
<div class="sect3">
<h4 id="heading_access_windows">
<span class="hidden-anchor sr-only" id="access_windows"></span>Access rights on execution</h4>
<div class="paragraph"><p>For security reasons, the agent plug-in <code>mk_oracle.ps1</code> only executes Oracle binaries as administrator if these programs can only be changed by administrators.
Administrators under Windows are the LocalSystem account and members of the built-in <code>Administrators</code> group.
This applies to the programs <code>sqlplus.exe</code>, <code>tnsping.exe</code> and — if available — <code>crsctl.exe</code>.
The agent plug-in <code>mk_oracle.ps1</code> does not execute any of these programs if non-administrative users have one of the permissions <code>Write</code>, <code>Modify</code> or <code>Full control</code> for the file.
This prevents the security risk of non-privileged users executing programs as administrator.</p></div>
<div class="admonitionblock tip"><table><tr>
<td class="icon"><img src="../images/icons/tip.png" alt="Tip"></td>
<td class="content"><div class="paragraph"><p>You can find out in which patch version of Checkmk this change was made in <a href="https://checkmk.com/werk/15843" target="_blank">Werk #15843</a>.</p></div></td>
</tr></table></div>
<div class="paragraph"><p>If necessary, change the access rights by removing the above-mentioned permissions of non-administrative users for the programs.
The agent plug-in helps you with the diagnosis and checks whether non-administrative users have access to the files mentioned and displays them in the <a href="#connection_test">connection test</a>.
The exact procedure for diagnosing and correcting access rights can be found in the <a href="https://checkmk.atlassian.net/wiki/spaces/KB/pages/70582273/" target="_blank">Checkmk Knowledge Base</a>.</p></div>
<div class="paragraph"><p>If it is not possible for you to adjust the permissions for the Oracle programs securely, you can allow individual users and groups to run the programs:</p></div>
<div class="listingblock">
<div class="title">C:\ProgramData\checkmk\agent\config\mk_oracle_cfg.ps1</div>
<div class="content"><pre class="pygments highlight"><code><span></span># Oracle plugin will allow users and groups in the list to have write access to the Oracle binaries
$WINDOWS_SAFE_ENTRIES=@("NT AUTHORITY\Authenticated Users", "&lt;Domain&gt;\&lt;User&gt;")</code></pre></div>
</div>
<div class="paragraph"><p>Only if there is no other way to ensure the Oracle monitoring you can switch off the access rights check as a final option.</p></div>
<div class="admonitionblock important"><table><tr>
<td class="icon"><img src="../images/icons/important.png" alt="Important"></td>
<td class="content"><div class="paragraph"><p>If you disable the access rights check, the agent plug-in will no longer run securely.</p></div></td>
</tr></table></div>
<div class="listingblock">
<div class="title">C:\ProgramData\checkmk\agent\config\mk_oracle_cfg.ps1</div>
<div class="content"><pre class="pygments highlight"><code><span></span># Oracle plugin will not check if the used binaries are write-protected for non-admin users
$SKIP_ORACLE_SECURITY_CHECK=1</code></pre></div>
</div>
<div class="paragraph"><p>However, there is also another way to execute the agent plug-in — without administrator rights.
You can <a href="agent_windows.html#customizeexecution">customize the execution of the agent plug-in</a> and run it under the local Windows group <code>Users</code>, for example.
To do this, edit the configuration file <code>check_mk.user.yml</code> of the Windows agent, for example like this:</p></div>
<div class="listingblock">
<div class="title">C:\ProgramData\checkmk\agent\check_mk.user.yml</div>
<div class="content"><pre class="pygments highlight"><code><span></span>plugins:
    enabled: yes
    execution:
        - pattern: $CUSTOM_PLUGINS_PATH$\mk_oracle.ps1
          async: yes
<span class="hll">          group: Users
</span>          run: true</code></pre></div>
</div>
<div class="paragraph"><p><span class="image-inline"><img src="../images/CEE.svg" alt="CEE" class="icon-left"></span>
In the commercial editions, you can have these entries created by the Agent Bakery with the agent rule <span class="guihint">Run plug-ins and local checks using non-system account</span>.</p></div>
</div>
</div>
<div class="sect2">
<h3 id="heading__monitoring_remote_databases">
<span class="hidden-anchor sr-only" id="_monitoring_remote_databases"></span>4.5. Monitoring remote databases</h3>
<div class="paragraph"><p>Monitoring remote databases is currently not possible using the Windows agent plug-in.
Therefore if you want to monitor remote databases, you need a host with a compatible <a href="#linux">Unix-like operating system</a>.</p></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="heading_bakery">
<span class="hidden-anchor sr-only" id="bakery"></span>5. Setting up with the Agent Bakery</h2>
<div class="sectionbody">
<div class="paragraph"><p><span class="image-inline"><img src="../images/CEE.svg" alt="CEE" class="icon-left"></span>
The setup can be greatly simplified in the commercial editions with the <a href="glossar.html#agent_bakery">Agent Bakery</a>,
because syntax errors in the configuration files are avoided, and adaptations to changing environments can be implemented more easily.
The main difference compared to a manual configuration is that you only need to work on the Oracle host at the command line if you want to make special Oracle-specific configurations.
You can perform the setup with the Agent Bakery for Linux, Solaris, AIX and Windows.</p></div>
<div class="paragraph"><p>Nevertheless, you cannot configure all functions of the agent plug-in with the Agent Bakery,
for example, if these are functions that require a major intervention and in-depth specialist knowledge.
Accordingly, the <a href="#custom_sqls">custom SQL queries</a> cannot be configured in the Agent Bakery.</p></div>
<div class="paragraph"><p>Via <span class="guihint">Setup &gt; Agents &gt; Windows, Linux, Solaris, AIX</span> and the <span class="guihint">Agents &gt; Agent rules</span> menu, you will find the page with the <span class="guihint">Oracle databases (Linux, Solaris, AIX, Windows)</span> <a href="glossar.html#rule_set">rule set</a>.
Create a new rule with <span class="guihint">Add rule</span>.
Here you will find all options available to you for configuring the agent plug-in:</p></div>
<div class="imageblock"><div class="content"><img src="../images/monitoring_oracle_bakery_ruleset.png" alt="Rule for configuring Oracle in the Agent Bakery."></div></div>
<div class="paragraph"><p>Many options will be familiar to you from the manual setup.
As described there, there are options that are not available for all operating systems.
The title of these options shows for which operating systems they can be used.</p></div>
<div class="sect2">
<h3 id="heading_bakery_users">
<span class="hidden-anchor sr-only" id="bakery_users"></span>5.1. Configuring users</h3>
<div class="paragraph"><p>In the <a href="#user_config">simplest configuration</a> for a Unix-like operating system, the rule will look something like this:</p></div>
<div class="imageblock"><div class="content"><img src="../images/monitoring_oracle_bakery_login1.png" alt="Simplest rule for configuring Oracle in the Agent Bakery."></div></div>
<div class="paragraph"><p>In the Agent Bakery you also have the option of creating standard users and creating exceptions for specific instances.
The options, separated in the configuration file with a colon (for <a href="#adv_user_linux">Linux &amp; Co.</a>) or as list entries (for <a href="#adv_user_windows">Windows</a>),
you will find under <span class="guihint">Login Defaults</span> as individual options which you can then fill out as needed.
Of course, you can also use the <a href="#oracle_wallet">Oracle Wallet</a> here by simply changing <span class="guihint">Authentication method</span> to <span class="guihint">Use manually created Oracle password wallet</span>.</p></div>
<div class="paragraph"><p>The configuration for Automatic Storage Management (ASM) is done analogously via the <span class="guihint">Login for ASM</span> option,
and the exceptions for specific instances are entered under <span class="guihint">Login for selected databases</span>, as described in the advanced user configuration for <a href="#adv_user_linux">Linux, Solaris, AIX</a> and <a href="#adv_user_windows">Windows</a>.</p></div>
</div>
<div class="sect2">
<h3 id="heading_bakery_advanced">
<span class="hidden-anchor sr-only" id="bakery_advanced"></span>5.2. Advanced options</h3>
<div class="paragraph"><p>The following table lists the remaining options in the <span class="guihint">Oracle databases (Linux, Solaris, AIX, Windows)</span> rule set, along with a reference to where to find a description of the option:</p></div>
<table class="table-responsive table-bordered table tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 40%;">
<col style="width: 60%;">
</colgroup>
<thead><tr>
<th class="tableblock halign-left valign-top">Option</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr></thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="guihint">Host uses xinetd or systemd (Linux/AIX/Solaris only)</span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This option must be activated for Unix-like systems with <code>xinetd</code>/<code>systemd</code>.
With <code>systemd</code> the asynchronous execution of the agent plug-in is mandatory — at the interval you specify.
You can find out more about this at the <a href="#install_linux">agent plug-in installation</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="guihint">Instances to monitor</span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This option summarizes several options of the configuration file with which you can include or exclude instances for <a href="#skip_include">Linux, Solaris, AIX</a> or <a href="#skip_include_windows">Windows</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="guihint">Add pre or postfix to TNSALIASes (Linux/AIX/Solaris only)</span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This option allows you to extend the <a href="#tns_config">TNS alias</a> either globally or for a specific instance.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="guihint">Sections - data to collect</span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All available sections are listed under this option, and these can be configured individually at global level.
They therefore correspond to the variables <code>SYNC_SECTIONS</code> and <code>ASYNC_SECTIONS</code> and for ASM their counterparts <code>SYNC_ASM_SECTIONS</code> and <code>ASYNC_ASM_SECTIONS</code>.
More on this in the section on the data to be fetched for <a href="#sections">Linux, Solaris, AIX</a> or <a href="#sections_windows">Windows</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="guihint">Exclude some sections on certain instances</span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If you do not want to use <code>EXCLUDE_&lt;SID&gt;</code> to exclude the entire instance, but only to exclude a few sections, you can do so with this option, as described for <a href="#sections">Linux, Solaris, AIX</a> or <a href="#sections_windows">Windows</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="guihint">Cache age for background checks</span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specify here how long asynchronous sections should remain valid.
The default value is 600 seconds (10 minutes).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="guihint">Sqlnet Send timeout</span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This option is added to the <code>sqlnet.ora</code> file and sets a timeout that applies to all instances.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="guihint">Remote instances (Linux/AIX/Solaris only)</span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configure <a href="#remote_instances">remote instances</a> with this option.
It contains all elements of the configuration that you already know.
To specify the variable’s ID, via <span class="guihint">Unique ID</span> you can select from various options.
You just have to make sure that the ID is unique within the configuration.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="guihint">ORACLE_HOME to use for remote access (Linux/AIX/Solaris only)</span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Here you can determine where the agent plug-in finds the <code>sqlplus</code> program.
You must enter a value here if you want to monitor a <a href="#remote_instances">remote instance</a>, but <code>sqlplus</code> cannot be found via the environment variables.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="guihint">TNS_ADMIN to use for sqlnet.ora and tnsnames.ora (Linux/AIX/Solaris only)</span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If the two files are located in a directory other than <code>/etc/check_mk/</code>, you can use this option to specify the path name via the environment variable <a href="#tns_config"><code>TNS_ADMIN</code></a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="guihint">sqlnet.ora permission group (Linux/AIX/Solaris only)</span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enter here the Linux group of the non-privileged user who owns the Oracle binaries so that this user can read the <code>sqlnet.ora</code> file created by the Agent Bakery.
For a standard Oracle installation, <code>oinstall</code> can be used as group.<br>
Further information can be found in the section <a href="#access_linux">Access rights on execution</a> for Linux.
Other files and directories are also mentioned there, e.g. <code>tnsnames.ora</code>, which are not created by the Agent Bakery.
For these manually created files and directories you must also set the necessary permissions manually.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="guihint">Oracle binaries permissions check (Windows only)</span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Here you can configure the access rights check for the Oracle binaries by allowing individual, non-administrative users and groups to execute the programs.
You should only switch off the check if you know what you are doing.
You can find more information on this topic in the section <a href="#access_windows">Access rights on execution</a> for Windows.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="heading_clustered_instances">
<span class="hidden-anchor sr-only" id="clustered_instances"></span>6. Clustered instances</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="heading__standby_databases">
<span class="hidden-anchor sr-only" id="_standby_databases"></span>6.1. Standby databases</h3>
<div class="paragraph"><p>Oracle supports so-called <em>standby databases</em> which can perform specified tasks, and which are usually simply copies of production or primary databases.
These database concepts also require special monitoring mechanisms.
You can find out more about these mechanisms in the following sections.</p></div>
<div class="sect3">
<h4 id="heading_cluster_adg">
<span class="hidden-anchor sr-only" id="cluster_adg"></span>With Active Data Guard (ADG)</h4>
<div class="paragraph"><p>Once you have licensed and activated ADG, you do not need to make any changes to the configuration of the agent plug-in, since you can read from a standby instance at any time without having to interrupt the synchronization with the primary instance.</p></div>
</div>
<div class="sect3">
<h4 id="heading_cluster_dg">
<span class="hidden-anchor sr-only" id="cluster_dg"></span>Without Active Data Guard (DG)</h4>
<div class="paragraph"><p>If the instances do not have ADG, the user with which the monitoring data from the standby instances is to be fetched needs the <code>SYSDBA</code> role.
This permission enables the user to fetch at least part of the data, even if the primary instance fails and the instance on the standby server has not yet been changed from <code>MOUNTED</code> to <code>OPEN</code>.</p></div>
<div class="paragraph"><p>Assign the permission to the user who is authorized to retrieve the data from the instances.
<strong>Important:</strong> How this works may differ from the following example.
Here the role is assigned to the user as created in the <a href="#first_steps">initial setup</a> example:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="sql"><span></span><span class="tok-n">sqlplus</span><span class="tok-o">&gt;</span><span class="tok-w"> </span><span class="tok-k">grant</span><span class="tok-w"> </span><span class="tok-n">sysdba</span><span class="tok-w"> </span><span class="tok-k">to</span><span class="tok-w"> </span><span class="tok-n">checkmk</span><span class="tok-p">;</span></code></pre></div></div>
<div class="paragraph"><p>To enable the data to be queried by the agent plug-in on the standby server in case of an error, create the user on the primary instance, and then copy the password file to the standby server.
Finally, in the plug-in’s configuration file, set the role of the user to <code>SYSDBA</code>:</p></div>
<div class="listingblock">
<div class="title">/etc/check_mk/mk_oracle.cfg</div>
<div class="content"><pre class="pygments highlight"><code><span></span># Syntax:
# DBUSER='USER:PASSWORD:ROLE:HOST:PORT:TNSALIAS'
DBUSER='checkmk:myPassword:sysdba'</code></pre></div>
</div>
<div class="paragraph"><p>Note that specifying a host, port, or TNS alias is optional, and can be omitted.
In addition, the agent plug-in must of course be installed on the host of the primary instance as well as on the hosts of the standby instances.</p></div>
</div>
<div class="sect3">
<h4 id="heading_clustered_services">
<span class="hidden-anchor sr-only" id="clustered_services"></span>Setting up cluster services</h4>
<div class="paragraph"><p>On Checkmk side, it is necessary — regardless of whether you are using ADG or DG — to customize the services and assign them to a <em>cluster host</em>.
The corresponding check plug-ins have already been prepared to the extent that they can also be configured as <a href="clustered_services.html">cluster services</a>.
Create a cluster host in Checkmk and add the individual Oracle hosts on which the primary and standby instances are running to it as nodes.
Then assign the following services to this cluster host:</p></div>
<div class="ulist"><ul>
<li><p><code>ORA .* RMAN Backup</code></p></li>
<li><p><code>ORA .* Job</code></p></li>
<li><p><code>ORA .* Tablespaces</code></p></li>
</ul></div>
<div class="paragraph"><p>After this you will no longer need to worry about which instance the data comes from, and will have ensured seamless monitoring of the above-mentioned services — even in the event of a switchover of the primary instance.</p></div>
</div>
</div>
<div class="sect2">
<h3 id="heading_rac">
<span class="hidden-anchor sr-only" id="rac"></span>6.2. Real Application Cluster (RAC)</h3>
<div class="paragraph"><p>Since there is a central storage for the data in a RAC, it is sufficient here to create the user for the agent plug-in only once.
Only the agent plug-in needs to be installed and configured on each node of the Oracle cluster.</p></div>
<div class="paragraph"><p><strong>Important:</strong> Always set up the cluster’s nodes yourself, and do not query the Oracle <em>SCAN listener</em>.
This is the only way to ensure that access via the agent plug-in works correctly.</p></div>
<div class="sect3">
<h4 id="heading__setting_up_cluster_services">
<span class="hidden-anchor sr-only" id="_setting_up_cluster_services"></span>Setting up cluster services</h4>
<div class="paragraph"><p>It also makes sense to set up cluster services for a RAC.
In addition to the services that you assign to the cluster host under an <a href="#cluster_adg">(Active) Data Guard</a>, you also assign the following services to the cluster host to ensure seamless monitoring in the event of a switch over:</p></div>
<div class="ulist"><ul>
<li><p><code>ASM.* Diskgroup</code></p></li>
<li><p><code>ORA .* Recovery Area</code></p></li>
</ul></div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="heading_custom_sqls">
<span class="hidden-anchor sr-only" id="custom_sqls"></span>7. Custom SQL queries (Custom SQLs)</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="heading__why_custom_sql_queries">
<span class="hidden-anchor sr-only" id="_why_custom_sql_queries"></span>7.1. Why custom SQL queries?</h3>
<div class="paragraph"><p>With its agent plug-in Checkmk already provides a large number of SQL queries with which you can monitor your database instances.
To make these suitable for the widest possible range of technical and content requirements, they are of course kept in a very generalized form.</p></div>
<div class="paragraph"><p>In order to be able to meet the individual requirements of each company for the monitoring of a specific database, Checkmk provides the possibility of creating your own custom SQL queries (<em>custom SQLs</em> for short) and having them retrieved with the agent plug-in.
These custom SQL queries are then automatically recognized and monitored as own services in the Web interface.</p></div>
<div class="admonitionblock tip"><table><tr>
<td class="icon"><img src="../images/icons/tip.png" alt="Tip"></td>
<td class="content"><div class="paragraph"><p>It is only possible to use custom SQL queries under Linux, Solaris and AIX.
This option is not available under Windows.</p></div></td>
</tr></table></div>
</div>
<div class="sect2">
<h3 id="heading__simple_custom_sql_queries">
<span class="hidden-anchor sr-only" id="_simple_custom_sql_queries"></span>7.2. Simple custom SQL queries</h3>
<div class="sect3">
<h4 id="heading__writing_sql_queries">
<span class="hidden-anchor sr-only" id="_writing_sql_queries"></span>Writing SQL queries</h4>
<div class="paragraph"><p>The easiest way to connect such a SQL is to use the <a href="https://checkmk.com/integrations/oracle_sql" target="_blank">Oracle Database: Custom SQLs</a> check plug-in.
To do this, first create the <code>MyCustomSQL.sql</code> file in the agent’s configuration directory on the host on which the SQL is to be executed.</p></div>
<div class="paragraph"><p>The following is a dummy that illustrates the syntax:</p></div>
<div class="listingblock">
<div class="title">/etc/check_mk/MyCustomSQL.sql</div>
<div class="content"><pre class="pygments highlight"><code data-lang="sql"><span></span><span class="tok-cm">/*Syntax help in comments. The first word is alwyas the key word and ends with a ":"*/</span>

<span class="tok-cm">/*details:Text to display in the service detail output*/</span>
<span class="tok-n">prompt</span><span class="tok-w"> </span><span class="tok-n">details</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-k">Some</span><span class="tok-w"> </span><span class="tok-n">details</span><span class="tok-w"> </span><span class="tok-k">for</span><span class="tok-w"> </span><span class="tok-n">the</span><span class="tok-w"> </span><span class="tok-n">service</span><span class="tok-w"> </span><span class="tok-k">output</span><span class="tok-p">;</span>

<span class="tok-cm">/*perfdata:METRIKNAME=CURRENTVALUE;WARN;CRIT;MAX METRIKNAME=CURRENTVALUE2;WARN;CRIT;MAX*/</span>
<span class="tok-n">prompt</span><span class="tok-w"> </span><span class="tok-n">perfdata</span><span class="tok-p">:</span><span class="tok-n">MyMetricName1</span><span class="tok-o">=</span><span class="tok-mi">10</span><span class="tok-p">;</span><span class="tok-mi">15</span><span class="tok-p">;</span><span class="tok-mi">20</span><span class="tok-p">;</span><span class="tok-mi">30</span><span class="tok-w"> </span><span class="tok-n">MyMetricName2</span><span class="tok-o">=</span><span class="tok-mi">16</span><span class="tok-p">;</span><span class="tok-mi">15</span><span class="tok-p">;</span><span class="tok-mi">20</span><span class="tok-p">;</span><span class="tok-mi">30</span><span class="tok-p">;</span>
<span class="tok-n">prompt</span><span class="tok-w"> </span><span class="tok-n">perfdata</span><span class="tok-p">:</span><span class="tok-n">MyMetricName3</span><span class="tok-o">=</span><span class="tok-mi">21</span><span class="tok-p">;</span><span class="tok-mi">15</span><span class="tok-p">;</span><span class="tok-mi">20</span><span class="tok-p">;</span><span class="tok-mi">30</span><span class="tok-w"> </span><span class="tok-n">MyMetricName4</span><span class="tok-o">=</span><span class="tok-mi">15</span><span class="tok-p">;</span><span class="tok-mi">15</span><span class="tok-p">;</span><span class="tok-mi">20</span><span class="tok-p">;</span><span class="tok-mi">30</span><span class="tok-p">;</span>

<span class="tok-cm">/*long:Text to display in the long output of the service*/</span>
<span class="tok-n">prompt</span><span class="tok-w"> </span><span class="tok-n">long</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-n">Here</span><span class="tok-w"> </span><span class="tok-n">comes</span><span class="tok-w"> </span><span class="tok-k">some</span><span class="tok-w"> </span><span class="tok-n">long</span><span class="tok-w"> </span><span class="tok-k">output</span><span class="tok-w"> </span><span class="tok-k">for</span><span class="tok-w"> </span><span class="tok-n">the</span><span class="tok-w"> </span><span class="tok-n">service</span><span class="tok-p">;</span>
<span class="tok-n">prompt</span><span class="tok-w"> </span><span class="tok-n">long</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-n">Here</span><span class="tok-w"> </span><span class="tok-n">comes</span><span class="tok-w"> </span><span class="tok-k">some</span><span class="tok-w"> </span><span class="tok-k">more</span><span class="tok-w"> </span><span class="tok-n">long</span><span class="tok-w"> </span><span class="tok-k">output</span><span class="tok-w"> </span><span class="tok-k">for</span><span class="tok-w"> </span><span class="tok-n">the</span><span class="tok-w"> </span><span class="tok-n">service</span><span class="tok-p">;</span>

<span class="tok-cm">/*exit:Status of the service as a number*/</span>
<span class="tok-n">prompt</span><span class="tok-w"> </span><span class="tok-n">exit</span><span class="tok-p">:</span><span class="tok-mi">2</span><span class="tok-p">;</span></code></pre></div>
</div>
<div class="paragraph"><p>The example shows on the one hand that you can define any number of statements in such a file.
On the other hand, the syntax is very similar to that of a <a href="glossar.html#local_check">local check</a>, especially with regard to <a href="glossar.html#metric">metrics</a>.
In detail, this syntax is much more powerful here, because you can generate multi-line output, and this is then processed on the Checkmk server as a service.
In principle, all lines are optional and do not need to be filled.</p></div>
<div class="paragraph"><p>The possible keywords are in detail:</p></div>
<div class="ulist"><ul>
<li><p><code>details</code>:
Here you can determine what should be output in the generated service’s <span class="guihint">Summary</span>.
This line is introduced with the keyword and a colon.
The rest of the line is the output.</p></li>
<li><p><code>perfdata</code>:
Metrics is passed with this keyword.
Within a line, you can create any number of metrics — each separated by a space.
You can also distribute the output of the metrics over several lines.
Just always start with the keyword <code>perfdata:</code>.</p></li>
<li><p><code>long</code>:
If the service should have a long output for the <span class="guihint">Details</span> field, you can specify it here.
You can also use this keyword multiple times to create multiple lines in the <span class="guihint">Details</span>.</p></li>
<li><p><code>exit</code>:
If the output should have a certain status, you can specify this here.
The known assignments <code>0</code>, <code>1</code>, <code>2</code>, <code>3</code> are available for the statuses <span class="state0">OK</span>, <span class="state1">WARN</span>, <span class="state2">CRIT</span>, <span class="state3">UNKNOWN</span>.</p></li>
</ul></div>
<div class="admonitionblock tip"><table><tr>
<td class="icon"><img src="../images/icons/tip.png" alt="Tip"></td>
<td class="content"><div class="paragraph"><p>You do not have to define the keyword <code>elapsed</code> manually.
It is generated automatically at runtime to check how long the statements you defined took to process.</p></div></td>
</tr></table></div>
</div>
<div class="sect3">
<h4 id="heading__configuring_the_agent_plug_in">
<span class="hidden-anchor sr-only" id="_configuring_the_agent_plug_in"></span>Configuring the agent plug-in</h4>
<div class="paragraph"><p>Now that you have defined your first, very simple SQL, make it known to the agent plug-in <code>mk_oracle</code>.
This is done via the familiar configuration file, which you can expand accordingly:</p></div>
<div class="listingblock">
<div class="title">/etc/check_mk/mk_oracle.cfg</div>
<div class="content"><pre class="pygments highlight"><code><span></span>SQLS_SECTIONS="mycustomsection1"

mycustomsection1 () {
    SQLS_SIDS="INST1"
    SQLS_DIR="/etc/check_mk"
    SQLS_SQL="MyCustomSQL.sql"
}</code></pre></div>
</div>
<div class="paragraph"><p>With the first option (<code>SQLS_SECTIONS</code>) you determine which individual sections you want to have executed.
Note that <em>section</em> here means a part of the agent plug-in output — and <em>not</em> a part of a database instance.
In the example, we have only specified one section (<code>mycustomsection1</code>) and then described it in more detail directly afterwards.
Each section is actually a small function called by the agent plug-in.</p></div>
<div class="paragraph"><p>In this function you can then determine further details and specify for which instances (<code>SQLS_SIDS</code>) this section applies.
In addition, you also define where the file with the SQL statements is located (<code>SQLS_DIR</code>), and the name of this file (<code>SQLS_SQL</code>).</p></div>
<div class="paragraph"><p>This simple configuration is sufficient to be able to see the result in Checkmk.
To do this, perform a <a href="glossar.html#service_discovery">service discovery</a> and activate the new service.
Afterwards you will see this new service with the other services in the host overview:</p></div>
<div class="imageblock"><div class="content"><img src="../images/monitoring_oracle_custom_sqls_list.png" alt="The new service created by custom SQL queries in the service list."></div></div>
</div>
</div>
<div class="sect2">
<h3 id="heading_adv_custom_sqls">
<span class="hidden-anchor sr-only" id="adv_custom_sqls"></span>7.3. Advanced options</h3>
<div class="paragraph"><p>The possibilities to monitor with custom SQL queries of course go beyond the simple example shown above.
In the following you will find an overview of the available variables that you can use in the <code>mk_oracle.cfg</code> configuration file.
For a detailed description, you can also call the agent plug-in <code>mk_oracle</code> with the <code>--help</code> option.</p></div>
<div class="admonitionblock tip"><table><tr>
<td class="icon"><img src="../images/icons/tip.png" alt="Tip"></td>
<td class="content"><div class="paragraph"><p>Variables that can only be set outside or only within a section function are marked accordingly.
All others can be defined in both sections.
If they are set outside of a section, they will apply globally to all sections.</p></div></td>
</tr></table></div>
<table class="table-responsive table-bordered table tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 10%;">
<col style="width: 85%;">
<col style="width: 5%;">
</colgroup>
<thead><tr>
<th class="tableblock halign-left valign-top">Variable</th>
<th class="tableblock halign-left valign-top">Short description</th>
<th class="tableblock halign-left valign-top">Optional</th>
</tr></thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SQLS_SECTIONS</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The self-defined section functions to be executed by the agent plug-in.<br>
This variable can only be set globally (outside of a section function).</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SQLS_SIDS</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The instances that are to execute the section(s).</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SQLS_DIR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The path name of the directory in which the files with the custom SQL queries are stored.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SQLS_SQL</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The file that contains the SQL statements for a section.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SQLS_SECTION_NAME</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the section that you evaluate with an <a href="#own_check_plug-in">own check plug-in</a> for the custom SQL queries.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SQLS_SECTION_SEP</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The separator of the individual elements in a line of the output, defined as a decimal <a href="https://en.wikipedia.org/wiki/ASCII#Printable_characters" target="_blank">ASCII</a> ID.
This variable can only be used in conjunction with the variable <code>SQLS_SECTION_NAME</code>.
We recommend that you define your own separator for your own sections and use the ASCII ID <code>124</code> for the pipe character (<code>|</code>), as the agent plug-in always separates the elements of the output in the event of an error with <code>|</code>, in the format <code>&lt;SID&gt;|FAILURE|&lt;error description&gt;</code>.
The following characters may <em>not</em> be used as a separator: <code>;</code> <code>[</code> <code>]</code> <code>=</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SQLS_ITEM_NAME</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies a part of the generated service name.
By default, the service name is composed of SID and the file name with the custom SQL queries.
The value of this variable replaces the file name in the service name.<br>
This variable can only be set locally (within a section function).
It cannot be used together with the variable <code>SQLS_SECTION_NAME</code>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SQLS_MAX_CACHE_AGE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Performs the same task as <a href="#sections"><code>CACHE_MAXAGE</code></a> — but for the custom SQL queries.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SQLS_DBUSER</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines an individual user for a section.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SQLS_DBPASSWORD</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines the password of the user defined with <code>SQLS_DBUSER</code>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SQLS_DBSYSCONNECT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only if the user defined with <code>SQLS_DBUSER</code> is <code>SYSDBA</code> or <code>SYSOPER</code> you have to define the associated role (<code>SYSDBA</code> or <code>SYSOPER</code>) with this variable.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SQLS_TNSALIAS</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines an individual <a href="#tns_config">TNS alias</a> for a section.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="heading_own_check_plug-in">
<span class="hidden-anchor sr-only" id="own_check_plug-in"></span>7.4. Using your own check plug-ins</h3>
<div class="paragraph"><p>If the possibilities of the syntax described above are not sufficient, you can also use the <code>SQLS_SECTION_NAME</code> variable to output your own section names for one or more SQL queries and define your own separator with <code>SQLS_SECTION_SEP</code>.
However, this requires that you have also written an appropriate check plug-in and included it in your Checkmk <a href="glossar.html#site">site</a>.</p></div>
<div class="paragraph"><p>If you have written such a check plug-in, you are completely free to evaluate the output of the self-defined sections of the agent plug-in and can go your own way.
Since this method is the most comprehensive, and also the most difficult, it is only mentioned here for completeness.
It assumes that you know how to write an <a href="devel_check_plugins.html">agent-based check plug-in</a> and integrate it into the site.
After that you assign the custom SQL queries with the variables to this check plug-in.</p></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="heading_diagnostic">
<span class="hidden-anchor sr-only" id="diagnostic"></span>8. Diagnostic options</h2>
<div class="sectionbody">
<div class="paragraph"><p>Under Linux, diagnostics are performed by calling the agent plug-in <code>mk_oracle</code> with various options.
With <code>mk_oracle --help</code> you can display an overview of all available options.</p></div>
<div class="sect2">
<h3 id="heading_connection_test">
<span class="hidden-anchor sr-only" id="connection_test"></span>8.1. Testing connections</h3>
<div class="admonitionblock tip"><table><tr>
<td class="icon"><img src="../images/icons/tip.png" alt="Tip"></td>
<td class="content"><div class="paragraph"><p>The connection test described below also checks whether the necessary access rights are set during execution on <a href="#access_linux">Linux</a> or <a href="#access_windows">Windows</a>.
If access rights are missing, these are displayed with specific suggestions for rectification.
The exact procedure for diagnosing and correcting access rights can be found in the <a href="https://checkmk.atlassian.net/wiki/spaces/KB/pages/70582273/" target="_blank">Checkmk Knowledge Base</a>.</p></div></td>
</tr></table></div>
<div class="sect3">
<h4 id="heading__linux_solaris_aix">
<span class="hidden-anchor sr-only" id="_linux_solaris_aix"></span>Linux, Solaris, AIX</h4>
<div class="paragraph"><p>If you have problems connecting to one or more instances on an Oracle server, the first thing you can do is to check basic parameters.
If you start the agent plug-in with the <code>-t</code> option, it displays the details of a connection.
Note that the agent plug-in must be provided with the paths to its configuration file and to the plugin’s cached data beforehand.
In the output the <em>dummy sections</em> have been omitted for readability.</p></div>
<div class="paragraph"><p>The following example is for a Linux server with <code>systemd</code>, on which the agent plug-in is executed <a href="#install_linux">asynchronously</a> every 60 seconds:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">root@linux# </span><span class="tok-nb">export</span><span class="tok-w"> </span><span class="tok-nv">MK_CONFDIR</span><span class="tok-o">=</span><span class="tok-s2">"/etc/check_mk/"</span><span class="tok-p">;</span><span class="tok-w"> </span><span class="tok-nb">export</span><span class="tok-w"> </span><span class="tok-nv">MK_VARDIR</span><span class="tok-o">=</span><span class="tok-s2">"/var/lib/check_mk_agent"</span>
<span class="tok-gp">root@linux# </span>/usr/lib/check_mk_agent/plugins/60/mk_oracle<span class="tok-w"> </span>-t<span class="tok-w"> </span>--no-spool
<span class="tok-go">---login----------------------------------------------------------------</span>
<span class="tok-go">    Operating System:       Linux</span>
<span class="tok-go">    ORACLE_HOME (oratab):   /u01/app/oracle/product/11.2.0/xe</span>
<span class="tok-go">    Logincheck to Instance: XE</span>
<span class="tok-go">    Version:                11.2</span>
<span class="tok-go">    Login ok User:          checkmk on ORA-SRV01 Instance XE</span>
<span class="tok-go">    SYNC_SECTIONS:          instance dataguard_stats processes longactivesessions sessions recovery_status undostat logswitches recovery_area performance</span>
<span class="tok-go">    ASYNC_SECTIONS:         tablespaces rman jobs ts_quotas resumable</span>
<span class="tok-go">------------------------------------------------------------------------</span></code></pre></div></div>
<div class="paragraph"><p>On a Linux server with <code>xinetd</code>, call <code>mk_oracle</code> for the connection test as follows instead:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">root@linux# </span>/usr/lib/check_mk_agent/plugins/mk_oracle<span class="tok-w"> </span>-t</code></pre></div></div>
<div class="paragraph"><p>Since this call is more likely to be made in the event of an error, you will then also receive further information:
Both the <em>connection string</em> that was used for the connection and the first 100 characters of the error message that was returned during the connection attempt.
With the help of this information, you can quickly identify simple configuration problems and then correct them accordingly.</p></div>
</div>
<div class="sect3">
<h4 id="heading__windows">
<span class="hidden-anchor sr-only" id="_windows"></span>Windows</h4>
<div class="paragraph"><p>The agent plug-in does not accept any parameters under Windows.
So to test the connection here, temporarily limit the sections to be retrieved to <code>instance</code> and activate the <code>DEBUG</code> option:</p></div>
<div class="listingblock">
<div class="title">C:\ProgramData\checkmk\agent\config\mk_oracle_cfg.ps1</div>
<div class="content"><pre class="pygments highlight"><code><span></span># Syntax:
# $DBUSER = @("USERNAME", "PASSWORD")
$DBUSER = @("checkmk", "myPassword")

SYNC_SECTIONS = @("instance")
ASYNC_SECTIONS = @("")
DEBUG = 1</code></pre></div>
</div>
<div class="paragraph"><p>Then run the agent plug-in manually.
Again, you will get information about how the plug-in tries to access the instances.
An output may then look like this, for example:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="powershell"><span></span><span class="tok-nb">PS </span><span class="tok-n">C</span><span class="tok-p">:\</span><span class="tok-n">ProgramData</span><span class="tok-p">\</span><span class="tok-n">checkmk</span><span class="tok-p">\</span><span class="tok-n">agent</span><span class="tok-p">\</span><span class="tok-n">plugins</span><span class="tok-p">\&gt;</span> <span class="tok-p">.\</span><span class="tok-n">mk_oracle</span><span class="tok-p">.</span><span class="tok-n">ps1</span>
<span class="tok-n">2020</span><span class="tok-p">-</span><span class="tok-n">08</span><span class="tok-p">-</span><span class="tok-n">23T12</span><span class="tok-p">:</span><span class="tok-n">48</span><span class="tok-p">:</span><span class="tok-n">20</span><span class="tok-p">.</span><span class="tok-n">3930944</span><span class="tok-p">+</span><span class="tok-n">02</span><span class="tok-p">:</span><span class="tok-n">00</span> <span class="tok-n">DEBUG</span><span class="tok-p">:</span><span class="tok-n">value</span> <span class="tok-n">of</span> <span class="tok-n">DBVERSION</span> <span class="tok-n">software</span> <span class="tok-p">=</span> <span class="tok-n">xxx112020xxx</span>
<span class="tok-p">&lt;&lt;&lt;</span><span class="tok-n">oracle_instances</span><span class="tok-p">&gt;&gt;&gt;</span>
<span class="tok-n">2020</span><span class="tok-p">-</span><span class="tok-n">08</span><span class="tok-p">-</span><span class="tok-n">23T12</span><span class="tok-p">:</span><span class="tok-n">48</span><span class="tok-p">:</span><span class="tok-n">20</span><span class="tok-p">.</span><span class="tok-n">3930944</span><span class="tok-p">+</span><span class="tok-n">02</span><span class="tok-p">:</span><span class="tok-n">00</span> <span class="tok-n">DEBUG</span><span class="tok-p">:</span><span class="tok-n">value</span> <span class="tok-n">of</span> <span class="tok-n">inst_name</span> <span class="tok-p">=</span> <span class="tok-n">xxxXExxx</span>
<span class="tok-n">2020</span><span class="tok-p">-</span><span class="tok-n">08</span><span class="tok-p">-</span><span class="tok-n">23T12</span><span class="tok-p">:</span><span class="tok-n">48</span><span class="tok-p">:</span><span class="tok-n">20</span><span class="tok-p">.</span><span class="tok-n">3930944</span><span class="tok-p">+</span><span class="tok-n">02</span><span class="tok-p">:</span><span class="tok-n">00</span> <span class="tok-n">DEBUG</span><span class="tok-p">:</span><span class="tok-n">value</span> <span class="tok-n">of</span> <span class="tok-n">DBVERSION</span> <span class="tok-n">database</span> <span class="tok-p">=</span> <span class="tok-n">xxx112020xxx</span>
<span class="tok-n">2020</span><span class="tok-p">-</span><span class="tok-n">08</span><span class="tok-p">-</span><span class="tok-n">23T12</span><span class="tok-p">:</span><span class="tok-n">48</span><span class="tok-p">:</span><span class="tok-n">20</span><span class="tok-p">.</span><span class="tok-n">3930944</span><span class="tok-p">+</span><span class="tok-n">02</span><span class="tok-p">:</span><span class="tok-n">00</span> <span class="tok-n">DEBUG</span><span class="tok-p">:</span><span class="tok-n">value</span> <span class="tok-n">of</span> <span class="tok-n">the_section</span> <span class="tok-p">=</span> <span class="tok-n">sql_instance</span>
<span class="tok-n">2020</span><span class="tok-p">-</span><span class="tok-n">08</span><span class="tok-p">-</span><span class="tok-n">23T12</span><span class="tok-p">:</span><span class="tok-n">48</span><span class="tok-p">:</span><span class="tok-n">20</span><span class="tok-p">.</span><span class="tok-n">3930944</span><span class="tok-p">+</span><span class="tok-n">02</span><span class="tok-p">:</span><span class="tok-n">00</span> <span class="tok-n">DEBUG</span><span class="tok-p">:</span><span class="tok-n">now</span> <span class="tok-n">calling</span> <span class="tok-n">multiple</span> <span class="tok-n">SQL</span>
<span class="tok-n">2020</span><span class="tok-p">-</span><span class="tok-n">08</span><span class="tok-p">-</span><span class="tok-n">23T12</span><span class="tok-p">:</span><span class="tok-n">48</span><span class="tok-p">:</span><span class="tok-n">20</span><span class="tok-p">.</span><span class="tok-n">3930944</span><span class="tok-p">+</span><span class="tok-n">02</span><span class="tok-p">:</span><span class="tok-n">00</span> <span class="tok-n">DEBUG</span><span class="tok-p">:</span><span class="tok-n">value</span> <span class="tok-n">of</span> <span class="tok-n">sql_connect</span> <span class="tok-k">in</span> <span class="tok-n">dbuser</span> <span class="tok-p">=</span> <span class="tok-n">checkmk</span><span class="tok-p">/</span><span class="tok-n">myPassword</span><span class="tok-p">@(</span><span class="tok-n">DESCRIPTION</span><span class="tok-p">=(</span><span class="tok-n">ADDRESS</span><span class="tok-p">=(</span><span class="tok-n">PROTOCOL</span><span class="tok-p">=</span><span class="tok-n">TCP</span><span class="tok-p">)(</span><span class="tok-n">HOST</span><span class="tok-p">=</span><span class="tok-n">localhost</span><span class="tok-p">)(</span><span class="tok-n">PORT</span><span class="tok-p">=</span><span class="tok-n">1521</span><span class="tok-p">))(</span><span class="tok-n">CONNECT_DATA</span><span class="tok-p">=(</span><span class="tok-n">SID</span><span class="tok-p">=</span><span class="tok-n">XE</span><span class="tok-p">)))</span> <span class="tok-n">as</span> <span class="tok-n">sysdba</span>
<span class="tok-p">&lt;&lt;&lt;</span><span class="tok-n">oracle_instance</span><span class="tok-p">&gt;&gt;&gt;</span>
<span class="tok-n">XE</span><span class="tok-p">|</span><span class="tok-n">FAILURE</span><span class="tok-p">|...</span></code></pre></div></div>
</div>
</div>
<div class="sect2">
<h3 id="heading_logging">
<span class="hidden-anchor sr-only" id="logging"></span>8.2. Logging</h3>
<div class="sect3">
<h4 id="heading__linux_solaris_aix_2">
<span class="hidden-anchor sr-only" id="_linux_solaris_aix_2"></span>Linux, Solaris, AIX</h4>
<div class="paragraph"><p>If the error cannot be found by checking a simple connection, the next step is to create a a log file, which logs all of the agent plug-in’s steps.
Do not forget the necessary environment variables here either.
In the following example, the output of the sections has also been omitted to improve readability.</p></div>
<div class="paragraph"><p>Here is the call for a Linux server with <code>systemd</code>, on which the agent plug-in is executed <a href="#install_linux">asynchronously</a> every 60 seconds:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">root@linux# </span><span class="tok-nb">export</span><span class="tok-w"> </span><span class="tok-nv">MK_CONFDIR</span><span class="tok-o">=</span><span class="tok-s2">"/etc/check_mk/"</span><span class="tok-p">;</span><span class="tok-w"> </span><span class="tok-nb">export</span><span class="tok-w"> </span><span class="tok-nv">MK_VARDIR</span><span class="tok-o">=</span><span class="tok-s2">"/var/lib/check_mk_agent"</span>
<span class="tok-gp">root@linux# </span>/usr/lib/check_mk_agent/plugins/60/mk_oracle<span class="tok-w"> </span>-l<span class="tok-w"> </span>--no-spool
<span class="tok-go">Start logging to file: /var/lib/check_mk_agent/log/mk_oracle.log</span></code></pre></div></div>
<div class="paragraph"><p>Here is the call of <code>mk_oracle</code> for logging on a Linux server with <code>xinetd</code>:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">root@linux# </span>/usr/lib/check_mk_agent/plugins/mk_oracle<span class="tok-w"> </span>-l</code></pre></div></div>
<div class="paragraph"><p>You can use the generated log file to identify very precisely on which line of the script the problem has occurred.</p></div>
</div>
<div class="sect3">
<h4 id="heading__windows_2">
<span class="hidden-anchor sr-only" id="_windows_2"></span>Windows</h4>
<div class="paragraph"><p>Logging under Windows works similarly to the connection test described above.
If the connection itself is stable, you can add the real sections back to the configuration file and then get a complete logging output.</p></div>
</div>
</div>
<div class="sect2">
<h3 id="heading_debugging">
<span class="hidden-anchor sr-only" id="debugging"></span>8.3. Debugging</h3>
<div class="sect3">
<h4 id="heading__linux_solaris_aix_3">
<span class="hidden-anchor sr-only" id="_linux_solaris_aix_3"></span>Linux, Solaris, AIX</h4>
<div class="paragraph"><p>If you cannot get to the problem, even with the help of the log, as a last option the agent plug-in provides the complete output of all steps for error analysis.
This output is therefore the most comprehensive, and certainly the most difficult to read method to get to the cause of a problem, and should therefore only be used as a last resort.</p></div>
<div class="paragraph"><p>The following is an example of debugging on a Linux server with <code>systemd</code>, on which the agent plug-in is executed <a href="#install_linux">asynchronously</a> every 60 seconds:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">root@linux# </span><span class="tok-nb">export</span><span class="tok-w"> </span><span class="tok-nv">MK_CONFDIR</span><span class="tok-o">=</span><span class="tok-s2">"/etc/check_mk/"</span><span class="tok-p">;</span><span class="tok-w"> </span><span class="tok-nb">export</span><span class="tok-w"> </span><span class="tok-nv">MK_VARDIR</span><span class="tok-o">=</span><span class="tok-s2">"/var/lib/check_mk_agent"</span>
<span class="tok-gp">root@linux# </span>/usr/lib/check_mk_agent/plugins/60/mk_oracle<span class="tok-w"> </span>-d<span class="tok-w"> </span>--no-spool</code></pre></div></div>
<div class="paragraph"><p>Here is the call of <code>mk_oracle</code> for debugging on a Linux server with <code>xinetd</code>:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="console"><span></span><span class="tok-gp">root@linux# </span>/usr/lib/check_mk_agent/plugins/mk_oracle<span class="tok-w"> </span>-d</code></pre></div></div>
<div class="paragraph"><p><strong>Important:</strong> In this output sensitive data such as passwords is <em>not</em> masked.
So everything is readable in plain text.</p></div>
</div>
<div class="sect3">
<h4 id="heading__windows_3">
<span class="hidden-anchor sr-only" id="_windows_3"></span>Windows</h4>
<div class="paragraph"><p>A similar functionality is available under Windows.
However, since you cannot pass any arguments to the agent plug-in, you will need to switch on tracing manually:</p></div>
<div class="listingblock"><div class="content"><pre class="pygments highlight"><code data-lang="powershell"><span></span><span class="tok-nb">PS </span><span class="tok-n">C</span><span class="tok-p">:\</span><span class="tok-n">ProgramData</span><span class="tok-p">\</span><span class="tok-n">checkmk</span><span class="tok-p">\</span><span class="tok-n">agent</span><span class="tok-p">\</span><span class="tok-n">plugins</span><span class="tok-p">\&gt;</span> <span class="tok-nb">Set-PSDebug</span> <span class="tok-n">-Trace</span> <span class="tok-n">1</span>
<span class="tok-nb">PS </span><span class="tok-n">C</span><span class="tok-p">:\</span><span class="tok-n">ProgramData</span><span class="tok-p">\</span><span class="tok-n">checkmk</span><span class="tok-p">\</span><span class="tok-n">agent</span><span class="tok-p">\</span><span class="tok-n">plugins</span><span class="tok-p">\&gt;</span> <span class="tok-p">.\</span><span class="tok-n">mk_oracle</span><span class="tok-p">.</span><span class="tok-n">ps1</span></code></pre></div></div>
</div>
</div>
<div class="sect2">
<h3 id="heading_ora-01031">
<span class="hidden-anchor sr-only" id="ora-01031"></span>8.4. Error messages in Oracle log files</h3>
<div class="paragraph"><p>The <a href="#create_user">database user</a> for monitoring usually does not require the <code>SYSDBA</code> role.
However, note that the agent plug-in <code>mk_oracle</code> can generate error messages  (not relevant for monitoring) with multi-tenant databases which may not be written to Oracle database log files due to a lack of the <code>SYSDBA</code> privilege.
This can then lead, for example, to Oracle error messages of type <code>ORA-01031: insufficient privileges</code> in an alert log file.</p></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="heading_files">
<span class="hidden-anchor sr-only" id="files"></span>9. Files and directories</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="heading__on_the_oracle_host_under_linux_solaris_aix">
<span class="hidden-anchor sr-only" id="_on_the_oracle_host_under_linux_solaris_aix"></span>9.1. On the Oracle host under Linux, Solaris, AIX</h3>
<table class="table-responsive table-bordered table tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead><tr>
<th class="tableblock halign-left valign-top">File path</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr></thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/usr/bin/check_mk_agent</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The Checkmk agent that collects all data about the host.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/usr/lib/check_mk/plugins/mk_oracle/</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The Oracle agent plug-in in the usual directory for agent plug-ins.
Note that the path name under AIX is slightly different: <code>/usr/check_mk/lib/plugins/mk_oracle</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/etc/check_mk/oracle.cfg</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The configuration file for the agent plug-in.
Again, AIX is different: <code>/usr/check_mk/conf/mk_oracle.cfg</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/etc/check_mk/sqlnet.ora</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The configuration file required for the <a href="#oracle_wallet">Oracle Wallet</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/etc/check_mk/tnsnames.ora</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The configuration file which contains TNS aliases.
Sample files are also located in the Oracle installation, but since the path differs from installation to installation, it cannot be specified in a standardized way.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="heading__on_the_oracle_host_under_windows">
<span class="hidden-anchor sr-only" id="_on_the_oracle_host_under_windows"></span>9.2. On the Oracle host under Windows</h3>
<table class="table-responsive table-bordered table tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead><tr>
<th class="tableblock halign-left valign-top">File path</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr></thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>C:\Program Files (x86)\checkmk\service\check_mk_agent.exe</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The Checkmk agent that collects all data about the host.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>C:\ProgramData\checkmk\agent\plugins\mk_oracle.ps1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The Oracle agent plug-in in the usual directory for agent plug-ins.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>C:\ProgramData\checkmk\agent\config\mk_oracle_cfg.ps1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The configuration file for the agent plug-in.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>C:\ProgramData\checkmk\agent\config\sqlnet.ora</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The configuration file required for the Oracle Wallet.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>C:\ProgramData\checkmk\agent\config\tnsnames.ora</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The configuration file which contains TNS aliases.
Sample files are also located in the Oracle installation, but since the path differs from installation to installation, it cannot be specified in a standardized way.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="heading_files_cmk">
<span class="hidden-anchor sr-only" id="files_cmk"></span>9.3. On the Checkmk server</h3>
<table class="table-responsive table-bordered table tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead><tr>
<th class="tableblock halign-left valign-top">File path</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr></thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>~/share/check_mk/agents/plugins/mk_oracle</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The agent plug-in for Unix-like systems, which fetches the data on the Oracle host.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>~/share/check_mk/agents/plugins/mk_oracle_crs</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This agent plug-in for Unix-like systems provides data to an Oracle Cluster Manager.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>~/share/check_mk/agents/windows/plugins/mk_oracle.ps1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The agent plug-in for Windows, which fetches the data on the Oracle host.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>~/share/check_mk/agents/cfg_examples/</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Here are sample configuration files for Unix-like systems in the files <code>mk_oracle.cfg</code>, <code>sqlnet.ora</code> and <code>tnsnames.ora</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>~/share/check_mk/agents/windows/cfg_examples/mk_oracle_cfg.ps1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An example configuration file for Windows.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div></main><div id="toc" class="toc2">
<div id="toctitle">On this page</div>
<ul class="sectlevel1">
<li><a href="#intro">1. Introduction</a></li>
<li>
<a href="#first_steps">2. Initial setup</a><ul class="sectlevel1">
<li>
<a href="#create_user">2.1. Creating a database user</a><ul class="sectlevel2"><li><a href="#_multi_tenant_databases">Multi-tenant databases</a></li></ul>
</li>
<li><a href="#user_config">2.2. Creating the configuration</a></li>
<li><a href="#oracle_wallet">2.3. Using the Oracle Wallet</a></li>
</ul>
</li>
<li>
<a href="#linux">3. Setting up for Linux, Solaris, AIX</a><ul class="sectlevel1">
<li><a href="#_plug_in_and_configuration_paths">3.1. Plug-in and configuration paths</a></li>
<li><a href="#install_linux">3.2. Installing the agent plug-in</a></li>
<li>
<a href="#adv_linux">3.3. Advanced options</a><ul class="sectlevel2">
<li><a href="#adv_user_linux">Advanced user configuration</a></li>
<li><a href="#skip_include">Including or excluding instances</a></li>
<li><a href="#sections">Determining the data to be fetched</a></li>
<li><a href="#tns_config">Configuring TNS alias and TNS_ADMIN</a></li>
<li><a href="#access_linux">Access rights on execution</a></li>
</ul>
</li>
<li><a href="#remote_instances">3.4. Monitoring remote databases</a></li>
</ul>
</li>
<li>
<a href="#windows">4. Setting up for Windows</a><ul class="sectlevel1">
<li><a href="#_plug_in_and_configuration_paths_2">4.1. Plug-in and configuration paths</a></li>
<li><a href="#install_windows">4.2. Installing the agent plug-in</a></li>
<li><a href="#_special_features_under_windows">4.3. Special features under Windows</a></li>
<li>
<a href="#adv_windows">4.4. Advanced options</a><ul class="sectlevel2">
<li><a href="#adv_user_windows">Advanced user configuration</a></li>
<li><a href="#skip_include_windows">Enabling and disabling instances</a></li>
<li><a href="#sections_windows">Determining the data to be fetched</a></li>
<li><a href="#access_windows">Access rights on execution</a></li>
</ul>
</li>
<li><a href="#_monitoring_remote_databases">4.5. Monitoring remote databases</a></li>
</ul>
</li>
<li>
<a href="#bakery">5. Setting up with the Agent Bakery</a><ul class="sectlevel1">
<li><a href="#bakery_users">5.1. Configuring users</a></li>
<li><a href="#bakery_advanced">5.2. Advanced options</a></li>
</ul>
</li>
<li>
<a href="#clustered_instances">6. Clustered instances</a><ul class="sectlevel1">
<li>
<a href="#_standby_databases">6.1. Standby databases</a><ul class="sectlevel2">
<li><a href="#cluster_adg">With Active Data Guard (ADG)</a></li>
<li><a href="#cluster_dg">Without Active Data Guard (DG)</a></li>
<li><a href="#clustered_services">Setting up cluster services</a></li>
</ul>
</li>
<li>
<a href="#rac">6.2. Real Application Cluster (RAC)</a><ul class="sectlevel2"><li><a href="#_setting_up_cluster_services">Setting up cluster services</a></li></ul>
</li>
</ul>
</li>
<li>
<a href="#custom_sqls">7. Custom SQL queries (Custom SQLs)</a><ul class="sectlevel1">
<li><a href="#_why_custom_sql_queries">7.1. Why custom SQL queries?</a></li>
<li>
<a href="#_simple_custom_sql_queries">7.2. Simple custom SQL queries</a><ul class="sectlevel2">
<li><a href="#_writing_sql_queries">Writing SQL queries</a></li>
<li><a href="#_configuring_the_agent_plug_in">Configuring the agent plug-in</a></li>
</ul>
</li>
<li><a href="#adv_custom_sqls">7.3. Advanced options</a></li>
<li><a href="#own_check_plug-in">7.4. Using your own check plug-ins</a></li>
</ul>
</li>
<li>
<a href="#diagnostic">8. Diagnostic options</a><ul class="sectlevel1">
<li>
<a href="#connection_test">8.1. Testing connections</a><ul class="sectlevel2">
<li><a href="#_linux_solaris_aix">Linux, Solaris, AIX</a></li>
<li><a href="#_windows">Windows</a></li>
</ul>
</li>
<li>
<a href="#logging">8.2. Logging</a><ul class="sectlevel2">
<li><a href="#_linux_solaris_aix_2">Linux, Solaris, AIX</a></li>
<li><a href="#_windows_2">Windows</a></li>
</ul>
</li>
<li>
<a href="#debugging">8.3. Debugging</a><ul class="sectlevel2">
<li><a href="#_linux_solaris_aix_3">Linux, Solaris, AIX</a></li>
<li><a href="#_windows_3">Windows</a></li>
</ul>
</li>
<li><a href="#ora-01031">8.4. Error messages in Oracle log files</a></li>
</ul>
</li>
<li>
<a href="#files">9. Files and directories</a><ul class="sectlevel1">
<li><a href="#_on_the_oracle_host_under_linux_solaris_aix">9.1. On the Oracle host under Linux, Solaris, AIX</a></li>
<li><a href="#_on_the_oracle_host_under_windows">9.2. On the Oracle host under Windows</a></li>
<li><a href="#files_cmk">9.3. On the Checkmk server</a></li>
</ul>
</li>
</ul>
</div>
<script src="../../assets/js/manifest.js?id=7db827d654313dce4250"></script>
<script src="../../assets/js/vendor.js?id=581a3d4a61b7156d04df"></script>
<script src="../../assets/js/app.js?id=959ccd04b1f8b7b78c5e"></script>
<script src="../../assets/js/lunr.js"></script>
<script src="../../assets/js/lunr.stemmer.support.js"></script>
<script src="../lunr.index.en.js"></script>
<script src="../../assets/js/lunr.client.js"></script>
</body>
</html>
